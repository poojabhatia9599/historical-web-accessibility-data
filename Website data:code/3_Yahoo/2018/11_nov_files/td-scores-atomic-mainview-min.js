YUI.add("td-scores-atomic-mainview",function(e){"use strict";e.namespace("TD.Scores").MainView=e.Base.create("TDScoresMainView",e.Af.AppletView,[e.Mjata.Binder],{module:"Scores",autoRender:!1,events:{".SimpleTabs a":{click:"handleRange"},".expand-fold":{click:"handleToggleFold"},"#ysp-more-scores":{click:"handleScoreLinkClick",mouseover:"handleScoreLinkMouseOver"}},initializer:function(t){var i=this.get("model"),s=i.getDataModel("scores"),n=i.get("i18n");this.initRapid(),s.plug(e.Af.Poll),t.auto_update&&this.updatePolling(),"scorestrip"===t.rendermode&&e.use("stencil-carousel",function(e){}),this.mjataBind(e.TD.Scores.Model,this.get("container"),{ctx:function(){return{user_settings:i.get("settings"),i18n:n}},callback:e.bind(function(t){t||e.Stencil.initAll(this.get("container"))},this)}),s.after("reset",this.forceRender,this),s.after("*:refresh",this.refreshScores,this),i.after("stateChange",this.refreshScores,this),i.after("settingsChange",this.refreshScores,this)},initRapid:function(){var e={"td-applet-scores-atomic_container":"scrbrd"};YMedia&&YMedia.rapid&&YMedia.rapid.addModules(e)},refreshScores:function(){this._throttledRefresh||(this._throttledRefresh=e.Af.Utils.throttle(e.bind(function(){var t=this.get("model"),i=t.getDataModel("scores"),s=t.get("user_settings"),n=t.get("state");i.load(e.merge(s,n),e.bind(function(e,t){this.updatePolling()},this))},this),250)),this._throttledRefresh()},updatePolling:function(){var t,i,s=this.get("model"),n=s.getDataModel("scores"),o=s.get("user_settings"),a=s.get("state"),r=s.get("config");t=n.hasLiveGames(),i=r.states[t?"live":"not-live"].interval,(e.Af.Config.isFeatureOn("scorespipe")||!0===n.get("enablePipe"))&&(i=Math.max(r.pipe.min_polling_interval,i)),n.poll.update({interval:i},e.merge(o,a))},handleRange:function(e){var t=e.currentTarget.getAttribute("data-range");this.get("model").set("state.range",t),e.preventDefault()},handleToggleFold:function(e){var t=this.get("model"),i=e.currentTarget,s=this.get("container").one(".below-fold"),n="1"===t.get("state.folded"),o=s.getDOMNode().scrollHeight;n||s.setStyle("height",o+"px"),setTimeout(function(){i.set("disabled",!0),i.all("i").toggleClass("Dn"),s.setStyles({"-webkit-transition":"height 0.3s ease","-moz-transition":"height 0.3s ease","-o-transition":"height 0.3s ease",transition:"height 0.3s ease",height:n?o+"px":"0"}),setTimeout(function(){t.set("state.folded",n?"0":"1")},400)},1),e.preventDefault()},handleScoreLinkClick:function(e){var t=this.getMoreScoresLink();""!==t&&(!0===e.shiftKey||2===e.button?window.open(t):document.location=t)},handleScoreLinkMouseOver:function(e){var t=this.getMoreScoresLink(),i=e.target;""!==t&&i.set("href",t)},getMoreScoresLink:function(){var e=this.get("model"),t=e.get("user_settings").league||"trending",i=e.get("config");return i.scores_links&&i.scores_links[t]?i.scores_links[t]:""},destructor:function(){this.get("model").getDataModel("scores").poll.end(),this.mjataUnbind()}})},"@VERSION@",{requires:["af-applet-view","af-config","af-poll","mjata-binder","stencil-toggle","td-applet-scores-atomic-templates-score","td-scores-atomic-model"]});
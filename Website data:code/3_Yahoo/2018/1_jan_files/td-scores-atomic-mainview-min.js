YUI.add("td-scores-atomic-mainview",function(e){"use strict";var t=250;e.namespace("TD.Scores").MainView=e.Base.create("TDScoresMainView",e.Af.AppletView,[e.Mjata.Binder],{module:"Scores",autoRender:!1,events:{".SimpleTabs a":{click:"handleRange"},".expand-fold":{click:"handleToggleFold"},"#ysp-more-scores":{click:"handleScoreLinkClick",mouseover:"handleScoreLinkMouseOver"}},initializer:function(t){var n=this.get("model"),r=n.getDataModel("scores"),i=n.get("i18n");this.initRapid(),r.plug(e.Af.Poll),t.auto_update&&this.updatePolling(),t.rendermode==="scorestrip"&&e.use("stencil-carousel",function(e){}),this.mjataBind(e.TD.Scores.Model,this.get("container"),{ctx:function(){return{user_settings:n.get("settings"),i18n:i}},callback:e.bind(function(t){t||e.Stencil.initAll(this.get("container"))},this)}),r.after("reset",this.forceRender,this),r.after("*:refresh",this.refreshScores,this),n.after("stateChange",this.refreshScores,this),n.after("settingsChange",this.refreshScores,this)},initRapid:function(){var e={};e["td-applet-scores-atomic_container"]="scrbrd",YMedia&&YMedia.rapid&&YMedia.rapid.addModules(e)},refreshScores:function(){this._throttledRefresh||(this._throttledRefresh=e.Af.Utils.throttle(e.bind(function(){var n=this.get("model"),r=n.getDataModel("scores"),i=n.get("user_settings"),s=n.get("state");r.load(e.merge(i,s),e.bind(function(e,t){this.updatePolling()},this))},this),t)),this._throttledRefresh()},updatePolling:function(){var t,n,r=this.get("model"),i=r.getDataModel("scores"),s=r.get("user_settings"),o=r.get("state"),u=r.get("config");t=i.hasLiveGames(),n=u.states[t?"live":"not-live"].interval;if(e.Af.Config.isFeatureOn("scorespipe")||i.get("enablePipe")===!0)n=Math.max(u.pipe.min_polling_interval,n);i.poll.update({interval:n},e.merge(s,o))},handleRange:function(e){var t=e.currentTarget.getAttribute("data-range");this.get("model").set("state.range",t),e.preventDefault()},handleToggleFold:function(e){var t=this.get("model"),n=e.currentTarget,r=this.get("container").one(".below-fold"),i=t.get("state.folded")==="1",s=r.getDOMNode().scrollHeight;i||r.setStyle("height",s+"px"),setTimeout(function(){n.set("disabled",!0),n.all("i").toggleClass("Dn"),r.setStyles({"-webkit-transition":"height 0.3s ease","-moz-transition":"height 0.3s ease","-o-transition":"height 0.3s ease",transition:"height 0.3s ease",height:i?s+"px":"0"}),setTimeout(function(){t.set("state.folded",i?"0":"1")},400)},1),e.preventDefault()},handleScoreLinkClick:function(e){var t=this.getMoreScoresLink();t!==""&&(e.shiftKey===!0||e.button===2?window.open(t):document.location=t)},handleScoreLinkMouseOver:function(e){var t=this.getMoreScoresLink(),n=e.target;t!==""&&n.set("href",t)},getMoreScoresLink:function(){var e=this.get("model"),t=e.get("user_settings"),n=t.league||"trending",r=e.get("config");return r.scores_links&&r.scores_links[n]?r.scores_links[n]:""},destructor:function(){this.get("model").getDataModel("scores").poll.end(),this.mjataUnbind()}})},"@VERSION@",{requires:["af-applet-view","af-config","af-poll","mjata-binder","stencil-toggle","td-applet-scores-atomic-templates-score","td-scores-atomic-model"]});

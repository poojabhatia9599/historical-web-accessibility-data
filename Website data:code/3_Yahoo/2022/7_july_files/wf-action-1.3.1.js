var _____WB$wombat$assign$function_____ = function(name) {return (self._wb_wombat && self._wb_wombat.local_init && self._wb_wombat.local_init(name)) || self[name]; };
if (!self.__WB_pmw) { self.__WB_pmw = function(obj) { this.__WB_source = obj; return this; } }
{
  let window = _____WB$wombat$assign$function_____("window");
  let self = _____WB$wombat$assign$function_____("self");
  let document = _____WB$wombat$assign$function_____("document");
  let location = _____WB$wombat$assign$function_____("location");
  let top = _____WB$wombat$assign$function_____("top");
  let parent = _____WB$wombat$assign$function_____("parent");
  let frames = _____WB$wombat$assign$function_____("frames");
  let opener = _____WB$wombat$assign$function_____("opener");

!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("wafer-action",[],e):"object"==typeof exports?exports["wafer-action"]=e():(t.wafer=t.wafer||{},t.wafer.wafers=t.wafer.wafers||{},t.wafer.wafers["wafer-action"]=e())}("undefined"!=typeof self?self:this,function(){return function(t){function e(o){if(r[o])return r[o].exports;var n=r[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var r={};return e.m=t,e.c=r,e.d=function(t,r,o){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="https://web.archive.org/web/20220630233728/https://s.yimg.com/aaq/wf/",e(e.s="./src/entry.js")}({"./src/base.js":function(t,e,r){"use strict";function o(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},c=function(){function t(t,e){var r=[],o=!0,n=!1,a=void 0;try{for(var i,s=t[Symbol.iterator]();!(o=(i=s.next()).done)&&(r.push(i.value),!e||r.length!==e);o=!0);}catch(t){n=!0,a=t}finally{try{!o&&s.return&&s.return()}finally{if(n)throw a}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function t(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,r,o){return r&&t(e.prototype,r),o&&t(e,o),e}}(),l=[],d=window.wafer,f=d.constants,p=d.features,b=d.utils,v=d.WaferBaseClass,y=f.ATTR_PREFIX,m=b.fetchWithCache,h=b.findAncestor,g=b.getWaferInstanceForElem,k=["handleClick"],w="wafer-action-is-true",_={block:-1,unblock:0},S="publisher",P={},T=function(t){function e(t){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},u=i.appId,d=i.actionHost,f=i.bookmarkActionHost,p=i.crumb,b=i.id,v=i.name,m=i.providerBrandProperty,g=i.selector,_=i.shouldSaveToStorage,P=i.subType,T=i.type;n(this,e);var A=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,{selector:g},{STATE_ATTRS:l}));u=t.getAttribute(y+"app-id")||u,p=t.getAttribute(y+"crumb")||p;var O=t.getAttribute(y+"action-type")||T||"follow",E=t.getAttribute(y+"action-api-path"),j=t.getAttribute(y+"action-sub-type")||P,I=t.getAttribute(y+"action-sub-type-category")||"",L=t.getAttribute(y+"action-id")||b,B=t.getAttribute(y+"action-content-id")||"",C=t.getAttribute(y+"action-label"),H=t.getAttribute(y+"action-name")||v,x=C&&C.split("|")||[],D=c(x,2),M=D[0],R=D[1],W=t.getAttribute(y+"action-title")||"",F=t.getAttribute(y+"action-boundary"),N={follow:d+"api/v3/topics?appId="+u,block:d+"api/v1/content/feedback/"+(j===S?S:"entities")+"?appId="+u,blockProvider:d+"api/v1/providerbrands/block/providers/"+L+"?appId="+u,unblockProviderBrand:d+"api/v1/providerbrands/block?appId="+u},J=E||N[O],K=F&&h(t,F);return A._util=s({},A._util,(r={actionHost:d,apiPath:J,appId:u,bookmarkActionHost:f,boundaryElem:K,subType:j,contentId:B,crumb:p,elem:t,falseLabel:R,id:L,mappingId:L+O+j+I,providerBrandProperty:m,subTypeCategory:I,shouldSaveToStorage:void 0===_?void 0:!!_,name:H},o(r,"subType",j),o(r,"title",W),o(r,"trueLabel",M),o(r,"type",O),r)),k.forEach(function(t){A[t]=A[t].bind(A)}),A._state={actionStatus:!1,inProgress:!1},t.classList.add("has-click","has-wafer-click"),setTimeout(function(){A.setActionStatus(t.classList.contains(w))},0),A}return i(e,t),u(e,[{key:"statusDidUpdate",value:function(t){var e=this._util.elem;if(e){var r=this._util,o=r.falseLabel,n=r.trueLabel;this._state.actionStatus=t,t?(o&&e.setAttribute("title",o),e.classList.add(w)):(n&&e.setAttribute("title",n),e.classList.remove(w))}}},{key:"saveToStorage",value:function(){if(p.localStorage){var t=this._util,r=t.id,o=t.name,n=void 0===o?"":o,a=t.subType,i=t.type,s=Date.now()+9e5;return window.localStorage.setItem(e.LS_KEY,JSON.stringify({id:r,name:n,subType:a,ttl:s,type:i})),Promise.resolve()}}},{key:"triggerTopicAction",value:function(t){var e=this._util,r=e.appId,n=e.actionHost,a=e.bookmarkActionHost,i=e.contentId,s=e.id,c=e.name,u=e.providerBrandProperty,l=e.shouldSaveToStorage,d=e.subType,f=e.subTypeCategory,p=e.title,b=e.type,v=this._util.apiPath,y={follow:this._state.actionStatus?"PUT":"DELETE",block:"POST",blockProvider:this._state.actionStatus?"PUT":"DELETE",bookmark:this._state.actionStatus?"POST":"DELETE",urlBookmark:"DELETE",unblockProviderBrand:"POST"},h=y[b],g=void 0,k=void 0;return"follow"===b?(g={types:o({},d,[{id:s}])},k={Crumb:t},"provider"===d&&(g.types[d][0].type=f||"PROVIDER")):"block"===b?(g={entities:[{entity_id:s,entity_type:d,score:_[this._state.actionStatus?"block":"unblock"]}]},k={Crumb:t},d===S&&(g.entities[0].entity_name=c)):"blockProvider"===b?(g={property:u},k={Crumb:t}):"unblockProviderBrand"===b?(g={brands:[{id:s}]},k={Crumb:t}):"bookmark"===b?("DELETE"===h?v=a+"api/v1/user/bookmarks/"+d+"/"+i+"?appId="+r:(v=a+"api/v1/user/bookmarks/"+d+"?appId="+r,g={contentId:i,title:p}),k={"X-CSRF-Token":t}):"urlBookmark"===b?(v="deleteFolder"===d?n+"api/v1/bookmarks/folders/"+i+"?appId="+r:n+"api/v1/bookmarks/items/"+i+"?appId="+r,k={Crumb:t}):"location"===b&&(g={requests:{g0:{resource:"WeatherLocationService.favoriteLocation",operation:this._state.actionStatus?"create":"delete",params:{woeid:s}}}}),l?this.saveToStorage():m(v,{body:JSON.stringify(g),cache:0,clientHeaders:k,credentials:"include",method:h,mode:"cors"})}},{key:"getCrumb",value:function(){var t=this._util,e=t.appId,r=t.actionHost,o=t.bookmarkActionHost,n=t.shouldSaveToStorage,a=t.type;if("location"===a)return Promise.resolve({});var i=this._util.crumb||P[a];if(i||n)return new Promise(function(t){t(i||"")});var s=void 0;return s="bookmark"===a?o+"api/v1/auth/crumb?appId="+e:r+"api/v1/auth/crumb?appId="+e,m(s,{cache:0,credentials:"include",mode:"cors"}).then(function(t){var e=t.crumb;if(P[a]=e,!e)throw new Error("crumb not found");return e})}},{key:"trigger",value:function(t){var e=this;if(t){var r=this._util.type,o=t.crumb;o&&(P[r]=o),this._util=s({},this._util,t)}var n=this._util,a=n.elem,i=n.boundaryElem,c=n.name,u=this._state.actionStatus;this._state.inProgress=!0,i&&i.classList.add("wafer-action-in-progress"),u?this.setActionStatus(!1):this.setActionStatus(!0),this.getCrumb().then(function(t){return e._state.inProgress=!1,e.triggerTopicAction(t)}).then(function(t){var r=t||{},o=r.result,n=void 0===o?{}:o,u=n.success,l=void 0===u?{}:u,d=l.entities,f=void 0===d?[]:d,p=e._util,b=p.id,v=p.subType,m=p.type,h={id:b,name:c,subType:v,type:m};if("blockProvider"===m||"unblockProviderBrand"===m){var k=t.data;k=void 0===k?{}:k;var w=k.currentBlocked;void 0!==w&&(h=s({currentBlocked:w},h))}var _="follow"===m&&f.some(function(t){return t.id===b}),S=("block"===m||"blockProvider"===m||"unblockProviderBrand"===m)&&(null!==t&&t===Object(t)),P="bookmark"===m&&(null!==t&&t===Object(t)),T="urlBookmark"===m&&(null!==t&&t===Object(t)),A=void 0;if("follow"===m)A=_;else if("block"===m||"blockProvider"===m||"unblockProviderBrand"===m)A=S;else if("urlBookmark"===m)A=T;else if("location"===m){var O=e._util.locationAssistTargetElem;if(!O){var E=a.getAttribute(y+"action-location-assist-target");E&&(O=e._util.locationAssistTargetElem=document.querySelector(E))}if(O){var j=g(O,"wafer-autocomplete");j&&j.instance._instance.fetchAndRenderSavedLocations()}A=!0}else A=P;if(!A)throw i&&(i.classList.add("wafer-action-boundary-error"),i.remove("wafer-action-boundary-success","wafer-action-in-progress")),new Error("action failed");i&&(i.classList.add("wafer-action-boundary-success"),i.remove("wafer-action-boundary-error","wafer-action-in-progress")),e.didComplete(null,h)}).catch(function(){e._state.inProgress=!1,i&&(i.classList.remove("wafer-action-in-progress","wafer-action-boundary-success"),i.add("wafer-action-boundary-error")),e._state.actionStatus=!e._state.actionStatus,e.setActionStatus(e._state.actionStatus)})}},{key:"handleClick",value:function(t){t.preventDefault(),this._state.inProgress||this.trigger()}}]),e}(v);T.events={click:[["has-click","handleClick"]]},T.LS_KEY=y+"action-storage",e.default=T,t.exports=e.default},"./src/controller.js":function(t,e,r){"use strict";function o(){return c=n(r("./src/base.js"))}function n(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var c,u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},l=function(){function t(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,r,o){return r&&t(e.prototype,r),o&&t(e,o),e}}(),d=window.wafer,f=d.controllers,p=d.features,b=d.utils,v=f.WaferBaseController,y=b.getConfigFromJSONScriptNode,m=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.root,n=void 0===r?document:r,s=t.selector;a(this,e);var l=y(document.getElementById("wafer-action-config")),d=l.actionHost,f=l.appId,b=l.bookmarkActionHost,v=l.crumb,m=l.providerBrandProperty,h=l.shouldSaveToStorage,g=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,{root:n,selector:s,props:{actionHost:d,appId:f,bookmarkActionHost:b,crumb:v,providerBrandProperty:m,shouldSaveToStorage:h,selector:s},WaferClass:(c||o()).default})),k=g;return g.sync(),g._state=u({},g._state,{idInstanceMapping:new Map}),(c||o()).default.prototype.setActionStatus=function(t){var e=this._util.mappingId,r=k._state.idInstanceMapping;r.has(e)||r.set(e,[]),r.get(e).push(this),r.get(e).forEach(function(e){e.statusDidUpdate(t)})},p.localStorage&&setTimeout(function(){g.processStoredAction(l,s)},1),g}return s(e,t),l(e,[{key:"processStoredAction",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(t.shouldProcessState){var r=t.actionHost,n=t.appId,a=t.bookmarkActionHost,i=t.crumb,s=t.providerBrandProperty,l=window.localStorage.getItem((c||o()).default.LS_KEY);if(l){var d=document.createElement("div"),f={actionHost:r,appId:n,bookmarkActionHost:a,crumb:i,providerBrandProperty:s,selector:e};try{var p=JSON.parse(l),b=p.id,v=p.name,y=p.ttl,m=void 0===y?0:y,h=p.subType,g=p.type;m&&m>=Date.now()&&g&&h&&b&&(d.setAttribute("data-wf-on","complete:setState:wfAction.entity."+g),new((c||o()).default)(d,Object.assign({},f,{id:b,name:v,subType:h,type:g})).trigger(u({},f,{id:b,name:v,subType:h,type:g})))}catch(t){}window.localStorage.removeItem((c||o()).default.LS_KEY)}}}}]),e}(v);e.default=m,t.exports=e.default},"./src/entry.js":function(t,e,r){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n;e.default=new((n||function(){return n=o(r("./src/controller.js"))}()).default)({selector:".wafer-action"}),t.exports=e.default}})});

}
/*
     FILE ARCHIVED ON 23:37:28 Jun 30, 2022 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 12:02:40 Jan 24, 2024.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
*/
/*
playback timings (ms):
  exclusion.robots: 0.066
  exclusion.robots.policy: 0.058
  cdx.remote: 0.097
  esindex: 0.011
  LoadShardBlock: 185.107 (6)
  PetaboxLoader3.datanode: 147.637 (8)
  load_resource: 208.568 (2)
  PetaboxLoader3.resolve: 146.826 (2)
*/
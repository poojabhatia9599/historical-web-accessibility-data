YUI.add("ads_bridge_service",function(b){var m=b.config,c=m.win,g=m.doc.documentElement,n=b.DOM,j="ad-takeover",h="ad-running",d=false,i,k=b.ModulePlatform,f="MPServices",a="AdsBridgeProvider",e,l;c.ad_running=function(q){if(d){return false;}var p=g.className.match(/[^\-](bkt\d+)/),o=p&&p[1]?h+"-"+p[1]:"",r=q?n.addClass:n.removeClass;r(g,h);r(g,o);return true;};c.ad_takeover=function(q){if(d){return false;}var p=g.className.match(/[^\-](bkt\d+)/),o=p&&p[1]?j+"-"+p[1]:"",r=q?n.addClass:n.removeClass;r(g,j);r(g,o);return true;};c.ad_feature_active=function(){return d;};c.ad_user_info=function(){var o=null;if(l){o={loc:l.getLocation()||null};}return o;};i={MODULE_ACTIVE:"moduleactive",fire:function(o){var p=c.ad_action;if(o.type==this.MODULE_ACTIVE){d=!!o.active;}if(b.Lang.isFunction(p)){p(b.merge({detail:{}},o));}}};b.namespace(f);b[f][a]={name:"ads_bridge",getService:function(p,o){if(!e){e=p;l=e.getService("userinfo");}return i;}};if(k){k.registerService(b[f][a]);}});/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */
(function(){var s,k,y,q,t,D,p,A,b,g,C,w,i,u,n,z=false,B=[],v="",m="",c="pa:open",f="pa:close",o="stream:new_content",j="modal:open",x="modal:close",e="apps:resized",d="fp:window:scroll",h="fp:window:resize",a="fixed-enabled",r=40,l=500;YModules.type_fp={viewevents:["click","contextmenu"],lastScroll:0,scrollSince:0,scrollTimer:null,init:function(E){D=E;A=D.getService("moduleplatform");b=D.getService("yui");g=b.config.win;p=D.getId();s=D.getService("ads_bridge");k=D.getService("instrumentation");q=D.getService("modal");w=D.getService("sethomepage");C=D.getService("metrologger");y=D.getService("sticky_position");},onviewload:function(I){this.listeners=[];if(I=="default"){var H=D.getContextData("ilc"),F,G,E;this.body=D.getViewNode(I);this.fixCenterCol=A.getProperty("filters.bar.enable");this.mHeight=b.one("#masthead").get("offsetHeight");this.wrapper=b.one(".main-row-wrapper")||b.one(".main-col-wrapper");this.scrollY=0;if(y){E={top:this.mHeight,onSticky:b.bind(this.onStickyHandler,this),onLoose:b.bind(this.onLooseHandler,this)};y=new y({".sticky-rail-right-holder":E,".sticky-rail-left-holder":E,"#stream .type_fstream":E});D.listen(e);}B=A.queryModules(function(J){var K=A.getModuleState(J);return !!(K&&K.defer);});A.subscribe("error",this.handleError,this,true);A.subscribe("navigate",this.handleNavigate,this,true);A.subscribe("modulesignal",this.handleModuleSignal,this,true);A.subscribe("ready",this.handleReady,this,true);D.listen(f);D.listen(c);D.listen(j);D.listen(x);D.listen(o);this.watchScroll();this.watchResize();this.handleAction("resize");if(B.length>0){b.on("load",b.bind(this.loadDeferred,this),window);}if(D.getContextData("deferredRes")){G=D.getContextData("deferredResDelay");if(G>0){b.on("load",b.rbind(function(J){b.later(J,this,this.loadDeferredRes);},this,[G]),window);}else{b.on("load",b.bind(this.loadDeferredRes,this),window);}}if(w.getHpCookie()===null){F=w.isHomepageSet(H)?"1":"0";w.setHpCookie(H,F);b.on("load",b.bind(this.logHomepageSet,this,H,F),window);}if(b.UA.ie===9){if(window.external&&("msIsSiteModeFirstRun" in window.external)&&(1===window.external.msIsSiteModeFirstRun(true))){this.beaconIE9PinningAction();}}b.on("unload",function(){v="unload";},window);}},isFixedEnabled:function(){return this.body.hasClass(a);},onStickyHandler:function(F,E){if(E==="top"){F.setStyles({top:this.mHeight,bottom:""});}else{F.setStyles({top:"",bottom:0});}},onLooseHandler:function(E){E.setStyles({top:"",bottom:"",width:""});},watchResize:function(){this.listeners.push(b.on("resize",function(E){this.handleAction("resize");},g,this));},watchScroll:function(){this.listeners.push(b.on("scroll",function(E){var F=+(new Date())-this.lastScroll;this.scrollSince=F;if(this.scrollTimer){this.scrollTimer.cancel();}if(F>=r){this.handleAction("scroll");}else{this.scrollTimer=b.later(r-F,this,this.handleAction,"scroll");}},g,this));},handleAction:function(G){var E=this.viewport,I=b.DOM.docScrollY(),H=this.body,F;this.lastScroll=+(new Date());this.scrollY=I;if(G==="resize"){F=parseInt(this.wrapper.getStyle("min-width"),10)||980;E=this.viewport=b.DOM.viewportRegion();this.body.toggleClass(a,(E.width>=F));}H.toggleClass("has-scrolled",I>0);if(y){if(this.scrollSince>l){y.recalculateThresholds(E);}y.trigger(E,I,G,b.bind(this.isFixedEnabled,this));}D.broadcast(G==="scroll"?d:h,{type:G,viewport:E});},openModal:function(F,E){if(!t){t=q.create(F.config);}t.setContent(F.content);t.show();},closeModal:function(E){if(!t){return;}t.setContent("");t.hide();},onviewunload:function(E){if(E=="default"){if(u){u.cancel();}A.unsubscribe("error",this.handleError);A.unsubscribe("navigate",this.handleNavigate);A.unsubscribe("modulesignal",this.handleModuleSignal);A.unsubscribe("ready",this.handleReady);u=i=null;}},onviewevent:function(I,F){var G=F.target,H=G&&F.button===1&&G.ancestor(".back-to-top",true),E;if(F.type=="contextmenu"){G=G.get("tagName")=="A"?G:G.ancestor("A");if(G){E=G.getAttribute("href").replace(location.href,"");if(E.charAt(0)=="#"||/^javascript:/i.test(E)){F.preventDefault();}}}if(H){H.blur();g.scrollTo(0,0);k.fireYwaBeacon({slk:z?"top-msg":"top",sec:"td-strm-btn",action:"click",outcome:"top"});}},onmessage:function(K,G,I){var J,F,H,E;switch(K){case e:if(y){y.recalculateThresholds(this.viewport);y.trigger(this.viewport,this.scrollY,"resize",b.bind(this.isFixedEnabled,this));}return;case j:this.openModal(I,false);return;case x:this.closeModal(false);return;case c:case f:if(!i){i=b.one("#y-cols");}if(i){i.toggleClass("y-pa-open",(K===c));}if(!m||K!=m){m=K;s.fire({type:s.MODULE_ACTIVE,module:G,active:(K===c),detail:{mode:I&&I.type?"module":"panel"}});}return;case o:J=this.body.one(".back-to-top");F=J&&J.one(".new-stories-notif");if(F){H=b.Object.getValue(I,["count"])||0;E=H&&b.Object.getValue(I,["message"])||"";z=!!(E);F.setContent(E).toggleClass("show",z);if(z){k.fireYwaBeacon({action:"secview",sec:"td-strm-btn",outcome:"cuetop"});}}return;default:}},loadDeferred:function(){b.Array.each(B,function(E){A.refreshView(E,"default");});B=[];},loadDeferredRes:function(){var E=D.getContextData("deferredRes"),F;if(E){F=A.getService("resourcemgr");b.Array.each(E,function(G){F.load(G);});}},logHomepageSet:function(F,E){k.firePageParameterBeacon("hpset="+E+(F?"&ilc="+F:""));},handleReady:function(F){var E=OnloadCache;E.dispatch();E.reset();},handleError:function(J){C.logError(J.moduleId,J.errorType+"(view="+J.view+",pageMode= "+v+"):"+J.error.message);if(v!="unload"){var E,I,F,H,L,K;if(!J.moduleId){return;}if(J.errorType=="onviewunload"&&(J.viewName=="default"||(J.args&&J.args[0]=="default"))){return;}else{try{E=J.html;I=J.moduleId;F=A.getModuleApi(I);L=F.getProperty("type");H=D.getString("STR.MODULE.ERROR_FALLBACK_TEXT");K=A.getProperty("errorDetails");if(K||(L!="pa"&&L!="pacontainer"&&L!="masthead"&&L!="fptoday")){if(K){H="JavaScript error: "+J.error.message;}if(!E){E=b.Lang.sub(A.getProperty("modErrorHtml"),{message:H,name:F.getProperty("title"),img:F.getProperty("icon"),title:F.getProperty("title"),url:F.getProperty("detailUrl")});}this.showModuleDefaultViewError(I,E);}}catch(G){}}}},handleModuleStart:function(H){var G=H.moduleId,E=A.getModuleApi(G),I=E.getProperty("type"),F=E.getContextData("mods");if(I!="fp"&&I!="pa"){if(b.Lang.isArray(F)){b.Array.each(F,function(J){A.registerModule(J);A.start(J.props.id,true,true);});}}},handleNavigate:function(E){if(k.hasPendingBeacons()){k.firePendingBeacons();}b.later(200,this,function(F){location.href=F;},E.url);},handleModuleSignal:function(G){if(G.signal=="viewevent"){var F=G.args[1],H=F.target,E=H.get("tagName");if((E=="SELECT"||E=="OPTION")){if(E=="SELECT"){b.detach("selectchange|change");H.on("selectchange|change",function(I){this.processInstrumentation(I.target,true);},this);}return;}this.processInstrumentation(H,(G.moduleId==p));}},processInstrumentation:function(F,E){k.collectData(F);if(E){k.firePendingBeacons();}},showModuleDefaultViewError:function(L,H){var J=A.getModuleApi(L),G=J.getProperty("detailUrl"),E=A.getViewNode(L,"default"),K=(E?E.ancestor(".mod"):null),F=b.Lang.sub(A.getProperty("modChromeHtml"),{html:H,type_name:J.getProperty("type"),view_name:"error"}),I=b.Node.create(F);if(!G){I.addClass("no-link");}if(K){K.set("innerHTML","").appendChild(I);}},fontResizeDetect:function(){var F=b.one("#y-width"),H=parseInt(F.getComputedStyle("width").substring(-2),10),I=b.one("#y-min-width"),G=parseInt(I.getComputedStyle("width").substring(-2),10),E=b.one("body");if(H<G){E.addClass("min-width");}else{if(H>G){E.removeClass("min-width");}}u=b.later(300,this,this.fontResizeDetect);},beaconIE9PinningAction:function(){var E=Math.random(),F="http://pclick.internal.yahoo.com/p/s=2145185763&t="+E;n=new Image();n.onload=n.onerror=function(){n=null;};n.src=F;}};})();/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */
var MORE_MENU_CLASS="uh-more-menu",MENU_EXPOSED_CLASS="menu-active",MOUSEOVER="mouseover",MOUSEOUT="mouseout";YModules.type_universalheader={body:null,editBody:null,id:"",moduleapi:null,viewevents:["click"],instrumentation:null,tooltipService:null,tooltip:null,autoHide:null,init:function(a){this.Y=a.getService("yui");this.id=a.getId();this.moduleapi=a;this.instrumentation=a.getService("instrumentation");this.listeners=[];this.moreClickEnabled=a.getContextData("moreClickEnabled");},onviewload:function(b){var a=this.moduleapi;if(b==="default"){this.body=a.getViewNode(b);this.registerAutoHide();if(!this.moreClickEnabled){this.listeners.push(this.Y.one(".uh-more-menu").on(MOUSEOVER,this.mouseenterleave,this,this.clearSiteMenuHideTimer));this.Y.one(".uh-more-menu").on(MOUSEOUT,this.mouseenterleave,this,this.Y.bind(this.hideMoreMenuMouse,this,"more"));this.Y.one("#uh-more-link").on(MOUSEOUT,this.mouseenterleave,this,this.Y.bind(this.hideMoreMenuMouse,this,"more"));this.Y.one("#uh-more-link").on(MOUSEOVER,this.mouseenterleave,this,this.Y.bind(this.exposeMoreMenuMouse,this,"more"));}}},registerAutoHide:function(){var c=this.Y,a=this.moduleapi.getService("autohide"),b=this.body.one("."+MORE_MENU_CLASS),d=this.body.one("#uh-more-link");this.menu=b;this.moreLink=d;this.autoHideId=a.register({targets:[d,b],hide:c.bind(this.hideMoreMenu,this)});this.autoHide=a;},onviewunload:function(a){if(a==="default"){this.body=null;}else{if(a==="edit"){this.editBody=null;}}},onviewevent:function(b,a){var c;if(b==="default"){c=a.target.ancestor("#uh-more-link",true,".type_universalheader");if(c&&this.moreClickEnabled){if(!c.hasClass(MENU_EXPOSED_CLASS)){this.exposeMoreMenu();}else{this.hideMoreMenu();}a.preventDefault();}}},exposeMoreMenu:function(){var a,b=this.body.one("ul").all("li")._nodes.length;this.moreLink.addClass(MENU_EXPOSED_CLASS);this.menu.removeClass("d-n");a={sec:"hd-nav",slk:"more",ltxt:this.moduleapi.getContextData("str.more"),cpos:b,itc:1};this.instrumentation.fireUltBeacon(a);},hideMoreMenu:function(){this.moreLink.removeClass(MENU_EXPOSED_CLASS);this.menu.addClass("d-n");},exposeMoreMenuMouse:function(){if(!this.siteMenuExposeMenuTimer){this.siteMenuExposeMenuTimer=setTimeout(this.Y.bind(function a(){this.exposeMoreMenu();this.siteMenuExposeMenuTimer=null;},this),300);}},hideMoreMenuMouse:function(){if(!this.siteMenuHideTimer){this.siteMenuHideTimer=setTimeout(this.Y.bind(function a(){this.hideMoreMenu();this.siteMenuHideTimer=null;},this),700);}},clearSiteMenuHideTimer:function(){if(this.siteMenuHideTimer){window.clearInterval(this.siteMenuHideTimer);this.siteMenuHideTimer=null;}},mouseenterleave:function(d,a){var c=d.currentTarget,b=d.relatedTarget;if(c!==b&&!c.contains(b)){a.call(this,d);}}};/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */
(function(){var f="mouseover",c="mouseout",a="tab_enter",e="tab_exit",g="innerHTML",d=null;function b(k,h){var j=k.currentTarget,i=k.relatedTarget;if(j!==i&&!j.contains(i)){h.call(this,k);}}YModules.type_tabbar={body:d,id:"",api:d,viewevents:["click"],events:d,tiles:d,ulm:d,locWidget:d,locaBadgeReq:d,init:function(h){this.Y=h.getService("yui");this.id=h.getId();this.api=h;this.events=[];},onviewload:function(q){var n=this.api,v=n.getViewNode(q),j=this.handleEnterLeave,i=this.id,s,m,k,u,h,o,l,p,t,r;s=v.getById(i+"-tiles");r=this.tiles=s.all(".tab");this.body=v;this.locaBadgeReq=this.api.getContextData("localbadge");this.Y.each(r,this.Y.bind(function(w){this.events.push(w.on(f,b,this,j),w.on(c,b,this,j));},this));l=v.one(".local-drop");if(l){m=n.getService("ulm");n.listen("ulm:defaultlocation");this.ulm=m.create(l.one(".y-ulm"),{setDefault:true});this.ulm.subscribe("locationselect",this.onLocationSelect,this);l.removeClass("hide");l.one(".y-ulm-dd").addClass("hide-textindent");}else{if(v.one("#mld-widget")){n.listen("ldw:defaultlocation");o=n.getService("locdrop_widget");p=n.getContextData("locale");t=n.getContextData("locdrop_crumb");k=n.getContextData("country_filter");u=n.getContextData("def_loc");h=n.getContextData("cur_loc");this.locWidget=o.create("#mld-widget",{crumb:t,locale:p,countryFilter:k,currentLoc:h,defaultLoc:u});this.locWidget.subscribe("locationselect",this.onLocWidgetSelect,this);}}s.destroy();},onmessage:function(h,i,j){if((h==="ulm:defaultlocation"||h==="ldw:defaultlocation")&&i!="tabbar"){this.updateLocation(j.loc);}},updateLocation:function(i){var h={type:"module",moduleId:this.id,args:{_action:"show",_subAction:"ulmLocationSelect",ulmLocation:i}},j={success:this.onUpdateLocationSuccess,failure:this.onUpdateLocationFailure,argument:{},scope:this};this.api.makeRequest(h,j);},onUpdateLocationSuccess:function(h,i){if(h.html){this.body.one(".local-txt").set(g,h.html);}},onUpdateLocationFailure:function(h,i){},onLocationSelect:function(i){var h,j;if(i.response.html){h=this.body.one(".local-txt");h.set(g,i.response.html);j=(i.response.data._ULM_LOCATION)?i.response.data._ULM_LOCATION:i.location;if(this.locaBadgeReq&&j){if(NILE&&NILE.onLocationChange){NILE.onLocationChange(j);}}}},onLocWidgetSelect:function(h){this.updateLocation(h);},onviewunload:function(h){this.body.destroy();this.Y.Array.each(this.events,function(i){i.detach();});this.tiles.destroy();this.body=this.events=this.tiles=d;},onviewevent:function(p,k){var m,l=k.target,i,o,h,n,q=this.body.one(".y-menu"),j;if(l.hasAttribute("aria-haspopup")){k.preventDefault();q.setStyle("visibility","visible");q.setAttribute("aria-hidden",false);j=this.Y.one("body").on("focus",function(r){if(!q.contains(r.target)){q.setStyle("visibility","hidden");q.setAttribute("aria-hidden",true);j.detach();}});}if(!l.hasClass("lw")&&!l.ancestor(".lw")&&!l.hasClass("y-ulm")&&!l.ancestor(".y-ulm")&&l.get("nodeName").toLowerCase()!="a"){i=l.hasClass("tab")?l:l.ancestor(".tab");if(i){n=i.one(".mod");m=l.get("className");if((!n||!n.contains(l)||/\btab-(?:label|caption)\b/.test(m))&&!l.hasClass("feature-cue")&&!l.ancestor(".feature-cue")){o=i.one(".tab-label");h=o.get("href");if(h){this.api.navigate(h);}o.destroy();}}}},handleEnterLeave:function(m){var o=m.type==f?a:e,j=m.currentTarget,l,k=j.one(".bd"),n,i,h;if(!k){return;}i=k.get("className");h=/type_(\w+)/.exec(i);if(h&&h[1]){n=h[1];l=m.target;if("mail"===n&&(l.hasClass("feature-cue")||l.ancestor(".feature-cue"))){return;}this.api.broadcast(o,{moduleType:n});}else{}}};})();/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */
(function(){var x=null,j=true,s=false,l=47,v="-tuc",e="-nickname-p2",b="default",o="browser",t="parentNode",c="offsetWidth",f="width",u="hidden",a="tuc-dropdown",g="tuc-nickname",h=".name",i="active",y="y-bg-3",w="y-hdr-link",r="y-txt-1",d="27",k="px",m="tab_enter",p="tab_exit",n=400,q="rtl";YModules.type_tuc={id:"",body:x,viewevents:["click"],moduleapi:x,autoHideService:x,autohideTuc:x,tucDropdown:x,type:x,menu:x,isShown:s,timer:x,tucContentReqId:null,arcadeTransport:null,isWave3:s,isWave3badge:s,socialLoginEnable:s,isLoggedIn:s,isLoggedInFB:s,isLinkedFB:s,init:function(z){this.Y=z.getService("yui");this.id=z.getId();this.moduleapi=z;this.platform=z.getService("moduleplatform");if(this.platform){this.arcadeTransport=this.platform.getService("arcade_transport");}else{this.arcadeTransport=z;}this.arcadeTransport=z;this.isWave3=z.getContextData("wave3");this.isWave3badge=z.getContextData("wave3badge");this.socialLoginEnable=z.getContextData("tuc.social.login");this.type=z.getProperty("type");this.browser=z.getContextData(o);this.isLoggedInFB=z.getContextData("fb.loggedin");this.isLinkedFB=z.getContextData("fb.account.linked");},onviewevent:function(B,z){var C=this.id,A=z.target;if(B===b){switch(A.get("id")){case C+"-tuc-nickname":case C+"-nickname-p1":case C+"-nickname-p2":case C+"-tuc-nickname-arrow":z.preventDefault();this.toggleTuc();break;default:if(A.hasClass("theme")){z.preventDefault();if(A.get("id")&&!A.get(t).hasClass("selected")){this.selectTheme(A);}}break;}}},onviewload:function(C){var B=this.moduleapi,D=this.id,A,z;this.isLoggedIn=(B.getService("userinfo").isLoggedIn()||B.getContextData("recognizedState"));if(C===b){this.body=B.getViewNode(b);this.autoHideService=B.getService("autohide");A=this.body;this.tucDropdown=A.getById(D+"-"+a);z=A.one(h);this.autohideTuc=this.attachEvents(z,{hide:this.tucHide,keyup:this.tucKeyUp});}if(this.isLoggedIn&&this.isWave3==j){B.listen(m);B.listen(p);}if(!this.isLoggedIn&&this.socialLoginEnable){B.listen(m);B.listen(p);}},onviewunload:function(B){var A=this.body,z=A.one(h);if(B===b&&this.isWave3!=j){this.detachEvents(z,{hide:this.tucHide,keyup:this.tucKeyUp});this.tucDropdown=x;this.autohideTuc=x;this.autoHideService=x;}else{this.clear();if(this.menu){this.menu.destroy();}this.menu=x;}},attachEvents:function(C,B){var z,A;if(C){for(A in B){if(B[A]){switch(A){case"hide":z=this.autoHideService.register({targets:[C],hide:this.Y.bind(B[A],this,s)});break;case"keyup":C.on(A,B[A],this,j);break;default:break;}}}}return z;},detachEvents:function(B,A){var C=this.autoHideService,z;if(B){for(z in A){if(A[z]){switch(z){case"hide":if(C){C.unregister(A[z]);}break;case"keyup":B.detach(z,A[z]);break;default:break;}}}}},tucShow:function(){var E=this.id,A=this.body,z=A.getById(E+v),D=this.tucDropdown,C=z.getById(E+"-"+g),B=z.getById(E+e);D.removeClass(u);z.addClass(i);C.addClass(y);B.replaceClass(w,r);this.positionUserCard();},tucHide:function(){var E=this.id,A=this.body,z=A.getById(E+v),D=this.tucDropdown,C=z.getById(E+"-"+g),B=z.getById(E+e);D.addClass(u);z.removeClass(i);C.removeClass(y);B.replaceClass(r,w);},onmessage:function(B,z,A){if(A.moduleType==this.type){this.showHideLater(B==m);}},onMenuExecute:function(B){var A=B.url,z=B.relatedTarget.hasClass("popup");if(A&&!z){this.moduleapi.navigate(A);}},selectTheme:function(C){var z,D,A=this.moduleapi,B=C.get("id").split("th-")[1];z={type:"module",moduleId:this.id,args:{_container:0,_action:"show",_subAction:"theme",_theme:B}};D={success:this.handleThemeSuccess,failure:this.handleThemeFailure,argument:C,scope:this};A.makeRequest(z,D);},handleThemeSuccess:function(z,E){var D=this.Y.DOM.byId("tmp-css"),C,A,G,F,B;if(!D){return;}if(this.browser=="IE"){A=D.cloneNode(false);document.body.appendChild(A);if(A.styleSheet!==x){A.styleSheet.cssText=z.html;}else{window.location.reload();}D.parentNode.replaceChild(A,D);}else{if(D.hasChildNodes()){D.removeChild(D.firstChild);}D.appendChild(document.createTextNode(z.html));}C=this.body.getById(this.id+"-color").one(".selected");C.removeClass("selected");C=C.one("a");G=C.getStyle("backgroundPosition").split(" ");G[1]="0";C.setStyle("backgroundPosition",G[0]+" "+G[1]);F=E.get(t);G=E.getStyle("backgroundPosition").split(" ");G[1]="-15px";E.setStyle("backgroundPosition",G[0]+" "+G[1]);F.addClass("selected");B=this.moduleapi.getService("statemgr");if(B){B.update();}},handleThemeFailure:function(){},makeTucRequest:function(){var B={_action:"show",_subAction:"tuc_preview"},z=this.arcadeTransport,A=null,C={success:this.processTucSuccess,failure:this.processTucFailure,scope:this};A={type:"module",moduleId:this.id,args:B};this.requestObject=A;this.callback=C;if(z.isRequestPending(this.tucContentReqId)){z.abortRequest(this.tucContentReqId);}this.tucContentReqId=z.makeRequest(A,C);},processTucSuccess:function(z,A){this.body.appendChild(z.html);this.showHideTUC(j);},processTucFailure:function(z,A){},showHideLater:function(z){this.clear();this.timer=this.Y.later(n,this,this.showHide,z);},showHide:function(z){var A=this.menu;if(this.isShown==z){return;}if(!A){if(this.isWave3badge==j&&!this.body.one("#"+this.id+"-menu")){this.makeTucRequest();}else{this.showHideTUC(z);}}else{this.showHideTUC(z);}},showHideTUC:function(z){var C=this.moduleapi,B,E=this.menu,D,A;if(!E){B=C.getService("menu");E=B.create("#"+this.id+"-menu");E.on("execute",this.onMenuExecute,this);this.menu=E;}A=this.Y.one(".login-menu-pointer");this.clear();if(z){E.show({left:-88,top:110},null,"%");if(A){A.setStyle("display","block");}D=C.getService("instrumentation");D.fireBeacon(C.getContextData("showBeacon"));}else{if(A){A.setStyle("display","none");}E.hide(false);}this.isShown=!!z;},clear:function(){if(this.timer){this.timer.cancel();}this.timer=x;},toggleTuc:function(){var z=this.body.getById(this.id+v);if(z&&z.hasClass(i)){this.tucHide();}else{this.tucShow();}},tucKeyUp:function(z){if(z.keyCode&&z.keyCode==d){this.tucHide();}},positionUserCard:function(){var C=this.Y.UA,B=this.body,E=this.moduleapi.getViewDirection("default"),A=B.getById(this.id+"-"+g),H=A.getX(),G=A.get(c),z=this.tucDropdown,D=z.get(c),F=G+l;if(F>D){z.setStyle(f,F+k);}F=z.get(c);if(C.ie&&C.ie<8){if(E==q){z.setX(H+G-F);}else{z.setX(H);}}}};})();/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */
YUI.add("transport_helper_service",function(f){var a="MPServices",e="TransportHelperServiceProvider",c="abort",d={};function b(g,h){this.arcadeTransport=g.getService("arcade_transport");this.moduleapi=g.getModuleApi(h);this.arcadeLiteEnabled=g.getProperty("arcadeLiteEnabled");}b.prototype={makeRequest:function(g,j){var i=f.clone(g||{},true),h=this.arcadeTransport;if(i.ups||i.udb||this.arcadeLiteEnabled==="0"){h=this.moduleapi;if(!i.ups){i.noups=1;}delete i.ups;delete i.udb;}return{transport:h,id:h.makeRequest(i,j),abort:function(){return this.transport.abortRequest(this.id);}};},wasAborted:function(g){return(g&&(g.result===c||g.statusText===c));}};f[a][e]={name:"transport_helper",getService:function(g,h){if(!d.hasOwnProperty(h)){d[h]=new b(g,h);}return d[h];}};if(f.ModulePlatform){f.ModulePlatform.registerService(f[a][e]);}},"1.0");/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */
YUI.add("login",function(f){var x=null,B="MPServices",N="LoginProvider",e=f.ModulePlatform,n=f.config.win,A="p_30345826",k="at",F="ylogin",U="fblogin",v="fblink",t="fbrefresh",m="a."+F+",a."+U+",a."+v+",a."+t+",.login-tooltip",p="login:fbinfo_refreshed",I="click",r="vertical",o=/http[s]?:\/\/[\S]*[&|?].done=(.*)/,H=1,E=3,D,a,L,C=x,d,T,R,G=x,i="",b="",q="",M=x,w=[],j;function c(){return G;}function g(){R.one("#cookie-refresh").remove();if(M){M();}}function O(Y){var X=n.location.protocol+"//"+f.config.win.location.host,V=encodeURIComponent(X+"/credstore_proxy/CredStoreEventsProxy.php?callback_function=cookie_refresh"),W='<iframe id="cookie-refresh" src="https://login.yahoo.com/config/refresh_cookie?.done='+V+'" height="0px" width="0px" class="vh"></iframe>';M=Y;R.append(W);}function P(X,V){if(X&&X==="200"){O(function W(){n.location.replace(n.location.href.split("#")[0]);});}else{}}function h(){var W,V;V=f.on("message",function(X){var Y=X._event;if(Y.data&&Y.origin&&/https?:\/\/.*\.yahoo\.com:?[0-9]*$/.test(Y.origin)){if(V&&f.Lang.isFunction(V.detach)){V.detach();}P(Y.data,Y.origin);}});W="http://"+n.location.host+"/credstore_proxy/CredStorePopupProxy.php?spid="+T.spid+"&fbperms="+q;n.open(W,"fblink_popup","height=533,width=698,modal=yes,alwaysRaised=yes");}function S(X,W,V){var Y;if(L){Y=L.makeRequest({type:"module",moduleId:A,args:f.merge({_action:"show",_subAction:"getButtons",noups:1},W)},{success:function(Z){if(X&&Z.html){X.setContent(Z.html);}if(f.Lang.isFunction(V)){V();}},failure:function(Z){},scope:this});}}function l(X,Y,Z){var V={success:Z.onSuccess||function(){},failure:Z.onFailure||function(){},scope:this},W={type:"module",moduleId:A,args:{_action:"save",_subAction:X,value:Y}};L.makeRequest(W,V);}function u(){return b;}function J(V){q=V.fbPerms||"email,user_birthday,user_education_history,user_likes,user_location,user_relationships,user_subscriptions,user_work_history,friends_birthday,friends_education_history,friends_likes,friends_location,friends_work_history,publish_actions";i=V.fbAppId||"90376669494";}function Q(X,W){var V=X||i;if(n.FB){if(f.Lang.isFunction(W)){W();}return;}n.fbAsyncInit=function(){n.FB.init({appId:V,channelUrl:n.location.protocol+"//"+n.location.host+"/channel.html",status:true,cookie:true,xfbml:false});if(f.Lang.isFunction(W)){W();}};f.Get.script("http://connect.facebook.net/en_US/all.js");}function z(){var W=function(X,Y){D.fireYwaBeacon({action:"reauthfb",rescode:Y});L.broadcast(p,X);if(X===true){f.all("a."+t).hide();}},V=function(){n.FB.getLoginStatus(function(Y){var ab,ac,aa,X,ad,Z;if(Y.status==="connected"){ac="q="+encodeURIComponent('insert into media.social.homerun.credential (accessToken, userID, expiresIn, signedRequest, spid, env) values("'+Y.authResponse.accessToken+'","'+Y.authResponse.userID+'","'+Y.authResponse.expiresIn+'","'+Y.authResponse.signedRequest+'", "'+T.spid+'", "prod")');aa="env="+encodeURIComponent(T.store);X="crumb="+T.crumb;ad=[ac,aa,X,"callback={callback}","format=json"].join("&");Z=["http://"+T.host+T.path+"?",ad];f.jsonp(Z.join(""),function(ae){var af;if(f.Object.getValue(ae,["query","results","result","status"])==="200"){af=f.Object.getValue(ae,["query","results","result","data","results","credential","issued_ts"]);l(k,af,{onSuccess:function(){W(true,0);},onFailure:function(){W(false,3);}});}else{W(false,4);}});}else{ab=(Y.status==="unknown")?1:2;W(false,ab);}});};if(!i){J({});}Q(i,V);}function K(X){var V=X.doneParams||"",W=n.location.protocol+"//"+n.location.hostname+V;n.location.replace(W);}function s(ab){var aa=ab.currentTarget,W=f.DOM.winWidth(),ac=n.screen.height,Z=(f.UA.ie)?n.screenLeft:n.screenX,X,V,Y;if(aa){if(aa.test("a."+U)){ab.preventDefault();X=aa.getAttribute("href");if(f.Lang.isString(X)&&!o.test(X)){X+=(X.indexOf("?")?"&":"?")+".done="+encodeURIComponent(n.location.href);}V=(W+Z>820)?W+Z-820:0;Y=(ac>680)?(ac-680)/2:0;n.open(X,"login","width=800,height=680,modal=yes,left="+V+",top="+Y);}else{if(aa.test("a."+F)){X=aa.getAttribute("href");if(f.Lang.isString(X)&&!o.test(X)){X+=(X.indexOf("?")?"&":"?")+".done="+encodeURIComponent(n.location.href);aa.setAttribute("href",X);}}else{if(aa.test("a."+v)){ab.preventDefault();h();}else{if(aa.test("a."+t)){ab.preventDefault();n.open(aa.getAttribute("href"),"fbrefresh","width=700,height=500,modal=yes");}}}}if(aa.test("a."+F+",a."+U)){D.fireBeacon(D.getBeaconKeys(aa));f.Array.each(w,function(ad){if(aa.test(ad.selector)&&f.Lang.isFunction(ad.clickHandler)){ad.clickHandler(aa);}});}}}function y(){var Z={parentNode:R,className:["y-tooltip-login"],pointerClass:"img-sprite",position:{box:"l",arrow:"r"},autohide:true},W={sec:"login-tooltip",cacheKey:"login-svc",layout:r,title:"Sign in to save your preference",narrow:1},aa=[],X,Y,V;V={init:function(){var ab=this;Y=d.create(Z);f.on("scroll",function(){ab.hide();});Y.getNode().on("mouseout",function(){X=f.later(3000,this,function(){ab.hide();});});Y.getNode().on("mouseover",function(){X.cancel();});},_showTooltip:function(ad,ac){var ab=this;if(X){X.cancel();}Y.show(ad,ac);X=f.later(ac.hideDelay||3000,this,function(){ab.hide();});},show:function(ag){var ad=f.mix(ag.buttonConfig||{},W),ac=f.mix(ag.tooltipCong||{},Z),af=this,ae,ab;if(!ag.pointAtMeNode){return;}if(!aa[ad.cacheKey]){ae=f.Node.create("<div></div>");ab=function(){aa[ad.cacheKey]=ae;af._showTooltip(ag.pointAtMeNode,f.mix({msg:ae},ac));};S(ae,ad,ab);}else{f.later(250,this,function(){af._showTooltip(ag.pointAtMeNode,f.mix({msg:aa[ad.cacheKey]},ac));});}},hide:function(){if(Y&&Y.isVisible()){Y.hide();}}};V.init();return V;}j={getTooltip:function(){if(!C){C=new y();}return C;},configClick:function(W){var X=W.clickHandler||x,V=W.selector||"";w.push({selector:V,clickHandler:X});return this;},setupFBApp:J,displayFBLinkingDialog:h,getFBAcctLinkStatus:c,getFBLoginUrl:u,getButtons:S,loadFBSDK:Q,refreshCookie:O,updateFBAccessToken:z};f.namespace(B);f[B][N]={name:"login",getService:function(X,W){var V;D=X.getService("instrumentation");a=X.getService("moduleplatform");d=X.getService("tooltip");L=X.getModuleApi(W);T={spid:a.getProperty("credstore.spid"),host:a.getProperty("yql.host"),path:a.getProperty("yql.path"),publicPath:a.getProperty("yql.public.path"),store:a.getProperty("yql.store"),crumb:a.getProperty("yql.crumb"),env:a.getProperty("yql.env")};V=a.getProperty("fbauthstate");b=a.getProperty("login.fb.url");G=(V===H||V===E);if(!R){R=f.one("body");R.delegate(I,s,m,this);}return j;},updateFBAccessToken:z,onFBConnectSuccess:P,onCookieRefresh:g,onYSignIn:K};if(e){e.registerService(f[B][N]);}},"1.0");/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */
(function(){var d=null,e=d,c=false,b="click",a="default";YModules.type_login={body:d,id:"",moduleapi:d,instrumentation:d,loginService:d,fbAppConfig:d,accessTokenRefresh:c,init:function(g){e=g.getService("yui");var f=g.getContextData();this.id=g.getId();this.moduleapi=g;this.loginService=g.getService("login");this.instrumentation=g.getService("instrumentation");this.fbAppConfig={fbAppId:f.fbAppId,fbPerms:f.fbPerms};this.accessTokenRefresh=f.accessTokenRefresh;},onviewload:function(j){var f=this.moduleapi,i=f.getContextData("signOutTooltipEnabled"),g=i&&e.one("#banner_secondary .name"),h=this.instrumentation;if(j===a){this.body=this.moduleapi.getViewNode(j);this.loginService.setupFBApp(this.fbAppConfig);if(this.accessTokenRefresh){e.later(5000,this,function(){this.loginService.updateFBAccessToken();});}}if(g){g.on("click",function(n){n.preventDefault();var k=g.next(".account-sign-out"),m=f.getString("STR.YOUR.PROFILE"),o,l;h.fireBeacon({sec:"header",slk:"tl-usr",ltxt:"menu",itc:"1"});if(k){k.focus();if(!k.one(".profile-link")){o=k.one("a");l=o&&o.cloneNode(true);if(l){o.addClass("signout-link");l.setAttribute("href",g.one("a").getAttribute("href"));l.setContent(m).addClass("profile-link");k.prepend(l);}}k.toggleClass("reveal");}});}},onviewunload:function(f){if(f===a){this.body=d;}},onviewevent:function(g,f){if(g===a){if(f.type===b){this.onClick(f);}else{}}}};}());/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */
(function(){var e=null,i=false,j="pv-shown",h=".pv-ymail-preview",b="pv-loading",f="default",d="innerHTML",n="tab_enter",o="tab_exit",m="/user/ymail",g="mail_preview",l=0,k=1,c=2,a=400;YModules.type_mail={id:"",body:e,api:e,viewevents:["click"],w3:i,type:e,isShown:i,timer:e,pv:e,loadState:e,shim:e,mailLoadReqId:null,arcadeTransport:null,refreshed:false,mailTranslations:null,isRecogStateMsgShown:false,init:function(p){this.Y=p.getService("yui");this.id=p.getId();this.api=p;this.platform=p.getService("moduleplatform");if(this.platform){this.arcadeTransport=this.platform.getService("arcade_transport");}else{this.arcadeTransport=p;}this.arcadeTransport=p;this.mailTranslations=p.getContextData("mailtranslations");this.type="mail";this.w3=true;},onviewload:function(u){var s=this.api,t=s.getService("userinfo").isLoggedIn(),q=s.getContextData("recognizedState"),r=s.getContextData("isLoggedOutPage"),p=s.getContextData("logOutMsgDly");if(u===f){this.body=s.getViewNode(u);if(this.w3){if(q&&r){this.isRecogStateMsgShown=true;s.listen(m);this.timer=this.Y.later(p,this,this.showHideRecogStateMsg,false);}else{if(q||t){this.isRecogStateMsgShown=false;s.listen(n);s.listen(o);s.listen(m);}}}}},onviewunload:function(p){if(p===f){this.body=e;}},onviewevent:function(u,t){var r=this.api,q=t.target,p,s;if(u===f){if(q.get("tagName")!=="A"){p=q.ancestor("TR");if(p){s=p.one(".subject A").getAttribute("href");r.navigate(s);}}else{if(q.hasClass("refresh-mail-account")){t.preventDefault();r.refreshView(f);r.refreshView("pa");}}}},onmessage:function(r,p,q){switch(r){case n:case o:if(q.moduleType==this.type){this.showHideLater(r==n);}break;case m:if(q){this.showVitalityCount(q);}break;default:}},showVitalityCount:function(u){var s,r,t,w,q,v,p;s=(u.data)?u.data:"";if(s){r=this.body.one(".tab-badge")||this.body.one(".mail-badge");if(r){r.set(d,s);r.removeClass("hidden");r.addClass("tab-badge-shown");r.setStyle("visibility","visible");}t=this.body.one(".mail-spr");if(t){t.addClass("tab-icon-unread");}w=this.body.one(".tab-badge-txt");if(w){if(s==1){v=this.mailTranslations.s;}else{v=this.mailTranslations.p;}v=v.replace("{0}",s);w.set(d,v);}if(this.api.getContextData("recognizedState")){p=this.api.getContextData("logOutMsgDly");q=this.body.one(".recog-email-msg");if(q&&v){if(this.isRecogStateMsgShown){this.Y.later(p,this,function(x){q.set(d,this.mailTranslations.r+" "+v);},true);}else{q.set(d,this.mailTranslations.r+" "+v);}}}}},clear:function(){if(this.timer){this.timer.cancel();}this.timer=e;},showHideLater:function(p){this.clear();this.timer=this.Y.later(a,this,this.showHide,p);},showHide:function(p){if(this.isShown==p){return;}this.clear();var r=this.api,t,s=this.pv,q;if(!s){s=this.body.getById(this.id+"-pv");if(!s){s=this.body.one(h);}this.pv=s;}q=this.Y.one(".mail-menu-pointer");if(p){this.loadMail();if(q){q.setStyle("display","block");}s.addClass(j);t=r.getService("instrumentation");t.fireBeacon(r.getContextData("showBeacon"));}else{if(q){q.setStyle("display","none");}s.removeClass(j);}this.isShown=!!p;},showHideRecogStateMsg:function(q){this.clear();var s=this.api,u,p,t=this.pv,r;if(!t){t=this.body.getById(this.id+"-pv");if(!t){t=this.body.one(h);}this.pv=t;}r=this.Y.one(".mail-menu-pointer");if(q){this.loadMail();if(r){r.setStyle("display","block");}t.addClass(j);u=s.getService("instrumentation");u.fireBeacon(s.getContextData("showBeacon"));}else{if(r){r.setStyle("display","block");}t.removeClass(j);p=this.body.one(".logmsg");p.remove(true);this.isRecogStateMsgShown=false;s.listen(n);s.listen(o);}},loadMail:function(){if(this.loadState){return;}var r=this.pv,p=this.arcadeTransport,q={type:"module",moduleId:this.id,args:{_action:"show",_subAction:g}};this.loadState=k;if(p.isRequestPending(this.mailLoadReqId)){p.abortRequest(this.mailLoadReqId);}this.mailLoadReqId=p.makeRequest(q,{success:this.loadMailSuccess,failure:this.loadMailFailure,scope:this});r.addClass(b);r.set(d,"");},loadMailSuccess:function(t,p){this.loadState=c;var r=this.pv,s,q;r.removeClass(b);r.set(d,t.html);if(this.api.getContextData("recognizedState")){q=this.body.one(".recog-email-msg");s=this.body.one(".tab-badge-txt");if(q&&s){q.set(d,this.mailTranslations.r+" "+s.get(d).toLowerCase()+".");}}},loadMailFailure:function(r,p){if(r.result=="abort"){return;}this.loadState=l;var q=this.pv;q.removeClass(b);q.set(d,this.api.getContextData("err"));}};}());/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */
(function(){var c="fp:open-inline",b=null,a;YModules.type_lightbox={body:null,editBody:null,id:"",moduleapi:null,viewevents:["click"],activeElement:null,closeMessage:false,ctxData:null,instrumentation:null,isRunning:false,slkValue:"",ctValue:1,secValue:"",dataType:"str",storyType:"",historyEnabled:false,adsBridgeService:null,videoPlayer:null,init:function(d){this.Y=d.getService("yui");this.id=d.getId();this.moduleapi=d;this.instrumentation=d.getService("instrumentation");this.platform=d.getService("moduleplatform");this.contextData=d.getContextData();this.bucket=this.contextData.bucket;this.adsBridgeService=d.getService("ads_bridge");this.secValue="rdr";this.itcValue="5";},onviewload:function(i){var h=this.moduleapi,e,g,d;this.video=true;a=this.Y.config.win;if(i==="default"){this.body=h.getViewNode(i);h.listen(c);if(this.contextData.deviceType==="smartphone"){e=window.hasOwnProperty("onorientationchange");g=e?"orientationchange":"resize";window.addEventListener(g,this.Y.bind(this.onorientationchange,this),false);}if(this.contextData.oopsMessage){d={sec:"rdr",slk:"err",itc:"5",test:this.bucket};this.instrumentation.fireBeacon(d);return;}if(this.contextData.navigateUrl){d={sec:"rdr",slk:"err-url",itc:"5",test:this.bucket};this.instrumentation.fireBeacon(d);this.moduleapi.navigate(this.contextData.navigateUrl);return;}if(this.contextData.contentOnload){this.showInlineContent(true);}if(this.contextData.articleImage){this.articleImage=this.contextData.articleImage;}if(this.contextData.historyEnabled){try{b=!!(a.history&&a.history.replaceState&&a.history.state!==undefined);}catch(f){b=false;}}}},showInlineContent:function(h){var g=this.moduleapi,j=this.body,m=j.ancestor("html"),i=j.ancestor("body"),f=i.get("region"),p=j.one(".light-cover"),d=j.one(".container"),n=j.one(".lb-align"),l=p.fx,o,k=this.storyType,e={sec:this.secValue,slk:"btn-op",pkgt:k,test:this.bucket};if(h){e.itc="5";}else{e.action="secvw";}this.notifyAds(true);this.instrumentation.fireBeacon(e);this.isRunning=true;p.setStyle("height",f.height+"px");g.broadcast("lightbox:start");this.scrollTop=m.get("scrollTop");if(!this.scrollTop){this.scrollTop=i.get("scrollTop");}if(this.contextData.inlineWidth){n.setStyle("width",this.contextData.inlineWidth+"px");}if(d&&this.contextData.deviceType===false){d.focus();}if(!h){p.removeClass("dn");d.removeClass("dn");o={from:{opacity:0},to:{opacity:0.65}};o.duration=0.2;l.setAttrs(o);d.fx.setAttrs({from:{opacity:0},to:{opacity:1}});l.run();d.fx.run();}this.scrollEvent=this.Y.one("document").on("touchmove",this.preventScroll,this,this);this.bodyScrollEvent=p.on("touchmove",this.preventBodyScroll,this,this);if(this.moduleapi.getContextData("storyType")){this.storyType=this.moduleapi.getContextData("storyType");}if(this.video===true){this.videoService=g.getService("videoyep");this.videoPlayer=this.videoService.create();this.initVideo();}},closeLightbox:function(j){var h=this.body,d=h.one(".container"),n=h.one(".light-cover"),l,k,o={from:{opacity:1},to:{opacity:0},duration:0.3},i=this.storyType,f={sec:"rdr",slk:"btn-cl",pkgt:i,itc:"1",test:this.bucket},g=this.platform.getProperty("default.server.url"),m=document.getElementsByName("p")[0];if(n){l=n.fx;}else{return;}k=d.fx;k.setAttrs(o);k.detach("end");k.run();o.from.opacity=0.9;o.duration=0.2;l.setAttrs(o);l.detach("end");l.on("end",function(){l.detach("end");n.addClass("dn");n.removeClass("opaque-load");d.addClass("dn");this.isRunning=false;this.moduleapi.broadcast("lightbox:end");if(d.hasClass("opaque-load")){d.removeClass("opaque-load");}this.notifyAds(false);if(m&&this.contextData.deviceType===false){m.focus();}},this);l.run();this.scrollEvent.detach("touchmove");if(b&&g){a.history.replaceState("","",g);}this.instrumentation.fireBeacon(f);},onviewunload:function(d){if(d==="default"){this.body=null;}},onviewevent:function(o,k){var l=k.target,i=l.ancestor(".share-actions",true,".type_lightbox"),q=l.ancestor(".email",true,".type_lightbox"),n=l.ancestor("A",true,".type_lightbox"),m=l.ancestor(".fb-link",true,".type_lightbox"),h=l.hasClass("light-cover"),j=l.hasClass("container"),p,f=this.body.one(".oops-message"),g,d=this.contextData.uuid;if(o==="default"){if(l.ancestor(".close-btn",true,".type_lightbox")||h||j){k.preventDefault();if(!f){this.closeLightbox();}else{this.closeOopsMessage();}}if(i&&n||m){p=n.getAttribute("data-ylk");g={sec:this.secValue,slk:p,pkgt:this.storyType,itc:"1",test:this.bucket};if(d){g.g=d;}if(this.ctValue){g.ct=this.ctValue;}this.instrumentation.fireBeacon(g);if(q){k.preventDefault();this.moduleapi.navigate(n.getAttribute("href"));}if(!q){k.halt();this.openPopup(n);}}}},onmessage:function(d,e,g){var f,h;if(d===c){if(!this.isRunning){if(this.Y.Object.getValue(g,"mode")==="embed"){f={type:"module",moduleId:this.id,args:{_action:"show",_subAction:"loadEmbedded",subModule:g.module||"",subModuleView:g.subModuleView||"",subModuleData:g.subModuleData||""}};}else{f={type:"module",moduleId:this.id,args:{_action:"show",_subAction:"load",uuid:g.uuid,href:g.href}};}h={success:this.insertContent,failure:this.insertContentFailure,scope:this,argument:{href:g.href}};if(g.type){f.args.type=g.type;this.dataType=g.type;}this.moduleapi.makeRequest(f,h);if(g.sec){this.secValue=g.sec;this.slkValue=g.sec;}if(g.ct){this.ctValue=g.ct;}if(g.itcValue){this.itcValue="1";}}}},insertContent:function(e,f){var d={itc:this.itcValue,sec:this.secValue,slk:this.slkValue,test:this.bucket};this.body.setHTML(e.html);this.showInlineContent();if(this.contextData.articleImage){this.articleImage=this.contextData.articleImage;}this.instrumentation.fireBeacon(d);},insertContentFailure:function(e,f){var d=f.href;this.moduleapi.navigate(d);},preventScroll:function(d){if(!d.target.ancestor(".container",true,".type_lightbox")){d.preventDefault();}},preventBodyScroll:function(d){d.stopPropagation();},onorientationchange:function(j){var g,h,f,d,i;if(this.articleImage&&this.articleImage.id&&this.articleImage.classes){g=this.body.one("#"+this.articleImage.id);if(!g){return;}f=g.getComputedStyle("background-image");h=g.getAttribute("data-img");d=g.getAttribute("class");i=this.articleImage.classes;g.setStyle("background-image",h);g.setAttribute("class",i);if(d&&f){this.articleImage.classes=d;g.setAttribute("data-img",f);}}},openPopup:function(d){if(d.hasAttribute("href")){this.Y.config.win.open(d.getAttribute("href"),d.getAttribute("data-popup")||"_new",d.getAttribute("data-popup-specs")||"");}},closeOopsMessage:function(d){this.body.one(".oops-message").remove();},notifyAds:function(d){var e=this.adsBridgeService;e.fire({type:e.MODULE_ACTIVE,module:this.moduleapi.getProperty("type"),active:d});},initVideo:function(){var f,e,d="rdr-vid";if(this.contextData.videoId){f=this.contextData.videoId;e={analytics:{sec:d},config:{yep:{id:f,autoplay:true,endscreen:1},animated:false,attach:this.body.one("#fp-video-player")}};this.videoPlayer.init(e);}}};})();/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */
YModules.type_windowshade={body:null,editBody:null,id:"",moduleapi:null,viewevents:["click"],init:function(a){this.Y=a.getService("yui");this.id=a.getId();this.moduleapi=a;},onviewload:function(b){var a=this.moduleapi;if(b==="default"){this.body=a.getViewNode(b);}},onviewunload:function(a){if(a==="default"){this.body=null;}},onviewevent:function(d,c){var b,a;if(d==="default"){b=c.target;a=b.ancestor(".close-btn",true,".type_windowshade");if(a){c.preventDefault();this.body.remove();}}}};/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */
var FP_SCROLL_EVENT="fp:window:scroll",FP_RESIZE_EVENT="fp:window:resize",NAVRAIL_TOOLTIP_CLASS="navrail-menu";YModules.type_navrail={body:null,editBody:null,id:"",moduleapi:null,viewevents:["click","focus","keyup"],moreSitesMenuEnabled:false,instrumentation:null,siteMenuHideTimer:null,siteMenuExposeMenuTimer:null,fallbackAdService:null,platform:null,favCustomizationEnabled:false,favListNode:null,addFavAreaNode:null,addFavAreaUrlNode:null,addFavAreaMsgNode:null,autoHide:null,favAutoHideId:null,tooltipService:null,tooltip:null,tooltipNode:null,toolTipAutoHideId:null,loggedIn:false,loginTooltipHTML:null,dragDropItems:{},actionLock:false,init:function(a){this.Y=a.getService("yui");this.id=a.getId();this.moduleapi=a;this.moreSitesMenuEnabled=!!parseInt(a.getContextData("use.more.sites.menu"),10);this.platform=a.getService("moduleplatform");this.instrumentation=a.getService("instrumentation");this.favCustomizationEnabled=!!parseInt(a.getContextData("fav.customization.enabled"),10);this.autoHide=this.moduleapi.getService("autohide");this.tooltipService=this.moduleapi.getService("tooltip");this.loggedIn=a.getService("userinfo").isLoggedIn();a.listen(FP_SCROLL_EVENT);a.listen(FP_RESIZE_EVENT);},onviewload:function(h){var d=this.moduleapi,g,c,a=this.platform,e=d.getContextData(),f,b;if(this.Y.one(".ad-rsch")){this.Y.one(".ad-rsch").setStyle("display","block");}if(h==="default"){this.body=d.getViewNode(h);if(this.moreSitesMenuEnabled){g=this.Y.one(".more-sites");if(g){this.Y.one(".navrail-more-menu-wrapper").appendTo(g);this.Y.one(".type_navrail .more-sites").on("click",this.Y.bind(function(i){b={sec:"pa-y",slk:"more",ltxt:this.Y.one(".more-sites .more-link").get("text"),itc:1};this.instrumentation.fireUltBeacon(b);this.exposeSiteMenu("more",i);},this));this.Y.one(".type_navrail .more-sites").on("mouseout",this.mouseenterleave,this,this.Y.bind(this.hideSiteMenu,this,"more"));this.Y.one(".navrail-more-menu").on("mouseover",this.mouseenterleave,this,this.clearSiteMenuHideTimer);this.Y.one(".navrail-more-menu").on("mouseout",this.mouseenterleave,this,this.Y.bind(this.hideSiteMenu,this,"more"));}}c=this.Y.one(".type_navrail .more-favs");if(c){c.on("click",this.Y.bind(this.exposeSiteMenu,this,"fav"),this);c.on("mouseout",this.mouseenterleave,this,this.Y.bind(this.hideSiteMenu,this,"fav"));this.Y.one(".navrail-fav-menu").on("mouseover",this.mouseenterleave,this,this.clearSiteMenuHideTimer);this.Y.one(".navrail-fav-menu").on("mouseout",this.mouseenterleave,this,this.Y.bind(this.hideSiteMenu,this,"fav"));}if(e&&e.adsfallbackData){f=e.adsfallbackData;a.registerModule(f);a.start(f.props.id,true,true);}else{}if(this.favCustomizationEnabled){this.initFavCustomization();this.tooltipInit();this.dragDropInit();}}else{if(h==="edit"){this.editBody=d.getViewNode(h);}}},mouseenterleave:function(d,a){var c=d.currentTarget,b=d.relatedTarget;if(c!==b&&!c.contains(b)){a.call(this,d);}},onviewunload:function(a){if(a==="default"){this.body=null;if(this.favAutoHideId){this.autoHide.unregister(this.favAutoHideId);}if(this.toolTipAutoHideId){this.autoHide.unregister(this.toolTipAutoHideId);}this.autoHide=null;}else{if(a==="edit"){this.editBody=null;}}},onviewevent:function(g,f){var d=f.target,b,h,c=f.keyCode,a;if(g==="default"){a=d.ancestor(".intl-site",true,".type_navrail_default");if(a){this.setDNR(false);}b=d.ancestor(".add-favorite-area",true,".type_navrail_default");if(b){if((f.type==="click"&&d.ancestor(".fav-add-btn",true,".type_navrail_default"))||(c&&c===13)){this.addNewFav();return;}if(!c){this.updateFavAddArea(f);return;}}h=d.ancestor(".drag-item",true,".type_navrail_default");if(h&&d.hasClass("remove-nav-btn")&&f.type==="click"){this.removeFavItem(h);return;}}},setDNR:function(c){var b=new Date(),a;if(c===true){a=1;}else{a=parseInt(this.moduleapi.getContextData("dnr.cookie.value"),10);}this.Y.Cookie.set("DNR",a,{expires:"Thu, 01 Jan 1970 00:00:01 GMT",path:"/",domain:"www.yahoo.com"});b.setDate(b.getDate()+360);this.Y.Cookie.set("DNR",a,{expires:b,path:"/",domain:"yahoo.com"});},showLoginPopup:function(a){if(!this.loginTooltipHTML){this.moduleapi.makeRequest({type:"module",moduleId:this.id,args:this.Y.merge({_action:"show",_subAction:"login_popup",noups:1})},{success:function(b){this.loginTooltipHTML=b.html;this.tooltipShow(a,this.loginTooltipHTML);},failure:function(){},scope:this});}else{this.tooltipShow(a,this.loginTooltipHTML);}},tooltipInit:function(){this.tooltip=this.tooltipService.create({parentNode:this.body,className:NAVRAIL_TOOLTIP_CLASS,position:{box:"t",arrow:"b"},pointerClass:"img-sprite",msg:""});this.tooltipNode=this.body.one("."+NAVRAIL_TOOLTIP_CLASS);this.toolTipAutoHideId=this.autoHide.register({targets:[this.body],hide:this.Y.bind(this.tooltipHide,this)});},tooltipShow:function(a,b){if(a.hasClass("remove-nav-btn")){this.body.one(".pointer").addClass("remove-pointer-align");}this.tooltip.show(a,{msg:b});},tooltipHide:function(){var a=this.body.one(".remove-btn-active");if(!this.tooltipNode.one(".hide")){this.tooltip.hide();if(a){a.removeClass("remove-btn-active");}this.body.one(".pointer").removeClass("remove-pointer-align");this.tooltipNode.removeClass("error");}this.actionLock=false;},displayToolTipError:function(b,a){var c=a||this.moduleapi.getContextData("error.msg");if(c&&c!=""){this.tooltipNode.addClass("error");this.tooltipShow(b,c);return true;}return false;},initFavCustomization:function(){this.addFavAreaNode=this.body.one(".add-favorite-area");this.addFavAreaMsgNode=this.body.one(".add-fav-submit-lbl");this.addFavAreaUrlNode=this.body.one(".add-fav-url");this.favListNode=this.body.one(".favs");this.favAutoHideId=this.autoHide.register({targets:[this.addFavAreaNode],hide:this.Y.bind(this.resetFavAddArea,this)});},updateFavAddArea:function(b){var a=b.target;this.toggleFavLabel();if(!this.loggedIn){this.showLoginPopup(this.addFavAreaUrlNode);this.addFavAreaUrlNode.set("disabled");return;}if(!this.addFavAreaNode.hasClass("active")&&a.hasClass("add-fav-url")){a.set("value","http://");}if(a.hasClass("add-fav-url")){this.toggleFavLabel(".add-fav-url-lbl");}if(a.hasClass("add-fav-name")){this.body.one(".add-name-area").addClass("focused");a.set("value","");this.toggleFavLabel(".add-fav-name-lbl");}if(b&&b.type==="focus"&&a.hasAttribute("type")){a.set("value",a.get("value"));}this.addFavAreaNode.addClass("active");},resetFavAddArea:function(){this.addFavAreaNode.removeClass("active");this.body.one(".add-name-area").removeClass("focused");this.addFavAreaUrlNode.set("value",this.moduleapi.getContextData("str.fav.input.url"));this.body.one(".add-fav-name").set("value",this.moduleapi.getContextData("str.fav.input.name"));this.toggleFavLabel();},addNewFav:function(){var d=this.Y.Lang.trim(this.body.one(".add-fav-name").get("value")),a=this.Y.Lang.trim(this.addFavAreaUrlNode.get("value")),c,b;if(this.actionLock){return;}if(d==this.moduleapi.getContextData("str.fav.input.name")||d==""){d=a;}this.actionLock=true;b={sec:"pa-f",slk:"add",ltxt:this.body.one(".fav-add-btn span").getContent(),itc:1};this.instrumentation.fireUltBeacon(b);this.moduleapi.makeRequest({type:"module",moduleId:this.id,args:this.Y.merge({_action:"save",_subAction:"addfav",label:d,url:a,noups:1})},{success:function(e){if(!this.displayFavError()){c=this.Y.Node.create(e.html);this.favListNode.insert(c,this.addFavAreaNode);this.onChange("add",c);}},failure:this.Y.bind(this.handleReqFailure,this,this.addFavAreaUrlNode),scope:this});},removeFavItem:function(e){var a=e.getAttribute("data-suid"),b,d,c;if(this.actionLock){return;}b=e.one("a");d=e.one("button");d.addClass("remove-btn-active");c={sec:"pa-f",slk:"rm",ltxt:b.get("text"),itc:1};this.instrumentation.fireUltBeacon(c);if(!this.loggedIn){this.showLoginPopup(d);return;}this.actionLock=true;this.moduleapi.makeRequest({type:"module",moduleId:this.id,args:this.Y.merge({_action:"save",_subAction:"remove",suid:a,noups:1})},{success:function(){if(!this.displayToolTipError(d)){e.remove();this.onChange("remove",e);}},failure:this.Y.bind(this.handleReqFailure,this,e),scope:this});},displayFavError:function(){var a=this.moduleapi.getContextData("error.msg");this.actionLock=false;if(a&&a!=""){this.toggleFavLabel(".add-fav-submit-lbl");this.addFavAreaMsgNode.setContent(a);return true;}return false;},toggleFavLabel:function(a){this.body.all(".add-fav-msg").addClass("vh");if(a){this.addFavAreaNode.one(a).removeClass("vh");}},handleReqFailure:function(a){this.displayToolTipError(a,this.moduleapi.getContextData("str.fav.msg.error.generic"));this.actionLock=false;},onChange:function(a,b){switch(a){case"add":this.makeDraggable(b);this.resetFavAddArea();break;case"remove":delete this.dragDropItems[b.getAttribute("data-suid")];break;}this.actionLock=false;this.moduleapi.broadcast("apps:resized");},makeDraggable:function(c,b){var a;a=new this.Y.DD.Drag({node:c,target:{padding:"0 0 0 20"}}).plug(this.Y.Plugin.DDProxy,{moveOnEnd:false}).plug(this.Y.Plugin.DDConstrained,{constrain2node:b}).removeInvalid("a");this.dragDropItems[c.getAttribute("data-suid")]=a;},dragDropInit:function(){var a,c=false,b=0;this.Y.use("dd-delegate","dd-constrain","dd-proxy","dd-drop",this.Y.bind(function(d){a=this.favListNode.all(".drag-item");a.each(function(f,e){this.makeDraggable(f,this.favListNode);},this);d.DD.DDM.on("drag:start",d.bind(function(j){var g=j.target,h=g.get("node"),i,f;f=h.get("parentNode");i=g.get("dragNode");i.set("innerHTML",h.get("innerHTML"));i.one("button").remove();i.addClass("navrail-drag-node");},this));d.DD.DDM.on("drag:end",d.bind(function(g){var f=g.target;f.get("node").setStyles({visibility:"",opacity:"1"});},this));d.DD.DDM.on("drag:drag",d.bind(function(f){var g=f.target.lastXY[1];if(g<b){c=true;}else{c=false;}b=g;},this));d.DD.DDM.on("drop:over",d.bind(function(i){if(this.actionLock||!this.loggedIn){return false;}var h=i.drag.get("node"),g=i.drop.get("node"),f,j;if(!c&&g){g=g.get("nextSibling");}if(g&&h){f=h.ancestor("ul",true,".type_navrail");j=g.ancestor("ul",true,".type_navrail");if(j.getAttribute("id")===f.getAttribute("id")){f.insertBefore(h,g);}}},this));d.DD.DDM.on("drag:drophit",d.bind(function(i){var f=i.drop.get("node"),g=i.drag.get("node"),h;h={sec:"pa-f",slk:"drop",ltxt:g.one("a").get("text"),itc:1};this.instrumentation.fireUltBeacon(h);if(!this.loggedIn){this.showLoginPopup(g);return;}if(!f.test("li")){if(!f.contains(g)){f.appendChild(g);}}this.reorderFavItem(g);},this));this.Y.DD=d.DD;this.Y.DDM=d.DD.DDM;},this));},reorderFavItem:function(c){var a=c.getAttribute("data-suid"),b;b=c.get("nextElementSibling")||c.get("nextSibling");if(b){b=b.getAttribute("data-suid");}this.moduleapi.makeRequest({type:"module",moduleId:this.id,args:this.Y.merge({_action:"save",_subAction:"reorder",suid:a,next_suid:b,noups:1})},{success:function(d){if(!this.displayToolTipError(c)){this.onChange("reorder",c);}},failure:this.Y.bind(this.handleReqFailure,this,c),scope:this});},exposeSiteMenu:function(a,b){if(!this.siteMenuExposeMenuTimer){this.siteMenuExposeMenuTimer=setTimeout(this.Y.bind(function(){this.Y.one(".navrail-"+a+"-menu-wrapper").removeClass("d-n");this.siteMenuExposeMenuTimer=null;},this),300);}if(b.target.ancestor(".more-link",true)){b.preventDefault();}},clearSiteMenuHideTimer:function(){if(this.siteMenuHideTimer){window.clearInterval(this.siteMenuHideTimer);this.siteMenuHideTimer=null;}},hideSiteMenu:function(a,b){if(!this.siteMenuHideTimer){this.siteMenuHideTimer=setTimeout(this.Y.bind(function(){this.Y.one(".navrail-"+a+"-menu-wrapper").addClass("d-n");this.siteMenuHideTimer=null;},this),700);}}};/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */
(function(){var b=true,c=false,f=null;function e(g){this.reserveHeight(b);}function a(g){this.reserveHeight(c);}function d(g){this.reserveHeight(c);}YModules.type_ads={api:f,deferred:f,id:f,location:f,locationCtr:f,Y:f,init:function(g){var h=g.getService("yui");this.api=g;this.id=g.getId();this.Y=h;},onviewload:function(m){var j=this.api,i=this.Y.Node.getDOMNode(j.getViewNode(m)),l=j.getContextData,q=l("def"),g=l("ref"),n=l("adlocs"),o=this.Y.Selector.query("."+n,i,b),h,k,p;this.location=n;this.locationCtr=o;if(q||g){k=j.getService("ads_deferred");h=l("data");p={defer:q,refresh:g,moduleId:this.id,location:h.l,node:o,data:h,fallback:l("fallback")};this.deferred=k.register(p,{start:e,success:a,failure:d,scope:this});}else{this.reserveHeight(c);}},onviewunload:function(g){if(this.deferred){this.deferred.unregister();}this.body=this.deferred=f;},reserveHeight:function(g){var i=g?"add":"remove",h=this.Y.DOM[i+"Class"];h(this.locationCtr,this.location+"-reserve");}};})();/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */
(function(){var b="modal:open",a="modal:close";YModules.type_adsfallback={body:null,editBody:null,id:"",moduleapi:null,viewevents:["click"],setHomepageService:null,instrumentation:null,autoHideService:null,overlayEnabled:true,showSetHPOnLoad:false,init:function(c){this.Y=c.getService("yui");this.id=c.getId();this.moduleapi=c;this.setHomepageService=c.getService("sethomepage");this.instrumentation=c.getService("instrumentation");this.browser=c.getContextData("browser");this.overlayEnabled=!!c.getContextData("overlayEnabled");this.autoHideService=c.getService("autohide");this.showSetHPOnLoad=!!c.getContextData("showSetHPOnLoad");},onviewload:function(e){var d=this.moduleapi,c;if(e==="default"){this.body=d.getViewNode(e);c={};c["default-"+this.id]="pa-pr";this.loadFallbackAd();this.instrumentation.addModules(c);if(this.showSetHPOnLoad){if(this.Y.UA.ie){this.setIEOverlay();}else{this.setHomePage();}}}else{if(e==="edit"){this.editBody=d.getViewNode(e);}}},onviewunload:function(c){if(c==="default"){this.body=null;}else{if(c==="edit"){this.editBody=null;}}},onviewevent:function(h,g){if(!this.overlayEnabled){return;}var j=this.id,i="",f=g.target,c=null,d=g.type;if(d==="click"){i=f.get("id");if(i===""||f.hasClass("yhoo-logo")){c=f.get("parentNode");if(c){i=c.get("id");}}switch(i){case j+"-homepage":if(this.Y.Array.indexOf(["IE","FF","WK","OP","CH"],this.browser)>-1){g.preventDefault();}this.setHomePage();break;case j+"-mobilizer":break;case"modal-close-overlay":g.preventDefault();this.hideOverlay();break;default:break;}}},loadFallbackAd:function(){var d=this.moduleapi,i=this.body,k,l,e,m,f,h,c,g=true,j;k=d.getContextData("forceSethp");l=d.getContextData("randomPromo");e=d.getContextData("sethpPromoShare");m=d.getContextData("showOnlySetHP");f=d.getContextData("showOnlySpecial");if(i){j=i.getById(this.id+"-promotion");if(j){h=!this.setHomepageService.isHomepageSet();if((k||(h&&(!l||Math.random()>e)))&&!f){c="hpCode";}else{if(m===1){g=false;}c="promoCode";}if(g){j.set("innerHTML",d.getContextData(c));this.Y.one(".type_adsfallback_default").setStyle("display","block");}}}},setIEOverlay:function(){var c=this.moduleapi,d=c.getContextData("hpOverlay");d=this.Y.Node.create(d);d.delegate("click",function(e){c.broadcast(a);this.setHomePage();e.preventDefault();},".set-hp-lnk",this);c.broadcast(b,{config:{width:652,zIndex:50,srcNode:"",className:"fp-modal"},content:d});},setMobilizer:function(){var d="100%",i=document.documentElement.clientHeight+"px",f=document.body.scrollTop||document.documentElement.scrollTop,g=document.createElement("iframe"),e="99999",c=this.moduleapi.getContextData("locale"),j=this.moduleapi.getContextData("mobilizerUrl");if(document.getElementById("ymobilizerouter")){document.body.removeChild(document.getElementById("ymobilizerouter"));}g.src=j+"&lang="+c;g.setAttribute("id","ymobilizerouter");g.setAttribute("name","ymobilizerouter");g.setAttribute("allowTransparency","allowTransparency");g.setAttribute("frameborder",0);g.setAttribute("scrolling","no");g.setAttribute("width",d);g.setAttribute("height",i);g.style.position="absolute";g.style.left="0px";g.style.top=f+"px";g.style.zoom="1";g.style.zIndex=e;g.style.overflow="hidden";g.setAttribute("style","z-index:"+e+";position:absolute;top:"+f+"px;left:0px;width:"+d+";height:"+i+";");document.body.appendChild(g);if(typeof window.addEventListener!="undefined"){window.addEventListener("message",this.closeMobilizer,false);}else{if(typeof window.attachEvent!="undefined"){window.attachEvent("onmessage",this.closeMobilizer);}}},closeMobilizer:function(c){if(c.data=="closeYMBZ"){if(document.getElementById("ymobilizerouter")){document.body.removeChild(document.getElementById("ymobilizerouter"));}}},setHomePage:function(){var g,o=this.setHomepageService,i=this.moduleapi,d,l,k,m,f,h=this.body,c=this.id,n=i.getContextData("hpOverlay"),p=i.getContextData("ilc"),j=i.getContextData("showSetHPOnLoadId");if(this.browser=="IE"||this.browser=="FF"){d={sec:"cue-hpset",ilc:1,camp:"hpset",code:"100",outcome:"cuehpset",action:"secview"};if(j){d.f=j;}this.instrumentation.fireBeacon(d);}if(this.browser=="IE"){if(o.setIEHomepage(p)){f=i.getContextData("promoCode");if(f!==""&&f!==null){g=document.getElementById(this.id+"-promotion");g.innerHTML=f;}else{k=h.getById(c+"-promotion");k.get("parentNode").removeChild(k);}d={sec:"cue-hpset",slk:"btn-yes",ilc:1,camp:"hpset",code:"100",outcome:"hpset",action:"click"};this.fireAkqaBeacon();}else{d={sec:"cue-hpset",slk:"btn-no",ilc:1,camp:"hpset",code:"100",outcome:"close",action:"click"};}if(j){d.f=j;}this.instrumentation.fireBeacon(d);}else{if(this.Y.Array.indexOf(["FF","WK","OP","CH"],this.browser)>-1){m=this.Y.bind(function e(q){if(q.type==="click"){this.yBangClick(q);}else{this.fireFFBeacon(q);this.fireAkqaBeacon();}},this);n=this.Y.Node.create(n);n.delegate("click",m,".drag-icon",this);n.delegate("mousedown",m,".drag-icon",this);i.broadcast(b,{config:{width:652,zIndex:50,srcNode:"",className:"fp-modal"},content:n});}else{o.setHpCookie(p,"1");}}l={};l[this.id+"-set-homepage-overlay"]="cue-hpset";this.instrumentation.addModules(l);},hideOverlay:function(){this.moduleapi.broadcast(a);},fireFFBeacon:function(){var f=this.setHomepageService,d=this.moduleapi,c,e=d.getContextData("showSetHPOnLoadId");c={sec:"cue-hpset",slk:"icon",ilc:1,itc:1,camp:"hpset",code:"100",outcome:"hpset",action:"drag"};if(e){c.f=e;}this.instrumentation.fireBeacon(c);f.setHpCookie(d.getContextData("ilc"),"1");},fireAkqaBeacon:function(){var d=this.moduleapi.getContextData("beaconAkqaUrl"),c;if(d){c=this.body.create('<img src="'+d+'">');this.body.append(c);}}};}());/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */
(function(){var j=true,p=false,q=null,d=null,h="apps:resized",b="app-drag-over",c="below",m="dragNode",i="show-draggable",e="app-shadow",l=".app",n=".app-heading",o="."+c,g=l+" .drag-over-indicator",r=".mod",f=".cursor-region",a=r+" "+l,k="dd:toggle-draggable-ui";YModules.type_appscontainer={moduleapi:q,instrumentation:q,currentBucket:q,body:q,isBusy:p,viewevents:["click"],moduleCookieName:"fpms",isLoggedIn:p,enableAppReordering:p,enableAppReorderingLoggedOut:p,cookieDomain:q,hasMovedToTop:p,hasCustomAppOrder:p,lazyImageService:q,streamClickReordingEnabled:p,listeners:[],nextResize:null,init:function(s){d=s.getService("yui");this.id=s.getId();this.moduleapi=s;this.isLoggedIn=(s.getContextData("recognizedState")||s.getService("userinfo").isLoggedIn());this.instrumentation=s.getService("instrumentation");this.currentBucket=s.getContextData("currentBucket");this.enableAppReordering=s.getContextData("enableAppReordering");this.enableAppReorderingLoggedOut=s.getContextData("enableAppReorderingLoggedOut");this.enableLoginTooltip=s.getContextData("enableLoginTooltip");if(!this.isLoggedIn&&this.enableAppReorderingLoggedOut){this.statemgr=this.moduleapi.getService("statemgr");}if(!this.isLoggedIn&&this.enableLoginTooltip){this.loginService=s.getService("login");}},onviewload:function(t){var s=".app";this.body=this.moduleapi.getViewNode(t);this.streamClickReordingEnabled=this.moduleapi.getContextData("streamClickReordingEnabled");this.listeners.push(this.body.delegate("mouseover",this.onShowToolbar,s,this));this.listeners.push(this.body.delegate("mouseout",this.onHideToolbar,s,this));if(this.streamClickReordingEnabled){this.hasCustomAppOrder=this.moduleapi.getContextData("hasCustomAppOrder");this.moduleapi.listen("stream:filter");this.appOrder=this.getAppOrder();}if((this.isLoggedIn&&this.enableAppReordering===j)||(!this.isLoggedIn&&this.enableAppReorderingLoggedOut)){this.listeners.push(this.body.once("mouseover",this.initDD,this));this.listeners.push(this.body.delegate("mouseover",this.onShowDraggable,n,this));this.listeners.push(this.body.delegate("mouseout",this.onHideDraggable,n,this));this.moduleapi.listen(k);}},onHideDraggable:function(t){var s=t.target.ancestor(r);if(s){this.toggleDraggableUi(s,"off");}},onShowDraggable:function(t){var s=t.target.ancestor(r);if(s){this.toggleDraggableUi(s,"on");}},toggleDraggableUi:function(t,s){if(s==="on"){if(!this.body.one(".disable-dd")){t.one(n).setStyle("cursor","move");t.addClass(i);t.one(l).addClass(e);}}else{t.one(n).setStyle("cursor","auto");t.removeClass(i);t.one(l).removeClass(e);}},getAppOrder:function(){var t=this.body.all(a),s=[];t.each(function(w,u){if(w.ancestor(r).getStyle("display")!=="none"){s.push(w.getAttribute("data-moduleid"));}});return s;},initDD:function(){var s=this.body,t=this;s.all(a).each(function(w,u){w.append(d.Node.create('<div class="top-region pos-a h-50"></div>'));});d.use("dd-delegate","dd-proxy","dd-drop","dd-drop-plugin","dd-scroll",function(y){var x,u,v=new y.DD.Delegate({container:".type_appscontainer",nodes:r,target:j,handles:[n]});v.dd.plug(y.Plugin.DDProxy,{moveOnEnd:p,cloneNode:p});v.dd.plug(y.Plugin.DDWinScroll,{buffer:100,horizontal:p});function z(D){var C,B=u,A=s.all(r);if(B){C=D.one(l).getData("modulesec");B.removeClass(b);if(B.hasClass(c)){A.insert(D,B.next());}else{A.insert(D,B);}t.sendBeacon("drop",C,"",x+"-"+B.modIndex);t.rearrangeApps();}}function w(D){var C,B,E,A=p;C=D.target.get("node");B=D.target.get(m);E=C.one(l).getAttribute("data-moduleid");u=q;s.all(r).each(function(J,I){var H,F=J,G=F.one(".top-region");if(!A&&G&&!F.hasClass("yui3-dd-dragging")&&B.one(f).inRegion(G)){F.addClass(b);A=j;u=F;u.modIndex=I;if(y.UA.ie&&y.UA.ie<8&&!F.one(g)){F.one(l).append(y.Node.create('<div class="drag-over-indicator pos-a w-100"></div>'));}}else{F.removeClass(b);if(y.UA.ie&&y.UA.ie<8){H=F.one(g);if(H){H.remove(j);}}}});}v.on("drag:mouseDown",function(A){if(s.one(".disable-dd")){A.halt();}});v.on("drag:start",function(E){E.preventDefault();v.dd.winscroll.start();var D,C=E.target,A=C.get("node").one(l),B=C.get(m);if(!B.one(f)){B.append(y.Node.create('<div class="cursor-region w-100 pos-r"></div>'));}s.all(l).each(function(G,F){if(G.getData("moduleid")===A.getData("moduleid")){x=F+1;}});t.sendBeacon("drag",A.getData("modulesec"));B.setStyles({opacity:".3",borderColor:"#aaaaaa",backgroundColor:"#dbdbdb"});D=C.get("node").next();while(D){D.addClass(c);D=D.next();}});v.on("drag:drag",y.throttle(w,50));v.on("drag:end",function(A){var B=s.one(o);v.dd.winscroll.end();if(u&&A.target){z(A.target.get("node"));}while(B){B.removeClass(c);B=B.next();}u=q;if(y.UA.ie&&y.UA.ie<8){s.all(".drag-over-indicator").each(function(D,C){D.remove(j);});}});});},onShowToolbar:function(v){var u=v.target.ancestor(l,j),t=(u)?u.one(".app-ctas"):q,s=u.one(".app-remove-confirm");if(!s){this.show(t);}},onHideToolbar:function(u){var t=u.target.ancestor(l,j),s=(t)?t.one(".app-ctas"):q;this.hide(s);},show:function(s){if(s){s.removeClass("v-h");s.removeClass("d-n");}},hide:function(s){if(s){s.addClass("v-h");s.addClass("d-n");}},display:function(s){if(s){s.removeClass("d-n");}},onviewunload:function(s){this.body=q;d.Array.each(this.listeners,function(t){t.detach();});this.listeners=[];},onviewevent:function(u,s){if(this.isBusy){return;}var t=s.target;if(t.ancestor(".halt",true)||t.ancestor(".app-remove-confirm-body",true)){s.preventDefault();this.handleDefaultClick(t);}},onmessage:function(v,t,u){var s=t==="fstream"||t==="stream";if(s&&v==="stream:filter"&&u){this.onStreamFilter(u);}if(v===k&&u.el&&u.toggle){this.toggleDraggableUi(u.el,u.toggle);}},handleDefaultClick:function(x){var y,w,s,u,v,t=q;y=x.ancestor(l,true);if(y){w=y.getAttribute("data-moduleid");s=y.getAttribute("data-modulesec");}if(!this.isLoggedIn&&this.enableLoginTooltip&&x.hasClass("login-tooltip-app")){u=y.getData("login-tooltip-msg");v={sec:s+"-auth",cacheKey:x.hasClass("remove-cta")?"remove-"+s:s};if(d.Lang.isString(u)&&!x.hasClass("remove-cta")){v.title=u;}this.loginService.getTooltip().show({pointAtMeNode:x,buttonConfig:v});return;}else{if(x.hasClass("remove-app")||x.hasClass("remove-cta")){if(w){this.confirmRemoveApp(w);}}else{if(x.hasClass("app-remove-confirm-remove")){if(w){this.removeApp(w);this.sendBeacon("btn-delete",s,this.moduleapi.getContextData("removeCtaRemoveBtn"));}}else{if(x.hasClass("app-close-button")||x.hasClass("app-remove-confirm-cancel")){if(w){t=x.ancestor(".app-remove-confirm");if(t&&t.getAttribute("signin-cta")==="signin-cta"){this.sendBeacon("btn-signin-cancel",s,this.moduleapi.getContextData("removeCtaCancelBtn"));}else{this.sendBeacon("btn-cancel",s,this.moduleapi.getContextData("removeCtaCancelBtn"));}this.hideConfirmRemoveApp(w);}}else{if(x.hasClass("rearrange-apps")){this.rearrangeApps(q);}else{if(x.hasClass("reset-apps")){this.resetApps();}}}}}}},sendBeacon:function(t,v,w,u){var s={sec:v,slk:t,ltxt:w,cpos:0,pos:0,itc:1,mpos:u||"",test:this.currentBucket};this.instrumentation.fireBeacon(s);},confirmRemoveApp:function(D){var x=d.one("#appMgmtDialog"),B=this.body,C=B.one("#default-p_"+D),s=C.one(".app-wrapper"),y=C.one(".show-panel"),z=this.moduleapi.getContextData("removeCta"),u=this.moduleapi.getContextData("removeCtaRemoveBtn"),v=this.moduleapi.getContextData("removeCtaCancelBtn"),w='<div class="app-remove-confirm ta-c"><div class="app-remove-confirm-body"><h3 class="fz-s mb-m app-remove-confirm-message">'+z+'</h3><div class="cf d-ib"><button class="fl-l btn secondary app-remove-confirm-cancel">'+v+'</button> <button class="fl-l btn dismissal app-remove-confirm-remove">'+u+"</button></div></div></div>",t=s.one(".app-remove-confirm"),A=C.one(".app-ctas");if(!this.isLoggedIn&&x){w='<div class="app-remove-confirm ta-c p-l pb-xl" data-context="signin-cta">'+x.get("innerHTML")+"</div>";}if(!t){s.insert(w,"after");t=C.one(".app-remove-confirm");this.hide(s);s.addClass("d-n");this.hide(A);if(y){y.addClass("v-h");}}},onStreamFilter:function(x){if(this.hasCustomAppOrder){return;}var u=x&&x.category,y={"YPROP:SPORTS":".type_sportacular","YPROP:FINANCE":".type_finance","YPROP:OMG":".type_topvideos","YPROP:LIFESTYLES":".type_horoscope"},z=d.Object.owns(y,[u]),C=this,s,B,w,t,v,A;if(z){s=this.body.one(y[u]).ancestor(r);if(s){B=s.one(l);v=B.get("offsetHeight");B.setStyles({height:"0px",overflow:"hidden"});this.body.insert(s,1);B.transition({duration:0.25,easing:"ease-in",height:v+"px"},function(){var D=B.all(".lzbg");B.setStyles({height:"auto",overflow:"visible"});if(D.size()>0){D.each(function(F,E){if(!C.lazyImageService){C.lazyImageService=C.moduleapi.getService("lazyimage");}C.lazyImageService.loadImage(F);});}});this.hasMovedToTop=j;}}else{if(this.hasMovedToTop&&!z){t=this.body.all(a);w=[];t.each(function(E,D){w[E.getAttribute("data-moduleid")]=E.ancestor(r);});if(d.Lang.isArray(this.appOrder)&&this.appOrder.length>0){A=C.body.one(".reset-apps-container")||C.body.one(".app-remove-confirm");if(!A){return;}d.Array.each(this.appOrder,function(E,D){if(D===0){v=w[E].get("offsetHeight");w[E].setStyles({height:"0px",overflow:"hidden"});C.body.insert(w[E],A);w[E].transition({duration:0.25,easing:"ease-in",height:v+"px"},function(){w[E].setStyles({height:"auto",overflow:"visible"});});}else{C.body.insert(w[E],A);}});}this.hasMovedToTop=p;}}},removeApp:function(t){var s={type:"module",moduleId:this.id,args:{_container:0,_id:this.id,_action:"save",_subAction:"removeApp",appIdToRemove:t,is_pageload:p}},u={success:this.handleGetDataSuccess,failure:this.handleGetDataError,scope:this,argument:{appId:t,is_pageload:p,removeApp:j}};if(this.hasMovedToTop){s.args.appOrder=this.getAppOrder();}this.isBusy=j;this.moduleapi.makeRequest(s,u);},hideConfirmRemoveApp:function(w){var s=this.body,v=s.one("#default-p_"+w),t=v.one(".app-wrapper"),u=v.one(".app-remove-confirm"),x=v.one(".show-panel");if(u){u.remove(true);}this.show(t);if(x){x.removeClass("v-h");}},rearrangeApps:function(t){if(this.isLoggedIn){var s={type:"module",moduleId:this.id,args:{_container:0,_id:this.id,_action:"save",_subAction:"rearrangeApps",appOrder:t||this.getAppOrder(),is_pageload:p}},u={success:this.handleGetDataSuccess,failure:this.handleGetDataError,scope:this,argument:{is_pageload:p}};this.isBusy=j;this.moduleapi.makeRequest(s,u);}else{this.statemgr.setUserModuleState("appOrder",(t||this.getAppOrder()).join(","));this.statemgr.update();}},resetApps:function(){var s={type:"module",moduleId:this.id,args:{_container:0,_id:this.id,_action:"save",_subAction:"resetApps",is_pageload:p}},t={success:this.handleGetDataSuccess,failure:this.handleGetDataError,scope:this,argument:{reset:j,is_pageload:p}};this.isBusy=j;this.moduleapi.makeRequest(s,t);},refreshView:function(t){var s={type:"module",moduleId:this.id,args:{_container:0,_id:this.id,_action:"show",_subAction:"refreshApps",is_pageload:p}},u={success:this.handleGetDataSuccess,failure:this.handleGetDataError,scope:this,argument:{is_pageload:p}};this.isBusy=j;this.moduleapi.makeRequest(s,u);},handleGetDataSuccess:function(t,v){var s=this.body,x,w,u=s.one(".reset-apps-container");x=v.appId;if(x){w=(x)?s.one("#default-p_"+x):undefined;this.hideConfirmRemoveApp(x);w.setStyle("display","none");this.moduleapi.broadcast(h);this.hasCustomAppOrder=j;this.show(u);}if(v.reset===j){window.location.reload();}this.isBusy=p;this.appOrder=this.getAppOrder();},handleGetDataError:function(s,t){this.isBusy=p;}};}());/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */
(function(){var d="default",i="edit",c=null,f="location:update",j="location:picker-open",g="location:picker-close",b=".app-ctas",h=".app",e="v-h",a="d-n";YModules.type_weather={id:"",body:null,editBody:null,api:null,viewevents:["click"],locdropWidget:null,userCitySelection:null,ldwService:null,listeners:[],defaultScale:null,locationPickerEnabled:false,locationService:null,locationInstance:null,init:function(k){this.Y=k.getService("yui");this.id=k.getId();this.api=k;this.platform=k.getService("moduleplatform");if(this.platform){this.arcadeTransport=this.platform.getService("arcade_transport");}else{this.arcadeTransport=k;}this.arcadeTransport=k;},onviewload:function(n){var l=this.api,m,k;this.locationPickerEnabled=l.getContextData("locationPickerEnabled");if(n===d){this.body=l.getViewNode(n);if(!l.getContextData("isApp")){this.listeners.push(this.body.delegate("mouseover",this.onShowToolbar,h,this));this.listeners.push(this.body.delegate("mouseout",this.onHideToolbar,h,this));}k=l.getContextData("locationModuleMeta");if(k){k.state.view="default";this.platform.registerModule(k);this.platform.start(k.props.id,false,true);}if(this.locationPickerEnabled){this.initLocation();}}if(n===i){this.editBody=l.getViewNode(n);if(this.editBody.one("#weather-locdrop-widget")&&this.locdropWidget===null){this.subscribeLocdropWidgetV2("weather-locdrop-widget");}m=this.editBody.one(".scale-option.selected input");if(m){this.defaultScale=m.get("value");}}},onviewunload:function(k){if(k===d){this.body=null;if(this.locationPickerEnabled){this.locationService=null;if(this.locationInstance){this.locationInstance.destroy();this.locationInstance=null;}}}if(k===i){this.editBody=null;}this.Y.Array.each(this.listeners,function(l){l.detach();});this.listeners=[];},onviewevent:function(o,n){var l=this.api,k=n.target,m;if(o===d){if(k.ancestor(".settings-cta",true)){l.openView("edit");return;}if(this.body.one(".wrapper-current")&&k.ancestor(".current",true,".type_weather")){window.location=this.body.one(".wrapper-current").one("a").getAttribute("href");}}else{if(o===i){if(k.ancestor(".lw-anchor-item",true)){this.manageLocdropWidgetToggle("opened");}if(k.hasClass("edit-save-btn")){n.preventDefault();this.arcadeTransport.makeRequest({type:"module",moduleId:this.id,args:this.Y.merge({_action:"save",_subAction:"saveScalePref",tempScale:this.defaultScale})},{success:function(){l.refreshView(d);this.cleanUpLocdropWidget();l.closeView(i);},failure:function(){},scope:this,argument:this.Y.merge({subAction:"saveScalePref"})});}if(k.ancestor(".scale-option",true)){m=k.ancestor(".scale-option",true).one("input").get("value");this.setScalePreference(m);}}}},subscribeLocdropWidgetV2:function(l){var m=this.api,p,r,n,q,k,o,s;m.listen("ldw:defaultlocation");if(this.ldwService===null){this.ldwService=m.getService("ld_service");}r=m.getContextData("locdrop_crumb");p=m.getContextData("locale");n=m.getContextData("best_loc");k=m.getContextData("cur_loc");q=m.getContextData("def_loc");o=this.userCitySelection||m.getContextData("user_loc");s={crumb:r,locale:p,bestLoc:n,currentLoc:k,defaultLoc:q,anchorText:o,anchorClass:"loc-label fz-s"};this.locdropWidget=this.ldwService.create(l,s);this.locdropWidget.on("locationselect",this.onLocWidgetSelect,this);this.locdropWidget.on("widgetclose",this.manageLocdropWidgetToggle,this);},onLocWidgetSelect:function(k){this.platform.fire(f,k);this.userCitySelection=k.city;this.editBody.one(".loc-input").set("value",this.userCitySelection);},manageLocdropWidgetToggle:function(l){var k=this.editBody.one(h);if(l==="opened"){k.setStyle("zIndex","10");}else{k.setStyle("zIndex","");}},cleanUpLocdropWidget:function(){if(this.locdropWidget){this.locdropWidget.detachAll();this.locdropWidget.destroy();this.locdropWidget=null;delete (this.locdropWidget);this.ldwService=null;}},initLocation:function(){var m=this.body.one(".loc-picker"),l=this.api,k;if(m){if(!m.one(".loc-picker-link")){return false;}if(!this.locationService){this.locationService=l.getService("location_service");}k={locDropSettings:{crumb:l.getContextData("locdrop_crumb"),locale:l.getContextData("locale"),bestLoc:l.getContextData("best_loc"),curLoc:l.getContextData("cur_loc"),defLoc:l.getContextData("def_loc"),userLoc:this.userCitySelection||l.getContextData("user_loc"),anchorClass:""},beacon:{sec:l.getContextData("beacon_sec"),slk:l.getContextData("beacon_slk"),test:l.getContextData("beacon_bucketid")},parentBody:this.body};if(this.locationService){this.locationInstance=this.locationService.create(m,this.id,l,k);}this.platform.subscribe(f,this.handleLocationUpdate,this);l.listen(j);l.listen(g);}},setScalePreference:function(p){var k=this.editBody.one(".scale"),o=k.one(".fahrenheit"),n=k.one(".celsius"),m,l;if(p==="F"){m=o;l=n;}else{m=n;l=o;}l.removeClass("selected");l.one("input").set("checked","");m.addClass("selected");m.one("input").set("checked","checked");this.defaultScale=p;},show:function(k){if(k){k.removeClass(e);k.removeClass(a);}},hide:function(k){if(k){k.addClass(e);k.addClass(a);}},onShowToolbar:function(m){var l=m.target.ancestor(h,true),k=(l)?l.one(b):c;this.show(k);},onHideToolbar:function(m){var l=m.target.ancestor(h,true),k=(l)?l.one(b):c;this.hide(k);},onmessage:function(m,k,l){if(k==="weather"){switch(m){case j:this.body.one(".app").setStyle("zIndex","10");this.body.one(".current").setStyle("zIndex","2");break;case g:this.body.one(".app").setStyle("zIndex","");this.body.one(".current").setStyle("zIndex","");break;default:}}},handleLocationUpdate:function(){this.api.refreshView(d);}};}());/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */
(function(){var i="click",f="submit",b="blur",c="default",h="edit",j="recent-quotes",d=true,g=false,e=null,a=e;YModules.type_finance={id:"",body:e,moduleapi:e,instrumentation:e,currentBucket:e,orderTable:"asc",viewevents:[i,f,"focus","mouseover"],allTickers:e,autocompleteEnabled:g,autocompleteLoaded:g,settingspaneEnabled:g,arcadeTransport:e,resizeThrottle:250,tabliteService:e,tabs:e,tabNavigationMode:e,searchBoxBlur:e,stateMgr:e,init:function(k){this.id=k.getId();this.moduleapi=k;a=this.moduleapi.getService("yui");this.autocompleteEnabled=k.getContextData("enableAutocomplete");this.settingspaneEnabled=k.getContextData("enableSettingspane");this.inlineEditEnabled=k.getContextData("enableRQInlineEdit");this.crumb=k.getContextData(".crumb");this.instrumentation=k.getService("instrumentation");this.currentBucket=k.getContextData("currentBucket");if(this.settingspaneEnabled){this.arcadeTransport=this.platform?this.platform.getService("arcade_transport"):k;}this.tabliteService=k.getService("tablite");this.tabNavigationMode=k.getContextData("tabNavigationMode");this.stateMgr=this.moduleapi.getService("statemgr");},onviewload:function(m){var l=this.moduleapi,k;if(m==c){this.body=this.moduleapi.getViewNode(c);this.autocompleteLoaded=g;this.allTickers=l.getContextData("allTickers");this.loadingInfo=l.getContextData("loadingInfo")||e;k=this.body.one(".tab-"+this.tabNavigationMode);this.tabs=new this.tabliteService({moduleApi:l,body:this.body,tabWidget:k,navMode:this.tabNavigationMode});this.tabs.setup();if(!this.searchBoxBlur){this.searchBoxBlur=this.body.delegate("blur",function(q){var p=q.target,o=p.get("value"),n=p.getAttribute("placeholder");if(o.length===0||n===o){p.addClass("quotes-input-inactive");p.set("value",n);}},".quotes-input");}}else{if(m==h){this.editBody=l.getViewNode(m);}}},onviewevent:function(t,p){var m=this.moduleapi,q=p.target,s=p.type,n=q.getAttribute("placeholder"),o=q.get("value"),r,k,l;if(t==c){if(s===i){if(q.ancestor(".toggle",d)){if(q.hasClass("edit-link")){return;}p.preventDefault();}if(q.ancestor(".settings-cta",d)&&this.settingspaneEnabled){p.preventDefault();m.openView(h);}if(q.ancestor(".markets .down",d)||q.ancestor(".markets .up",d)){k=q.ancestor(".markets");l=k&&k.hasClass("quote-percent");k.all(".down, .up").each(function(y,x){var z=y,w=z.getAttribute("data-changepercent"),u=z.getAttribute("data-change");if(l){z.setContent(z.getContent().replace(w,u));}else{z.setContent(z.getContent().replace(u,w));}});if(l){k.removeClass("quote-percent");}else{k.addClass("quote-percent");}this.sendBeacon("tog","app-fin","");}}if(s==="focus"||s===i){if(q.hasClass("quotes-input")&&n===o){this.emptyInputBox(q);if(q.hasClass("quotes-input-inactive")){q.removeClass("quotes-input-inactive");}}}if(s==="mouseover"&&this.autocompleteLoaded===g&&this.autocompleteEnabled){this.autocompleteLoaded=d;m.getViewNode(c).detach("mouseover");this.initAutocomplete();}}else{if(t==h){if(s==="submit"||(s===i&&q.hasClass("edit-save-btn"))){p.preventDefault();if(q.hasClass("app-close-button")){m.closeView(h);return;}if(s===i&&q.hasClass("edit-save-btn")){q=q.ancestor(".portfolio-form");}if(q.hasClass("portfolio-form")&&q.one('input[name="pf"]')){q.all('input[name="pf"]').each(function(u){if(u.get("checked")===d){r=u.getAttribute("value");}});this.arcadeTransport.makeRequest({type:"module",moduleId:this.id,args:a.merge({_action:"save",_subAction:"setdefault",pf_id:r})},{success:function(){m.refreshView(c);m.closeView(h);},failure:function(){},scope:this,argument:a.merge({subAction:"setdefault"})});}else{if(q.hasClass("portfolio-form")){m.closeView(h);}}}}}},initAutocomplete:function(){try{var k=this;a.use("jsonp","jsonp-url","autocomplete",function(o){var n=k.body.one(".quotes-input"),m;if(n){n.plug(o.Plugin.AutoComplete,{source:function(s,t){YAHOO.util={ScriptNodeDataSource:{callbacks:function(w){var v=w.ResultSet.Result,u=[];for(m=0;m<v.length;m++){if(v[m]&&v[m].symbol){u.push({symbol:v[m].symbol,name:v[m].name});}}t(u);}}};function q(u,v,w){return o.Lang.sub(u,{callback:"YAHOO.util.ScriptNodeDataSource.callbacks",query:w});}var r="http://d.yimg.com/aq/autoc?query={query}&region=US&lang=en-US&callback={callback}",p=new o.JSONPRequest(r,{format:q,on:{success:function(u){}}});p.send(s);},resultTextLocator:"symbol",resultFormatter:function(q,p){return o.Array.map(p,function(r){return"<strong>"+r.raw.symbol+"</strong> "+r.raw.name;});},resultHighlighter:"phraseMatch",align:{node:n,points:["tl","bl"]},queryDelay:200,maxResults:10,activateFirstItem:d});n.ancestor("form").on(f,function(p){if(n.ac.get("visible")===d){p.preventDefault();}});n.ac.on("select",function(p){p.preventDefault();if(k.inlineEditEnabled){if(k.stateMgr){k.stateMgr.saveUserSetting("st",j,k.moduleapi);}k.arcadeTransport.makeRequest({type:"module",moduleId:k.id,args:o.merge({_action:"save",_subAction:"addrq",s:p.result.text})},{success:function(){k.sendBeacon("search","app-fin","search");k.moduleapi.refreshView(c);},failure:function(){},scope:k,argument:o.merge({subAction:"addrq"})});}else{n.set("value",p.result.text);n.ancestor("form").submit();}});n.ac.on("visibleChange",function(p){if(p.newVal===d){k.body.one(".app").setStyle("zIndex","10");}else{k.body.one(".app").setStyle("zIndex","");}});}});}catch(l){}},emptyInputBox:function(k){k.set("value","").removeClass("quotes-input-inactive");k.on(b,this.setInputValue,this);},setInputValue:function(l){var k=l.target;if(k.get("value")===""){k.set("value",k.get("defaultValue"));k.addClass("quotes-input-inactive");}k.detach("blur",this.setInputValue);},onviewunload:function(k){if(k==c){this.tabs.teardown();if(this.searchBoxBlur){this.searchBoxBlur.detach();this.searchBoxBlur=e;}}},handleRequests:function(k,o){var l=this.moduleapi,n=this.requestId,m=this.body.getById(this.id+"-loading-info");if(l.isRequestPending(n)){l.abortRequest(n);if(m){m.get("parentNode").removeChild(m);}}this.requestId=l.makeRequest(k,o);},sendBeacon:function(l,m,n){var k={sec:m,slk:l,ltxt:n,cpos:0,pos:0,itc:1,test:this.currentBucket};this.instrumentation.fireBeacon(k);}};}());/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */
YModules.type_sportacular={body:null,editBody:null,id:"",moduleapi:null,arcadeTransport:null,teamLoadReqId:null,viewevents:["click","focus","mouseover"],searchBoxBlur:null,tabliteService:null,tabs:null,tabNavigationMode:null,init:function(a){this.Y=a.getService("yui");this.platform=a.getService("moduleplatform");this.enableAutocomplete=a.getContextData("enableAutocomplete");this.enableSearchbackfill=a.getContextData("enableSearchbackfill");this.enableMyTeams=a.getContextData("enableMyTeams");this.enableBucketedGames=a.getContextData("enableBucketedGames");this.defaultPanelCounter=a.getContextData("defaultPanelCounter");this.id=a.getId();this.arcadeTransport=this.platform?this.platform.getService("arcade_transport"):a;this.moduleapi=a;this.tabliteService=a.getService("tablite");this.tabNavigationMode=a.getContextData("tabNavigationMode");},formSubmit:function(a){return false;},onviewload:function(d){var b=this.moduleapi,c=this.Y,a;if(d==="default"){this.body=b.getViewNode(d);a=this.body.one(".tab-"+this.tabNavigationMode);this.tabs=new this.tabliteService({moduleApi:b,body:this.body,tabWidget:a,navMode:this.tabNavigationMode});this.tabs.setup();if(!this.searchBoxBlur){this.searchBoxBlur=this.body.delegate("blur",function(i){var h=i.target,g=h.get("value"),f=h.getAttribute("placeholder");if(g.length===0||f===g){h.addClass("sports-input-inactive");h.set("value",f);}},".sports-input");}}else{if(d==="edit"){this.editBody=b.getViewNode(d);}}},onviewunload:function(a){if(this.arcadeTransport.isRequestPending(this.teamLoadReqId)){this.arcadeTransport.abortRequest(this.teamLoadReqId);}if(a==="default"){this.body=null;}else{if(a==="edit"){this.editBody=null;}}this.tabs.teardown();if(this.searchBoxBlur){this.searchBoxBlur.detach();this.searchBoxBlur=null;}},loadTeams:function(b,c,e){var d,a;e=e||{};b=b||{};c=c||{};d=this.arcadeTransport.makeRequest({type:"module",moduleId:this.id,args:this.Y.merge({_action:"show",_subAction:"getTeams",noups:"1"},b)},{success:this.loadTeamsSuccess,failure:this.loadTeamsFailure,scope:this});a=this.moduleapi.getViewNode("default");a.detach("mouseover");return d;},loadTeamsFailure:function(a){},loadTeamsSuccess:function(c){if(c.data&&c.data.allTeams&&c.data.allTeams.teams){var b=c.data.allTeams.teams;try{this.Y.use("autocomplete","autocomplete-filters","autocomplete-highlighters",function(d){d.one("#sportsSearch").plug(d.Plugin.AutoComplete,{resultFilters:function(h,f){if(!h){return f;}var e={ignoreCase:true},g=d.Text.WordBreak.getUniqueWords(h,e);return d.Array.filter(f,function(i){var j=i.text.toLowerCase();return((i.raw.code.toLowerCase()).indexOf(h)!==-1)||d.Array.every(g,function(k){return j.indexOf(k)!==-1;});});},resultHighlighter:"subWordMatch",source:b,activateFirstItem:true,resultTextLocator:"name",maxResults:5,resultFormatter:function(f,e){return d.Array.map(e,function(g){return g.raw.name;});},on:{select:function(g){var f=g.result.raw.searchI13nUrl;d.config.win.location.href=f;}},align:{node:d.one("#sportsSearch"),points:["tl","bl"]}});});}catch(a){}}},onviewevent:function(g,d){var c=d.target,a=c.getAttribute("placeholder"),b=c.get("value"),f=this.Y.one("#sportsSearch");if(this.enableAutocomplete&&f){if(!this.teamLoadReqId){this.Y.one("#sportsSearch").on("submit",this.formSubmit,this);this.teamLoadReqId=this.loadTeams();}}if(g==="default"){}else{if(g==="edit"){}}if(this.enableSearchbackfill||this.enableAutocomplete){if(d.type==="focus"||d.type==="click"){if(c.hasClass("sports-input")&&a===b){c.set("value","");if(c.hasClass("sports-input-inactive")){c.removeClass("sports-input-inactive");}}if(this.autocompleteLoaded===false&&this.autocompleteEnabled){this.autocompleteLoaded=true;this.initAutocomplete();}}}}};/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */
YModules.type_flickr={body:null,editBody:null,id:"",moduleapi:null,viewevents:["click"],init:function(a){this.Y=a.getService("yui");this.id=a.getId();this.moduleapi=a;this.arcadeTransport=this.platform?this.platform.getService("arcade_transport"):a;this.user=a.getService("userinfo");this.loggedIn=this.user.isLoggedIn();this.enableMyPhotos=a.getContextData("enableMyPhotos")&&a.getContextData("isFlickrUser");},onviewload:function(c){var b=this.moduleapi,a=this;if(c==="default"){this.body=b.getViewNode(c);if(this.loggedIn&&this.enableMyPhotos){a.arcadeTransport.makeRequest({type:"module",moduleId:a.id,args:this.Y.merge({_action:"view",_subAction:"getPhotos",noups:0,s:"whatever this is"})},{success:function(d){if(d&&d.data&&d.data.myPhotos&&d.data.myPhotos.photos&&d.data.myPhotos.photos.length>0){this.body.set("innerHTML",d.data.myPhotos.markup);}},failure:function(){},scope:a,argument:this.Y.merge({subAction:"getPhotos"})});}}else{if(c==="edit"){this.editBody=b.getViewNode(c);}}},onviewunload:function(a){if(a==="default"){this.body=null;}else{if(a==="edit"){this.editBody=null;}}},onviewevent:function(b,a){if(b==="default"){}else{if(b==="edit"){}}}};/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */
(function(){var b=false,c=null,a=true,d=null;YModules.type_topvideos={body:c,ccode:c,ct:c,editBody:c,id:"",videoInlineEnabled:b,moduleapi:c,searchBoxEnabled:b,searchBoxBlur:c,videoService:c,viewevents:["click","focus"],yepPlayer:c,init:function(e){d=e.getService("yui");this.id=e.getId();this.moduleapi=e;this.ccode=e.getContextData("ccode");this.ct=e.getContextData("ct")||3;this.searchBoxEnabled=e.getContextData("searchBoxEnabled");this.videoInlineEnabled=e.getContextData("video.inline.enabled");},onviewload:function(f){var e=this.moduleapi;if(f==="default"){this.body=e.getViewNode(f);if(!this.searchBoxBlur){this.searchBoxBlur=this.body.delegate("blur",function(j){var i=j.target,h=i.get("value"),g=i.getAttribute("placeholder");if(h.length===0||g===h){i.addClass("videos-input-inactive");i.set("value",g);}},".videos-input");}}else{if(f==="edit"){this.editBody=e.getViewNode(f);}}},onviewunload:function(e){if(e==="default"){this.body=c;}else{if(e==="edit"){this.editBody=c;}}if(this.searchBoxBlur){this.searchBoxBlur.detach();this.searchBoxBlur=c;}},onviewevent:function(k,j){var i=j.target,f=i.getAttribute("placeholder"),g=i.get("value"),h,l=b;if(this.videoInlineEnabled&&j.type==="click"){h=i.ancestor("li.video-inline",true,"li");if(h){l=this.handleInlineVideo(h,i);}}if(this.searchBoxEnabled){if(j.type==="focus"||j.type==="click"){if(i.hasClass("videos-input")&&f===g){i.set("value","");if(i.hasClass("videos-input-inactive")){i.removeClass("videos-input-inactive");}}}}if(l){j.preventDefault();}},handleInlineVideo:function(k,f,e){var i=k.one("a"),h=this.body.one(".app-featured.videos"),j,l,g;if(!k){return b;}if(!this.videoService){this.videoService=this.moduleapi.getService("videoyep");if(this.videoService!==""){this.yepPlayer=this.videoService.create();}}if(!this.yepPlayer){return b;}if(i){g=i.get("href");}j=k.getData();if(j&&j.sec&&j.uuid&&j.pos){l={analytics:{sec:j.sec,cpos:parseInt(j.pos,10),ccode:this.ccode,ct:3},config:{animated:b,attach:h,location:"prepend",returnTabIndexTo:f,yep:{id:j.uuid,autoplay:true},videoPageUrl:g||c}};this.yepPlayer.init(l);return a;}}};}());/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */
(function(){YModules.type_birthday={moduleapi:null,isLinkedFB:false,isLoggedIn:false,instrumentation:null,birthdaySharingEnabled:false,viewevents:["click"],init:function(a){this.Y=a.getService("yui");this.moduleapi=a;this.isLinkedFB=a.getContextData("fb.account.linked")||false;this.isLoggedIn=(a.getService("userinfo").isLoggedIn()||a.getContextData("recognizedState"));this.instrumentation=a.getService("instrumentation");this.bucket=a.getContextData().bucket;this.birthdaySharingEnabled=a.getContextData("birthdaySharingEnabled");},onviewload:function(a){},onviewunload:function(a){if(a==="default"){this.moduleapi=null;this.isLinkedFB=null;this.isLoggedIn=null;}},onviewevent:function(d,c){var b=c.target,a=c.type;if(a==="click"){if(this.birthdaySharingEnabled&&b.ancestor(".bday-fb-wall",true)){c.preventDefault();this.handleBdayClick(b);}}},handleBdayClick:function(d){var a=d.ancestor(".bday-today",true),e=a.getData("userid"),b=a.getData("username"),c=a.getData("userbday");this.instrumentation.fireBeacon({sec:"app-bir",slk:"msg",itc:1,test:this.bucket,elm:"itm",elmt:"link",action:"click"});this.moduleapi.broadcast("fp:open-inline",{sec:"lb-bir",itcValue:"1",mode:"embed",module:"birthday",subModuleView:"birthday-share",subModuleData:this.Y.JSON.stringify({name:b,id:e,bday:c})});}};})();/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */
(function(){var d="default",a=".horoscope-sign",c=".halt",b;YModules.type_horoscope={moduleapi:null,body:null,isBusy:false,viewevents:["click"],moduleCookieName:"fpms",cookieDomain:null,cookieSignKey:null,statemgr:null,init:function(e){this.Y=e.getService("yui");this.id=e.getId();this.moduleapi=e;if(!b){b=e.getService("aria");}this.statemgr=e.getService("statemgr");this.cookieDomain=e.getContextData("cookieDomain");this.cookieSignKey=e.getContextData("cookieSignKey");},onviewload:function(f){var e=this.moduleapi;this.body=e.getViewNode(f);},onviewunload:function(e){this.body=null;},onviewevent:function(g,e){if(this.isBusy){return;}var f=e.target;if(f.test(c)||f.ancestor(c)){e.preventDefault();this.handleDefaultClick(f);}},handleDefaultClick:function(g){var f=g.ancestor(a,true),e=null;if(f){e=f.getAttribute("data-sign-id");}if(e!==null||g.hasClass("change-sign")){this.changeView(e);}},changeView:function(e){var f={type:"module",moduleId:this.id,args:{_container:0,_id:this.id,_action:"show",_subAction:"changeView",selectedSign:e,is_pageload:"false"}},g={success:this.handleGetSignDataSuccess,failure:this.handleGetSignDataError,scope:this,argument:{selectedSign:e,is_pageload:"false"}};this.isBusy=true;this.moduleapi.makeRequest(f,g);},handleGetSignDataSuccess:function(e,g){var f=this.moduleapi;this.isBusy=false;f.setView(d,e.html);if(g.selectedSign){this.Y.Cookie.setSub(this.moduleCookieName,this.id,"",{path:"/",domain:this.cookieDomain});if(this.statemgr){this.statemgr.setUserModuleState(this.cookieSignKey,g.selectedSign);this.statemgr.update();}}},handleGetSignDataError:function(e,f){this.isBusy=false;}};})();/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */
(function(){var e=null,c="d-n",b="loaded",d="load-error",f="current-comics-strip",a="type_comics";YModules.type_comics={body:null,editBody:null,id:"",moduleapi:null,viewevents:["click"],autoHide:e,autoHideId:e,comicsWrapper:e,expanded:false,tablistService:null,tabList:null,isBusy:false,instrumentation:e,modalService:e,modal:e,init:function(g){this.Y=g.getService("yui");this.id=g.getId();this.moduleapi=g;this.tablistService=g.getService("tablist");this.instrumentation=g.getService("instrumentation");this.modalService=g.getService("modal");},onviewload:function(i){var h=this.moduleapi,g=this;if(i==="default"){this.body=h.getViewNode(i);this.comicsWrapper=this.body.one(".comics-wrapper");this.tabList=this.tablistService.create(this.body.one(".y-tablist"),{moduleApi:h,panels:this.body.all(".tabpanel"),sticky:true,stickyKey:"st",vertical:true});this.tabList.on("tabchange",function(j){var k=this.getTabNode(this.getSelectedIndex());if(!k.hasClass(b)){g.loadComic(k);}else{g.updateAppState(g.body);}g.instrumentation.fireBeacon(k.getAttribute("data-b-inactive"));});}else{if(i==="edit"){this.editBody=h.getViewNode(i);}}},onviewunload:function(g){if(g==="default"){this.body=null;}else{if(g==="edit"){this.editBody=null;}}this.tabList.destroy();this.tabList=null;},onviewevent:function(h,g){if(h==="default"){this.handleEvents(this.body,g);}else{if(h==="edit"){}}},handleEvents:function(h,j){var k,m,o,l=j.target,g={},n=this.expanded?"lg":"sm",i=l.get("parentNode");if(!this.expanded){k=h.one(".tabpanel.selected ."+f);}else{k=h.one("."+f);}if(i.hasClass("older")||l.hasClass("older")){m=k.previous();if(m){k.replaceClass(f,c);m.replaceClass(c,f);this.updateAppState(h);g={sec:"app-com-"+n+"-"+this.getComicTag(),slk:"btn",ltxt:"pr",itc:1};this.instrumentation.fireBeacon(g);j.preventDefault();}}else{if(i.hasClass("newer")||l.hasClass("newer")){o=k.next();if(o){k.replaceClass(f,c);o.replaceClass(c,f);this.updateAppState(h);g={sec:"app-com-"+n+"-"+this.getComicTag(),slk:"btn",ltxt:"ne",itc:1};this.instrumentation.fireBeacon(g);j.preventDefault();}}}},loadComic:function(i){var g=i.getAttribute("data-comic"),h={type:"module",moduleId:this.id,args:{_container:0,_id:this.id,_action:"show",_subAction:"pickComic",comic:g}},j={success:this.handleGetComicDataSuccess,failure:this.handleGetComicDataFailure,scope:this,argument:{comicTabNode:i,comic:g}};this.isBusy=true;this.moduleapi.makeRequest(h,j);},handleGetComicDataSuccess:function(h,j){var g=this.body,i;this.isBusy=false;i=g.one(".y-tabpanels ."+j.comic);if(i){if(h.html&&h.html!=""){i.setHTML(h.html);j.comicTabNode.addClass(b);}else{i.setHTML(this.moduleapi.getString("STR.COMICS.FALLBACK"));j.comicTabNode.addClass(d);}this.updateAppState(g);}},handleGetComicDataFailure:function(h,j){var g=this.body,i;this.isBusy=false;i=g.one(".y-tabpanels ."+j.comic);if(i){i.setHTML(this.moduleapi.getString("STR.COMICS.FALLBACK"));this.updateAppState(g);j.comicTabNode.addClass(d);}},updateAppState:function(j){var g,h=j.one("button.older"),i=j.one("button.newer");if(!this.expanded){g=j.one(".tabpanel.selected .current-comics-strip");}else{g=j.one(".current-comics-strip");}if(h){this.updateNavButtonState(g,h,i);}},updateNavButtonState:function(g,h,i){if(!g){this.disableButton(h);this.disableButton(i);}else{if(g.previous()){this.enableButton(h);}else{this.disableButton(h);}if(g.next()){this.enableButton(i);}else{this.disableButton(i);}}},disableButton:function(g){g.setAttribute("disabled","disabled");g.addClass("disabled");},enableButton:function(g){g.removeAttribute("disabled");g.removeClass("disabled");},registerAutoHide:function(h){var g=this.moduleapi.getService("autohide");this.autoHideId=g.register({targets:[h],hide:this.Y.bind(this.restoreApp,this)});this.autoHide=g;},unregisterAutoHide:function(){var g=this.autoHide;if(g){g.unregister(this.autoHideId);}},restoreApp:function(){var g;this.modal.destroy();this.modal=e;this.expanded=false;this.unregisterAutoHide();g={sec:"app-com-lg-"+this.getComicTag(),slk:"comic",ltxt:"shnk",itc:1};this.instrumentation.fireBeacon(g);},getComicTag:function(){return this.body.one(".y-tablist .selected").getAttribute("data-comictag").substr(0,3);}};})();/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */
YModules.type_feedback={body:null,editBody:null,id:"",moduleapi:null,viewevents:["click"],submitData:{},isInternal:false,init:function(a){this.Y=a.getService("yui");this.id=a.getId();this.moduleapi=a;this.isInternal=a.getContextData("is.yahoo.ip");},onviewload:function(b){var a=this.moduleapi;if(b==="default"){this.body=a.getViewNode(b);}},onviewunload:function(a){if(a==="default"){this.body=null;}},onviewevent:function(c,b){var a=b.target;if(this.isInternal&&a.ancestor(".feedback_bug",true,".type_feedback")){this.emailBug();b.preventDefault();}},postBugzilla:function(d,e,f){f=f||"post";var c=document.createElement("form"),a,b;c.setAttribute("method",f);c.setAttribute("action",d);for(b in e){if(e.hasOwnProperty(b)){a=document.createElement("input");a.setAttribute("type","hidden");a.setAttribute("name",b);a.setAttribute("value",e[b]);c.appendChild(a);}}document.body.appendChild(c);c.submit();},emailBug:function(){var j={host_date:/(.*\.yahoo\.com) +compressed\/chunked +([A-Z][a-z]{2} +[A-Z][a-z]{2} +[0-9]{1,2} +[0-9]{2}:[0-9]{2}:[0-9]{2} +[A-Z]{3} +[0-9]{4})/,bucket:/bid=(\d+)/},k="\n--------------------------------------------------------------\n",i="\t",f=[],g=document.body,b=[],c=[],h,d,e,a=this.Y;this.submitData={product:"Frontpage",component:"Homerun-internal",bugtype:"Defect",assigned_to:"homerun-qt@yahoo-inc.com",qa_contact:"homerun-bugs@yahoo-inc.com"};d=new this.Y.NodeList(g.childNodes);d.each(function(o,l,m){e=o.getDOMNode();if(e.nodeType===8){h=e.nodeValue;a.each(j,function(n,p){switch(p){case"host_date":if(j[p].test(h)){h=h.replace(j[p],"host:$1;date:$2");f=f.concat(h.split(";"));}break;case"bucket":if(j[p].test(h)){h=h.replace(j[p],"bucket:$1");f.push(h);}break;}});}});f.push("requestId: "+window.Y.dali.config.props.requestId);f.push("bcookie: "+this.Y.Cookie.get("B"));this.Y.one("#default-p_30345786").all("li.content").each(function(m){var l=m.one("h3 a").getDOMNode().textContent;c.push(m.getAttribute("data-uuid")+i+m.getAttribute("data-reason")+i+l+"\t"+decodeURIComponent(m.getAttribute("data-url")));b.push({"data-uuid":m.getAttribute("data-uuid"),"data-reason":m.getAttribute("data-reason"),title:l,"data-url":decodeURIComponent(m.getAttribute("data-url"))});});this.submitData.comment=k+f.join("\n")+k+c.join("\n");this.submitData.short_desc="[Please include summary of the bug/defect you're seeing here]";this.moduleapi.makeRequest({type:"module",moduleId:this.id,args:this.Y.merge({_action:"show",_subAction:"getSlingstoneDataUrl",noups:1})},{success:function(){var l=this.moduleapi.getContextData("slingstone.data.url");if(l!==""&&l!==null){this.submitData.comment="[Replace this line with your report]\n"+k+"Slingstone Data: "+l+"\n"+this.submitData.comment;}else{this.submitData.comment="[Replace this line with your report]\n"+this.submitData.comment;}this.postBZ(this.submitData);},failure:function(){this.postBZ(this.submitData);},scope:this});},postBZ:function(){this.postBugzilla("http://bug.corp.yahoo.com/enter_bug.cgi?SIM_FLAGTYPE_ID=376&alias=&assigned_to=homerun-qt%40yahoo-inc.com&blocked=&bug_file_loc=http%3A%2F%2F&bug_severity=normal&bug_status=NEW&bug_status=NEW&bugtype=Defect&comment=Please%20describe%20the%20bug%2Fdefect%20you%27re%20seeing%20here.%20%0D%0A%0D%0APlease%20also%20include%20supporting%20information%3A%20screenshots%2C%20browser%2Fos%2C%20etc.%20&commentprivacy=0&component=Homerun-internal&contenttypeentry=&contenttypemethod=autodetect&contenttypeselection=text%2Fplain&crumb=&data=&deadline=&dependson=&description=&estimated_time=0.0&flag_type-437=X&flag_type-439=X&flag_type-447=X&form_name=enter_bug&keywords=&maketemplate=Remember%20values%20as%20bookmarkable%20template&material_to_version=0&op_sys=--&priority=--&product=Frontpage&production=0&qa_contact=homerun-bugs%40yahoo-inc.com&related_items=&rep_platform=--&short_desc=%5BPlease%20include%20summary%20of%20the%20bug%2Fdefect%20you%27re%20seeing%20here%5D&status_whiteboard=&steps_to_verify=&target_milestone=---&target_version=Unspecified&version=Unspecified",this.submitData);}};/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */
YModules.type_todaycontainer={body:null,editBody:null,id:"",moduleapi:null,viewevents:["click"],init:function(a){this.Y=a.getService("yui");this.id=a.getId();this.moduleapi=a;},onviewload:function(b){var a=this.moduleapi;if(b==="default"){this.body=a.getViewNode(b);}else{if(b==="edit"){this.editBody=a.getViewNode(b);}}},onviewunload:function(a){if(a==="default"){this.body=null;}else{if(a==="edit"){this.editBody=null;}}},onviewevent:function(b,a){if(b==="default"){}else{if(b==="edit"){}}}};/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */
(function(){var s="hide",ar="prev",o="next",d="close",L="empty",au="selected",ab="inlinevid",m="indicator",h="todaytop",M="main-story",i=".main-story-content",B='<div class="main-story-next"></div>',v="no-visibility",X="related-links",ax="no-top-padding",ah="indicator-playing",g="y-today-grad1",f="y-today-grad2",x="y-today-ln-1",ao="y-ln-2",am="y-ln-4",O="trans-border",ad="item",af="play",l="pause",aq="height",ac=null,S=true,y=false,ai="href",D="innerHTML",an="pa:open",av="pa:close",K="lightbox:start",a="lightbox:end",r="y-carousel",ap=32,e="parentNode",j="none",Y="px",al="OK",Z="-panel",u="abort",G="data-b",ae=".package-header",I="story",aa="footers",c="story_footer_pairs",b="fpck",q="interactive",Q="sayt:open",ay="sayt:close",C="fp:window:resize",V="mouseout",T="mouseover",H=300,n="pane",W="package",k="baseline",az="ta",U="ca",w="cat",z="1",ag="0",P="footers",aj="stories",F=0,A=0,aA=0,E=-1,t=1,N=2,R=3,at="fade",ak="crossfade",p="always",J="single_pane",aw="all_panes";YModules.type_fptoday={viewevents:["click","keyup"],moduleapi:ac,cache:ac,body:ac,moduleId:ac,mainStory:ac,mainStoryContent:ac,mainStoryNext:ac,lastSelectedFooter:ac,carousel:ac,instrumentation:ac,packageIds:ac,visibleElementCount:0,textCount:ac,paginationType:ac,yep:ac,cokeTestId:ac,mcode:ac,woeId:ac,cookieDomain:ac,delayMouseover:ac,timeDelayed:0,carouselContainer:ac,carouselOuterContainer:ac,footerOverlay:ac,loadingOverlay:ac,isTodayOnTop:1,showDate:S,animMode:j,animStoryOverlayDuration:0,animStoryOverlayDelay:0,animTransition:at,preloadPaneCount:0,timeoutPaneCount:0,animIntervalInitial:0,animIntervalSubsequent:0,isInitialAnim:S,animFadeDuration:A,animHtml:ac,animPlayBeacon:ac,animPauseBeacon:ac,animPlayString:ac,animPauseString:ac,delayAutoPlayMouseover:ac,autoPlayReference:ac,isOtherModuleOpen:y,isManuallyPaused:y,titleRegion:ac,statemgr:ac,arcadeTransport:ac,doBroadcastEvent:y,footerHeight:0,blurHandler:ac,focusHandler:ac,activeElement:ac,mod:ac,handleOffsetWidth:0,handleParentLeft:0,handleParentOffsetWidth:0,handleCursorOffset:0,populateStoryRequestId:ac,populateScrollItemRequestId:ac,unifiedEnabled:ac,persPkgId:ac,clickStCookie:ac,clickStToastCookie:ac,todayPkgPersEnabled:ac,inlineVideoEnabled:y,videoService:ac,videoBindNode:ac,videoPlayer:ac,sec:ac,init:function(aC){this.Y=aC.getService("yui");this.cache={};this.moduleId=aC.getId();this.moduleapi=aC;this.cookieDomain=aC.getService("moduleplatform").getProperty("cookieDomain");this.instrumentation=aC.getService("instrumentation");this.storage=aC.getService("storage");this.userinfo=aC.getService("userinfo");this.inlineLightboxEnabled=aC.getContextData("inlineLightboxEnabled");var aB=this.statemgr=aC.getService("statemgr");this.todayPkgPersEnabled=aC.getContextData("today_pkg_pers");if(this.todayPkgPersEnabled){this.clickStCookie=aB.getUserModuleState(U);}this.arcadeTransport=aC.getService("moduleplatform").getService("arcade_transport");this.inlineVideoEnabled=aC.getContextData("inline.video.enabled");if(this.inlineVideoEnabled){this.videoService=aC.getService("videoyep");if(this.videoService){this.videoPlayer=this.videoService.create();}this.sec=aC.getContextData("sec");}aC.listen(an);aC.listen(av);aC.listen(K);aC.listen(a);aC.listen(Q);aC.listen(ay);aC.listen(C);},onviewload:function(aM){if(aM=="default"){var aC=this.Y,aK=aC.UA.ie,aT,aI,aS,aP,aX,aV,aZ,aF,aD,aW=this.moduleId,a0=this.moduleapi,aY=a0.getContextData(),aG=a0.getService("carousel"),aO=a0.getContextData("crslAnimEnabled"),aJ=this.clickStCookie,aE,aL,aH,aU,aN,aQ,aB,aR;aI=this.body=a0.getViewNode(aM);if(this.inlineVideoEnabled){this.videoBindNode=aI.one(".fptoday-container");}aP=this.mainStory=aI.getById(aW+"-main_story");this.footerOverlay=aI.query(".footer-overlay");this.loadingOverlay=aI.query(".loading-overlay");if(!aP||aI.query(".xotitle")){this.onviewevent=ac;return;}this.mainStoryContent=aP.one(i);aS=this.carousel=aG.create(aI.query("."+r),{animDuration:0.4,loop:S,animate:aO});aS.subscribe("beforescroll",this.loadScrollItem,this);aS.subscribe("scroll",this.updatePaginator,this);this.isTodayOnTop=a0.getContextData(h);this.showDate=a0.getContextData("showdate");aX=this.packageIds=aY.pkgIds;this.initializeCache(aY);aZ=aI.query("#"+aW+Z+"0 ."+ad);this.lastSelectedFooter=(aY.centerStory==1)?aZ.next("."+ad):aZ;this.visibleElementCount=aX.length/aS.getItemCount();this.textCount=aY.textCount;this.paginationType=(aY.paginationtype)?aY.paginationtype:k;this.cokeTestId=aY.cokeTestId;this.mcode=aY.mcode;this.woeId=aY.woeId;this.timeDelayed=a0.getContextData("today_delay_mouseover")||H;if(aS.getItemCount()>1){aV=aI.query(".y-carousel-list").get("children");aV.removeClass(s);this.updatePaginator();aI.query(".navigation").removeClass(v);}aF=this.carouselContainer=aI.one("."+r);aD=this.carouselOuterContainer=aI.one(".carousel-container");aF.on(T,this.handleFooterMouseover,this);aF.on(V,this.handleFooterMouseout,this);this.unifiedEnabled=a0.getContextData("unified.todaynews.enabled");this.animMode=a0.getContextData("footer.anim.mode");if(this.animMode!=j){this.animIntervalInitial=a0.getContextData("footer.anim.interval.initial")||F;this.animIntervalSubsequent=a0.getContextData("footer.anim.interval.subsequent")||F;this.animFadeDuration=a0.getContextData("footer.anim.fade.duration")||A;this.animTransition=a0.getContextData("footer.anim.transition")||at;this.preloadPaneCount=a0.getContextData("footer.anim.preload.pane_count")||0;this.timeoutPaneCount=a0.getContextData("footer.anim.timeout.pane_count")||0;this.animHtml=aI.create(a0.getContextData("animHtml"));aR=aI.one(".title-date");this.titleRegion=aR?aR.get("region"):ac;this.attachEngagingAreaMouseEvents();if(aK){document.onfocusout=this.Y.bind(this.handleBlur,this);document.onfocusin=this.Y.bind(this.handleFocus,this);}else{this.blurHandler=this.Y.on("blur",this.Y.bind(this.handleBlur,this),window);this.focusHandler=this.Y.on("focus",this.Y.bind(this.handleFocus,this),window);}this.insertPlayPauseButton();this.isInitialAnim=S;this.isManuallyPaused=a0.getContextData("animPausedState");this.startAutoPlay();}this.doBroadcastEvent=a0.getContextData("broadcast.interactive_event");this.animStoryOverlayDuration=a0.getContextData("layout.overlay.anim.duration");this.showMainStoryOverlay();this.animStoryOverlayDelay=a0.getContextData("layout.overlay.anim.delay");if(aJ&&aJ.pkgId&&aJ.pkgIds){aN=true;aL=aJ.pane?aJ.pane:0;aB=aJ.pkgIds;aE=aB.length;for(aT=0;aT<aE;aT++){aQ=aB[aT];aH=this.indexOf(aQ,aX);if("-1"!=aH&&(!aU||(aU&&(aU+1)==aH))){aU=aH;}else{aN=false;break;}}if(aN){this.persPkgId=aJ.pkgId;if("0"!=aL){this.carousel.scrollTo(aL);}else{this.handlePersistantScroll();}}}if(aJ){this.statemgr.setUserModuleState(U,ac);}}},indexOf:function(aE,aD){var aC=aD.length,aB;for(aB=0;aB<aC;aB++){if(aD[aB]==aE){return aB;}}return -1;},handlePersistantScroll:function(aD){var aE,aC=this.body.getById(this.moduleId+Z+this.clickStCookie.pane).all("a"),aB=this.persPkgId;if(aC){aC.each(function(aF){if(aF.getAttribute("y-pkgid")==aB){aE=aF;}});if(aE){this.populateStory({linkNode:aE,userHover:y});}}this.persPkgId=null;},manageToast:function(aD){var aC=this.body.one(".toast"),aE,aF,aB;if(!this.clickStToastCookie){if(aD){if(!aC){this.body.setStyle("position","relative");aF=this.moduleapi.getContextData("TODAY_RETAIN_PKG_MARKUP");this.body.append(aF);aC=this.body.one(".toast");}aC.removeClass("hide");this.statemgr.setUserModuleState(w,"1");}else{aB=aC.fx;aE={from:{opacity:1},to:{opacity:0},duration:2};aB.setAttrs(aE);aB.on("end",function(){aC.addClass("hide");aB.detach("end");},this);aB.run();}}},onviewunload:function(aB){if(aB=="default"){this.cleanup();}},onviewevent:function(aO,aE){var aC,aL=aE.target,aP=aE.type,aF,aJ,aR,aG,aQ,aI,aN=this.delayMouseover,aH=y,aK,aB,aD,aM={};if(aN){aN.cancel();this.delayMouseover=ac;}if(aO=="default"&&aL){if(this.inlineLightboxEnabled){aK=aL.ancestor(".fp-open-inline",true);if(aK){aE.preventDefault();if(aK.hasClass("fp-bday")){aM={name:aK.getData("bday-name"),bday:aK.getData("bday-date"),hash:aK.getData("bday-hash"),id:aK.getData("bday-fbid")};this.moduleapi.broadcast("fp:open-inline",{sec:"fptoday-bday",mode:"embed",module:"birthday",subModuleView:"birthday-story",subModuleData:this.Y.JSON.stringify(aM)});}else{if(aK.getAttribute("data-uuid")){aB=aK.getAttribute("data-uuid");}if(aK.getAttribute("href")){aD=aK.getAttribute("href");}else{aD=aK.one("A.rapidnofollow").getAttribute("href");}this.moduleapi.broadcast("fp:open-inline",{uuid:aB,href:aD,sec:"td-strm",ct:"1"});}return;}}if(aP=="keyup"){if(this.carouselContainer.contains(aL)){this.handleFooterMouseover(aE);this.cancelAutoPlay();}}else{if(this.carouselContainer.contains(aL)){aC=this.handleFooterClick(aL);}else{if(this.classMatch(aL,ar)){aC=this.previous;aH=S;}else{if(this.classMatch(aL,o)){aC=this.next;aH=S;}else{if(this.classMatch(aL,af)){aC=this.handleManualPlayPauseAutoPlay(af,aL);}else{if(this.classMatch(aL,l)){aC=this.handleManualPlayPauseAutoPlay(l,aL);}else{if((aL.hasClass(ab)||this.classMatch(aL,M))){aC=this.handleMainStory(aL);}}}}}}}if(this.todayPkgPersEnabled&&aP=="click"&&(aL.get("tagName")=="A"||aL.ancestor("a"))&&aL.ancestor(".fptoday-container")){aF=this.carousel.getCurrentIndex();aI=this.statemgr;aJ=aL.ancestor(".fptoday-container").one(".footer-section .selected");aR=aJ.getAttribute("y-pkgid");aG=[];aJ.ancestor("li").all("a").each(function(aS){aG.push(aS.getAttribute("y-pkgid"));});aQ={pane:aF,pkgId:aR,pkgIds:aG};aI.setUserModuleState(U,aQ);}if(aC){this.cancelAutoPlay();aE.preventDefault();aC.call(this);if(aH&&this.doBroadcastEvent){this.broadcastEvent();}}}},loadScrollItem:function(aP){var aJ=this.body,aF,aG,aQ=this.carousel,aT=this.moduleapi,aN=aQ.getCurrentIndex(),aB=aN,aR=this.moduleId,aO=this.animMode,aK=aJ.getById(aR+Z+aN),aH,aI="",aL=ac,aC,aD,aE,aM=aP.toIndex,aS=(aM-aP.fromIndex==1)?o:ar;if(aK){if(aO==j){aC=aa;aD=this.populateScrollItem;aE=this.populateScrollItemFailure;aI=aK.hasClass(L)?N:"";}else{aC=c;aD=this.preloadSuccess;aE=this.preloadFailure;if(aK.hasClass(L)){aI=N;}else{if(this.preloadPaneCount!==aA){aI=t;}}}if(aI!==""){aL=this.getPackageIds(aN,aI,aS);}if(aL&&aL.length>0){if(aI==t){aT.refreshView("default");return;}if(aS==ar&&aI==R){aB=aN-aL.length/this.visibleElementCount+1;}aF={type:"module",moduleId:aR,args:{_action:"show",_subAction:aC,storyIds:aL,panelIndex:aB,cokeTestId:this.cokeTestId,mcode:this.mcode,woeId:this.woeId,todaytop:this.isTodayOnTop}};aG={success:aD,failure:aE,argument:{panel:aK,panelIndex:aN,showStory:S,direction:aS},scope:this};if(!this.autoPlayReference){aF.args=this.Y.merge(aF.args,{isScroll:1});}this.loadingOverlay.removeClass(s);if(this.arcadeTransport.isRequestPending(this.populateScrollItemRequestId)){this.arcadeTransport.abortRequest(this.populateScrollItemRequestId);}this.populateScrollItemRequestId=this.arcadeTransport.makeRequest(aF,aG,aR);}else{if(aO!=j){if(!this.persPkgId){aQ=this.carousel;aH=aQ.getItemNode(aQ.getCurrentIndex()).query("."+ad);this.populateStory({linkNode:aH,userHover:y});}else{this.handlePersistantScroll();}this.startAutoPlay();}}}},preload:function(aF,aC,aH){var aB=this.body.getById(this.moduleId+Z+aF),aE=this.getPackageIds(aF,R,o),aD={type:"module",moduleId:this.moduleId,args:{_action:"show",_subAction:c,storyIds:aE,panelIndex:aF,cokeTestId:this.cokeTestId,mcode:this.mcode,woeId:this.woeId,todaytop:this.isTodayOnTop}},aG={success:this.preloadSuccess,failure:this.preloadFailure,argument:{panel:aB,panelIndex:aF,showStory:aC,direction:o},scope:this};if(aH){aD.args=this.Y.merge(aD.args,aH);}if(this.arcadeTransport.isRequestPending(this.populateScrollItemRequestId)){this.arcadeTransport.abortRequest(this.populateScrollItemRequestId);}this.populateScrollItemRequestId=this.arcadeTransport.makeRequest(aD,aG,this.moduleId);},preloadSuccess:function(aC,aI){var aT=this.moduleapi,aP=this.carousel,aE=aT.getContextData(aj),aB=aT.getContextData(P),aL=aI.panelIndex,aJ=aI.panel,aF=aI.showStory,aR=aI.direction,aN=this.visibleElementCount,aM,aG,aO,aH=(aR==ar)?(aB.length-aN):0,aQ,aD=aJ,aS,aK="";while(aJ&&aJ.hasClass(L)&&aB[aH]){aK+=aB[aH];if((aH+1)%aN===0){aJ.removeClass(L);aJ.set(D,aK);aM=aJ.all("."+ad);for(aQ=0;aQ<aN;aQ++){aS=this.extractId(aM.item(aQ));if(aS!=""){this.cache[aS]=aE[aS];}}}aH++;if(aH%aN===0){aJ=(aR==ar)?aJ.previous():aJ.next();aK="";aH=(aR==ar)?aH-(2*aN):aH;}}if(aF){if(aL!=aP.getCurrentIndex()){this.carousel.scrollTo(aL);}this.loadingOverlay.addClass(s);if(!this.persPkgId){aG=aD.one("."+ad);this.populateStory({linkNode:aG,userHover:y});}else{this.handlePersistantScroll();}this.startAutoPlay();}aO=aD.one(".empty");if(aO){aT.refreshView("default");}},preloadFailure:function(aC,aD){var aB=this.Y.Lang.isObject(aC);if(aB&&aC.statusText==u){if(this.preloadPaneCount==this.timeoutPaneCount){this.handleFatalError();}else{}}else{if(aB&&aC.statusText==al){}else{this.handleFatalError();}}},handleFatalError:function(){var aB=this.carousel;this.animMode=J;this.loadingOverlay.addClass(s);aB.scrollTo(0,y);this.populateStory({linkNode:aB.getItemNode(0).query("."+ad),userHover:y});this.body.one(".y-nav-buttons").addClass(v);},updatePaginator:function(){var aB=this.body,aE,aH,aD,aC=this.visibleElementCount,aG,aF;switch(this.paginationType){case k:aB.query(".navigation .selected").removeClass(au);aB.getById(this.moduleId+"_"+this.carousel.getCurrentIndex()).addClass(au);break;case n:aE=aB.query(".navigation .y-nav-count");this.setPaginationString(this.carousel.getCurrentIndex()+1,this.carousel.getItemCount());break;case W:aH=aB.queryAll("."+ad);aD=aH.size();aF=(this.carousel.getCurrentIndex()+1)*aC;aG=aF-(aC-1);this.setPaginationString(aG+" \u2013 "+aF,aD);break;}},setPaginationString:function(aE,aD){var aC,aB=this.body.query(".navigation .y-nav-count");if(aB){aC=this.Y.Lang.sub(this.textCount,{"0":aE,"1":aD});aB.set(D,aC);}},handleFooterMouseover:function(aE){var aD=aE.target,aC=aD.ancestor(".item"),aB;if(aD.hasAttribute(ai)){aB=aD;}else{aB=aC;}if(!aB||(aB.hasClass(ad)&&aB.hasClass(au))){return;}this.delayMouseover=this.Y.later(this.timeDelayed,this,this.populateStory,{linkNode:aB,userHover:S});},handleFooterMouseout:function(aC){var aB=this.delayMouseover;if(aB){aB.cancel();this.delayMouseover=ac;}},populateStory:function(aM){var aI,aP,aO,aH,aG=this.moduleapi,aB=this.cache,aL=aM.linkNode,aE=aM.userHover,aN=this.animMode===p||!aE,aF=this.extractId(aL),aK=this.lastSelectedFooter,aR=aK.query(".image"),aQ=aB[aF],aD,aC,aJ;if(!aL.hasClass(ad)){return;}if(aQ&&aQ.index&&!(/^\d+$/.test(aQ.index))){return;}if(aR){aR.replaceClass(am,ao);}aK.removeClass(au).replaceClass(am,O).replaceClass(f,g).addClass(x);this.lastSelectedFooter=aL;if(!aQ){aF=this.extractId(aL);this.lastSelectedFooter=aL;aQ=aB[aF];}if(aQ){this.lastSelectedFooter.addClass(au).replaceClass(O,am).replaceClass(g,f).removeClass(x);aH=aQ.html;if(aH){aN=(this.Y.UA.ie&&this.Y.UA.ie<=8)?y:aN;this.setMainStory(aH,aF,aN,S);}else{aD=this.body.getById(this.moduleId+"-header-image");if(aD){if(aD.hasAttribute("data-img")){aC=aD.getAttribute("data-img");aJ=aD.get("text");}else{aC=aD.get("src");aJ=aD.get("alt");}}aI={type:"module",moduleId:this.moduleId,args:{_action:"show",_subAction:I,storyId:aF,storyIndex:aQ.index,cokeTestId:this.cokeTestId,woeId:this.woeId,todaytop:this.isTodayOnTop}};aP={success:this.handlePopulateStorySuccess,failure:this.handlePopulateStoryFailure,argument:{storyId:aF,oldImageSrc:aC,oldImageAlt:aJ,doFade:aN},scope:this};if(aG.isRequestPending(this.populateStoryRequestId)){aG.abortRequest(this.populateStoryRequestId);}this.populateStoryRequestId=aG.makeRequest(aI,aP);}aO=aK.query("."+ah);if(this.showDate&&this.isTodayOnTop!="0"){this.mainStory.addClass("has-date");}if(aO){aO.replaceClass(ah,m);this.carouselContainer.removeClass(ax);}if(aL&&aE){this.tracking(aL);}this.updatePaginator();if(this.doBroadcastEvent&&aE){this.broadcastEvent();}}},tracking:function(aB){var aC=this.cache,aD=this.extractId(aB);if(aC[aD]&&!aC[aD].beaconFired){if(aB.hasAttribute("data-b-tdh")){this.instrumentation.fireUltBeacon(aB.getAttribute("data-b-tdh"));}aC[aD].beaconFired=S;if(this.preloadPaneCount!==aA){this.setFPCKCookie(aD);}}},handleMainStory:function(aC){var aD,aE=ac,aB=this.cache;if(!this.inlineVideoEnabled||!this.videoPlayer){return aE;}if(this.classMatch(aC,d)){aE=this.closeVideo;}else{if(aC.hasClass(ab)||!this.classMatch(aC,X)&&(aC.hasAttribute(ai)||aC.ancestor(function(aF){return aF.hasAttribute(ai);}))){aD=this.extractId(this.lastSelectedFooter);if(aB[aD]&&aB[aD].clipId){aE=this.showInlineVideo;}}}return aE;},handleFooterClick:function(aC){var aE,aF=ac,aB=this.cache,aD=this.classMatch(aC,ad);if(aD){aE=this.extractId(aD);if(aB[aE]&&aB[aE].clipId&&this.inlineVideoEnabled){aF=this.showInlineVideo;}}return aF;},closeVideo:function(){if(this.inlineVideoEnabled&&this.videoPlayer){this.videoPlayer.detachVideo();}},showInlineVideo:function(){if(!this.inlineVideoEnabled){return;}var aE=this.extractId(this.lastSelectedFooter),aC=this.cache[aE],aB=this.footerOverlay,aD;if(aB){aB.removeClass(s);}aD={analytics:{sec:this.sec,ccode:this.cokeTestId,cpos:aC.index},config:{yep:{id:aC.clipId,autoplay:S},animated:y,attach:this.body.one(".main-story-content")}};this.videoPlayer.init(aD);},onmessage:function(aD,aB,aC){var aE=this.body.getById(this.moduleId+"-main_story");if(!aE||this.body.query(".xotitle")){return;}switch(aD){case K:case an:case Q:this.isOtherModuleOpen=S;this.cancelAutoPlay();break;case a:case av:case ay:this.isOtherModuleOpen=y;this.startAutoPlay();break;case C:this.handleResize();break;default:break;}},handlePopulateStorySuccess:function(aC,aF){var aE=aC.data,aB=aE.story,aH=aF.storyId,aD=this.cache[aH],aG=this.extractId(this.lastSelectedFooter);if(aG===aH){aF.doFade=(this.Y.UA.ie&&this.Y.UA.ie<=8)?y:aF.doFade;this.setMainStory(aB,aH,aF.doFade,y);aD.clipId=aE.clipId;aD.channelNodeId=aE.channelNodeId;}else{}},handlePopulateStoryFailure:function(aB,aC){},populateScrollItem:function(aD,aE){var aG,aC,aB=aE.panel,aF=this.body.getById(this.moduleId+Z+aE.panelIndex);aB.removeClass(L);this.loadingOverlay.addClass(s);aF.set(D,aD.data.footers);if(this.animMode!=j){if(!this.persPkgId){aG=this.carousel;aC=aG.getItemNode(aG.getCurrentIndex()).query("."+ad);this.populateStory({linkNode:aC,userHover:y});}else{this.handlePersistantScroll();}this.startAutoPlay();}},populateScrollItemFailure:function(aB){if(aB.statusText==u){}else{this.moduleapi.refreshView("default");}},getPackageIds:function(aG,aI,aJ){var aO=[],aL=this.packageIds,aH=aL.length,aN=this.visibleElementCount,aD=this.preloadPaneCount,aB,aM,aK,aC,aE,aF;if(aI==t){aB=this.body.getById(this.moduleId+Z+aG);aM=aB.all("."+ad);for(aF=0;aF<aN;aF++){if(aM.item(aF).hasClass(L)){aO.push(aL[(aG*aN)+aF]);}}}else{aD=(aD==E)?aL.length/aN-1:aD;aK=this.carouselContainer.all(".y-panel");if(aJ==ar){aE=(aG+1)*aN;aC=(aI!==R)?aE-aN:aE-aD*aN;if(aC<0){aC=aN;}}else{aC=aG*aN;aE=(aI!==R)?aC+aN:aC+aD*aN;aE=aE>aH?aH:aE;}for(aF=aC;aF<aE;aF++){if(aK.item(Math.floor(aF/aN)).hasClass(L)){aO.push(aL[aF]);}}}return aO;},cleanup:function(){var aE=this.carousel,aB=this.delayMouseover,aD=this.carouselContainer,aC=this.moduleapi;if(aE){aE.unsubscribe("beforescroll",this.loadScrollItem);aE.unsubscribe("scroll",this.updatePaginator);aE.destroy();}if(aB){aB.cancel();}if(aD){aD.detach(T,this.handleFooterMouseover);aD.detach(V,this.handleFooterMouseout);}if(this.animMode!=j){this.detachEngagingAreaMouseEvents();this.cancelAutoPlay();if(this.Y.UA.ie){document.onfocusout=ac;document.focusin=ac;}else{this.Y.detach("blur",this.blurHandler,window);this.Y.detach("focus",this.focusHandler,window);}}aC.abortRequest(this.populateStoryRequestId);this.arcadeTransport.abortRequest(this.populateScrollItemRequestId);this.moduleapi.unlisten();this.body=this.statemgr=this.carousel=this.mainStory=this.mainStoryContent=this.delayMouseover=this.carouselContainer=this.carouselOuterContainer=this.populateStoryRequestId=this.populateScrollItemRequestId=this.activeElement=this.blurHandler=this.focusHandler=ac;},setMainStory:function(aD,aG,aB,aF){var aH=this.mainStoryContent,aC=this.mainStoryNext,aE;if(this.animMode==j||!aB){aH.set(D,aD);this.replaceImageInMainStory(aD,aG,aF);this.showMainStoryOverlay();aE=aH;}else{if(this.animTransition===ak){if(aC){this.crossFadeMainStoryEnd();aH=this.mainStoryContent;}this.mainStoryNext=aC=this.mainStory.insertBefore(B,this.mainStoryContent);aC.setContent(aD);this.showMainStoryOverlay(aC);aE=aC;}aH.transition({opacity:0,duration:this.animFadeDuration},this.Y.bind(this.fadeOutMainStoryEnd,this,aD,aG,aF));}},replaceImageInMainStory:function(aB,aD,aC){this.cache[aD].html=this.mainStoryContent.get(D);},showMainStoryOverlay:function(aB){var aD=this.mainStoryContent,aC=(aB||aD).one(".package-overlay");if(aC){if(aB&&aB!==aD&&this.animTransition===ak){aD.one(".package-overlay").hide();}if(this.animStoryOverlayDuration){aC.setStyle("opacity",0);aC.transition({duration:this.animStoryOverlayDuration,delay:this.animStoryOverlayDelay,opacity:1});}else{aC.setStyle("opacity",1);}}},fadeOutMainStoryEnd:function(aE,aC,aB){var aI=this.mainStoryContent,aD=this.extractId(this.lastSelectedFooter),aJ,aH=this.body.one("#navigation-"+this.moduleId),aF=this.oldTextPosition,aG;if(aD===aC){if(this.animTransition===ak){this.crossFadeMainStoryEnd();this.replaceImageInMainStory(aE,aC,aB);}else{aI.set(D,aE);this.replaceImageInMainStory(aE,aC,aB);}}else{}if(this.animTransition===at){this.showMainStoryOverlay();aI.transition({opacity:1,duration:this.animFadeDuration});}aG=this.mainStoryContent.one(ae);if(aG){aJ=aG.getAttribute("data-pos");if(aF){aH.replaceClass(aF,aJ);}this.oldTextPosition=aJ;}},crossFadeMainStoryEnd:function(){if(this.mainStoryNext){var aB=this.mainStoryContent;this.mainStoryContent=this.mainStoryNext.replaceClass("main-story-next","main-story-content");aB.remove();this.mainStoryNext=ac;}},setOpacity:function(aC,aB){aC.setStyle("opacity",aB);if(aB==1){aC.setStyle("filter","none");}else{aC.setStyle("filter","progid:DXImageTransform.Microsoft.Alpha(opacity="+aB*100+")");}},extractId:function(aB){return(aB?aB.getAttribute("y-pkgId"):ac);},classMatch:function(aC,aB){return aC.hasClass(aB)?aC:aC.ancestor(function(aD){return aD.hasClass(aB);});},initializeCache:function(aE){var aD,aG=aE.pkgIds,aC=aE.stories,aF=aG.length,aB;for(aD=0;aD<aF;aD++){aB=aC[aG[aD]];this.cache[aG[aD]]=(aB&&aB.html)?{html:aB.html,index:aD,clipId:aB.clipId,channelNodeId:aB.channelNodeId,beaconFired:aB.beaconFired}:{html:ac,index:aD,clipId:ac,channelNodeId:ac,beaconFired:y};}},previous:function(){var aB=this.carousel;if(!aB.isScrolling()){aB.previous();}},next:function(){var aB=this.carousel;if(!aB.isScrolling()){aB.next();}},replaceTitle:function(aC){var aB=this.body.query("#"+this.moduleId+"-main_story .video-title");aC=aC.length>ap?aC.substr(0,ap)+"...":aC;aB.set(D,aC);},fixCarouselPanelHeight:function(aD){var aC,aE=this.footerHeight,aB=aD.queryAll("."+ad);aB.setStyle(aq,"auto");aB.each(function(aF){aC=parseInt(aF.getComputedStyle(aq),10);if(aC>aE){aE=aC;}});this.footerHeight=aE;aB.setStyle(aq,aE+Y);},cacheMainStoryHtml:function(aC){var aB=this.body.getById(this.moduleId+"-main_story");if(aB){this.cache[aC].html=aB.get(D);}},handleChkBoxSubmissionSuccess:function(aB,aC){},handleChkBoxSubmissionFailure:function(aB,aC){},replaceNode:function(aD,aE){var aC,aB;if(aD&&aE){aB=aE.get(e);aC=this.body.create(aD);aE.setStyle("display","none");aB.insertBefore(aC,aE);aB.removeChild(aE);}},startAutoPlay:function(){if(this.animMode!=j&&!this.autoPlayReference&&!this.isVideoPlaying()&&!this.isOtherModuleOpen&&!this.isManuallyPaused){var aB=this.animIntervalInitial,aC=this.animIntervalSubsequent;if(this.isInitialAnim){if(aB>0){this.autoPlayReference=this.Y.later(aB*1000,this,this.autoPlay,ac,S);}}else{if(aC>0){this.autoPlayReference=this.Y.later(aC*1000,this,this.autoPlay,ac,S);}}}},autoPlay:function(){var aF=this.lastSelectedFooter,aH=aF.next(),aG=this.animMode,aJ=this.carousel,aD,aE=aJ.getCurrentIndex(),aB=aE+1,aI,aC=this.timeoutPaneCount;if(this.hasAdRunning()){this.cancelAutoPlay();this.startAutoPlay();return;}if(aH){aD=aH;this.populateStory({linkNode:aD,userHover:y});if(!aH.next()&&(aG==aw||aG==p)){aI=this.body.getById(this.moduleId+Z+aB);if(aI&&aI.hasClass(L)){this.preload(aB,y);}}}else{if(aG==J){aD=aJ.getItemNode(aE).query("."+ad);this.populateStory({linkNode:aD,userHover:y});}if(aG==aw||aG==p){if(this.arcadeTransport.isRequestPending(this.populateScrollItemRequestId)){this.arcadeTransport.abortRequest(this.populateScrollItemRequestId);if(aC>0&&this.preloadPaneCount!=aC){this.preloadPaneCount=aC;this.preload(aB,S,{isTimeout:1});}}else{this.next();}}}if(this.isInitialAnim){this.isInitialAnim=y;this.cancelAutoPlay();this.startAutoPlay();}},cancelAutoPlay:function(aC){var aB=this.autoPlayReference;if(aB){aB.cancel();this.autoPlayReference=ac;}if(this.isInitialAnim){this.isInitialAnim=y;}if(aC){this.tracking(this.lastSelectedFooter);}},delayedStartOrCancelAutoPlay:function(aC,aD){var aB=this.delayAutoPlayMouseover;if(aB){aB.cancel();this.delayAutoPlayMouseover=ac;}this.delayAutoPlayMouseover=this.Y.later(this.timeDelayed,this,aC,aD);},handleEngagingAreaMouseover:function(aD){var aC=this.titleRegion,aB=aD.pageX,aE=aD.pageY;if(aC&&aC.top<aE&&aC.right>aB&&aC.bottom>aE&&aC.left<aB){this.delayedStartOrCancelAutoPlay(this.startAutoPlay,y);}else{this.delayedStartOrCancelAutoPlay(this.cancelAutoPlay,S);}},handleEngagingAreaMouseout:function(aB){this.delayedStartOrCancelAutoPlay(this.startAutoPlay);},attachEngagingAreaMouseEvents:function(){var aB=this.carouselOuterContainer,aC=this.mainStory;aB.on(T,this.handleEngagingAreaMouseover,this);aB.on(V,this.handleEngagingAreaMouseout,this);aC.on(T,this.handleEngagingAreaMouseover,this);aC.on(V,this.handleEngagingAreaMouseout,this);},detachEngagingAreaMouseEvents:function(){var aB=this.carouselOuterContainer,aC=this.mainStory;aC.detach(T,this.handleEngagingAreaMouseover);aC.detach(V,this.handleEngagingAreaMouseout);aB.detach(T,this.handleEngagingAreaMouseover);aB.detach(V,this.handleEngagingAreaMouseout);},handleBlur:function(){if(this.Y.UA.ie){this.activeElement=document.activeElement;}this.cancelAutoPlay(y);this.detachEngagingAreaMouseEvents();},handleFocus:function(){if(!this.Y.UA.ie||this.activeElement==document.activeElement){this.startAutoPlay();this.attachEngagingAreaMouseEvents();}},isVideoPlaying:function(){if(this.inlineVideoEnabled&&this.videoPlayer){return this.videoPlayer.playing;}return y;},insertPlayPauseButton:function(){var aD=this.body.query(".navigation .next"),aC=this.moduleapi,aB=this.animHtml;this.animPlayBeacon=aC.getContextData("animPlayBeacon");this.animPauseBeacon=aC.getContextData("animPauseBeacon");this.animPlayString=aC.getContextData("animPlay");this.animPauseString=aC.getContextData("animPause");if(aD){aD.get(e).insertBefore(aB,aD);}},handleManualPlayPauseAutoPlay:function(aF,aD){var aH=ac,aC=this.statemgr,aE,aG=(aD.get("tagName")=="A")?aD:aD.ancestor("A"),aB=aG.one(".ti");if(aF==af){this.isManuallyPaused=y;aE=z;aG.replaceClass(af,l);aG.setAttribute(G,this.animPauseBeacon);aB.set(D,this.animPauseString);aH=this.startAutoPlay;}else{if(aF==l){this.isManuallyPaused=S;aE=ag;aG.replaceClass(l,af);aG.setAttribute(G,this.animPlayBeacon);aB.set(D,this.animPlayString);aH=this.cancelAutoPlay;}}if(aH&&aC){aC.setUserModuleState(az,aE);}return aH;},broadcastEvent:function(){this.moduleapi.broadcast(q);},setFPCKCookie:function(aC){var aB={type:"module",moduleId:this.moduleId,args:{_action:"show",_subAction:b,storyId:aC}},aD={scope:this};if(true){return;}this.arcadeTransport.makeRequest(aB,aD,this.moduleId);},hasAdRunning:function(){return(document.documentElement.className.indexOf("ad-running")>-1);},handleResize:function(){this.carousel.resetPositioning();}};})();/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */
(function(){var h="tooltip",a="mouseover",n="mouseout",c="focus",j="blur",b="hover",e="td-ofl-rm",g="td-ofl-ctrl",f="remove",d=".type_offlead",k=".offlead-drawer-login",l=".voh-parent-wrapper",i=".offlead-wrapper",m="data-pkg-id";YModules.type_offlead={body:null,editBody:null,id:"",moduleapi:null,viewevents:["click"],tooltip:null,listeners:[],userinfo:null,statemgr:null,wrapperContent:null,removeTimer:null,removeEnabled:false,actionDrawer:null,instrumentation:null,init:function(o){this.Y=o.getService("yui");this.id=o.getId();this.moduleapi=o;this.loginService=o.getService("login");this.userinfo=o.getService("userinfo");this.statemgr=o.getService("statemgr");this.instrumentation=o.getService("instrumentation");this.userState=this.userinfo.isLoggedIn();if(this.loginService&&!this.userState){this.loginWrapperItem=this.Y.Node.create(this.moduleapi.getContextData("drawer.login.html"));this.loginService.getButtons(this.loginWrapperItem,{sec:e,layout:"horizontal",title:"",narrow:1});this.loginService.configClick({selector:k+" a",clickHandler:this.Y.bind(this.onLoginBtnClick,this)});}},onviewload:function(s){var r=this.moduleapi,q="t",p="c";this.body=r.getViewNode(s);this.actionDrawer=this.body.one(".offlead-drawer");if(this.body.one(l)){this.removeEnabled=true;}if(this.removeEnabled){this.actionDrawer.append(this.loginWrapperItem);try{if(this.moduleapi.getContextData("offlead.position")==1){p="b";q="b";}this.tooltip=r.getService("tooltip").create({parentNode:this.body,className:h,position:{box:q,arrow:p}});this.tooltip.getNode().addClass("fz-xxs");this.listeners.push(this.body.delegate([a,c],this.onShowTooltip,".side-button",this));this.listeners.push(this.body.delegate([n,j],this.onHideTooltip,".side-button",this));}catch(o){}}},onviewunload:function(o){if(o==="default"){this.body=null;}else{if(o==="edit"){this.editBody=null;}}},onviewevent:function(q,p){var o=p.target;this.instrument(o);if(this.removeEnabled){if(o.hasClass("side-button")){if(o.hasClass("close")){this.handleCloseBtn(p);}}}},onShowTooltip:function(o){var p=this.moduleapi,r,q=o.target;r=this.body.hasClass(f)?p.getString("STR.TOOLTIP.UNDO"):p.getString("STR.INTERESTS.REMOVE");if(r){this.tooltip.show(q,{msg:r});}},onHideTooltip:function(o){this.tooltip.hide();},handleCloseBtn:function(o){var r=this.body.one(".voh-parent"),q=this.userinfo.isLoggedIn(),p=this.getPkgId();if(!this.body.hasClass(f)){if(!q){this.statemgr.setUserModuleState("loggedOutRemove",p);this.showLoginBtns();}else{this.removeOfflead();}this.body.addClass(f);r.addClass(b);}else{if(!q){this.actionDrawer.transition({height:"0px",duration:0.3,easing:"ease-out"},this.Y.bind(function(){this.actionDrawer.addClass("d-n");this.body.removeClass("drawer-open");},this));this.statemgr.removeUserModuleState("loggedOutRemove");}else{this.undoRemoveOfflead();}this.body.removeClass(f);r.removeClass(b);}this.onShowTooltip(o);},getPkgId:function(){return this.body.one(l).getAttribute(m);},removeOfflead:function(){var o=this.body.one(i),p=this.getPkgId();if(!this.wrapperContent){this.wrapperContent=o.getContent();}o.setContent(this.moduleapi.getString("STR.ITEM_REMOVED"));if(!this.removeTimer){this.statemgr.saveUserSetting("ol_pkg",p,this.moduleapi);this.removeTimer=setTimeout(this.Y.bind(function(){o.transition({height:"0px",duration:0.3,easing:"ease-out"},this.Y.bind(function(){this.body.addClass("d-n");},this));},this),4000);}},undoRemoveOfflead:function(){var o=this.body.one(i);this.statemgr.saveUserSetting("ol_pkg","0",this.moduleapi);o.setContent(this.wrapperContent);clearTimeout(this.removeTimer);},showLoginBtns:function(){var p=this.actionDrawer.one(".embed"),o,q;this.body.addClass("drawer-open");this.actionDrawer.removeClass("d-n");if(!this.actionDrawer.one(".title")){q=this.Y.Node.create(this.moduleapi.getContextData("drawer.title.html"));p.prepend(q);}o=p.get("offsetHeight");this.actionDrawer.transition({height:o+"px",duration:0.3,easing:"ease-in"},function(){});},instrument:function(p){var o={};if(p.ancestor(".ylogin",true,d)){o.sec=e;o.slk="login-yh";o.itc=0;}else{if(p.ancestor(".fblogin",true,d)){o.sec=e;o.slk="login-fb";o.itc=1;}else{if(p.ancestor(".close",true,d)){if(p.ancestor(".drawer-open",true,d)){o.sec=g;o.slk="undo";o.itc=1;o.g="id-"+this.getPkgId();o.ltxt=this.moduleapi.getContextData("offlead.ltxt");o.pkgt=this.moduleapi.getContextData("offlead.pkgt");}else{o.sec=g;o.slk="rm";o.itc=1;o.g="id-"+this.getPkgId();o.ltxt=this.moduleapi.getContextData("offlead.ltxt");o.pkgt=this.moduleapi.getContextData("offlead.pkgt");}}}}if(o.sec){this.instrumentation.fireBeacon(o);}}};}());/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */
YUI.add("storage_service",function(d){var i="MPServices",e="StorageProvider",f=true,h=false,g=null,a={},b={},j=g;function c(k){this._moduleId=k;this.onReady(function(){this.ready=f;},this);}c.prototype={_moduleId:g,ready:h,onReady:function(l,k){d.StorageLite.on("storage-lite:ready",function(){l.call(k);});},getItem:function(k){var l;try{l=b[k]||d.StorageLite.getItem(k,f);}catch(m){j.logError(this._moduleId,m.message);}finally{if(l&&d.Object.owns(l,"$v")&&(!l.$e||l.$e>+(new Date()))){b[k]=l;return l.$v;}delete b[k];return g;}},setItem:function(l,p,k){var m;try{m={$v:p,$e:k?+(new Date())+k:0};d.StorageLite.setItem(l,m,f);b[l]=m;return f;}catch(o){if(/QUOTA_EXCEEDED_ERR/.test(o.message)){try{d.StorageLite.removeItem(l);d.StorageLite.setItem(l,m,f);b[l]=m;return f;}catch(n){j.logError(this._moduleId,n.message);}}else{j.logError(this._moduleId,o.message);}return h;}},removeItem:function(k){try{delete b[k];d.StorageLite.removeItem(k);return f;}catch(l){j.logError(this._moduleId,l.message);return h;}},getSet:function(k,n){var p=this.getItem(k),m=+(new Date()),o=h,l={};d.Object.each(p,function(r,q){if(d.Object.owns(r,"$v")&&(!r.$e||r.$e>m)){l[q]=r.$v;}else{o|=delete p[q];}});if(o){this.setItem(k,p);}return n?d.Object.keys(l):l;},addToSet:function(l,m,n,k){var o=this.getItem(l)||{};o[m]={$v:n,$e:k?+(new Date())+k:0};return this.setItem(l,o);},removeFromSet:function(k,l){var m=this.getItem(k);if(m&&d.Object.owns(m,l)){delete m[l];return this.setItem(k,m);}return h;}};d.namespace(i)[e]={name:"storage",getService:function(l,k){if(!j){j=l.getService("metrologger");}if(!a[k]){a[k]=new c(k);}return a[k];}};if(d.ModulePlatform){d.ModulePlatform.registerService(d[i][e]);}},"0.0.1",{requires:["gallery-storage-lite","metrologger"]});/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */
(function(){var i=null,m=false,h=true,d=null,c=30*60*1000,j="stream:filter",o="stream:dynamic",e="stream:loadsuccess",a="stream_filter",g="recent_filters",b="filter-selected",l="transform",f="mouseover",n="mouseout",k=".static-list, .dynamic-list, .recent-list";YModules.type_fstream={body:null,editBody:null,id:"",moduleapi:null,platform:i,autoHideEnabled:false,autoHideService:i,swiperService:i,lastSwipeOffset:0,autoHideId:i,viewevents:["click"],init:function(r){this.Y=r.getService("yui");this.id=r.getId();this.moduleapi=r;this.platform=r.getService("moduleplatform");this.instrumentation=r.getService("instrumentation");this.statemgr=r.getService("statemgr");this.storage=r.getService("storage");this.loginService=r.getService("login");this.swiperService=r.getService("swiper");this.listeners=[];d=this.Y.config.win;var q=r.getContextData(),p=r.getService("userinfo");this.filterRestoreEnabled=q.filterRestoreEnabled;this.filterFontSize=q.filterFontSize;this.dropdownFilter=q.dropdownFilter;this.tabFilter=q.tabFilter;this.dropdownHover=q.dropdownHover;this.dynamicMax=q.dynamicMax;this.autoHideEnabled=q.autoHideEnabled;this.saveEnabled=q.saveEnabled;this.swipeFilterEnabled=q.swipeFilterEnabled;this.loginState=p.isLoggedIn();if(this.autoHideEnabled){this.autoHideService=r.getService("autohide");}this.recentFiltersEnabled=q.recentFiltersEnabled;if(this.saveEnabled&&this.loginService){this.quickTimer=i;this.loginWrapperItem=this.Y.Node.create("<span></span>");this.loginService.getButtons(this.loginWrapperItem,{sec:"fltr-strm-sv",layout:"vertical",title:this.moduleapi.getString("STR.FILTERS.SAVEDLOGIN"),narrow:1});}r.listen(j);r.listen(o);r.listen(e);},onviewload:function(u){var s=this.moduleapi,q,p=this.Y.one("#banner"),t,r;if(p){this.headerHeight=p.get("clientHeight");}if(u==="default"){this.body=s.getViewNode(u);}else{if(u==="edit"){this.editBody=s.getViewNode(u);}}if(this.body.one(".dropdown-label")){if(!this.dropdownFilter&&this.dropdownHover){this.listeners.push(this.body.delegate(f,this.onShowFilterMenu,".dropdown-label-text, .list-container, .drop-arrow",this));this.listeners.push(this.body.delegate(n,this.onHideFilterMenu,".dropdown-label-text, .list-container, .drop-arrow",this));}}if(this.swipeFilterEnabled){r=d.hasOwnProperty("onorientationchange")?"orientationchange":"resize";this.listContainer=this.body.one(".list-container");t=this.Y.bind(this.swipeActionHandler,this);this.swiper=new this.swiperService({body:this.listContainer,slides:1,completeHandler:t,actionEndHandler:t,transitionEnd:h,slideHandler:t,invalid_swipe_range:80});this.swiper.swipeMinDistance=0;this.Y.on(r,this.onOrientationChange,d,this);this.rotationDelay=this.Y.UA.android?250:0;}this.storage.onReady(function(){if(this.filterRestoreEnabled){this.savedFilters=this.storage.getItem(a);if(this.savedFilters&&this.savedFilters.loginState===this.loginState){s.unlisten(o);this.buildDynamicCategories(this.savedFilters.list,m);this.platform.on("ready",function(){s.broadcast(o,{dynamicCategories:this.savedFilters.list});},this);}else{this.statemgr.removeUserModuleState(a);this.savedFilters=i;}}q=this.body.one(".filter-selected");if(this.tabFilter&&q){if(this.Y.one(".type_login .wrap")){q.addClass("filter-signedOut");}else{q.removeClass("filter-signedOut");}}if(this.recentFiltersEnabled&&m===this.loginState){var v=this.storage.getItem(g);if(v){this.buildRecentFilters(v);}}},this);},onviewunload:function(p){if(p==="default"){this.body=i;}else{if(p==="edit"){this.editBody=i;}}},onmessage:function(s,p,r){var q;if(p=="stream"){if(r){if(s===j){this.checkFilterState(r.category,r.name);}else{if((s===o)){this.moduleapi.unlisten(o);this.buildDynamicCategories(r.dynamicCategories,h);}}}if((s===j)||(s===e)){q=this.body.one(".filter-selected");if(q&&this.Y.one(".type_login .wrap")){q.addClass("filter-signedOut");}}}},onviewevent:function(r,p){var q=this.Y;if(r==="default"){if(p.type==="click"){p.preventDefault();this.onClick(p.target);}else{}}},buildDynamicCategories:function(t,r){var p=this.body.one(".recommended-label"),q=(this.tabFilter)?"fltr-strm-menu":"fltr-strm",u={ftype:"dynamic",sec:q,ft:2,fontSize:this.filterFontSize},s=0;s=this._buildFilters(t,".dynamic-list .filter-list",this.dynamicMax,u);if(s>0&&p){p.removeClass("dn");}if(r&&this.filterRestoreEnabled){this.savedFilters={list:t,loginState:this.loginState};if(!this.storage.setItem(a,this.savedFilters,c)){this.savedFilters=i;}}if(this.swipeFilterEnabled){this.calculateHorizontalFilterWidths();}},buildRecentFilters:function(r){var t={ftype:"recent",sec:"gs-fltr-mu",ft:4},s=this.body.one(".recent-list"),q=0,p=8;q=this._buildFilters(r,s.one(".filter-list"),p,t);if(q>0){s.removeClass("dn");}},_buildFilters:function(r,w,v,q){var p=this.Y,t=this.body,u=(typeof w==="string")?t.one(w):w,s="",x=[];if(q.fontSize){s=" "+q.fontSize;}p.Array.each(r,function(y,z){if(z<v){x.push('<li class="filter-item" data-filter="'+y.id+'" data-ftype="'+q.ftype+'"><a href="javascript:void(0);" data-ylk="sec:'+q.sec+";slk:"+y.name+";ft:"+q.ft+";cpos:"+(z+1)+';pos:0;" data-action-outcome="filter" class="filter-name rapidnofollow'+s+'" role="button">'+y.name+"</a></li>");}});if(x.length>0){u.append(x.join(""));this.instrumentation.refreshModule(t);}return x.length;},setSavedFilter:function(t){var s=this.body.one('[data-filter="'+t+'"]'),q=this.body.one('span[data-filter="'+t+'"]'),r=this.body.one(".dropdown-label-text"),p;if(s&&s.getAttribute("data-api")){return;}if(s&&t!=="YPROP:SAVE"){this.body.all("."+b).removeClass(b);p=s.one("a").getContent();s.addClass(b);if(q){q.addClass(b);}if(this.tabFilter&&s.ancestor(".filter-list")){this.fillTabs(s);}if(r&&!this.tabFilter){r.setContent(p);}if(this.swipeFilterEnabled&&(this.filter_page_width<(s.getX()+s.get("offsetWidth")+this.sflContainerWidth))){this.lastSwipeOffset=-Math.floor(s.getX());if(this.lastSwipeOffset<-this.finalSwipeOffset){this.lastSwipeOffset=-this.finalSwipeOffset;}this.listContainer.setStyle(l,"translateX("+this.lastSwipeOffset+"px)");}}},fillTabs:function(t){var q=this.body.one(".tab-list"),p=q.get("lastChild"),r=this.body.one(".dynamic-list"),s=r.one(".recommended-label"),z,x,u,y,w,v;u=p.getAttribute("data-filter");y=p.getContent();w=p.getAttribute("data-ftype");v=p.getAttribute("data-api");p.setAttribute("data-filter",t.getAttribute("data-filter"));p.setContent(t.getContent());p.setAttribute("data-ftype",t.getAttribute("data-ftype"));p.setAttribute("data-api",t.getAttribute("data-api"));t.setAttribute("data-filter",u);t.setContent(y);t.setAttribute("data-ftype",w);t.setAttribute("data-api",v);z=((w==="dynamic")||(w==="stream"))?this.body.one(".dynamic-list"):this.body.one(".static-list");z.one(".filter-list").prepend(t);p.one("a").replaceClass("fz-xs","fz-s");t.one("a").replaceClass("fz-s","fz-xs");q.setStyle("overflow","visible");this.Y.later(0,this,function(){q.setStyle("overflow","");});x=z.one(".filter-list");if(x&&x.get("children").size()>this.dynamicMax){x.get("lastChild").remove();if(this.savedFilters){this.savedFilters.list.pop();if(!this.storage.setItem(a,this.savedFilters,c)){this.savedFilters=i;}}}s.toggleClass("dn",r.all(".filter-list>*").size()===0);t.removeClass(b);p.addClass(b);p.one("A").focus();this.instrumentation.refreshModule(this.body);},addNewFilter:function(t,r){var v=this.Y,q,p=this.body.one(".dynamic-list"),s=p.one("UL"),u=+(new Date())+c;q='<li class="filter-item" data-filter="'+t+'" data-ftype="stream"><a href="#" data-ylk="sec:fltr-strm;slk:'+r+';cpos:5;pos:0;ft:3" data-action-outcome="filter" class="filter-name rapidnofollow '+this.filterFontSize+'" role="button">'+r+"</a></li>";if(s){s.append(q);this.body.all("."+b).removeClass(b);if(this.savedFilters){this.savedFilters.list.unshift({id:t,name:r});this.setCurFilterData(t,u);}this.fillTabs(v.one('.type_fstream .dynamic-list [data-filter="'+t+'"]'));}},checkFilterState:function(r,p){var s=this.body.one("."+b),q=this.body.one('[data-filter="'+r+'"]'),t=+(new Date())+c;if(!q){if(!p){this.Y.later(0,this,function(){this.moduleapi.broadcast(j,{category:""});this.setSavedFilter("");});}else{this.addNewFilter(r,p);}}else{if(s!==q){if(this.savedFilters){this.setCurFilterData(r,t);}this.setSavedFilter(r);}else{if(this.tabFilter&&s&&s.ancestor(".list-container")){this.setSavedFilter(r);}}}},setCurFilterData:function(p,q){this.savedFilters.loginState=this.loginState;if(this.storage.setItem(a,this.savedFilters,c)){this.statemgr.setUserModuleState(a,p+"::"+q);}else{this.savedFilters=i;}},onClick:function(G){var q=this.Y,z=this.body,s=z.one(".dropdown-label-text"),B=z.one(".list-container"),A=G,u,t,p,y,F,E,x,C=+(new Date())+c,D,w,v,r;u=this.body.all("."+b);if((this.dropdownFilter||!this.dropdownHover)&&!this.swipeFilterEnabled&&!A.ancestor(".list-container,.save-for-later,.save-container",h)){if(B.hasClass("list-container-reveal")){this.onHideFilterMenu();}else{this.onShowFilterMenu();}return;}if(G.getAttribute("aria-haspopup")=="true"){this.onShowFilterMenu();D=this.Y.one("body").on("focus",function(H){if(!B.contains(H.target)){this.onHideFilterMenu();D.detach();}},this);return;}A=A.ancestor(".filter-item",h);if(A&&(u.indexOf(A)===-1)){p=A.getAttribute("data-filter");x=A.getAttribute("data-ftype");if(u){u.removeClass(b);}w=this.body.one('[data-filter="'+p+'"]');w.addClass(b);y=A.one("a").getContent();F=A.ancestor(".static-list")?"filter-s":(A.ancestor(".dynamic-list")?"filter-d":"filter-yml");if(this.tabFilter){F=(x==="dynamic")?"filter-d":(x==="stream")?"filter-i":"filter-s";}E=A.ancestor(k)?B.all("li"):this.body.all(".tab-list li");if((x==="dynamic")||(this.tabFilter)){t={sec:!A.ancestor(".list-container")?"fltr-strm":"fltr-strm-menu",slk:F,ltxt:y,cpos:E?E.indexOf(A)+1:"",pos:0,itc:1};this.instrumentation.fireBeacon(t);}if(s&&G.ancestor(".list-container")){this.onHideFilterMenu();if(!this.tabFilter){s.setContent(y);}}if(this.savedFilters){this.setCurFilterData(p,C);}this.moduleapi.broadcast(j,{category:p,api:A.getAttribute("data-api")});if(this.tabFilter&&A.ancestor(k)){this.fillTabs(A);}if(this.swipeFilterEnabled){r=A.getX();v=r+A.get("offsetWidth")+this.sflContainerWidth;if(this.filter_page_width<v){v+=this.dropdownFilter?20:0;this.lastSwipeOffset+=Math.floor(this.filter_page_width-v);this.listContainer.setStyle(l,"translateX("+this.lastSwipeOffset+"px)");}else{if(r<0){this.lastSwipeOffset-=Math.floor(r);this.listContainer.setStyle(l,"translateX("+this.lastSwipeOffset+"px)");}}}}else{if(A&&(u.indexOf(A)!==-1)){if(s){this.onHideFilterMenu();}}else{if(G.ancestor(".save-container",h)){this.handleSaveFilter(G);}}}},onShowFilterMenu:function(){var p=this.body,v=p.one(".list-container"),q=p.one(".dropdown-label-text"),t=p.one(".dropdown-label"),r=p.one(".drop-arrow"),u=this.Y,s=this.autoHideService;if(v){if(this.hoverBeacon){this.hoverBeacon.cancel();}if(!this.tabFilter){this.instrumentation.fireBeacon({sec:"fltr-strm",slk:"menu-open",itc:1,action:"click"});}if(this.dropdownFilter){d.scrollTo(0,t.getY()-this.headerHeight);this.curSelectedText=q.getContent();q.setContent(this.moduleapi.getString("STR.FILTERS.FILTERBY"));v.removeClass("list-container-animate");}v.addClass("list-container-reveal");v.setAttribute("aria-hidden",false);}if(r){t.addClass("dropdown-label-hover");r.addClass("drop-arrow-hover");}if(v.hasClass("list-container-reveal")&&s){this.autoHideId=s.register({targets:[p],hide:u.bind(this.onHideFilterMenu,this)});}},onHideFilterMenu:function(){var t=this.body.one(".list-container"),p=this.body.one(".dropdown-label-text"),s=this.body.one(".dropdown-label"),r=this.body.one(".drop-arrow"),q=this.autoHideId;if(t){if(this.tabFilter){this.hoverBeacon=this.Y.later(500,this,function(){this.instrumentation.fireBeacon({sec:"fltr-strm",slk:"menu",itc:2,action:"hover"});});}else{this.instrumentation.fireBeacon({sec:"fltr-strm",slk:"menu-close",itc:1,action:"click"});}if(this.dropdownFilter){p.setContent(this.curSelectedText);t.addClass("list-container-animate");}t.removeClass("list-container-reveal");t.setAttribute("aria-hidden",true);}if(r){s.removeClass("dropdown-label-hover");r.removeClass("drop-arrow-hover");}if(i!==q){this.autoHideService.unregister(q);this.autoHideId=i;}},handleSaveFilter:function(s){var r=s.ancestor(".save-container",h),t=this.body.one("."+b),q=r.getAttribute("data-filter"),p=this.body.one(".dropdown-label-text");r.removeClass("saved-stories");if(!r.hasClass(b)){if(t){t.removeClass(b);}r.addClass(b);this.moduleapi.broadcast(j,{category:q});this.instrumentation.fireBeacon({sec:"fltr-strm",slk:"filter-s",ltxt:"save",itc:1});if(!this.tabFilter&&!this.swipeFilterEnabled){if(this.dropdownFilter){this.curSelectedText=this.moduleapi.getString("STR.FILTERS.FILTERSAVED");this.onHideFilterMenu();}else{p.setContent(this.moduleapi.getString("STR.FILTERS.FILTERSAVED"));}}}},swipeActionHandler:function(p){var r,q=0,t=8,s;switch(p.type){case"slide":if(p.delta.ax>20){this.listContainer.removeClass("fast-animate");r=p.delta.x+this.lastSwipeOffset;this.listContainer.setStyle(l,"translateX("+r+"px)");}s+=1;break;case"swipeEnd":this.lastSwipeOffset+=p.delta.x;if(p.delta.ax>0){q=Math.floor(p.delta.ax/s);}if(q>1){if(p.delta.x<0){this.lastSwipeOffset-=(q*t);}else{this.lastSwipeOffset+=(q*t);}}if(this.lastSwipeOffset>0){this.lastSwipeOffset=0;this.fireSwipeBeacon();}else{if(Math.abs(this.lastSwipeOffset)>this.finalSwipeOffset){this.lastSwipeOffset=-(this.finalSwipeOffset);this.fireSwipeBeacon();}}this.lastSwipeOffset=Math.floor(this.lastSwipeOffset);this.listContainer.setStyle(l,"translateX("+this.lastSwipeOffset+"px)");this.listContainer.addClass("fast-animate");s=1;break;case"complete":this.listContainer.removeClass("fast-animate");break;}},calculateHorizontalFilterWidths:function(){var q=this.listContainer.ancestor(),p=this.body.one(".save-container");this.filter_page_width=q.get("offsetWidth");this.scrollerWidth=this.listContainer.get("offsetWidth");this.sflContainerWidth=p?p.get("offsetWidth"):0;this.scrollerWidth+=this.sflContainerWidth;this.finalSwipeOffset=Math.floor(this.scrollerWidth-this.filter_page_width);},onOrientationChange:function(p){this.Y.later(this.rotationDelay,this,function(){this.calculateHorizontalFilterWidths();if(this.lastSwipeOffset<-this.finalSwipeOffset){this.lastSwipeOffset=-this.finalSwipeOffset;this.listContainer.setStyle(l,"translateX("+this.lastSwipeOffset+"px)");}});},fireSwipeBeacon:function(){this.instrumentation.fireBeacon({sec:"fltr-strm",slk:"swipe",itc:3,action:"hswipe"});}};}());/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */
(function(){var ag=null,s=false,N=true,T=ag,b=ag,aq=ag,w,al=ag,ah=1000/60,aM=2*24*60*60*1000,f=20,aA="click",O="mouseover",S="mouseout",ai="focus",at="blur",aB="ul",r="li",aK="> "+aB+":last-of-type",j="hover",aT="newcontent",I="lastnew",aD="more",au="fetch_uuids",aS="content_by_uuid",aw="stream:click",P="stream:dynamic",Q="stream:filter",B="stream:refresh",i="location:update",L="stream:loadsuccess",d="stream:new_content",U="stream:entities",H="stream:filters",D="y-tooltip-stream",aP=D+"-1",aN=D+"-2",aL=D+"-3",ab="hidden",V="dn",aU="remove",ar="label",aO="value",n="disabled",h="checked",A="offsetHeight",aJ="offsetWidth",aF="height",C="width",G="data-ka",E="data-kb",ak=r+".rmx-ad",F=r+".stream-ad,"+ak,Z=ak+" .adlink",e=ak+" .adv",ap=ak+" .sp",l=Z+","+e+","+ap,m="data-uuid",an=r+".content",ay="highline",u="data-reason",aR="data-wikiid",c="data-wikiids",aE="next-batch",ae="."+aE,ad="endfilters",J="."+ad,av=".historystate",y=">H2,>UL,>.loading,>.grp-more,>.type_login,>.strm-error-msg",x="li.cavideo h3 a,li.slideshow h3 a",af="hovertitle",ao="YPROP:LOCAL",p="YPROP:SOCIAL",ac="YPROP:SAVE",v="YCUSTOM:MYTEAMS",aQ="fblogin",g="ylogin",aj="streamLoginType",t="reveal",a=0,M=0,aH=".action-drawer-button-wrapper",az="saved",am="liked",z="disliked",ax="drawer-open",R="p_30345831",aC="pos-feedback",X="neg-feedback",q="hilite",k=an+"."+q,K="request-manager",W="streamReadList",aa="streamClosedList",aI="streamEntityFeedbackList",o="streamState",aG="data-rmx-beacon";YModules.type_stream={body:ag,list:ag,lastScrollCheck:0,scrollThrottle:40,scrollBuffer:50,id:"",moduleapi:ag,platform:ag,viewevents:[aA],instrumentation:ag,batchCount:1,pollBatchCount:0,batchSize:0,clientPagination:ag,items:ag,woeId:ag,intl:ag,ccode:ag,filter:ag,itemRemovalTimer:ag,currentRemovalMenu:ag,pendingNewItems:[],shareDrawer:ag,swipeMenu:ag,yepService:ag,yepPlayer:ag,evtStreamEntities:ag,isRmp:s,nativeAds:[],locationPickerEnabled:false,locationService:null,locationInstance:null,init:function(aW){T=aW.getService("yui");b=T.config.win;aq=T.config.doc;try{al=!!(b.history&&b.history.replaceState&&b.history.state!==w);}catch(aV){al=s;}var Y=aW.getContextData();this.moduleapi=aW;this.id=aW.getId();this.platform=aW.getService("moduleplatform");this.transportHelperService=aW.getService("transport_helper");this.listeners=[];this.customEvents=[];this.instrumentation=aW.getService("instrumentation");this.storage=aW.getService("storage");this.statemgr=aW.getService("statemgr");this.saveForLaterService=aW.getService("saveforlater");this.highlineService=aW.getService("stream_highline");this.userinfo=aW.getService("userinfo");this.loginService=aW.getService("login");this.interestsService=aW.getService("interests");this.batchSize=Y.batchSize||20;this.woeId=Y.woeId;this.intl=Y.intl;this.ccode=Y.ccode||"";this.listId=Y.listId||"";this.blogType=Y.blogType||"";this.items=Y.items||[];this.clientPagination=Y.clientPagination;this.filter={category:Y.filter||"",name:Y.catName||""};this.contentpos=Y.contentpos;this.dynamicEnabled=Y.dynamicEnabled;this.removalMenuEnabled=Y.removalMenuEnabled;this.pollForNewBroadcastEnabled=Y.pollForNewBroadcastEnabled;this.pollForNewFrequency=Y.pollForNewFrequency;this.pollForNewAutoInsert=Y.pollForNewAutoInsert;this.pollForNewPauseOnIdle=Y.pollForNewPauseOnIdle;this.userIdleAfter=Y.userIdleAfter;this.newCountInTitleEnabled=Y.newCountInTitleEnabled;this.pendingNewItems=Y.pendingNewItems||[];this.restoreStateExpire=Y.restoreStateExpire;this.restoreStateMethod=Y.restoreStateMethod;this.restoreStateOnCacheMiss=Y.restoreStateOnCacheMiss;this.batchPause=Y.batchPause;this.endFiltersEnabled=Y.endFiltersEnabled;this.endFiltersCount=Y.endFiltersCount;this.allStoriesSectionView=Y.allStoriesSectionView;this.allStoriesSectionData=Y.allStoriesSectionData;this.highlightActive=Y.highlightActive;this.highlightActiveBroadcastScroll=Y.highlightActiveBroadcastScroll;this.itemClickBroadcastOnly=Y.itemClickBroadcastOnly;this.itemClickContext=Y.itemClickContext;this.markAsReadEnabled=Y.markAsReadEnabled;this.closeEnabled=Y.closeEnabled;this.fbAcctLinked=Y.fbAcctLinked;this.tooltipsEnabled=Y.tooltipsEnabled;this.interestFiltersEnabled=Y.interestFiltersEnabled;this.interestFiltersBroadcast=Y.interestFiltersBroadcast;this.broadcastDynamicEnabled=Y.broadcastDynamicEnabled;this.sortBy=Y.sortBy;this.isRmp=Y.isRmp;this.minArticleCount=Y.minArticleCount;this.saveEnabled=Y.saveEnabled;this.inlineLightboxEnabled=Y.inlineLightboxEnabled;this.actionDrawerEnabled=Y.actionDrawerEnabled;this.actionDrawerButtonsEnabled=Y.actionDrawerButtonsEnabled;this.writeMixerActions=Y.writeMixerActions;this.readMixerActions=Y.readMixerActions;if(this.interestsService&&Y.interestsData){this.interestsService.set(Y.interestsData);}T.Node.DOM_EVENTS.mouseenter=1;T.Node.DOM_EVENTS.mouseleave=1;T.Node.DOM_EVENTS.touchend=1;T.Node.DOM_EVENTS.pageshow=1;aW.listen(Q);aW.listen(P);aW.listen(B);this.platform.subscribe(i,this.handleLocationUpdate,this);T.on("pageshow",function(aX){this.markRead();},b,this);this.initGlobalListeners();},onviewload:function(aV){if(aV==="default"){var Y=this.moduleapi;this.body=Y.getViewNode(aV);this.rapidContainer=this.body.ancestor(".rapid-container")||this.body;this.isLoading=s;this.locationPickerEnabled=Y.getContextData("locationPickerEnabled");this.setupScroll();if(this.restoreStateExpire){this.restoreState(this.initDefaultView);}else{this.initDefaultView();}}},initDefaultView:function(){if(this.storage){this.storage.onReady(this.setupDefaultView,this);}else{this.setupDefaultView();}},setupDefaultView:function(){var aX=this.moduleapi,aY=aX.getContextData("dynamicCategories"),aW=aX.getContextData("dynamicEntities"),aZ,aV;this.markRead();this.updateDislikedInterests();this.updateControls();if(this.readMixerActions){aV=this.getUuids();if(aV.length){this.makeRequestToGetMixerActions(aV,{success:function(a0){this.markStreamActions(a0.data.mixerActions);},failure:function(a0){},scope:this});}}this.cacheNativeAdData();this.initPagination();this.statemgr.removeUserModuleState("context");if(this.highlightActive){if(this.restored){if(this.activeItemId){aZ=this.getItemByUuid(this.activeItemId);this.highlightItem(aZ);}}else{aZ=this.body.one(k+":not(.dn)");if(aZ){if(this.highlightActiveBroadcastScroll){T.Global.fire("media:scroll-into-view",{node:aZ});}else{this.scrollDomNode.scrollTop=aZ.get("offsetTop")-(this.scrollNodeHeight-aZ.get(A))/2;}}}if(aZ&&this.interestFiltersBroadcast){this.broadcastEntities(aZ);}}if(!aX.getContextData("skipCheckBufferOnload")){T.later(0,this,this.checkScroll);}this.platform.on("ready",function(){if(aY&&T.Lang.isArray(aY)&&aY.length>0){this.moduleapi.broadcast(P,{dynamicCategories:aY});}if(this.broadcastDynamicEnabled){this.broadcastDynamicFilters({dynamicCategories:aY,dynamicWikis:aW});}this.moduleapi.broadcast(Q,T.merge(this.filter,{norefresh:1}));},this);if(this.pollForNewFrequency&&this.body.one(an)){if(!this.pollForNewAutoInsert){this.listeners.push(this.body.delegate(aA,this.onClickNewContentNotice,".newcontentnotice button",this));this.listeners.push(T.on("resize",T.bind(this.positionNewContentNotice,this,N)));}if(this.pollForNewPauseOnIdle&&this.userIdleAfter){this.idleService=aX.getService("idle");if(this.idleService){this.idleService.on("idleChange",this.onIdleChange,this);this.idleService.start(this.userIdleAfter);}}this.scheduleNewContentPoll();if(this.pendingNewItems.length){this.onNewContent();}}if(this.saveForLaterService){this.saveForLaterWidget=new this.saveForLaterService({body:this.body,moduleApi:aX,writeToMixer:this.writeMixerActions,itemSelector:an,saveHandler:T.bind(this.onSaveArticle,this),signedOutSaveHandler:T.bind(this.onSignedOutSaveClick,this)});}if(this.actionDrawerEnabled){this.actionDrawer=aX.getService("stream_action_drawer");if(this.actionDrawer){this.actionDrawer.on("declareFeedback",this.onActionDrawerFeedback,this);this.actionDrawer.on("removeStreamItem",this.removeStreamItem,this);this.actionDrawer.on("deleteSaved",this.deleteSavedFromActionDrawer,this);if(!this.actionDrawerButtonsEnabled){this.actionDrawer.on("drawerToggleStart",this.disableStreamButtons,this);this.actionDrawer.on("drawerToggleComplete",this.enableStreamButtons,this);this.actionDrawer.disableButtons();}}}if(aX.getContextData("shareDrawerEnabled")){this.shareDrawer=aX.getService("share_widget");this.shareDrawer.init({rootNode:this.body,isRmp:this.isRmp});}if(aX.getContextData("swipeEnabled")){this.swipeMenu=aX.getService("stream_swipe_menu");this.swipeMenu.init({rootNode:this.body,swipeEducCount:aX.getContextData("swipeEducCount"),swipeEducMaxViews:aX.getContextData("swipeEducMaxViews"),filter:this.filter,closeEnabled:this.closeEnabled,eventHandlers:{onRemoveTransition:T.bind(this.fancyRemove,this),onRemoveContent:T.bind(this.removeContent,this),onSavedRemove:this.saveForLaterService?T.bind(this.deleteSavedArticle,this):ag}});}if(this.tooltipsEnabled){try{this.tooltip=aX.getService("tooltip").create({parentNode:this.body,className:D,position:{box:"t",arrow:"c"}});this.tooltip.getNode().addClass("fz-xxs");this.listeners.push(this.body.delegate([O,ai],this.onShowTooltip,".label, .profile-img, .more, .side-button",this));this.listeners.push(this.body.delegate([S,at],this.onHideTooltip,".label, .profile-img, .more, .side-button",this));}catch(Y){}}if(aX.getContextData("playIconHoverEnabled")){this.listeners.push(this.body.delegate([O,S],this.onHoverTitle,x,this));}if(this.removalMenuEnabled){this.listeners.push(this.body.delegate(O,this.onMouseOverMenu,".remove",this));this.listeners.push(this.body.delegate(S,this.onMouseOutMenu,".remove",this));}if(this.interestFiltersEnabled){this.listeners.push(this.body.delegate([O,ai],this.onMouseOverLi,".content",this));this.listeners.push(this.body.delegate([S,at],this.onMouseOutLi,".content",this));}if(T.UA.ie&&T.UA.ie<=6){this.listeners.push(this.body.delegate([O,S],this.onHoverContent,"ul .content",this));}this.pruneClosed();if(this.filter.category===ao&&this.locationPickerEnabled===true){this.initLocation();}this.scrollhint=this.getNode(".scrollhint");this.updateScrollHint(N);T.Global.fire("pane-manager:sync-nav-pane-scroll");},onviewunload:function(Y){if(Y==="default"){this.body=ag;if(this.streamLoadReqObj){this.streamLoadReqObj.abort();this.streamLoadReqObj=ag;}T.Array.each(this.listeners,function(aV){aV.detach();});this.listeners=[];T.Array.each(this.customEvents,function(aV){aV.fired=s;});this.customEvents=[];if(this.scrollListener){this.scrollListener.detach();this.scrollListener=ag;}if(this.newContentPoll){this.newContentPoll.cancel();this.newContentPoll=ag;}if(this.tooltip){this.tooltip.destroy();this.tooltip=ag;}if(this.locationPickerEnabled){this.locationService=null;if(this.locationInstance){this.locationInstance.destroy();this.locationInstance=null;}}}},onmessage:function(aX,aV,aW){switch(aX){case Q:if(!aW||!aW.norefresh){this.onFilter(aW);}break;case B:this.onFilter(this.filter);break;case P:this.moduleapi.unlisten(P);this.dynamicCats=aW.dynamicCategories;var Y=this.getNode(J);if(Y){this.handleStreamEnd(Y);}break;default:}},handleLocationUpdate:function(Y){this.woeId=Y.woe;if(this.filter.category===ao){this.onFilter(this.filter);}},onviewevent:function(aV,Y){if(aV==="default"){if(Y.type===aA){this.onClick(Y);}else{}}},initLocation:function(aV){var aX=this.body.one(".loc-picker"),aW=this.moduleapi,Y;if(aX){if(!aX.one(".loc-picker-link")){return false;}if(!this.locationService){this.locationService=aW.getService("location_service");}Y={locDropSettings:{crumb:aW.getContextData("locdrop_crumb"),locale:aW.getContextData("locale"),bestLoc:aW.getContextData("best_loc"),curLoc:aW.getContextData("cur_loc"),defLoc:aW.getContextData("def_loc"),userLoc:this.userCitySelection||aW.getContextData("user_loc"),anchorClass:""},beacon:{sec:aW.getContextData("beacon_sec"),slk:aW.getContextData("beacon_slk"),test:aW.getContextData("beacon_bucketid")}};if(this.locationInstance&&aV){this.locationInstance.destroy();this.locationInstance=null;if(this.locationService){this.locationInstance=this.locationService.create(aX,this.id,aW,Y);}}else{if(!this.locationInstance){if(this.locationService){this.locationInstance=this.locationService.create(aX,this.id,aW,Y);}}}}},loadContent:function(aV,aW,aY){var aX,Y={};if(this.pollRequestObj&&!aV.poll){this.pollRequestObj.abort();this.pollRequestObj=ag;}if(this.filter.category===ao){Y.ups=N;}else{if(this.filter.category===v){Y.udb=N;}}aY=aY||{};aX=this.transportHelperService.makeRequest(T.merge({type:"module",moduleId:this.id,args:T.merge({_action:"show",batch:this.batchCount+1,cat:this.filter.category||"",catName:this.filter.name||"",sb:this.sortBy,sv:this.allStoriesSectionView,ccode:this.ccode,woeid:this.woeId},aV)},Y),{success:aY.success||this.loadContentSuccess,failure:aY.failure||this.loadContentFailure,scope:this,argument:T.merge(aW,{subAction:aV._subAction})});return aX;},loadContentSuccess:function(aZ,aX){var aV=this.getNode(aX.insertNode),aY=this.getNode(aX.removeNode),aW,Y;if(aZ.html){if(aV){aV.insert(aZ.html,aX.insertLoc);this.cacheNativeAdData();}this.pruneClosed();this.markRead();this.instrumentation.refreshModule(this.rapidContainer);}if(aY){aY.remove();}if(aX.subAction===aD){this.isLoading=s;aW=this.moduleapi.getContextData("dynamicCategories");if(aW&&T.Lang.isArray(aW)&&aW.length>0){if(this.filter&&this.filter.category===""){this.platform.on("ready",function(){this.moduleapi.broadcast(P,{dynamicCategories:aW});},this);}}Y=this.moduleapi.getContextData("dynamicEntities");if(aZ.hasOwnProperty("data")){if(aZ.data.hasOwnProperty("contentpos")){this.contentpos=aZ.data.contentpos;}if(aZ.data.comscore==="pageview_candidate"){this.instrumentation.fireComscoreBeacon();}if(aZ.data.hasOwnProperty("items")&&T.Lang.isArray(aZ.data.items)){this.items=this.closeEnabled?this.removeDuplicates(aZ.data.items,this.storage.getSet(aa,N)):aZ.data.items;}if(this.interestsService&&aZ.data.hasOwnProperty("interestsData")){this.interestsService.set(aZ.data.interestsData);}}if(aX.firstBatch&&this.items.length===0){this.fetchContentIds();}}else{if(aX.subAction===aS){this.contentReqDone=N;}}this.batchCount+=1;if((this.filter.category===p)||(aX.firstBatch)){this.moduleapi.broadcast(L,{category:this.filter.category});}this.body.all("a.twitter-follow-button").each(function(a0){b.twttr.widgets.load(a0.getDOMNode());});if(this.filter.category===ao&&this.locationPickerEnabled===true){this.initLocation(true);}T.later(ah,this,function(){this.body.setStyle(aF,ag);var a0=this.getNode(J);if(a0){this.handleStreamEnd(a0);}else{this.checkScroll();}});T.Global.fire("pane-manager:sync-nav-pane-scroll");},loadContentFailure:function(aW,Y){if(this.transportHelperService.wasAborted(aW)){return;}var aV=this.getNode(Y.removeNode);if(aV){aV.remove();}if(Y.subAction===aD){this.isLoading=s;if(Y.firstBatch&&this.filter.category){this.moduleapi.broadcast(Q,{category:""});}}T.later(ah,this,function(){this.body.setStyle(aF,ag);});},fetchContentIds:function(){var Y,aV;Y={_subAction:au,listid:this.listId,blogtype:this.blogType,key:this.getContinuationKey()};if(!this.clientPagination||!Y.key){return;}this.isLoading=N;aV={success:function(aZ){var aW,aY,aX=this.body.one(aK);if(aZ&&aZ.data){aW=aZ.data.items;aY=aZ.data.dynamicCategories;if(aZ.data.fbcount&&aX){aX.append("<!-- fb="+aZ.data.fbcount+" uuids -->");}}this.isLoading=s;if(aW&&T.Lang.isArray(aW)){this.items=this.removeDuplicates(aW,this.items,aX?aX.all(an):[],this.closeEnabled?this.storage.getSet(aa,N):[]);}if(aY&&T.Lang.isArray(aY)){this.moduleapi.broadcast(P,{dynamicCategories:aY});}if(this.items.length===0){this.handleStreamEnd();}else{this.checkScroll();}},failure:function(aW){if(this.transportHelperService.wasAborted(aW)){return;}this.isLoading=s;if(this.items.length===0){this.handleStreamEnd();}}};this.streamLoadReqObj=this.loadContent(Y,{},aV);},loadNextBatch:function(Y,aX){if(this.isLoading){return;}var aY=this.body.one(ae),aW,aZ,aV;if(!aY){return;}aV=this.items.splice(0,this.batchSize);aW={_subAction:aD,items:aV,listid:this.listId,blogtype:this.blogType,left:this.items.length,key:this.getContinuationKey(aY),cpos:this.contentpos};if(aX){aW.data=aX;}aZ={removeNode:aY,insertNode:aY,insertLoc:"after",firstBatch:Y};if(!Y){this.instrumentation.fireBeacon(aY);}if(aY.hasClass("loading")&&(aW.key||aW.items.length)){this.isLoading=N;aY.setContent(this.moduleapi.getString("STR.LOADING"));this.streamLoadReqObj=this.loadContent(aW,aZ);}else{if(aY){this.handleStreamEnd(aY);}}},handleStreamEnd:function(aY){aY=aY||this.getNode(ae+","+J);if(!aY){return;}var aV=this.dynamicCats,aX=this.filter.category,Y=[],aW=0;if(this.endFiltersEnabled&&aX!==p){aY.removeClass(aE).replaceClass("loading",ad);T.Array.each(aV,function(aZ){if(aZ.id!==aX&&aW<this.endFiltersCount){Y[aW++]='<a href="#" class="interest-filter rapidnofollow whs-nw" data-action-outcome="filter" data-filter="'+aZ.id+'" data-ylk="sec:fltr-strm-ft;slk:'+aZ.name+";cpos:"+aW+';" role="button">'+aZ.name+"</a>";}},this);aY.setContent(!Y.length?"":'<h4 class="fz-s">'+this.moduleapi.getString("STR.END_FILTERS_HEADING")+'</h4><p class="fz-s">'+Y.join('<span class="v-h mr-s">, </span>')+"</p>");this.instrumentation.refreshModule(this.rapidContainer);}else{aY.remove();}},loadSocialFilter:function(){var Y=this,aV={success:function(aW){if(Y.socialFilterReq!==this){return;}var aX=aW?T.Object.getValue(aW,["query","results","contents"]):ag;Y.isLoading=s;Y.loadNextBatch(s,aX);}};aV.failure=aV.timeout=aV.success;this.isLoading=N;this.socialFilterReq=T.jsonp(this.filter.api,{on:aV});},setHistoryState:function(aV,Y){if(aV&&Y){aV._expires=+(new Date())+Y;}if(this.restoreStateMethod==="LOCAL_STORAGE"){if(aV){aV.href=b.location.href;this.storage.setItem(o,aV);}else{this.storage.removeItem(o);}}else{if(this.restoreStateMethod==="HTML5_HISTORY"&&al){b.history.replaceState(aV,"");}else{try{this.getNode(av).set(aO,T.JSON.stringify(aV));}catch(aW){}}}},getHistoryState:function(){var Y=ag,aW;if(this.restoreStateMethod==="LOCAL_STORAGE"){Y=this.storage.getItem(o);if(Y&&Y.href!==b.location.href){Y=ag;}}else{if(al){Y=b.history.state;}else{aW=this.getNode(av);if(aW&&aW.get(aO)){try{Y=T.JSON.parse(aW.get(aO));}catch(aV){}}}}if(Y){this.setHistoryState(ag);}return(Y&&(!Y._expires||new Date()<Y._expires))?Y:ag;},saveState:function(){var aV=[],aW=ag,Y=this.clickedItem||this.clickedLink,aX;if(Y&&this.filter.category!==p&&(this.filter.category||!this.allStoriesSectionData)){this.body.all(an).each(function(aY){aV.push({u:aY.getAttribute(m),r:aY.getAttribute(u)});});aX=this.scrollDomNode.scrollTop;aW={time:this.getNode(av).getAttribute("data-time"),items:aV,pending:this.items,filter:this.filter,scrollX:this.scrollDomNode.scrollLeft,scrollY:aX,sortBy:this.sortBy,relY:Y.getY()-aX,itemId:(this.clickedItem)?this.clickedItem.getAttribute(m):ag,activeItemId:this.activeItemId||T.Object.getValue(b,["YUI","type_stream","activeItemId"])};}this.setHistoryState(aW,this.restoreStateExpire);},restoreState:function(a1){var a0,aV,aZ=s,a2=this,Y=a2.getHistoryState(),aX=a2.getNode(aK),aW={},aY={};if(this.filter.category===ao&&this.locationPickerEnabled===true){this.initLocation();}if(Y&&Y.items&&aX&&T.Object.getValue(Y,["filter","category"])!==ac){a0=(Y.time===a2.getNode(av).getAttribute("data-time"));aW._subAction=aD;aW.restore=1;a2.activeItemId=Y.activeItemId;a2.sortBy=Y.sortBy;a2.updateControls();if(a0||this.restoreStateOnCacheMiss){aV=Y.pending;aW.items=Y.items;aW.left=aV.length;aW.batch=1;aW.cpos=0;aY.insertNode=this.body;aZ=N;}else{Y.items=a2.removeDuplicates(Y.items,aX.all(an));a2.scrollDomNode.scrollLeft=Y.scrollX;a2.scrollDomNode.scrollTop=Y.scrollY;a2.restored=!Y.items.length;a1.call(a2);return;}a2.isLoading=N;a2.filter=Y.filter;a2.loadContent(aW,aY,{success:function(a5,a4){a5.data.items=aV;delete a5.data.comscore;if(aZ){a2.body.all(y).remove();}a2.loadContentSuccess(a5,a4);a2.restored=N;a1.call(a2);var a3=Y.itemId&&a2.getItemByUuid(Y.itemId);a2.scrollDomNode.scrollLeft=Y.scrollX;a2.scrollDomNode.scrollTop=a3?a3.getY()-Y.relY:Y.scrollY;T.later(0,a2,function(){a2.checkScroll();if(a2.pollForNewFrequency){a2.checkForNewContent();}});},failure:function(a4,a3){a2.loadContentFailure(a4,a3);a1.call(a2);}});}else{a1.call(a2);}},updateDocTitle:function(Y){if(!this.newCountInTitleEnabled){return;}if(!this.originalDocTitle){this.originalDocTitle=T.Lang.trim(aq.title);if(!this.originalDocTitle){return;}}var aV=this.originalDocTitle;if(Y){if(Y>f){aV=T.Lang.sub(this.moduleapi.getString("STR.NEWCONTENT.TITLE.OVERMAX"),{count:f,title:aV});}else{aV=T.Lang.sub(this.moduleapi.getString("STR.NEWCONTENT.TITLE"),{count:Y,title:aV});}}aq.title=aV;},onIdleChange:function(Y){if(this.pollForNewPauseOnIdle){this.pollForNewPaused=Y.idle;if(!this.pollForNewPaused&&this.pollForNewSkipped){this.checkForNewContent();}}},scheduleNewContentPoll:function(){if(this.newContentPoll){this.newContentPoll.cancel();}this.newContentPoll=T.later(this.pollForNewFrequency,this,this.checkForNewContent);},checkForNewContent:function(){if(this.pollForNewPaused){this.pollForNewSkipped=N;return;}if(this.isLoading||this.filter.category||this.sortBy!==a){T.log("skipping checkForNewContent: isLoading="+this.isLoading+", sort="+this.sortBy+", filter="+T.Object.getValue(this.filter,["category"]),"debug","type_stream");this.scheduleNewContentPoll();return;}var Y={_subAction:au,key:0,poll:1},aV={},aW={success:function(aY){this.pollRequestObj=ag;var aX=T.Object.getValue(aY,["data","items"]),aZ;if(aX){aZ=this.body.all(an);aX=this.removeDuplicates(aX,aZ.size()?aZ:[],this.closeEnabled?this.storage.getSet(aa,N):[],this.items);if(aX.length){this.pendingNewItems=aX;this.broadcastNewContentNotice(aX.length);this.onNewContent();}this.scheduleNewContentPoll();}},failure:function(aX){this.pollRequestObj=ag;}};this.pollRequestObj=this.loadContent(Y,aV,aW);this.pollForNewSkipped=s;},onNewContent:function(){this.updateDocTitle(this.pendingNewItems.length);if(this.pollForNewAutoInsert){if(this.body.getY()>this.scrollDomNode.scrollTop){this.instrumentation.fireYwaBeacon({action:"insert",sec:"td-strm-new",slk:"insert"});this.insertNewContent();}}else{this.displayNewContentNotice(this.pendingNewItems.length);}},broadcastNewContentNotice:function(aV){if(!this.pollForNewBroadcastEnabled){return;}var Y="STR.NEWCONTENT.BROADCAST."+(["ZERO","ONE","TWO"][aV]||"OTHER"),aX=Y&&this.moduleapi.getString(Y)||"",aW=aX&&T.Lang.sub(aX,[aV])||"";this.moduleapi.broadcast(d,{count:aV,message:aW});},displayNewContentNotice:function(aW){var a0=this.moduleapi.getString("STR.NEWCONTENT.NOTICE.MESSAGE."+(aW===1?"SINGLE":(aW>f?"OVERMAX":"PLURAL"))),aZ=T.Lang.sub(a0,{count:(aW>f?f:aW)}),Y=T.Lang.sub(this.moduleapi.getString("STR.NEWCONTENT.NOTICE.TEMPLATE"),{msg:aZ}),aX=this.body.one(aK),aY=T.Node.create(Y),aV=this.body.one(".newcontentnotice");if(!aX){return;}if(aV){aV.replace(aY);}else{aX.insert(aY,"before");this.instrumentation.fireYwaBeacon({action:"secview",sec:"td-strm-msg",outcome:"msgview"});}this.newContentNotice=aY;this.positionNewContentNotice();this.highlightNewItems(ag);},onClickNewContentNotice:function(Y){this.newContentNotice.remove();this.newContentNotice=ag;this.scrollToTop();this.instrumentation.fireBeacon({sec:"td-strm-msg",slk:"top",itc:1});this.insertNewContent();},onActionDrawerFeedback:function(Y){this.onDeclareInterest(Y.interestObj,Y.item);},removeStreamItem:function(aX){var aV=aX.item,aY=!aX.animate?aX.uuid:aV?aV.getAttribute(m):ag,Y=this.moduleapi.getString("STR.REMOVE.ITEM.THANKYOU"),aW;if(aY){if(this.filter.category!==ac){if(aX.animate){if(this.actionDrawerEnabled){aV.one(".wrapper").addClass("dn");aV.append(Y);if(aV.hasClass("featured")){aV.replaceClass("featured","featured-removed");}if(aV.one(".fb-friends")){aV.one(".fb-friends").addClass("dn");}aW=aV.one(".action-drawer-button-wrapper");if(aW){aW.addClass("dn");}}else{aV.setContent(Y);}aV.addClass("remove-item");this.removalTimer=T.later(3000,this,function(){this.fancyRemove(aV);});}this.recordClosed(aY);}}},deleteSavedFromActionDrawer:function(Y){this.deleteSavedArticle();},restoreRemovedArticle:function(aV){var aW=aV.one(".action-drawer-button-wrapper"),aX=aV.one("h3 a").get("text").substring(0,8),Y=T.merge(this.instrumentation.getBeaconKeys(aV),{sec:"td-strm-rm",slk:"undo-itm",ltxt:aX,itc:1,action:aA,outcome:"undo"});if(this.removalTimer){this.removalTimer.cancel();aV.one(".remove-wrap").remove();aV.one(".wrapper").removeClass("dn");aV.removeClass("remove-item").removeClass(z);if(aV.one(".fb-friends")){aV.one(".fb-friends").removeClass("dn");}if(aW){aW.removeClass("dn");}if(aV.hasClass("featured-removed")){aV.replaceClass("featured-removed","featured");}this.instrumentation.fireBeacon(Y);}},insertNewContent:function(){var aV=this.body.one(aK),aY=350,Y=T.Node.create('<li style="height:0">'+this.moduleapi.getString("STR.LOADING")+"</li>"),aX=+(new Date()),aW=function(aZ,a0){this.newContentRequestObj=ag;T.later(Math.max(aY,+(new Date())-aX),this,function(){Y.remove();this.updateDocTitle(0);if(!aZ&&a0&&a0.html){var a1=T.Node.create("<ul>"+a0.html+"</ul>").all(an);if(aV&&a1.size()){aV.prepend(a1);this.highlightNewItems(a1);if(this.interestsService&&a0.data&&a0.data.interestsData){this.interestsService.set(a0.data.interestsData);}}this.instrumentation.refreshModule(this.rapidContainer);this.cacheNativeAdData();this.pollBatchCount+=1;}});};if(!aV){return;}aV.prepend(Y);Y.transition({height:"85px",duration:aY/1000});this.newContentRequestObj=this.loadContent({_subAction:aS,items:this.pendingNewItems,poll:1,ccode:this.ccode,woeid:this.woeId,batch:this.pollBatchCount+1},{},{success:function(aZ){aW.call(this,ag,aZ);},failure:function(aZ){aW.call(this,aZ);}});this.pendingNewItems=[];this.broadcastNewContentNotice(0);},getMastheadHeight:function(){var Y=T.one("#masthead");return Y?Y.get(A)-4:0;},scrollToTop:function(){var Y=T.one("#stream")||this.body,aV=Y.getY()-this.getMastheadHeight();if(this.scrollDomNode.scrollTop>aV){this.scrollDomNode.scrollTop=aV;}},updateScrollHint:function(Y){if(this.scrollhint){if(Y){this.scrollhint.setStyle(C,this.body.get(aJ)+"px");}this.scrollhint.toggleClass(V,(this.scrollDomNode.scrollTop+this.scrollNodeHeight===this.scrollDomNode.scrollHeight));}},positionNewContentNotice:function(aZ){if(!this.newContentNotice){return;}var aY=this.newContentNotice,aX=T.one("#stream").one(".filter-bar-section"),Y=this.getMastheadHeight(),a0=aY.hasClass("sticky"),aW,aV=T.one("BODY");if(aX){Y+=aX.get(A);}aW=(this.scrollDomNode.scrollTop>(this.body.getY()-Y));if(aW&&(!a0||aZ)&&aV.hasClass("fixed-enabled")){aY.setStyles({top:Y+"px",left:this.body.getX()+"px",width:(this.body.get(aJ)-parseInt(aY.getComputedStyle("paddingLeft"),10)-parseInt(aY.getComputedStyle("paddingRight"),10))+"px"}).addClass("sticky");}else{if(a0&&(!aW||!aV.hasClass("fixed-enabled"))){aY.removeClass("sticky").setStyles({top:ag,left:ag,width:ag});}}},highlightNewItems:function(Y){this.body.all("."+aT).removeClass(aT).removeClass(I);if(Y&&Y.size()){Y.addClass(aT);Y.item(Y.size()-1).addClass(I);}},recordRead:function(Y){if(!this.markAsReadEnabled){return;}Y=T.one(Y);if(Y&&Y.hasAttribute(m)&&!Y.test(F)&&!Y.hasClass(ay)){this.storage.addToSet(W,Y.getAttribute(m),1,aM);Y.addClass("read");}},markRead:function(aV){if(!this.markAsReadEnabled){return;}var Y=this.storage.getSet(W);if(Y&&T.Object.size(Y)){aV=aV||this.body.all(an);aV.each(function(aW){var aX=aW.getAttribute(m);if(aX&&Y[aX]){aW.addClass("read");}});}},markStreamActions:function(aY){if(!aY){return;}var aV=(aY.saveforlater&&T.Lang.isArray(aY.saveforlater))?aY.saveforlater:[],Y=(aY.like&&T.Lang.isArray(aY.like))?aY.like:[],aX=(aY.dislike&&T.Lang.isArray(aY.dislike))?aY.dislike:[],aW;T.Array.each(aV,function(aZ){aW=this.getItemByUuid(aZ);if(aW){aW.addClass(az);}},this);T.Array.each(Y,function(aZ){aW=this.getItemByUuid(aZ);if(aW){aW.addClass(am);}},this);T.Array.each(aX,function(aZ){aW=this.getItemByUuid(aZ);if(aW){aW.remove();}},this);},recordClosed:function(aV,Y){if(!this.closeEnabled||(this.readMixerActions&&this.userinfo.isLoggedIn())){return;}if(Y){this.storage.removeFromSet(aa,aV);}else{this.storage.addToSet(aa,aV,1,aM);}},pruneClosed:function(aV){if(!this.closeEnabled||this.filter.category===ac){return;}var Y=this.storage.getSet(aa);if(Y&&T.Object.size(Y)&&(this.filter.category!==ao)){aV=aV||this.body.all(an);aV.each(function(aW){var aX=aW.getAttribute(m);if(aX&&T.Object.owns(Y,aX)){aW.remove();}});}},onDeclareInterest:function(aX,aV){var aW=this.instrumentation.getBeaconKeys(aV),Y={"1":"pos","0":"neu","-1":"neg"};aW.slk=Y[aX.current]+"-"+Y[aX["new"]];aW.itc=1;aW.action=aA;switch(aX.type){case"entity":aW.sec="td-strm-dr-ent";aW.ltxt=aX.id;aW.outcome="entitydecl";break;case"content":aW.sec="td-strm-dr";aW.ltxt=aV.one("h3 a").get("text").substring(0,8);aW.outcome="itemdecl";break;}this.instrumentation.fireBeacon(aW);},initPagination:function(){this.listeners.push(T.after("touchend",this.afterScroll,b,this));this.listeners.push(T.on("resize",function(){this.scrollNodeHeight=this.getScrollNodeHeight();this.updateScrollHint(N);},b,this));if(this.clientPagination){if(this.items.length===0){if(this.pollForNewFrequency||this.dynamicEnabled||this.isInScrollBuffer()){this.fetchContentIds();}else{this.listeners.push(T.onceAfter("scroll",this.fetchContentIds,b,this));}}else{if(this.closeEnabled){this.items=this.removeDuplicates(this.items,this.storage.getSet(aa,N));}}}else{if(this.getContinuationKey()===""){this.batchCount=0;this.loadNextBatch();}}this.scrollBuffer=this.moduleapi.getContextData("scrollBuffer")||this.scrollBuffer;},getContinuationKey:function(aV){var Y=aV||this.body.one(ae);if(Y){return Y.hasAttribute("data-key")?Y.getAttribute("data-key"):ag;}return ag;},getNode:function(Y){return T.Lang.isString(Y)?this.body.one(Y):(Y&&this.body.contains(Y)?T.one(Y):ag);},getItemByUuid:function(aV,Y){Y=Y||this.body;return aV?Y.one(an+"["+m+'="'+aV+'"]'):ag;},getUuids:function(aV){var Y=aV||this.body.all(an),aW=[];Y.each(function(aY){var aX=aY.hasAttribute(m)&&aY.getAttribute(m);if(aX){aW.push(aX);}});return aW;},fancyRemove:function(aV){var Y=this;aV=aV&&T.one(aV);if(!aV||!aV.inDoc()){return;}aV.transition({height:0,opacity:0,duration:0.4,easing:"ease-in"},function(){aV.remove();aV=ag;Y.repaint();});},repaint:function(){if(T.UA.ie&&T.UA.ie<8){this.body._node.className=this.body._node.className;}},setupScroll:function(){var Y=aq.body||T.Node.getDOMNode(T.one("body"));this.scrollDomNode=this.isRmp?T.Node.getDOMNode(this.body.ancestor(function(aW){var aV=aW.getStyle("overflowY");return(aV==="scroll"||aV==="auto"||aW.compareTo(Y));})):Y;this._scrollNodeIsBody=(this.scrollDomNode===Y);if(this._scrollNodeIsBody&&!T.UA.webkit){this.scrollDomNode=aq.documentElement;}this.scrollNodeHeight=this.getScrollNodeHeight();if(this.scrollListener){this.scrollListener.detach();}this.scrollListener=T.one(this._scrollNodeIsBody?b:this.scrollDomNode).after("scroll",this.afterScroll,this);},getScrollNodeHeight:function(){var aV=this.scrollDomNode,Y=this._scrollNodeIsBody;if(Y&&T.UA.webkit){aV=aq.documentElement;}return(Y&&T.UA.ios)?b.innerHeight:aV.clientHeight;},isInScrollBuffer:function(){var aV=this.body.get("region"),Y=this.body.get("viewportRegion");return(aV.bottom<(Y.bottom+this.scrollBuffer));},checkScroll:function(){if(this.newContentNotice){this.positionNewContentNotice();}if(this.isInScrollBuffer()){if(!this.batchPause||this.batchCount%this.batchPause){this.loadNextBatch();}}if(this.pollForNewAutoInsert&&this.pendingNewItems.length){this.onNewContent();}this.updateScrollHint();this.beaconVisibleNativeAds();},onClick:function(a1){var aW=T.one(a1.target),aY="#"+T.DOM.generateID(this.body),a2=aW.ancestor(an,N,aY),aX=a2&&"#"+T.DOM.generateID(a2),a3=aW.ancestor("a",N,aY),aZ,Y="",aV="",a0={};if(a3&&a3.hasClass("fp-article")){aZ=aW.ancestor(".fp-open-inline",true);if(aZ&&a2.hasClass("fp-bday")){a1.preventDefault();a0={name:a2.getData("bday-name"),bday:a2.getData("bday-date"),hash:a2.getData("bday-hash"),id:a2.getData("bday-fbid")};this.moduleapi.broadcast("fp:open-inline",{sec:"td-strm",ct:"birthday",mode:"embed",module:"birthday",subModuleView:"birthday-story",subModuleData:T.JSON.stringify(a0)});}else{if(this.inlineLightboxEnabled&&aZ){if(aZ.getAttribute("data-uuid")){Y=aZ.getAttribute("data-uuid");}if(aZ.getAttribute("href")){aV=aZ.getAttribute("href");}else{aV=aZ.one("A.rapidnofollow").getAttribute("href");}a1.preventDefault();this.moduleapi.broadcast("fp:open-inline",{uuid:Y,href:aV,sec:"td-strm",ct:"1"});return;}}}if(aW.hasClass("fblink")){return;}if(aW.ancestor(".social-actions",N,aY)&&this.swipeMenu){this.swipeMenu.onClick(a1);return;}if(a3&&a3.test(".share-drawer .shareicon")&&this.shareDrawer){this.shareDrawer.onShareBtnClick(a1);return;}if(aW.test(ae+" button")){this.loadNextBatch();return;}if(aW.test('input[name="sb"]')){this.setSortMode(parseInt(aW.get(aO),10),N);return;}if(aW.test('input[name="sv"]')){this.setSectionView(parseInt(aW.get(aO),10));return;}if(a3&&a3.test(l)){this.onAdInfoClick(a3,a2);}if(aW.hasClass("interest-filter")){a1.halt();this.moduleapi.broadcast(Q,{category:aW.getAttribute("data-filter"),name:aW.getAttribute("data-filter-name")||aW.getContent()});this.filterBeacon(aW);return;}if(a2){if(a2.hasClass("remove")&&aW.ancestor(".menu",N,aX)){this.onRemovalMenuClick(a1);}else{if(this.actionDrawer&&aW.ancestor(aH,N,aX)){this.actionDrawer.toggleDrawer(a2,s);}else{if(this.actionDrawer&&aW.ancestor(".close,.check-icon,.save-button",N,aX)){if(!aW.ancestor("button:disabled",N,aX)){this.handleActionDrawerTrigger(a2,aW);}}else{if(this.actionDrawer&&aW.ancestor(".undo-btn",N,aX)){this.restoreRemovedArticle(a2);}else{if(aW.test(".more-summary")){a1.preventDefault();this.toggleSummary(a2);}else{if(aW.ancestor(".close",N,aX)){a1.preventDefault();if(a2.hasAttribute(m)){if(this.saveForLaterWidget&&this.filter.category===ac){this.deleteSavedArticle(aW);}else{this.removeContent(a2);}}else{this.fancyRemove(a2);}}else{if(aW.hasClass("share-drawer-icon")){a1.preventDefault();}else{if(aW.ancestor(".share-drawer, .friends-string, .label",N,aX)){}else{if(a2.hasClass("video-inline")&&this.handleInlineVideo(a2,aW)){a1.preventDefault();}else{if(a3){if(!aW.hasClass("interest-filter")){this.recordRead(a2);}if(a1.which!==2&&a1.button!==4&&!a1.altKey&&!a1.ctrlKey&&!a1.shiftKey&&!a1.metaKey&&a3.getAttribute("target").toLowerCase()!=="_blank"){this.clickedItem=a2;this.clickedLink=ag;if(this.restoreStateExpire){this.saveState();}if(this.itemClickContext){this.statemgr.setUserModuleState("context",{cat:this.filter.category,catName:this.filter.name||"",listid:this.listId||"",blogtype:this.blogType||"",u:a2.getAttribute(m)});}if(this.highlightActive){this.highlightItem(a2);}}}}}}}}}}}}}this.moduleapi.broadcast(aw);},handleActionDrawerTrigger:function(a3,aV){var aX=a3&&"#"+T.DOM.generateID(a3),aW=aV.ancestor(".close",N,aX)?z:aV.ancestor(".check-icon",N,aX)?am:az,Y,a1=this.userinfo.isLoggedIn(),a0,a2,aZ,aY;if(aW===am){aZ=z;aY=az;}else{if(aW===z){if(this.filter.category===ac){this.actionDrawer.toggleDrawer(a3,N);this.actionDrawer.handleSaveClick();return;}aZ=am;aY=az;}else{if(aW===az){aZ=am;aY=z;}}}a3.toggleClass(aW);if(aW===az){a0=a1;a2=a1?s:!a3.test("."+am+",."+z);}else{a0=!a3.hasClass(ax)&&!a3.hasClass(aW);a2=a1?!a3.test("."+aZ):!a3.test("."+aZ+",."+aY);}if(!a3.hasClass(ax)||a2){this.actionDrawer.toggleDrawer(a3,a0);}if(a1){if(aW===am){this.actionDrawer.handleLikeClick();}else{if(aW===z){this.actionDrawer.handleDislikeClick();Y=a3.getAttribute(m);this.recordClosed(Y,!a3.hasClass(z));}else{if(aW===az){this.actionDrawer.handleSaveClick();}}}}else{a3.removeClass(aZ).removeClass(aY);this.actionDrawer.showLoginBtns();}if(aW===z){this.actionDrawer.fireCloseBeacon();}this.onHideTooltip();this.showTooltip(aV);a3.one("h3 a").focus();},disableStreamButtons:function(aV){var Y=aV?aV.item:ag;if(Y){Y.all(".side-button").set(n,N);}},enableStreamButtons:function(aV){var Y=aV?aV.item:ag;if(Y){Y.all(".side-button").set(n,s);}},handleInlineVideo:function(aW,Y){var aX,aV,aY,aZ=ag;if(!this.yepService){this.yepService=this.moduleapi.getService("videoyep");if(this.yepService){this.yepPlayer=this.yepService.create();}}if(!this.yepPlayer){return s;}aX=aW.getData();if(!aX.uuid){return s;}if(aX["poster-img"]){aZ=aX["poster-img"];}aV=this.instrumentation.getBeaconKeys(aW);aY={analytics:{sec:aV.sec,ccode:this.ccode,cpos:aV.cpos,ct:aV.ct||3},config:{animated:N,attach:aW,location:"prepend",returnTabIndexTo:Y,yep:{autoplay:N,id:aX.uuid},videoPageUrl:aX.url||ag}};if(aZ){aY.config.image=aZ;}this.yepPlayer.init(aY);this.recordRead(aW);return N;},onRemovalMenuClick:function(a6){var aX=a6.target,a4,a8=aX.ancestor(an,N,"#"+T.DOM.generateID(this.body)),aZ=T.merge(this.instrumentation.getBeaconKeys(a8),{itc:1,pos:0}),a0,a2,aW,aY,a3,a1,Y,a5={},aV=[],a7=this;if(aX.ancestor("button.undo",N)){this.clearRemovalTimer();Y=a8.getAttribute(m);this.recordClosed(Y,N);a8.one(".menu").remove();a8.removeClass(aU);this.currentRemovalMenu=ag;a0=a8.one(".wrapper .body h3 a").get("text");a0=(a0&&a0.length>8)?a0.substring(0,8):a0;this.instrumentation.fireBeacon(T.mix({action:aA,outcome:"undo",sec:"td-strm-rm",slk:"undo",ltxt:a0},aZ));this.repaint();if(this.userinfo.isLoggedIn()&&this.writeMixerActions){a1={_subAction:"article_feedback",uuid:Y,state:"neutral",mixerAction:"dislike"};this.makeInterestRequest(a1);}a8.one(".wrapper .body a").focus();}else{if(aX.ancestor(".wikiid",N,".menu")){a4=aX.ancestor(".wikiid",N,".menu");a3=a4.hasClass(aC)?1:a4.hasClass(X)?-1:0;if(aX.hasClass("remove-title")){if(a4.hasClass(aC)){a4.replaceClass(aC,X);}else{if(a4.hasClass(X)){a4.removeClass(aC).removeClass(X);}else{a4.replaceClass(X,aC);}}}else{if(aX.ancestor(".remove-pos",N,".wikiid")){a4.toggleClass(aC).removeClass(X);}else{if(aX.ancestor(".remove-neg",N,".wikiid")){a4.toggleClass(X).removeClass(aC);}else{a4.toggleClass(X);a4.removeClass(aC);}}}aW=a4.hasClass(aC)?1:a4.hasClass(X)?-1:0;a0=a4.getAttribute(aR);aY=((a3===1)?"pos":(a3===-1)?"neg":"neu")+"-"+((aW===1)?"pos":(aW===-1)?"neg":"neu");a5[a0]={"new":aW,current:a3,type:a4.getAttribute("data-interesttype")};aV=a5;this.handleRemovalMenuFeedback(aV,function(ba,bb){var a9;if(a7.currentRemovalMenu&&a7.currentRemovalMenu===a8){if(ba===s){if(a7.interestsService){a7.interestsService.update(a0,{state:aW});}a9=aX.ancestor(".remove-menu-main",N,"div");if(!a9.getData("confirmed")){a9.append(a7.moduleapi.getString("STR.BUTTON.REMOVE_DONE"));a9.setData("confirmed",N);a7.repaint();}}else{if(a3===1){a4.replaceClass(X,aC);}else{if(a3===-1){a4.replaceClass(aC,X);}else{a4.removeClass(X).removeClass(aC);}}}}});a2=a8.one(".login");if(a2){a2.removeClass(ab);this.repaint();}if(this.userinfo.isLoggedIn()){this.instrumentation.fireBeacon(T.mix({sec:"td-strm-rm",slk:aY,ltxt:a0,action:aA,outcome:"entitydecl"},aZ));}}else{if(aX.ancestor("button.remove-done",N)){a8.one(".menu").empty().setStyle("minHeight",0).append(a7.moduleapi.getString("STR.REMOVE.CONFIRM"));a8.addClass("remove-disappear");a8.removeClass("featured");this.setRemovalTimer();this.repaint();this.instrumentation.fireBeacon(T.mix({slk:"done",ltxt:"done"},aZ));}else{if(aX.test(".profile-link")){this.instrumentation.fireYwaBeacon({sec:"td-strm-rm",slk:"pref",action:aA,outcome:"navigate"});}}}}},afterScroll:function(Y){if(this.scrollTimer){this.scrollTimer.cancel();}var aV=+(new Date()),aW=aV-this.lastScrollCheck;if(aW>this.scrollThrottle){this.checkScroll();this.lastScrollCheck=aV;}else{this.scrollTimer=T.later(this.scrollThrottle-aW,this,this.checkScroll);}},onHoverContent:function(Y){var aW=Y.currentTarget,aV=Y.relatedTarget;if(aW!==aV&&!aW.contains(aV)){aW.toggleClass(j,(Y.type===O));}},onHoverTitle:function(Y){var aV=Y.target.ancestor(an);if(aV){aV.toggleClass(af,Y.type===O);}},onMouseOverMenu:function(Y){this.clearRemovalTimer();},onMouseOutMenu:function(Y){this.setRemovalTimer();},onMouseOverLi:function(Y){var aV=Y.currentTarget;this.trimEntityList(aV);},trimEntityList:function(aV){var Y=aV.one(".interest-list"),aW=Y?aV.one(".attribution").get("region"):ag,aX;if(Y&&!aV.hasClass("remove")){Y.removeClass("voh");aX=Y.all(".interest-wrap");while(aX.size()&&!Y.inRegion(aW,N)){aX.pop().remove();}}},onMouseOutLi:function(Y){var aV=Y.currentTarget;this.hideEntityList(aV);},hideEntityList:function(aV){var Y=aV.one(".interest-list");if(Y){Y.addClass("voh");}},onShowTooltip:function(Y){this.showTooltip(Y.currentTarget);},showTooltip:function(aX){var aW=this.tooltip.getNode(),aV=this.moduleapi,Y=aX.ancestor(an),aY;if(aX.hasClass("side-button")&&this.actionDrawerEnabled){if(aX.hasClass("save-button")){aY=Y.hasClass("saved")?aV.getString("STR.TOOLTIP.UNDO"):aV.getString("STR.SAVE.SAVETEXT");aW.addClass(aP);}else{if(aX.hasClass("check-icon")){aY=Y.hasClass("liked")?aV.getString("STR.TOOLTIP.UNDO"):aV.getString("STR.INTERESTS.LIKETEXT");aW.addClass(aN);}else{if(aX.hasClass("close")&&this.filter.category!==ac){aY=Y.hasClass("disliked")?aV.getString("STR.TOOLTIP.UNDO"):aV.getString("STR.INTERESTS.DISLIKETEXT");aW.addClass(aL);}}}}else{if(aX.hasClass("profile-img")){aY=aX.one("img").get("alt");}else{if(aX.hasClass("more")){aY=aX.getAttribute("data-friendlist").split(",").join("<br/>");}}}if(aY){this.tooltip.show(aX,{msg:aY});}},onHideTooltip:function(Y){this.tooltip.hide();this.tooltip.getNode().removeClass(aP).removeClass(aN).removeClass(aL);},onFilter:function(Y){if(this.streamLoadReqObj){this.streamLoadReqObj.abort();this.streamLoadReqObj=ag;}if(this.newContentRequestObj){this.newContentRequestObj.abort();this.newContentRequestObj=ag;}this.filter=Y||{};this.batchCount=0;this.contentpos=0;this.isLoading=s;this.items=[];this.pendingNewItems=[];this.broadcastNewContentNotice(0);this.body.setStyle(aF,this.body.get(A)+"px");this.body.all(y).remove();this.body.append(this.moduleapi.getString("STR.LOADING.CONTENT"));T.later(ah,this,this.scrollToTop);this.clearRemovalTimer();this.currentRemovalMenu=ag;this.socialFilterReq=ag;this.updateDocTitle(0);this.updateControls();this.clearNativeAdData();if(Y.category===p){this.loadSocialFilter();}else{this.loadNextBatch(N);}if(this.saveForLaterWidget&&(Y.category===ac)){this.saveForLaterWidget.onSavedFilter();}if(this.actionDrawer){this.actionDrawer.onFilter(Y);}if(this.swipeMenu){this.swipeMenu.onFilter(Y);}},removeDuplicates:function(Y){var aW={},aV=[];if(Y&&Y.length){if(arguments.length>1){T.each(T.Array(arguments).slice(1),function(aX){T.each(aX,function(aY){if(!aY){return;}if(aY instanceof T.Node){aW[aY.getAttribute(m)]=1;if(aY.hasAttribute(G)){aW[aY.getAttribute(G)]=1;}if(aY.hasAttribute(E)){aW[aY.getAttribute(E)]=1;}}else{if(T.Lang.isObject(aY)){aW[aY.u]=1;if(aY.ka){aW[aY.ka]=1;}if(aY.kb){aW[aY.kb]=1;}}else{aW[aY]=1;}}});});T.each(Y,function(aX){if((!aW.hasOwnProperty(aX.u))&&(!aX.ka||!aW.hasOwnProperty(aX.ka))&&(!aX.kb||!aW.hasOwnProperty(aX.kb))){aV.push(aX);}});}else{aV=Y.slice(0);}}return aV;},showRemovalMenu:function(aX){var a1=aX.one(".wrapper"),aW=this.parseInterests(aX),Y=a1.get(A),aZ,aV,a0,aY;aX.addClass(aU);aV=this.moduleapi.getString("STR.REMOVE.MENU");aZ=aX.appendChild(aV);a0=aZ.one(".remove-menu-main");aY=aZ.one(".profile-link");aZ.setStyle("minHeight",Y);if(aW.length){a0.append(this.moduleapi.getString("STR.SHOW.LESS"));if(aY){aY.removeClass(V);}T.Array.each(aW,function(a2){a2.type=a2.declared?"declared":"";a2.selected=a2.state===1?aC:a2.state===-1?X:"";a0.append(T.Lang.sub(this.moduleapi.getString("STR.BUTTON.WIKIID"),a2));},this);}this.repaint();this.currentRemovalMenu=aX;},handleRemovalMenuFeedback:function(aV,aZ){if(!this.userinfo.isLoggedIn()){return;}var Y,aX;function aY(a0){if(T.Lang.isFunction(aZ)){aZ(s,a0);}}function aW(a0){if(T.Lang.isFunction(aZ)){aZ(N,a0);}}Y={_subAction:"int_manage",interest:aV};aX={success:aY,failure:aW,scope:this};this.makeInterestRequest(Y,aX);},makeRequestToGetMixerActions:function(Y,aV){this.transportHelperService.makeRequest({type:"module",moduleId:this.id,args:{_action:"show",_subAction:"getMixerActions",uuids:Y}},aV);},makeInterestRequest:function(Y,aV){var aW=aV?aV:{};this.transportHelperService.makeRequest({type:"module",moduleId:R,args:T.merge({_action:"show"},Y)},aW);},onRemovalMenuLoginClick:function(aX){var aW=aX.ancestor(an,N,"#"+T.DOM.generateID(this.body)),aV=T.mix(this.instrumentation.getBeaconKeys(aW),{itc:1,pos:0}),aZ=aX.get("text"),a0={},aY=s,Y=[];aZ=(aZ&&aZ.length>8)?aZ.substring(0,8):aZ;this.clearRemovalTimer();this.currentRemovalMenu=ag;aW.all("span.wikiid").each(function(a2){var a4=a2.getAttribute(aR),a1="neu-"+(a2.hasClass(aC)?"pos":a2.hasClass(X)?"neg":""),a3=a2.hasClass(aC)?1:a2.hasClass(X)?-1:0;if(a2.hasClass(aC)||a2.hasClass(X)){a0[a4]={"new":a3,current:0,type:"declared"};aY=N;Y.push(T.merge(aV,{slk:a1,ltxt:a4}));}});if(aY){this.storage.setItem(aI,{wikiids:a0,beacons:Y});}this.storage.setItem(aj,aX.hasClass("fblogin")?aQ:g);},updateDislikedInterests:function(){if(!this.removalMenuEnabled){return;}var Y;if(!this.userinfo.isLoggedIn()){this.loginService.configClick({selector:".type_stream .remove a",clickHandler:T.bind(this.onRemovalMenuLoginClick,this)});}else{Y=this.storage.getItem(aI);if(Y){if(T.Object.size(Y.wikiids)>0){this.handleRemovalMenuFeedback(Y.wikiids,N);}T.Array.each(Y.beacons,function(aV){this.instrumentation.fireBeacon(aV);},this);this.storage.removeItem(aI);}this.storage.removeItem(aj);}},parseInterests:function(aV){var Y=aV&&aV.hasAttribute(c)?aV.getAttribute(c):ag,aW=Y?T.Object.values(this.interestsService.get(Y.split("|"))):[];T.Array.each(aW,function(aX){aX.streamEligible=(aX.url&&(aX.count>=this.minArticleCount));},this);return aW;},clearRemovalTimer:function(Y){if(this.itemRemovalTimer){this.itemRemovalTimer.cancel();this.itemRemovalTimer=ag;}},setRemovalTimer:function(){this.itemRemovalTimer=T.later(5000,this,function(){this.fancyRemove(this.currentRemovalMenu);this.currentRemovalMenu=ag;});},removeContent:function(aW){var aV,Y;aW=T.one(aW);if(aW&&aW.hasAttribute(m)){aV=aW.getAttribute(m);this.recordClosed(aV);if(this.removalMenuEnabled){if(this.currentRemovalMenu){this.clearRemovalTimer();this.fancyRemove(this.currentRemovalMenu);this.currentRemovalMenu=ag;}this.showRemovalMenu(aW);}else{if(!this.swipeMenu){this.fancyRemove(aW);}}if(this.userinfo.isLoggedIn()&&this.writeMixerActions){Y={_subAction:"article_feedback",uuid:aV,state:"disliked",mixerAction:"dislike"};this.makeInterestRequest(Y);}this.instrumentation.fireYwaBeacon(T.mix({itc:1,action:aA,outcome:"rmct",slk:"rm",sec:"td-strm-ctrl"},this.instrumentation.getBeaconKeys(aW)));}},setSortMode:function(aX,aV){var aW=this.instrumentation,Y;if(aX===this.sortBy){return;}this.sortBy=aX;this.statemgr.saveUserSetting("sb",aX,this.moduleapi);this.onFilter(this.filter);if(aV){this.updateControls();Y=(aX===a?"sort-t":"sort-c");aW.fireBeacon({sec:"set-strm",itc:1,slk:Y,action:aA,outcome:"sort"});}},setSectionView:function(Y){if(Y===this.allStoriesSectionView){return;}this.allStoriesSectionView=Y;this.statemgr.saveUserSetting("sv",Y,this.moduleapi);this.onFilter(this.filter);this.updateControls();this.instrumentation.fireBeacon({sec:"set-strm",itc:1,slk:(Y===M?"view-rec":"view-cat"),action:aA,outcome:"setlayout"});},updateControls:function(){var Y=this.body.one(".controls"),aV,aY,aW,a0,aX=this.filter.category,aZ=this.sortBy;if(!Y){return;}aV=Y.one(".sort");aY=Y.one(".sections");Y.all(ar).removeClass(h);Y.toggleClass(V,aX===p||(aX&&!aV));if(aY){aY.toggleClass(V,aX);a0=aY.one('input[value="'+this.allStoriesSectionView+'"]');if(a0){a0.set(h,N).ancestor(ar).addClass(h);}}if(aV){if(aX===ao){aV.addClass(n).setAttribute(n,n);aZ=a;}else{aV.removeClass(n).removeAttribute(n);}aW=aV.one('input[value="'+aZ+'"]');if(aW){aW.set(h,N).ancestor(ar).addClass(h);}}},toggleSummary:function(aW){var aV=aW.hasClass(t)?"clps":"xpnd",Y={slk:aV,itc:1,elm:"btn",elmt:aV,action:aA};aW.toggleClass(t);this.instrumentation.fireBeacon(T.mix(Y,this.instrumentation.getBeaconKeys(aW)));},filterBeacon:function(aW){var aV,aX,Y={ltxt:aW.getContent(),cpos:aW.get("parentNode").all(".interest-filter").indexOf(aW)+1,itc:1};if(aW.ancestor(J)){Y.sec="fltr-strm-ft";Y.slk="filter-d";this.instrumentation.fireBeacon(Y);}else{if(aW.ancestor(".interest-list")){aV=aW.ancestor(an);aX=this.instrumentation.getBeaconKeys(aV);Y.slk="filter-i";Y.sec=aX.sec;Y.g=aX.g;Y.woe=this.woeid;Y.ccode=this.ccode;Y.intl=this.intl;this.instrumentation.fireBeacon(Y);}}},deleteSavedArticle:function(Y){if(this.saveForLaterWidget){this.saveForLaterWidget.deleteArticle(Y);}var aV=this.body.all(an),aW=this.body.one(".strm-error-msg");if(this.filter.category===ac&&aW&&aV&&aV.size()===0){aW.removeClass(V);}},onSaveArticle:function(aW,Y){if(!aW){return;}var aV=T.merge(this.instrumentation.getBeaconKeys(aW),{sec:"td-strm-ctrl",slk:Y,itc:1,action:aA,outcome:((Y==="sv")?"svct":"undo")});this.instrumentation.fireBeacon(aV);},onSignedOutSaveClick:function(aV){if(!aV){return;}var Y=T.merge(this.instrumentation.getBeaconKeys(aV),{sec:"td-strm-ctrl",action:aA,outcome:"login"});this.instrumentation.fireYwaBeacon(Y);},cacheNativeAdData:function(){var Y=this.body.all(ak+"["+aG+"]");this.clearNativeAdData();if(Y.size&&Y.size()>0){Y.each(function(aW,aV){this.nativeAds.push({node:aW,y:aW.getY(),height:aW.get(A)});},this);return true;}return false;},clearNativeAdData:function(){this.nativeAds=[];},beaconVisibleNativeAds:function(){var aW,aV,Y,aX;if(this.nativeAds.length>0){aW=this.scrollDomNode;aV=this.getScrollNodeHeight();Y=this.nativeAds.length-1;while(Y>=0){aX=this.nativeAds[Y];if(((aW.scrollTop+aV)>(aX.y+(aX.height/2)))&&(aW.scrollTop<aX.y)){this.fireNativeAdBeaconWhenReady(aX);this.nativeAds.splice(Y,1);}Y--;}}},fireNativeAdBeaconWhenReady:function(Y){T.later(1000,this,function(){var aW,aX=this.scrollDomNode,aV=this.getScrollNodeHeight();if(((aX.scrollTop+aV)>(Y.y+(Y.height/2)))&&(aX.scrollTop<Y.y)){aW=Y.node.getAttribute(aG);if(aW){this.instrumentation.getBeaconImage(aW);Y.node.removeAttribute(aG);}}else{this.nativeAds.push(Y);}});},onAdInfoClick:function(aX,aW){var aV=this.instrumentation.getBeaconKeys(aW),Y=aX.test(ap)?"sp":aX.test(e)?"adv":"info";this.instrumentation.fireYwaBeacon(T.mix(aV,{slk:Y,ad:1,action:"click",outcome:"navigate"}));},initGlobalListeners:function(){this.listeners.push(T.Global.on(K+":initialized",this.onReqMgrInitialized,this));this.listeners.push(T.Global.on(K+":active-content-changed",this.onReqMgrActiveContentChange,this));this.listeners.push(T.Global.on("pane-manager:scroll-mode-change",this.setupScroll,this));this.listeners.push(T.Global.on(Q,function(Y){this.moduleapi.broadcast(Q,Y);},this));},onReqMgrInitialized:function(Y){this.substituteDataInTemplate(Y);},onReqMgrActiveContentChange:function(aW){var Y=T.Object.getValue(aW,["uuid"]),aV=Y&&this.getItemByUuid(Y)||ag;b.YUI.namespace("type_stream").activeItemId=this.activeItemId=Y;if(aV&&this.interestFiltersBroadcast){this.broadcastEntities(aV);}if(this.highlightActive){this.highlightItem(aV);}},substituteDataInTemplate:function(aW){var Y=T.Object.getValue(aW,["metadata","uuid"]),aV=Y&&this.getItemByUuid(Y);if(aV&&aV.hasClass(V)){aV.setHTML(T.Lang.sub(aV.getHTML(),aW.metadata)).removeClass(V);}},highlightItem:function(Y){this.body.all(k).removeClass(q);if(Y&&!Y.hasClass(ay)){Y.addClass(q);}},broadcastEntities:function(aV){var aW={url:"",uuid:"",entities:[]},Y;if(aV){Y=aV.one("h3 a");if(Y){aW.url=Y.getAttribute("href");}if(aV.hasAttribute(m)){aW.uuid=aV.getAttribute(m);}if(this.interestFiltersBroadcast&&aV.hasAttribute(c)){aW.entities=this.parseInterests(aV);}}if(!this.evtStreamEntities){this.evtStreamEntities=T.Global.publish(U,{fireOnce:N,async:N});this.customEvents.push(this.evtStreamEntities);}else{if(this.evtStreamEntities.fireOnce){this.evtStreamEntities.applyConfig({fireOnce:s,async:s},N);}}this.evtStreamEntities.fire(aW);},broadcastDynamicFilters:function(Y){if(!this.evtStreamDynamicFilters){this.evtStreamDynamicFilters=T.Global.publish(H,{fireOnce:N,async:N});this.customEvents.push(this.evtStreamDynamicFilters);}else{if(this.evtStreamDynamicFilters.fireOnce){this.evtStreamDynamicFilters.applyConfig({fireOnce:s,async:s},N);}}this.evtStreamDynamicFilters.fire(Y);}};}());/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */
YUI.add("interests_service",function(b){var i="MPServices",d="InterestsProvider",e=true,f=null,j=b.guid(),g="interests_service|",h="interests:change",c={},k=f;function a(){b.Global.detachAll(g+"*");b.Global.on(g+h,this._onInterestsChange,this);}a.prototype={_fireWithOrigin:function(l,n){var m={origin:j,data:n};this.fire(l,m);},_onInterestsChange:function(l){if(l.origin!==j){this.set(l.data);}},get:function(n,m){var o,l={};b.Array.each(n||b.Object.keys(c),function(p){o=b.Object.owns(c,p)?b.merge(c[p]):f;if(o&&(!m||m(o,p))){l[p]=o;}});return l;},getById:function(l){return this.get([l])[l]||f;},set:function(m){var l={};b.Object.each(m,function(n,o){this.update(o,n,e);l[o]=b.merge(c[o]);},this);this._fireWithOrigin(h,l);return this;},update:function(o,m,l){var n={};if(b.Object.owns(c,o)){b.mix(c[o],m,e);}else{m.id=o;c[o]=b.merge(m);}if(!l){n[o]=b.merge(c[o]);this._fireWithOrigin(h,n);}return this;}};b.augment(a,b.EventTarget,e,f,{broadcast:2,emitFacade:e});b.namespace(i)[d]={name:"interests",getService:function(m,l){if(!k){k=new a();}return k;}};if(b.ModulePlatform){b.ModulePlatform.registerService(b[i][d]);}},"0.0.1",{requires:["event-custom-base"]});/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */
YUI.add("stream_action_drawer",function(Q){var W=null,J=true,x=false,aj="click",au=2*24*60*60*1000,am=5*60*1000,al=80,c="data-uuid",aw="YPROP:SAVE",ao="height",ar="td-strm-dr",U="MPServices",H="StreamSocialProvider",d=Q.ModulePlatform,h={LIKE:1,NEUTRAL:0,DISLIKE:-1},s=Q.Node.create('<span class="action-drawer-login"></span>'),k="like",ab="dislike",ah="saveforlater",F=".social-actions",a=".social-icon",G=".save-button",I=".check-button",L=".remove",j=".delete",n=G+","+I+","+L+","+j,aa=".saved,.liked,.disliked",an=".entity",t=".entity-list",S=".entity-msg",v=".done-button",ak=".action-drawer-login",w="li",ac=".menu",q=".flag-content-btn",R=".flag-content-item",ae="drawer-open",ag="highline",ai="saved",X="liked",K="neutral",C="disliked",r="pos",at="neu",ay="neg",m="saved-stories",u="flagged",o="put-update",av="delete-update",z="savedarticles",D="actionRestore",l="declareFeedback",B="removeStreamItem",O="deleteSaved",e="drawerToggleStart",ap="drawerToggleComplete",i="checked",P="input",T="p_30345860",M="p_30345831",aq,N,y,E,V,ad,af,b,Z=W,f=[],g=[],ax,p=J,A;A=function(Y){var aA=W,az=W,aB=y.isLoggedIn();Z=Q.one(".save-container");if(E&&!aB){E.getButtons(s,{sec:ar,layout:"horizontal",title:af.getString("STR.ACTIONDRAWER.LIKEDCTA"),narrow:1});E.configClick({selector:ak+" a",clickHandler:Q.bind(this.onLoginBtnClick,this)});}if(N){aA=N.getItem(z);if(aA&&Q.Lang.isArray(aA)){g=aA;}az=N.getItem(D);if(az){if(aB){this.restoreAction(az);}N.removeItem(D);}}this.viewingSavedStories=ad?ad.isSflPage:x;this.flagContentEnabled=ad?ad.flagContentEnabled:x;};A.prototype={disableButtons:function(){p=x;},restoreAction:function(az){var aA={},Y;if(az.type===ai){f.push(az.uuid);this.makeSaveRequest(o,az.uuid,J);aq.fireBeacon(az.beacon);}else{aq.fireBeacon(az.beacon);if(az.type===C){this.fire(B,{uuid:az.uuid,animate:x});aA={uuid:az.uuid,state:h.DISLIKE};}else{aA={uuid:az.uuid,state:h.LIKE};}this.fire(l,aA);Y=(az.type===X)?k:ab;this.markItemFeedbackInMixer(az.uuid,az.type,Y);}},getSavedList:function(){return g.concat(f);},handleSaveClick:function(aC){var aD=this.currentItem.hasClass(ai),aE=aD?"STR.SAVE.SAVEDTEXT":"STR.SAVE.SAVETEXT",aB,aA=this.currentItem.getAttribute(c),az,Y=Q.merge(aq.getBeaconKeys(this.currentItem),{sec:ar,itc:1,action:aj});if(!aD||this.viewingSavedStories){Y.slk="unsv";Y.outcome="undo";az=Q.Array.indexOf(f,aA);if(az>-1){f.splice(az,1);}az=Q.Array.indexOf(g,aA);if(az>-1){g.splice(az,1);}aB=av;}else{Y.slk="sv";Y.outcome="svct";f.push(aA);aB=o;if(Z){Z.addClass("filter-transition");Q.later(1500,this,function(){Z.removeClass("filter-transition");});}}aq.fireBeacon(Y);this.makeSaveRequest(aB,aA);if(this.viewingSavedStories){if(p){this.closeDrawer(this.currentDrawer);}this.currentItem.remove();this.fire(O,{});}else{if(p){this.updateBtnText(aC,aE);}}},handleLikeClick:function(aC){var aD=this.currentItem.hasClass(X),aB=this.currentItem.hasClass(C),az=this.currentItem.getAttribute(c),Y,aE=aD?"STR.INTERESTS.LIKEDTEXT":"STR.INTERESTS.LIKETEXT",aA={"new":aD?"1":"0",current:aB?"-1":aD?"0":"1",type:"content"};if(p){Y=this.currentDrawer.one(L);this.updateBtnText(Y,"STR.INTERESTS.DISLIKETEXT");this.updateBtnText(aC,aE);}else{this.currentItem.removeClass(C);if(this.currentDrawer){this.currentDrawer.removeClass(C);if(this.currentItem.hasClass(X)){this.currentDrawer.addClass(X);}}}this.fire(l,{interestObj:aA,item:this.currentItem,markFeedback:x});this.markItemFeedbackInMixer(az,aD?X:K,k);if(aB){this.markItemFeedbackInMixer(az,K,ab);}if(!aD){if(p){this.closeDrawer(this.currentDrawer);}}else{this.buildEntityList(x);}},handleDislikeClick:function(aC){var aD=this.currentItem.hasClass(X),aB=this.currentItem.hasClass(C),az=this.currentItem.getAttribute(c),Y,aE=aB?"STR.INTERESTS.DISLIKEDTEXT":"STR.INTERESTS.DISLIKETEXT",aA={"new":aB?"-1":"0",current:aD?"1":aB?"0":"-1",type:"content"};if(p){Y=this.currentDrawer.one(I);this.updateBtnText(Y,"STR.INTERESTS.LIKETEXT");this.updateBtnText(aC,aE);}else{this.currentItem.removeClass(X);if(this.currentDrawer){this.currentDrawer.removeClass(X);if(this.currentItem.hasClass(C)){this.currentDrawer.addClass(C);}}}this.fire(l,{interestObj:aA,item:this.currentItem,markFeedback:x});this.markItemFeedbackInMixer(az,aB?C:K,ab);if(aD){this.markItemFeedbackInMixer(az,K,k);}if(!aB){if(p){this.closeDrawer(this.currentDrawer);}}else{this.buildEntityList(x);this.updateConfirmationMsg(af.getString("STR.ENTITY.LIST.DISLIKED.MSG"));}},markItemFeedbackInMixer:function(Y,aA,az){if(!ad.writeMixerActions){return;}this.makeInterestRequest({_subAction:"article_feedback",uuid:Y,state:aA,mixerAction:az});},updateConfirmationMsg:function(az){var Y=this.currentDrawer.one(S);if(Y){Y.setHTML(az);}},buildEntityList:function(aB){var aA=p?af.getString("STR.ENTITY.LIST.TEMPLATE"):af.getString("STR.REMOVE.MENU"),aG=af.getString("STR.ENTITY.ITEM.TEMPLATE"),aI=this.currentDrawer.one(S),aD=this.currentDrawer.one(t),aH=this.currentDrawer.one(v),az=this.currentDrawer.one(ac),aE,aL="",aC={},Y,aF=J,aJ=0,aM=this.currentDrawer,aK=this;if(aD&&aH&&aI){aD.remove();aH.remove();aI.remove();}if(az){az.remove();}aE=V.get(this.currentItem.getAttribute("data-wikiids").split("|"));Q.Object.each(aE,function(aN){aC={state:(aN.state===1)?r:(aN.state===-1)?ay:at,type:aN.declared?"declared":"inferred",id:aN.id,name:aN.name};aL+=Q.Lang.sub(aG,aC);});if(!p){this.currentItem.addClass("y-pattern").addClass("hover");aM.removeClass("dn");}if(Q.Object.size(aE)>0){aL=Q.Lang.sub(aA,{entities:aL});aM.append(aL);if(p){aM.one(F).setStyle(ao,al+"px");Y=al+aM.one(t).get("clientHeight")+aM.one(v).get("clientHeight")+aM.one(S).get("clientHeight")+30;}else{aM.all(an).addClass("d-ib");Y=aM.one(ac).get("offsetHeight");aH=aM.one(v);}aF=x;}else{if(!aB){if(p){aM.one(F).remove();}aL=af.getString("STR.ACTIONDRAWER.NOENTITIESLIKE");aM.append(aL);Y=aM.one(".no-entities").get("clientHeight");aF=x;aJ=aM.hasClass(C)?0:3000;Q.later(aJ,this,function(){if(aK.currentDrawer===aM){aK.closeDrawer(aM);}});if(aM.hasClass(C)){aM.addClass("dn");this.currentItem.removeClass(ae);return aF;}}}aM.transition({height:Y+"px",duration:0.3,easing:"ease-in",on:{start:function(){aK.fire(e,{item:aK.currentItem});},end:function(){aK.fire(ap,{item:aK.currentItem});if(aH){aH.removeClass("dn");}aK.repaint();}}});return aF;},updateBtnText:function(aA,aB){var az=aA.one("i"),Y=af.getString(aB);aA.setHTML(az.get("outerHTML")+Y);},showLoginBtns:function(){if(!this.currentItem||!this.currentDrawer){return;}var az=this.currentItem.hasClass(ai)?af.getString("STR.ACTIONDRAWER.SAVEDCTA"):this.currentItem.hasClass(X)?af.getString("STR.ACTIONDRAWER.LIKEDCTA"):af.getString("STR.ACTIONDRAWER.DISLIKEDCTA"),aC,Y=this.currentDrawer.one(ak),aA,aB=this;if(Y){Y.remove();}Y=this.currentDrawer.appendChild(s.cloneNode(J));if(this.currentItem.hasClass(C)){aC=Y.appendChild(af.getString("STR.ACTIONDRAWER.DONE"));}this.currentDrawer.one(".title").setHTML(az);if(p){this.currentDrawer.one(F).setStyle(ao,al+"px");aA=al+this.currentDrawer.one(".embed").get("clientHeight");if(aC){aA+=(aC.get("clientHeight")+5);}}else{this.currentItem.addClass("y-pattern").addClass("hover");this.currentDrawer.removeClass("dn");aA=this.currentDrawer.one(".embed").get("offsetHeight");}this.currentDrawer.transition({height:aA+"px",duration:0.3,easing:"ease-in",on:{start:function(){aB.fire(e,{item:aB.currentItem});},end:function(){aB.fire(ap,{item:aB.currentItem});aB.repaint();}}});},onLoginBtnClick:function(Y){var aB=Q.merge(aq.getBeaconKeys(this.currentItem),{sec:ar,action:aj}),aA=this.currentItem.getAttribute(c),az;if(this.currentItem.hasClass(X)){az=X;aB.slk="neu-pos";aB.outcome="itemdecl";}else{if(this.currentItem.hasClass(C)){az=C;aB.slk="neu-neg";aB.outcome="itemdecl";}else{if(this.currentItem.hasClass(ai)){az=ai;aB.slk="sv";aB.outcome="svct";}}}N.setItem(D,{type:az,uuid:aA,beacon:aB},am);},onDoneClick:function(Y){aq.fireBeacon({sec:ar,slk:"btn-dn",itc:1,action:aj});this.closeDrawer(this.currentDrawer);},onFilter:function(Y){this.currentItem=W;this.currentDrawer=W;ax=Y.category;this.viewingSavedStories=x;if(ax===aw){g=g.concat(f);f=[];this.viewingSavedStories=J;}},populateHighlineMenu:function(){var aA=this.currentItem.getAttribute("data-highline-id"),az={id:encodeURIComponent(aA)},Y=this.currentDrawer.all("a");Y.each(function(aB){aB.setAttribute("href",Q.Lang.sub(aB.getAttribute("data-base-url"),az));});},onEntityClick:function(aG){var aB=aG.target,aF=aB.ancestor(an,J),az=aF.getAttribute("data-interestid"),aD=aF.hasClass(r)?h.LIKE:aF.hasClass(ay)?h.DISLIKE:h.NEUTRAL,aA=aF.hasClass("inferred")?"inferred":"declared",Y,aC={},aE={};if(this.currentDrawer.hasClass(X)&&!aF.hasClass(r)){aF.addClass(r);aF.removeClass(at).removeClass(ay);Y=h.LIKE;}else{if(this.currentDrawer.hasClass(C)&&!aF.hasClass(ay)){aF.addClass(ay);aF.removeClass(at).removeClass(r);Y=h.DISLIKE;}else{aF.addClass(at);aF.removeClass(r).removeClass(ay);Y=h.NEUTRAL;}}aE={"new":Y.toString(),current:aD.toString(),type:"entity",id:az};this.fire(l,{interestObj:aE,item:this.currentItem,markFeedback:x});aC[az]={"new":Y,current:aD,type:aA};this.makeInterestRequest({_subAction:"int_manage",interest:aC});V.update(az,{state:Y});},toggleDrawer:function(aF,aB){var aD=y.isLoggedIn(),aC="",aG,aE=J,Y,aA,az={sec:ar,itc:1,action:aj};if(this.currentItem&&this.currentItem.hasClass(ae)&&aF!==this.currentItem){this.closeDrawer(this.currentDrawer);}this.currentItem=aF;Y=this.currentItem.getAttribute(c);if(!aB&&this.currentItem&&!this.currentItem.hasClass(ae)){if(p){if(this.viewingSavedStories){aC=af.getString("STR.SAVE.BTN.TEMPLATE");}else{if(aF.hasClass(ag)){aC=af.getString("STR.HIGHLINE.BTN.TEMPLATE");}else{aC=af.getString("STR.SHARE.BTN.TEMPLATE");}}}aG='<li class="action-drawer y-pattern">'+aC+"</li>";this.currentItem.insert(aG,"after");this.currentDrawer=this.currentItem.get("nextSibling");if(p){this.currentDrawer.one(F).removeClass("v-h").removeClass("closed");this.actionBtnListner=this.currentDrawer.delegate(aj,this.onActionDrawerClick,n,this);}if(this.flagContentEnabled){this.flagBtnListner=this.currentDrawer.delegate(aj,this.onFlagContentClick,q,this);this.flagItemListner=this.currentDrawer.delegate("change",this.onFlagItemClick,R+" "+P,this);}this.entityListner=this.currentDrawer.delegate(aj,this.onEntityClick,an,this);this.doneBtnListner=this.currentDrawer.delegate(aj,this.onDoneClick,v,this);aA=Q.Array.indexOf(g.concat(f),Y);if(aA>-1){this.currentItem.addClass(ai);this.currentDrawer.addClass(ai);}if(!this.viewingSavedStories&&(p||aD)){if(p&&this.currentItem.hasClass(ai)){this.updateBtnText(this.currentDrawer.one(G),"STR.SAVE.SAVEDTEXT");}if(this.currentItem.hasClass(X)){this.currentDrawer.addClass(X);if(p){this.updateBtnText(this.currentDrawer.one(I),"STR.INTERESTS.LIKEDTEXT");aE=this.buildEntityList(J);}}if(this.currentItem.hasClass(C)){this.currentDrawer.addClass(C);if(p){this.updateBtnText(this.currentDrawer.one(L),"STR.INTERESTS.DISLIKEDTEXT");aE=this.buildEntityList(J);}this.updateConfirmationMsg(af.getString("STR.ENTITY.LIST.DISLIKED.MSG"));}if(this.currentItem.hasClass(ag)){this.currentDrawer.addClass(ag);this.populateHighlineMenu();}}else{if(!p&&!aD){aE=x;}}if(aE&&p){this.currentDrawer.transition({height:al+"px",duration:0.3,easing:"ease-in"});}this.currentItem.addClass(ae);if(!p){this.currentDrawer.addClass("dn");}az.slk="btn-xpnd";}else{if(!aB&&this.currentItem&&this.currentItem.hasClass(ae)){this.closeDrawer(this.currentDrawer);this.currentDrawer=W;az.slk="btn-clps";if(p){this.actionBtnListner.detach();}this.entityListner.detach();this.doneBtnListner.detach();if(this.flagContentEnabled){this.flagBtnListner.detach();this.flagItemListner.detach();}}}if(p){aq.fireBeacon(az);}},closeDrawer:function(aB){var aC=y.isLoggedIn(),aA=this.currentItem,az=aB.one(v),Y=this;if(az){az.addClass("dn");}if(aA.hasClass(C)){Q.later(300,this,function(){this.fire(B,{item:aA,animate:J});});}if(!aC&&this.currentItem){aA.removeClass(ai).removeClass(X).removeClass(C);}aB.transition({height:"0px",duration:0.3,easing:"ease-in",on:{start:function(){Y.fire(e,{item:aA});},end:function(){Y.fire(ap,{item:aA});aB.remove();aA.removeClass(ae);if(!p){aA.removeClass("y-pattern").removeClass("hover");}Y.repaint();}}});},fireCloseBeacon:function(){var az=aq.getBeaconKeys(this.currentItem),Y=this.currentItem.hasClass(C);if(Y){az=Q.merge(az,{sec:"td-strm-ctrl",slk:"rm",action:aj,outcome:"rmct"});}else{az=Q.merge(az,{sec:"td-strm-rm",slk:"undo",action:aj,outcome:"undo"});}aq.fireBeacon(az);},onActionDrawerClick:function(Y){var aB=Y.target,az=aB.ancestor(w),aA=aB.ancestor(a,J),aC=y.isLoggedIn();Y.preventDefault();if(aA.test(G)){az.toggleClass(ai);this.currentItem.toggleClass(ai);if(aC){this.handleSaveClick(aA);}else{az.removeClass(X).removeClass(C);this.currentItem.removeClass(X).removeClass(C);}}else{if(aA.test(j)){this.handleSaveClick(aA);}else{if(aA.test(I)){az.toggleClass(X);this.currentItem.toggleClass(X);if(aC){this.handleLikeClick(aA);}else{az.removeClass(ai).removeClass(C);this.currentItem.removeClass(ai).removeClass(C);}az.removeClass(C);this.currentItem.removeClass(C);}else{az.toggleClass(C);this.currentItem.toggleClass(C);if(aC){this.handleDislikeClick(aA);}else{az.removeClass(ai).removeClass(X);this.currentItem.removeClass(ai).removeClass(X);}az.removeClass(X);this.currentItem.removeClass(X);this.fireCloseBeacon();}}}if(!aC){if(this.currentDrawer.test(aa)){this.showLoginBtns();}else{this.closeDrawer(this.currentDrawer);}}},onFlagContentClick:function(aE){var aC=aE.target.ancestor(q,J,ac),aA=aC.ancestor(ac),aG=this.currentDrawer.one(".flag-content-form"),aB=aC.one("i"),aD,Y=0,aF=this,az=Q.merge(aq.getBeaconKeys(this.currentItem),{sec:"td-strm-dr",slk:aC.get("text"),elm:"btn",elmt:"flag",itc:1,intl:ad.intl,action:aj});if(aG){aA.removeClass(u);aC.setHTML(af.getString("STR.ACTIONDRAWER.FLAG")+aB.get("outerHTML"));aG.remove();Y=aA.get("offsetHeight")-aG.get("offsetHeight");az.rspns="clps";az.outcome="unflagitm";az.oc="unflagitm";}else{aA.addClass(u);aC.setHTML(af.getString("STR.ACTIONDRAWER.FLAGGED")+aB.get("outerHTML"));aD=af.getString("STR.ACTIONDRAWER.FEEDBACK");if(aD){aG=aC.insert(aD,"after");Y=aA.get("offsetHeight")+(aG?aG.get("offsetHeight"):0);}az.rspns="xpnd";az.outcome="flagitm";az.oc="flagitm";}aq.fireBeacon(az);this.currentDrawer.transition({height:Y+"px",duration:0.3,easing:"ease-in",on:{end:function(){aF.repaint();}}});},onFlagItemClick:function(aA){var aB=aA.target,az=aB.ancestor(R,J,ac),Y=Q.merge(aq.getBeaconKeys(this.currentItem),{sec:"td-strm-dr",slk:az.get("text"),elm:"inpt",elmt:"flag",itc:1,intl:ad.intl,action:aj});if(aB.get(i)){Y.outcome="flagcat";Y.oc="flagcat";}else{Y.outcome="unflagcat";Y.oc="unflagcat";}aq.fireBeacon(Y);},repaint:function(){var Y=this.currentItem?this.currentItem.get("parentNode"):W;if(Q.UA.ie&&Q.UA.ie<8&&Y){Y._node.className=Y._node.className;}},makeSaveRequest:function(aA,Y){var az=0,aB=Z?Z.hasClass(m):J;if(f.length>0&&!aB){az=1;if(Z){Z.addClass(m);}}else{if(f.length===0){az=-1;if(Z){Z.removeClass(m);}}}if(N){N.setItem(z,g.concat(f),au);}af.makeRequest({type:"module",moduleId:T,args:{_action:"save",_subAction:aA,noups:1,uuid:Y,mixerAction:ah,setUDB:az}},{});},makeInterestRequest:function(Y){b.makeRequest({type:"module",moduleId:M,args:Q.merge({_action:"show"},Y)},{});}};Q.augment(A,Q.EventTarget);Q.namespace(U);Q[U][H]={name:"stream_action_drawer",getService:function(az,Y){b=az.getService("transport_helper",Y);af=az.getModuleApi(Y);aq=az.getService("instrumentation");N=az.getService("storage");y=az.getService("userinfo");E=az.getService("login",Y);V=af.getService("interests");ad=af.getContextData();return new A();}};if(d){d.registerService(Q[U][H]);}},"1.0");/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */
var yasearch,fxsearch;(function(){var ay=null,ag=true,M=false,ax="undefined",e="-promotion",ad="-rsch1",I="ymobilizerouter",o="hp-hidden",au="hidden",y="promoCode",aC="hpCode",bb="hpOverlay",b="randomPromo",R="rsch1Successful",bf="forceSethp",v="browser",al="sethpPromoShare",aS="showOnlySetHP",bh="focus",a6="wsid",aR="30345158",u="SP",ar="v=1&a=1",a5="v=1&a=0",X=5,aI=10,aK=5,bg="web",aU="ebay",Z="jobs",aV="mail",aD="combo",d="games",ae="local",aF="music",af="images",l="people",aJ="omg",m="answers",q="shopping",bk="directory",K="innerHTML",n="value",a8="title",c="action",aH="name",a1="text",aj="parentNode",a0="tagName",S="firstChild",N="href",am="height",ap="width",ai="auto",L="disabled",E="paddingLeft",ah="paddingRight",A="data-tab",a4="focus",z="blur",f="submit",bj="mouseover",r="click",be="4em",ak="8em",p="1.6",aM="hide-completely",a3="ds-b",a="open",aB="bottom",T="denabled",aG="uenabled",ab="selected",aN="sa-results",aw="input-x-short",F="input-split-mode",G="menu-select",aL="ghosttext",g=".promo",at=".stabs",J=".more-tab",a7=".input-query",aQ=".search-form",ba=".searchwrapper",bi=".searchwrapper-inner",O=".sa-window",V=".sa-drawer",aE=".sa-results",bl=".aria-announce",W=".tab-cover",k="y-mast-sprite",h="y-mast-link",aP="y-mast-txt",aO="y-mast-bg",av="y-bg-3",az="y-ln-2",j="y-mast-bg-hide",Y="sa-drawer-container",H="hide-lip",s=0,aY=7,aq="px",aW="allow.redirected.ult.links",Q="pa:ready",aZ="search.tab.",ao=".showdrawer",an=".showdrawerhandle",C={kr:ag,jp:ag,tw:ag,cn:ag},D="ulm:defaultlocation",bc="ldw:defaultlocation",a9="pmh:searchtext",aX="pmh:show",ac="sayt:open",bd="sayt:close",aT="mh:web_srch_inp",U="mh:tab_select",P="AREA",B=150,i=1000,x=100,w="interactive",a2="srch-pl",aa="srch-pl-s",t="srch-plu",bm="srch-plu-s",aA="$q";YModules.type_masthead={id:"",body:ay,moduleapi:ay,platform:ay,instrumentation:ay,tablistService:ay,tablist:ay,autoHide:ay,autoHideId:ay,paService:ay,viewevents:[r,"keyup"],formData:ay,dummyYLT:ay,ywaObject:ay,YWATracker:ay,textboxBlurred:ay,saConfig:{enabled:ag,minQueryLength:0,queryDelay:0,containerOpen:M,timeoutId:ay,abortId:ay,cachedResults:ay,delayedRequests:0,numResults:0,normalizationRules:ay,isAutoOpen:M,isManualOpen:M,selectedIndex:-1,lastAnimHeight:0,lastVisibleItem:0,connectionPriming:{enabled:M,throttleRate:15000,beacon:null,beaconFunc:null}},currentTab:"",form:ay,textbox:ay,hood:ay,saWindow:ay,saDrawer:ay,saResults:ay,searchwrapperInner:ay,searchwrapper:ay,aria:ay,secondInput:ay,hiddenInputNodes:ay,suggestions:ay,searchQuery:"",lastSearchQuery:"",lastQueryLength:0,defLoc:"",currentSelectedListItem:ay,menu:ay,useFxjsonp:M,keyUpSupported:ag,handleKeyUpObject:ay,allowRedirectedULTLinks:ag,ebayInputField:ay,numberOfVisibleItems:X,horizontalPadding:"0",moreLink:ay,displayNameInMoreDropDown:M,cmsLogo:ay,logoContainer:ay,trendData:ay,numCycles:0,ghostTextIndex:0,ghostTextCharPosition:1,ghostTextId:ay,restartId:ay,uraPromo:ay,usingDoubleByte:M,ywaTrackingEnabled:0,setHomepageService:ay,browser:"",autoHideService:ay,compactFilter:false,compactDimensions:{},adPromoNodeHack:false,search_focused:false,search_wrapper:ay,blur_interval:1000,blur_timer:ay,init:function(br){this.Y=br.getService("yui");this.moduleapi=br;this.currentTab=br.getContextData("FIRST_TAB_FOR_SEARCH")?br.getContextData("FIRST_TAB_FOR_SEARCH"):bg;this.hiddenInputNodes=[];this.id=br.getId();this.platform=br.getService("moduleplatform");this.instrumentation=br.getService("instrumentation");this.tablistService=br.getService("tablist");this.defLoc=br.getContextData("defLoc");this.preloadSRP=br.getContextData("preloadSRP")?ag:M;this.srpAssetURL=br.getContextData("srpAssetURL");this.ywaTrackingEnabled=parseInt(br.getContextData("ywaTrackingEnabled"),10);this.setHomepageService=br.getService("sethomepage");this.browser=br.getContextData(v);this.autoHideService=br.getService("autohide");this.compactFilter=br.getContextData("search.filter.compact.enabled")?!!br.getContextData("search.filter.compact.enabled"):false;this.adPromoNodeHack=br.getContextData("adPromoNodeHack")?!!br.getContextData("adPromoNodeHack"):false;this.saConfig.connectionPriming.enabled=br.getContextData("sayt.connection.priming")?!!br.getContextData("sayt.connection.priming"):false;if(br.getContextData("visibleItems")){this.saConfig.lastVisibleItem=this.numberOfVisibleItems=parseInt(br.getContextData("visibleItems"),10);this.saConfig.lastVisibleItem--;}var bo=br.getContextData("saData"),bt=bo.cssSAWindowMaxHeightIE6,bs=br.getContextData("horizontalPadding"),bu=bo.cssSAWindowSuggestionHeightIE6,bn,bq,bp;this.horizontalPadding=bs?bs:"0";if(bt&&bt.length>0){ak=bt;}if(bu&&bu.length>0){p=bu;}this.formData=br.getContextData("formData");br.listen(D);br.listen(bc);br.listen(Q);bn=br.getProperty("channels");if(bn){bq=bn.length;for(bp=0;bp<bq;bp++){br.listen(bn[bp]);}}br.listen(aX);br.listen(a9);},onviewload:function(bJ){if(bJ==="default"){var bO=this.platform,bP=this.moduleapi,bq=this.Y,bH=this.id,bF,br,bI,bo,by,bL,bn,bC,bx,bw,bM,bB=bP.getViewNode(bJ),bs=bq.one(".logo-container"),bt,bA=bP.getContextData("adLogoMeta"),bK=bP.getContextData("searchIntl")?bP.getContextData("searchIntl").toLowerCase():ay,bE=bP.getContextData("moremenu"),bp=this.trendData=bP.getContextData("trendData"),bN,bv,bz,bD=true,bG,bu;bF=bB.getById(bH+e);by=bP.getContextData(R);bx=bP.getContextData(bf);bo=bP.getContextData(b);bw=bP.getContextData(al);bM=bP.getContextData(aS);if(!by){bn=bP.getContextData("rsch1Suid");if(bn){bC=bO.queryModules(function(bR){var bQ=bO.getModuleApi(bR);return bQ?bQ.getProperty("contentId")==bn:false;})[0];if(bC){bO.stop(bC);bO.unregisterModule(bC);}bL=bB.getById(bn+ad);if(bL){bL.remove();}}bt=bs.one("object")||bs.one("embed");if(bF&&!bt){bI=!this.setHomepageService.isHomepageSet()&&!this.isHpWindowShade();if(bx||(bI&&(!bo||Math.random()>bw))){br=aC;}else{if(bM===1){bD=false;}br=y;}if(bD){bF.set(K,bP.getContextData(br));bF.removeClass(o);bF.removeClass("rsch");}}}else{bt=bs.one("object")||bs.one("embed");if(bt){bL=bB.getById(bn+ad);if(bL){bL.addClass("rsch");}}}this.usingDoubleByte=C[bK]?ag:M;this.displayNameInMoreDropDown=bP.getContextData("search.more.firstitem")?ag:M;this.allowRedirectedULTLinks=bP.getContextData(aW);this.useFxjsonp=bP.getContextData("use.fxjsonp")?ag:M;this.keyUpSupported=(bq.UA.gecko&&C[bK])?M:ag;if(bA){bO.registerModule(bA);bO.start(bA.props.id,M,ag);}this.body=bB;this.form=bB.one(aQ);bG=this.textbox=bB.one(a7);this.searchwrapper=bB.one(ba);this.searchwrapperInner=bB.one(bi);this.aria=bB.one(bl);bz=bB.one(at);this.uraPromo=bB.one(g);if(bG.hasClass("ime-enabled")){bG.removeClass("ime-enabled");}this.tablist=this.tablistService.create(bz,{panel:this.searchwrapper,tabchange:"click"});this.tablist.subscribe("tabchange",this.switchSearchTab,this,ag);this.initSA();if(bE){this.moreLink=bB.one(".more");bN=this.moduleapi.getService("menu");bv=bB.create(bE);if(bz){bz.get("parentNode").insert(bv,bz);this.menu=bN.create(bv,{focusNode:this.textbox,compactFilter:this.compactFilter});this.menu.subscribe("execute",this.moreMenuSelect,this);this.menu.subscribe("show",this.moreMenuShow,this);this.menu.subscribe("hide",this.unselectMoreTab,this);this.moreLink.on("click",this.handleMoreMenu,this);bG.on(a4,this.hideMoreMenu,this);}}this.form.on(f,this.handleSubmit,this);this.form.on(a4,this.handleFocus,this);this.form.on(z,this.handleBlur,this);this.search_wrapper=bB.one(".searchwrapper-border");bG.on(z,this.handleTextBlur,this);bG.on(a4,this.handleTextFocus,this);this.registerAutoHide();this.dummyYLT=bP.getContextData("dummyYLT");if(!this.keyUpSupported){bG.on(a4,this.handleFFDoubleByte,this);bG.on(z,this.clearFFDoubleByte,this);}this.logoContainer=bB.one(".logo-container");if(bp){bG.blur();bG.on(a4,this.cancelGhostWriting,this,aL);this.numCycles=bP.getContextData("numCycles");this.ghostTextId=bq.later(B,this,this.ghostWrite,bp,true);}if(bq.UA.webkit){}if(this.adPromoNodeHack){bu=bq.one("#p_13838465-promotion");bu.addClass("ad-promo-hack");if(bu){bu.appendTo(bq.one("body"));}}}},handleFocus:function(bo){var bn=this.blur_interval;this.search_focused=true;if(this.search_wrapper){this.search_wrapper.addClass(bh);if(this.blur_timer){this.blur_timer.cancel();}this.blur_timer=this.Y.later(bn,this,function(){this.search_focused=false;},false);}},handleBlur:function(bn){if(this.search_wrapper&&!this.search_focused){this.search_wrapper.removeClass(bh);}},isHpWindowShade:function(){var bn=M,bp,bo=this.moduleapi.getService("statemgr");if(bo){bp=bo.getUserPageState(a6);if(bp==aR){bn=ag;bo.removeUserPageState(a6);}}return bn;},setMobilizer:function(){var bo="100%",bs=document.documentElement.clientHeight+"px",bq=document.body.scrollTop||document.documentElement.scrollTop,br=document.createElement("iframe"),bp="99999",bn=this.moduleapi.getContextData("locale"),bt=this.moduleapi.getContextData("mobilizerUrl");if(document.getElementById(I)){document.body.removeChild(document.getElementById(I));}br.src=bt+"&lang="+bn;br.setAttribute("id",I);br.setAttribute("name",I);br.setAttribute("allowTransparency","allowTransparency");br.setAttribute("frameborder",0);br.setAttribute("scrolling","no");br.setAttribute("width",bo);br.setAttribute("height",bs);br.style.position="absolute";br.style.left="0px";br.style.top=bq+"px";br.style.zoom="1";br.style.zIndex=bp;br.style.overflow="hidden";br.setAttribute("style","z-index:"+bp+";position:absolute;top:"+bq+"px;left:0px;width:"+bo+";height:"+bs+";");document.body.appendChild(br);if(typeof window.addEventListener!=ax){window.addEventListener("message",this.closeMobilizer,M);}else{if(typeof window.attachEvent!=ax){window.attachEvent("onmessage",this.closeMobilizer);}}},closeMobilizer:function(bn){if(bn.data=="closeYMBZ"){if(document.getElementById(I)){document.body.removeChild(document.getElementById(I));}}},setHomePage:function(){var bq,bw=this.setHomepageService,bs=this.moduleapi,bo,bt,bp,br=this.body,bn=this.id,bv=bs.getContextData(bb),bx=bs.getContextData("ilc"),bu;if(this.browser=="IE"){if(bw.setIEHomepage(bx)){bp=bs.getContextData(y);if(bp!==""&&bp!==ay){bq=document.getElementById(this.id+e);bq.innerHTML=bp;}else{bt=br.getById(bn+e);bt.get(aj).removeChild(bt);}bo=bs.getString("PARAM.NAVBAR.IE.YES_BEACON");}else{bo=bs.getString("PARAM.NAVBAR.IE.NO_BEACON");}this.instrumentation.fireUltBeacon(bo);}else{if(this.Y.Array.indexOf(["FF","WK","OP","CH"],this.browser)>-1){bt=br.getById(bn+e);if(br.getById(bn+"-set-homepage-overlay")==ay){bt.append(bv);}this.overlay=br.getById(bn+"-set-homepage-overlay");if(this.overlay){this.autohideId=this.autoHideService.register({targets:[this.overlay,bt],hide:this.Y.bind(function(){this.hideOverlay();},this)});bu=br.getById(bn+"-sethp-ff");if(bu){bu.on("mousedown",this.fireFFBeacon,this);bu.on("click",this.yBangClick,this);}this.overlay.removeClass(au);}}else{bw.setHpCookie(bx,"1");}}},hideOverlay:function(){this.overlay.addClass(au);},fireFFBeacon:function(){var bp=this.setHomepageService,bo=this.moduleapi,bn=bo.getString("PARAM.NAVBAR.DRAG.BEACON");this.instrumentation.fireUltBeacon(bn);bp.setHpCookie(bo.getContextData("ilc"),"1");},ghostWrite:function(bp){var bs="",bo=this.textbox,bq=arguments.length,bu=this.ghostTextIndex,bn=this.ghostTextCharPosition,br,bt;if(this.ghostTextIndex>=bq){bt=--this.numCycles;this.ghostTextIndex=this.ghostTextCharPosition=0;if(bt===0){this.cancelGhostWriting(ay,aL);}}else{br=arguments[bu].text;if(br&&bn<br.length+1){bs=br.substring(0,this.ghostTextCharPosition++);bo.set(n,bs).addClass(aL);}else{this.ghostTextIndex++;this.ghostTextCharPosition=0;this.cancelGhostWriting();this.restartId=this.Y.later(i,this,this.restartGhostText);}}},restartGhostText:function(){this.ghostTextId=this.Y.later(B,this,this.ghostWrite,this.trendData,true);},cancelGhostWriting:function(bp,bo){var bq=this.ghostTextId,bn=this.restartId;if(bq||bn){if(bq){bq.cancel();bq=ay;}if(bn){bn.cancel();bn=ay;}if(bo){this.textbox.removeClass(bo);}}},initSA:function(){var bp=this.moduleapi,bn=this.saConfig,bo=bp.getContextData("saData");bn.minQueryLength=bo.minQueryLength;bn.queryDelay=bo.queryDelay;bn.normalizationRules=bo.normalizationRules;bn.lastVisibleItem=this.numberOfVisibleItems-1;bn.cachedResults={};bn.cachedResults[bg]={};bn.cachedResults[aD]={};bn.cachedResults[af]={};if(this.Y.Cookie.get(u)===a5){bn.enabled=M;}yasearch=fxsearch=this.Y.bind(function(bq){this.handleSearch(bq);},this);this.createDropdown();},onviewunload:function(bp){var bn=this.textbox,bo=this.ghostWriteId;if(bo){bo.cancel();this.ghostWriteId=ay;}this.closeDropdown();if(this.currentTab===aU){bn.set(L,ag);}this.unregisterAutoHide();this.form.detach(f,this.handleSubmit);this.form.detach(a4,this.handleFocus);this.form.detach(z,this.handleBlur);bn.detach(z,this.handleTextBlur);if(!this.keyUpSupported){bn.detach(a4,this.handleFFDoubleByte);bn.detach(z,this.clearFFDoubleByte);}if(this.trendData){bn.detach(a4,this.cancelGhostWriting);}if(this.menu){this.moreLink.detach("click",this.handleMoreMenu);this.menu.destroy();bn.detach(a4,this.hideMoreMenu);}this.clearFFDoubleByte();this.tablist.destroy();this.tablist=this.body=this.menu=this.paService=this.textbox=this.form=this.searchwrapper=this.searchwrapperInner=this.aria=this.hood=this.saWindow=this.saDrawer=this.secondInput=this.hiddenInputNodes=this.restartId=this.ghostTextId=this.logoContainer=this.trendData=this.formData=this.saConfig=ay;},registerAutoHide:function(){var bq=this.id,bo=this.body,bp=this.Y,bn=this.moduleapi.getService("autohide");this.autoHideId=bn.register({targets:[this.hood,this.textbox,bo.getById(bq+"-masthead-stabs")],hide:bp.bind(this.closeDropdown,this)});this.autoHide=bn;},unregisterAutoHide:function(){var bn=this.autoHide;if(bn){bn.unregister(this.autoHideId);}},createDropdown:function(){var bn=this.body,bp,bq,bo;bp=bn.one(".hood");bq=bp.one(O);bo=bp.one(V);this.hood=bp;this.saWindow=bq;this.saDrawer=bo;},openDropdown:function(){var bo=this.saConfig,bn=this.body,bq=this.saWindow,bs,br=this.moduleapi,bp=bn.one(".search-promo"),bt=this.Y;br.broadcast(ac);br.broadcast(w);if(bo.isAutoOpen===ag){this.instrumentation.fireUltBeacon(this.formData[this.currentTab].bcnAutoOpen);bo.isAutoOpen=M;}if(bt.UA.ie===6&&bo.containerOpen===M){this.syncDropdown();}this.saDrawer.set("innerHTML",br.getString("STR.SA.TOGGLE.OFF"));bo.selectedIndex=-1;this.hood.addClass(a);bs=bq.get("offsetHeight");if(bs>bo.lastAnimHeight&&bo.containerOpen===M){bq.setStyle(am,"0");bq.transition({height:bs+"px",easing:"ease-out",duration:parseFloat(br.getContextData("saData").openAnimDuration)},this.Y.bind(this.afterDropdownOpened,this));bo.lastAnimHeight=bs;}bo.containerOpen=ag;this.textbox.set(a8,br.getString("STR.SA.DROPDOWN.DESCRIPTION")).focus();bn.one(ba+" .rc-bl").addClass(aM);bn.one(ba+" .rc-br").addClass(aM);if(bp){if(bt.UA.ie&&bt.UA.ie<8){bp.addClass(aM);}else{bt.Node.getDOMNode(bp).style.zIndex=0;}}},closeDropdown:function(bo){var bn=this.moduleapi;if(this.hood.hasClass("open")){this.saWindow.transition({height:0,easing:"ease-in",duration:parseFloat(bn.getContextData("saData").closeAnimDuration)},this.Y.bind(this.afterCloseDropdown,this,bo?true:false));}},afterDropdownOpened:function(){var bn=this.saWindow,bo=bn.get("offsetHeight");if(this.Y.UA.ie!==6){bn.setStyle(am,ai);}else{bn.setStyle(am,bo+"px");}},afterCloseDropdown:function(bu){var br=this.hood,bo=this.saConfig,bp=this.textbox,bn=this.body,bs=this.moduleapi,bt=this.Y,bq=bn.one(".search-promo");this.moduleapi.broadcast(bd);this.saDrawer.set("innerHTML",bs.getString("STR.SA.TOGGLE.ON"));this.saWindow.setStyle(am,ai);bo.lastAnimHeight=0;bo.lastVisibleItem=this.numberOfVisibleItems-1;br.removeClass(a);bo.containerOpen=M;bp.set(a8,this.formData[this.currentTab].button);if(!bu){bp.focus();if(!this.usingDoubleByte){bp.set(n,bp.get(n));}}bn.one(ba+" .rc-bl").removeClass(aM);bn.one(ba+" .rc-br").removeClass(aM);br.detach(bj,this.handleMouseover);if(bt.UA.ie===6){document.getElementById(this.id+"-hood").style.width="";br.addClass(a3);}if(bq){if(bt.UA.ie&&bt.UA.ie<8){bq.removeClass(aM);}else{bt.Node.getDOMNode(bq).style.zIndex=6;}}this.saConfig.selectedIndex=-1;bs.broadcast(aT,bp.get(n));},syncDropdown:function(){var br=this.saWindow,bp=this.searchwrapperInner,bo=this.hood,bs,bn,bq=this.saConfig.numResults;bs=parseFloat(bp.get("offsetWidth"))+2+aq;bo.removeClass(a3);bo.setStyle(ap,bs);if(!this.suggestions){bn=be;}else{if(bq>this.numberOfVisibleItems){bn=ak;}else{bn=p*bq+0.4+"em";}}br.setStyle(am,bn);},highlightItem:function(br,bq,bp,bs){var bo=br.item(bq),bt=bo.get("parentNode"),bn=this.currentSelectedListItem;if(bn){bn.removeClass(ab);}br.removeClass(ab);bo.addClass(ab);bt.addClass(ab);this.currentSelectedListItem=bt;if(!bp){this.textbox.set(n,bo.get(a1));}},scroll:function(){var bt,br=this.saConfig,bu=this.body,bn=this.id,bw=br.lastVisibleItem+1,bp=bw-this.numberOfVisibleItems>0?bw-this.numberOfVisibleItems:0,bq=bu.getById(bn+"-arr-up"),bo=bu.getById(bn+"-arr-down"),bs=bu.getById(bn+"-results"),bv=this.moduleapi,bx=bv.getContextData("saData").cssFontSizeSAYT;if(bx&&bx.length>0){bx=aN+" "+bx;}else{bx=aN;}bs.set("className",bx);bp=bp>bw?bw:bp;if(br.selectedIndex>=bw){bp++;}bs.addClass(bw>this.numberOfVisibleItems?aB+bp:"");if(bq){bt=this.numberOfVisibleItems-bw;if(bt===0||bt===1){bq.removeClass(aG);}else{bq.addClass(aG);}}if(bo){if(br.numResults-bw===0){bo.removeClass(T);}else{bo.addClass(T);}}},scrollSelection:function(bq,bp){var bn=this.saConfig,br=this.numberOfVisibleItems,bo;if(bp){bq=--bq;}bo=br-(aI-1-bq);if(bn.numResults>bn.lastVisibleItem){if(bo<0){bn.lastVisibleItem=br-1;}else{if(bo+br<=aI){bn.lastVisibleItem=bo+br-1;}else{if(bn.lastVisibleItem<br){bn.lastVisibleItem++;}}}if(bn.numResults>br){this.scroll();}}else{if(bp){bn.lastVisibleItem--;}}},moveSelectionDown:function(){var bn=this.saConfig,bp=bn.selectedIndex,bo=this.suggestions;if(bo&&bo.size()>0){if(bp<bn.numResults-1){bo.removeClass(ab);this.highlightItem(bo,++bn.selectedIndex,M);this.scrollSelection(bp);}}},moveSelectionUp:function(){var bn=this.saConfig,bp=bn.selectedIndex,bo=this.suggestions;if(bp!==-1){bo.removeClass(ab);if(bp===0){this.textbox.set(n,this.lastSearchQuery);bn.selectedIndex=-1;}else{this.highlightItem(bo,bn.selectedIndex===0?0:--bn.selectedIndex,M,ag);this.scrollSelection(bp,ag);}}},updateNameAttribute:function(bp){var bo=this.textbox,bn=this.formData[bp].paramQuery;if(!bn){bn=bp===aV?"s":"p";}bo.setAttribute(aH,bn);},setSecondInput:function(){var bu=this.moduleapi,bt=this.body,bw=this.textbox,bs=this.secondInput,bv=M,bo=this.currentTab,bp=this.formData[bo],by,br,bx,bn,bq;this.removeHiddenInputFields();bn=this.hiddenInputNodes;switch(bo){case ae:bv=ag;case Z:if(!bs){bx=bt.one(".input-query");bq=bx.get(aj);bs=bq.create(bu.getContextData("HTML_SECONDINPUT"));bx.insert(bs,"after");br=bq.create(bu.getContextData("HTML_SECONDLABEL"));bx.insert(br,"after");bw.addClass(aw);bw.addClass(F);}bw.set(aH,bp.paramQuery);bs.set(aH,bp.paramLocation);by=(bv&&this.defLoc)?this.defLoc:bp.locationGhostText;bs.setAttribute(n,by);bs.on(z,this.blurText,this);this.secondInput=bs;break;case aF:if(bp.param1Name&&bp.param1Value){bn[0]=this.createHiddenInputFieldForTab(bp.param1Name,bp.param1Value);}if(bs){this.secondInput=ay;bs.detach(z,this.blurText);br=bs.previous();br.get(aj).removeChild(br);bs.get(aj).removeChild(bs);bw.removeClass(aw);}break;case d:if(bp.vsValue){bn[0]=this.createHiddenInputFieldForTab("vs",bp.vsValue);}if(bs){this.secondInput=ay;bs.detach(z,this.blurText);br=bs.previous();br.get(aj).removeChild(br);bs.get(aj).removeChild(bs);bw.removeClass(aw);}break;case l:if(bp.vfValue&&bp.vsValue){bn[0]=this.createHiddenInputFieldForTab("vf",bp.vfValue);bn[1]=this.createHiddenInputFieldForTab("vs",bp.vsValue);}if(bs){this.secondInput=ay;bs.detach(z,this.blurText);br=bs.previous();br.get(aj).removeChild(br);bs.get(aj).removeChild(bs);bw.removeClass(aw);}break;default:if(bs){this.secondInput=ay;bs.detach(z,this.blurText);br=bs.previous();br.get(aj).removeChild(br);bs.get(aj).removeChild(bs);bw.removeClass(aw);bw.removeClass(F);}break;}},blurText:function(bn){var bo=bn.target;if(bo.get(n)===""){bo.set(n,bo.get("defaultValue"));}},resetSA:function(){var bo=this.saConfig,bn,bp=bo.containerOpen;this.suggestions=ay;if(bo.enabled===ag){bo.lastVisibleItem=this.numberOfVisibleItems-1;bo.numResults=0;bo.selectedIndex=-1;bo.isAutoOpen=M;bo.isManualOpen=M;bo.containerOpen=M;bn=this.body.getById(this.id+"-sa-info");if(bn){bn.setAttribute(N,this.formData[this.currentTab].yltInfoPage);}}if(bp){this.Y.later(150,this,this.resetHood);}else{this.resetHood();}},resetHood:function(){this.saWindow.set(K,this.moduleapi.getContextData(this.saConfig.enabled?"HTML_HOODCONTENT_ENABLED":"HTML_HOODCONTENT_DISABLED"));if(this.moduleapi.getContextData(aZ+this.currentTab+an)){this.saDrawer.removeClass(aM);}},hideSA:function(){this.saDrawer.addClass(aM);},fireYodelBeacon:function(){var bn={sec:"ylogo",slk:"yodel",ltxt:"yodel",pos:0,own:"Y",ld:0,itc:1};this.instrumentation.fireUltBeacon(bn);},handleMouseover:function(bu){var bv=bu.target,bs,bq,bw,bn,br,bt=this.body.getById(this.id+"-results"),bp=this.suggestions,bo=bv.get(a0);if(bp){if((bo==="A"||bo==="STRONG")&&bt.contains(bv)){bn=bp.size();if(bo==="A"){bw=bv.get("id");bq=bv.get(a1);}else{bq=bv.get(aj).get(a1);}for(br=0;br<bn;br++){bs=bp.item(br);if(bw){if(bw==bs.get("id")&&bq===bv.get(aj).get(a1)){this.highlightItem(bp,br,ag);break;}}else{if(bq===bs.get(a1)){this.highlightItem(bp,br,ag);break;}}}}else{bp.removeClass(ab);}}},switchSearchTab:function(bE){var bo=this.moduleapi,bn=this.saConfig,bF=this.uraPromo,bt=this.body,bA=this.tablist,bz=this.textbox,bx=bA.getTabNode(bE.fromIndex),bp=bx.get(S),bq=bp.get(S),bD=bA.getTabNode(bE.toIndex),bu=bD.get(S),br=bu.get(S),bB=this.Y.Lang.trim(bu.getAttribute(A)),bC=this.formData[bB],bv=bo.getContextData(aZ+bB+ao),by=bo.getContextData(aZ+bB+an),bw=this.saDrawer.get("parentNode").hasClass(Y)?this.saDrawer.get("parentNode"):ay,bs=bt.getById("search-submit");if(bn.containerOpen){this.closeDropdown();}if(bn.abortId){this.Y.Get.abort(bn.abortId);}this.currentTab=bB;bo.broadcast(U,{clickedTab:bB,buttonName:bC.button});bo.broadcast(aT,bz.get(n));bx.removeClass(k);bp.removeClass(k).addClass(h).removeClass(aP);bq.removeClass(aO).addClass(j);bD.addClass(k);bu.addClass(k).addClass(aP).removeClass(h);br.addClass(aO).removeClass(j);if(bv&&by){this.resetSA();}if(bB===bg){if(bF){bF.removeClass(aM);}}else{if(bF){bF.addClass(aM);}}switch(bB){case af:if(!bv){this.hideSA();bn.selectedIndex=-1;}break;case m:case bk:case aJ:case q:default:this.hideSA();bn.selectedIndex=-1;break;}if(bw){if(bB===aD||bB===bg||bB===af){if(bw.hasClass(H)){bw.removeClass(H);}}else{if(!bw.hasClass(H)){bw.addClass(H);}}}bt.getById(this.id+"-aria-label").set(K,bB);this.setSecondInput();this.updateNameAttribute(bB);bs.set(n,bC.button);if(!this.compactFilter){bs.set(K,bC.button);}bz.set(a8,bC.button);if(bC.noQueryURL){this.updateLandingPage();}else{this.form.setAttribute(c,bC.action);}},handleMoreMenu:function(bs){var br=bs.target.ancestor("li").one("a"),bp=br.ancestor("#masthead"),bq=br.get("region"),bn=bp.get("region"),bo={top:Math.floor(bq.bottom-bn.top),left:bq.left-bn.left-8};this.closeDropdown(ag);bs.preventDefault();this.menu.show(bo);},moreMenuShow:function(bo){var bn=this.moreLink.ancestor("li");bn.addClass(av);bn.addClass(az);bn.addClass(G);},unselectMoreTab:function(bo){var bn=this.moreLink.ancestor("li");bn.removeClass(av);bn.removeClass(az);bn.removeClass(G);},hideMoreMenu:function(bn){this.menu.hide(M);this.unselectMoreTab();},isYHSAction:function(){var bn=this.form.getAttribute(c);return(bn.indexOf("="+aA)!==-1&&window.location.search.indexOf("yhs")!==-1);},submitYHS:function(br,bq,bp){var bs,bo,bn;this.Y.all(".srch-hidden").set(L,true);this.Y.use("querystring-parse",function(bt){bs=br.substr((br.indexOf("?")+1),(br.length-1));bo=bt.QueryString.parse(bs);bt.each(bo,function(bv,bu){if(bv===aA){bq.one(".input-query").setAttribute("name",bu);}else{bn=bt.Node.create('<input type="hidden">');bn.setAttribute("name",bu);bn.setAttribute("value",bv);bq.append(bn);}});bq.set("action",br);bq.submit();});},moreMenuSelect:function(bG){var bn,bv,bE,bI,bC=this.tablist,bD=this.moreLink,bH=bC.getTabNodes().size()-1,bw=bG.relatedTarget,bo=bw.get(S),bz=bo.cloneNode(true),bM=bz.one(W),bp=bo.getAttribute(A),bA=bC.getTabNode(bH),br=bA.get(S),bJ=this.horizontalPadding,bK=null,bL=null,bt=null,bq=null,by=0,bs=0,bB=null,bx=null,bF=null;bE=this.formData[bp];if(bE.noQueryURL){this.updateLandingPage();}else{this.form.setAttribute(c,bE.action);}if(bM){bM.setStyle(E,bJ);bM.setStyle(ah,bJ);}if(bw.hasClass("link")){this.moduleapi.navigate(bo.getAttribute("href"));return;}if(this.compactFilter){bq=this.Y.one(".stabs");bK=this.Y.one(".more-tab");bL=this.Y.one(".input-long");if(this.compactDimensions.input_width===undefined){this.compactDimensions.input_width=bL.get("offsetWidth");this.compactDimensions.input_padding=bL.getStyle("padding-right");this.compactDimensions.current_more_width=this.compactDimensions.more_width=bq.get("offsetWidth");this.compactDimensions.stable_width=this.compactDimensions.input_width+s-aY;this.compactDimensions.wasMultiInputMode=false;}}br.replace(bz);if(bC.getSelectedIndex()===bH){bv={toIndex:bH,fromIndex:bH};this.switchSearchTab(bv);}else{bC.switchTo(bH);}if(this.displayNameInMoreDropDown){bD.setAttribute(N,bo.getAttribute(N));bD.setAttribute("data-b",bo.getAttribute("data-b"));bD.setAttribute(A,bp);bI=bo.one(W);bn=bI?bI.get(K):ay;if(bn){bI=bD.one(W);if(bI){bI.set(K,bn);}}}if(this.compactFilter){bK.one(".tab-cover").set(K,bM.getContent());if(this.Y.one(".ua-ie")){try{bB=document.createTextNode(" ");bx=bK.getDOMNode();bx.appendChild(bB);bx.removeChild(bB);bF=bx.up("ul");bF.appendChild(bB);bF.removeChild(bB);}catch(bu){}}bs=bq.get("offsetWidth");bt=bL.getDOMNode();if(this.formData[this.currentTab]&&this.formData[this.currentTab].clickBeacon){this.instrumentation.fireUltBeacon(this.formData[this.currentTab].clickBeacon);}if(this.currentTab===ae){this.compactDimensions.wasMultiInputMode=true;}else{if(this.compactDimensions.wasMultiInputMode||bs!==this.compactDimensions.current_more_width){by=this.compactDimensions.stable_width-(bs+s);if(this.Y.one(".ua-ie7")){bt.style.cssText="width: "+parseInt(by+60,10)+"px";}else{bt.setAttribute("style","width: "+parseInt(by+60,10)+"px");}this.compactDimensions.current_more_width=bs;this.compactDimensions.wasMultiInputMode=false;}}if(bL.get("value")===""){bL.set("value"," ");bL.set("value","");}else{bL.set("value",bL.get("value"));}}this.textbox.focus();},onviewevent:function(by,bE){if(by==="default"){var bu=this.instrumentation,bt=this.body,bx=this.id,bC,bG=this.saResults,bB=this.currentTab,bA=this.formData[bB],bn=this.saConfig,bw=this.textbox,br=this.secondInput,bD=bw.get(n),bp,bq,bH=bE.target,bv=bE.type,bs="",bo=this.trendData,bF=bt.one(J),bz=(bH===bw);this.searchQuery=bD;if(bz){this.moduleapi.broadcast(w);}if(bv==="keyup"&&bz){this.handleKeyUp(bE.keyCode);}else{if(bv===r){bq=bt.one(at);if(bq&&bq.contains(bH)){if(!bF||!bF.contains(bH)){bw.focus();if(this.Y.UA.ie===8){bw.set(n,bD);}}}if(this.search_wrapper){this.search_wrapper.addClass(bh);}bs=bH.get("id");bp=bH.get(a0);if(bp&&bp===P){this.fireYodelBeacon();}if(bs){if(this.hood.contains(bH)&&bH.get(a0)==="A"&&bH.getAttribute(N).indexOf("ylt")===-1){bE.preventDefault();switch(bs){case (bx+"-arr-up"):bu.fireUltBeacon(bA.bcnScroll);if(bH.hasClass(aG)){bn.lastVisibleItem--;this.scroll();}break;case (bx+"-arr-down"):bu.fireUltBeacon(bA.bcnScroll);if(bH.hasClass(T)){bn.lastVisibleItem++;this.scroll();}break;case (bx+"-sa-drawer"):if(bn.containerOpen===ag){bu.fireUltBeacon(bA.bcnDrawerClose);this.closeDropdown();}else{bu.fireUltBeacon(bA.bcnDrawerOpen);this.manualOpenDropdown();}break;case (bx+"-onswitch"):case (bx+"-sa-hintswitch"):this.toggleSA(true);break;case (bx+"-offswitch"):this.toggleSA(false);break;default:break;}}else{switch(bs){case (bx+"-location"):if(br.get(n)===bA.locationGhostText){br.set(n,"");}break;case bx+"-homepage":if(this.Y.Array.indexOf(["IE","FF","WK","OP","CH"],this.browser)>-1){bE.preventDefault();}this.setHomePage();break;case bx+"-close-overlay":bE.preventDefault();this.hideOverlay();break;case bx+"-mobilizer":bE.preventDefault();this.setMobilizer();break;default:break;}}}else{if(bo){bE.preventDefault();if(!bG){bG=this.saResults=bt.one(aE);}if(bG&&bG.contains(bH)){this.beaconPreloadedSearch(bw.get(n),ag);bC=bH.get(N);if(!bC){bC=bH.ancestor("A").get(N);}this.moduleapi.navigate(bC);}}}}}}},primeSearch:function(){var bn=this.saConfig.connectionPriming;if(bn.enabled){if(bn.beaconFunc===null){this.Y.use("yui-throttle",this.Y.bind(function(bo){bn.beaconFunc=bo.throttle(bo.bind(this.primeSearchConnection,this),bn.throttleRate);this.primeSearchConnection();},this));}else{bn.beaconFunc();}}},primeSearchConnection:function(){var bn=this.saConfig.connectionPriming,bo=new Date();bn.beacon=null;bn.beacon=new Image();bn.beacon.src="http://search.yahoo.com/beacon/tpc.gif?"+bo.getTime();},handleKeyUp:function(bv){var bt=this.aria,bq=this.moduleapi,bp=this.saConfig,bn=this.currentTab,bu=this.searchQuery,br=bu.length,bo=this.lastQueryLength,bs=this.srpAssetURL;this.updateLandingPage();if(this.preloadSRP&&bs){this.Y.Get.script(bs,{onSuccess:function(){this.preloadSRP=false;},context:this});}if(bn===aD||bn===bg||(bn===af&&(bq.getContextData(aZ+this.currentTab+ao)))){if(this.keyUpSupported){bu=this.textbox.get(n);br=bu.length;if(bv==8){if(br>bp.minQueryLength&&bp.enabled){if((bu&&br>0)&&bu!=this.lastSearchQuery){this.sendQuery();}}else{this.closeDropdown();}}}switch(bv){case 13:break;case 27:if(bp.containerOpen===ag){this.closeDropdown();}break;case 37:case 39:break;case 38:if(bp.enabled===ag&&bp.containerOpen===ag){this.clearFFDoubleByte();this.moveSelectionUp();}break;case 40:this.clearFFDoubleByte();if(bq.getContextData(aZ+bg+ao)){this.manualOpenDropdown();}break;default:if(br===bo&&!this.keyUpSupported){break;}if(!this.keyUpSupported&&!this.handleKeyUpObject){this.handleFFDoubleByte();}if(bp.enabled===ag){if(br===0){bt.set(K,"<p></p>");this.closeDropdown();}else{if(br>bp.minQueryLength){if(bp.timeoutId){bp.timeoutId.cancel();}if(bp.containerOpen===M){bp.isAutoOpen=ag;}if(bn===bg){this.primeSearch();}bp.timeoutId=this.Y.later(bp.queryDelay,this,this.sendQuery);if(bp.containerOpen){bp.lastVisibleItem=this.numberOfVisibleItems-1;}}else{bt.set(K,"<p>"+bq.getString("STR.MASTHEAD.NO_SUGGESTION")+"</p>");if(bp.containerOpen){this.closeDropdown();}}}this.lastQueryLength=br;}this.moduleapi.broadcast(aT,bu);break;}}},manualOpenDropdown:function(){var bn=this.saConfig;if(bn.enabled===ag){if(bn.containerOpen===M){if(this.searchQuery.length>bn.minQueryLength){bn.isManualOpen=true;this.sendQuery();}else{this.resetSA();this.openDropdown();}}else{if(this.suggestions){this.moveSelectionDown();}}}else{this.resetSA();this.openDropdown();}},toggleSA:function(bs){var bt=this.instrumentation,br=this.formData[this.currentTab],bn="yahoo.com",bq=new Date(),bp,bo;if(bs===ag){bp=ar;bo="on";}else{bp=a5;bo="off";}bt.fireUltBeacon(br.bcnOnOff);this.Y.Cookie.set(u,bp,{expires:bq.setDate(bq.getDate()+120),path:"/",domain:bn});this.saConfig.enabled=bs;this.resetSA();this.closeDropdown();},handleSubmit:function(bw){bw.preventDefault();var bv=this.moduleapi,bq=this.saConfig,bp=this.secondInput,bs=this.trendData,bt=this.body,bn=this.id,by,bx,br=this.textbox.get(n),bo=this.formData[this.currentTab],bu;if(br.length===0){bw.preventDefault();return;}bq.enabled=M;if(this.ywaTrackingEnabled&&YWA!==null){this.ywaObject=YWA;}if(this.ywaTrackingEnabled&&this.ywaObject!==ay){bu=this.moduleapi.getContextData("ywaProjectId")+"";this.YWATracker=this.ywaObject.getTracker(bu);this.Y.later(x,this,function(){if(this.YWATracker!==ay){this.YWATracker.setAction("INTERNAL_SEARCH");this.YWATracker.setISK(br);this.YWATracker.setISR("100");if(br.length===0){this.YWATracker.setISR("0");}this.YWATracker.setDocumentGroup("Search");this.YWATracker.setDocumentName("Search Results");this.YWATracker.submit();}},ay);}if(bs){this.beaconPreloadedSearch(this.textbox.get(n));}if(bq.selectedIndex!==-1){this.setFRCode(true);by=bt.getById(bn+"-results").all("li a");bx=by.item(bq.selectedIndex).get(N);if(bs){this.Y.later(x,this,function(){this.moduleapi.navigate(bx);},bx);}else{bv.navigate(bx);}}else{this.setFRCode(false);if(bp&&(bp.get(n)===bv.getString("STR.MASTHEAD.LOCAL.HELP2")||bp.get(n)===bv.getString("STR.MASTHEAD.JOBS.HELP2"))){bp.set(n,"");}if(this.formData[aU]){this.prepareEbaySubmit();}if(bs){this.Y.later(x,this,function(){this.form.submit();},ay);}else{if(this.isYHSAction()){this.submitYHS(bo.action,this.form,br);}else{this.form.set("action",bo.action);this.form.submit();}}}},handleTextBlur:function(){this.textboxBlurred=true;this.aria.set(K,"<p></p>");},handleTextFocus:function(){this.textboxBlurred=false;},sendQuery:function(){if(this.moduleapi.getContextData(aZ+this.currentTab+ao)){var bn=this.saConfig,bp=this.moduleapi,br=this.searchQuery,bq=""+br,bu=bq.replace(/%20/g," "),bt=this.currentTab,bo=bn.cachedResults[bt][bu],bs;if(typeof bo==="object"){bn.numResults=bo.length;this.populateList(bo);if(br.length>bn.minQueryLength&&bn.numResults>0||bn.isManualOpen){this.openDropdown();}}else{if(bn.delayedRequests<aK){bq=encodeURIComponent(bq.replace(/"/g,""));switch(bt){case af:bs=bp.getContextData("saData").imgGossipUrl;break;case aD:case bg:bs=bp.getContextData("saData").webGossipUrl;break;}if(bq.length>0){bn.abortId=this.Y.Get.script(bs+bq,{timeout:1000,onTimeout:this.Y.bind(this.increaseDelayedRequests,this)});}}}this.lastSearchQuery=""+br;}},increaseDelayedRequests:function(){this.saConfig.delayedRequests++;},handleSearch:function(bn){var bp=[],bo=this.saConfig,bq=this.useFxjsonp?bn[1].length:bq=bn.r.length;bo.numResults=bq;bp=this.formatResults(bn);if(this.useFxjsonp){bo.cachedResults[this.currentTab][bn[0]]=bp;}else{bo.cachedResults[this.currentTab][bn.q]=bp;}this.populateList(bp);if(this.searchQuery.length>bo.minQueryLength&&bq>0){this.openDropdown();}},populateList:function(bC){var bp=this.Y.DOM,bA=this.id,br=this.moduleapi,bn=this.saConfig,bE=this.formData,bF=this.currentTab,bI=bE[bF],bt=this.aria,by=this.body,bD=bp.byId(bA+"-sayt"),bz=bC.length,bo=br.getContextData("frCode"),bx=br.getContextData("typeCode"),bH=bx?"type="+bx+"&":"",bv="",bG,bu="",bJ,bB,bw,bq,bs=/<\S[^><]*>/g;if(bz>0){bt.set(K,"<p>"+br.getString("STR.MASTHEAD.HAS_SUGGESTION")+"</p>");if(!bD){this.resetHood();bD=bp.byId(bA+"-sayt");}bD.innerHTML=br.getContextData("HTML_RESULTSLIST");bJ=document.getElementById(bA+"-results");for(bG=0;bG<bz;bG++){if(this.useFxjsonp){if(!this.isYHSAction()){bv="?fr="+bo+"-s&toggle=1&"+bH+"cop=mss&ei=UTF-8"+bu+"&p="+encodeURIComponent(bC[bG].replace(bs,""));}else{bv=bI.yltClickSuggestion.replace(aA,encodeURIComponent(bC[bG].replace(bs,"")));}bJ.innerHTML+=br.getContextData("HTML_RESULTSITEM");bB=bJ.lastChild.firstChild;bB.href=bI.yltClickSuggestion+bv;bB.innerHTML=bC[bG];}else{bw=bC[bG].formattedResults;if(!this.isYHSAction()){bv="?fr="+bo+"-s&toggle=1&"+bH+"cop=mss&ei=UTF-8"+bu+"&p="+encodeURIComponent(bw.replace(bs,""));}else{bv=bI.yltClickSuggestion.replace(aA,encodeURIComponent(bw.replace(bs,"")));}bJ.innerHTML+=br.getContextData("HTML_RESULTSITEM");bq=bJ.lastChild;bB=bq.firstChild;if(this.isYHSAction()){bB.href=bv;}else{bB.href=bI.yltClickSuggestion+bv;}bB.innerHTML=bw;}}if(bn.numResults>this.numberOfVisibleItems){bD.innerHTML+=br.getContextData("HTML_RESULTS_SCROLLARROWS");}this.suggestions=by.getById(bA+"-results").all("li a");if(this.Y.UA.ie===6){this.syncDropdown();}this.hood.on(bj,this.handleMouseover,this);}else{if(this.suggestions||!this.saWindow.one("ul")){this.resetSA();this.closeDropdown();bt.set(K,"<p>"+br.getString("STR.MASTHEAD.NO_SUGGESTION")+"</p>");}this.suggestions=ay;}},formatResults:function(bt){var bD=this.saConfig.normalizationRules,bu,bC,bx,bs=bD.length,br,bv,bq,bp,bo,by,bB=[],bw,bz,bn,bA;if(this.useFxjsonp){bC=this.Y.Lang.trim(this.normalize(bt[0].toUpperCase()));bx=bt[1].length;}else{bu=bt.r;bC=this.Y.Lang.trim(this.normalize(bt.q));bx=bu.length;}bC=bC.replace(/\(+/g,"").replace(/\)+/g,"").replace(/\{+/g,"").replace(/\}+/g,"").replace(/\[+/g,"").replace(/\]+/g,"").replace(/\\+/g,"");bp=bC.split("");br=bp.length-1;while(br-->0){bw=bp[br+1];switch(bp[br]){case"A":if(bp[br+1]==="E"){bp[br]="AE";}break;case"O":if(bp[br+1]==="E"){bp[br]="OE";}break;case"U":if(bp[br+1]==="E"){bp[br]="UE";}break;case"T":if(bp[br+1]==="H"){bp[br]="TH";}break;case"S":if(bp[br+1]==="S"){bp[br]="SS";}break;default:break;}if(bp[br].length>1){bp.splice(br+1,1);}}bv=bp.length;while(bv-->0){while(bs-->0){if(bp[bv]===bD[bs][0]){bp[bv]="("+bD[bs][1]+")";}}bs=bD.length;}bo="("+bp.join("")+")";bo=bo.replace(/(\$|\^|\*|\+|\?|\\|\[|\]\{|\}\|\|)/g,"\\$1");by=new RegExp(bo,"i");for(bq=0;bq<bx;bq++){bA=this.useFxjsonp?bt[1][bq]:bu[bq][0];bn=(by)?bA.replace(by,"<strong>$1</strong>"):bt[1][1];if(this.useFxjsonp){bB[bq]=bn;}else{bz=bu[bq][3];bB[bq]={formattedResults:bn,suid:bz};}}return bB;},normalize:function(bn){var bp=this.saConfig.normalizationRules,bo=bp.length-1;while(bo--){bn=bn.replace(new RegExp(bp[bo][1],"g"),bp[bo][0]);}return bn;},setFRCode:function(bn){var bp=this.body.getById(this.id+"-frcode"),bo=this.moduleapi.getContextData("frCode");if(bp){bp.set(n,bn?bo+"-s":bo);}},removeYLT:function(bo){var bn=bo.lastIndexOf("http");return bo.substr(bn,bo.length);},saveSetting:function(bo,bp){var bn={type:"module",moduleId:this.id,args:{_action:"save",_subAction:bo,value:bp}},bq={success:function(bs,br){},failure:function(bs,br){},scope:this};this.moduleapi.makeRequest(bn,bq);},onmessage:function(bp,bo,br){var bu=this.body,bs=this.secondInput,bv=br?br.displayName:ay,bw,bq,bt,bn;if((bp===D||bp===bc)&&bv){this.defLoc=bv;if(bs){bs.set(n,bv);}bw=bu.getById(this.id+"-weather");if(bw){bq=bw.next();if(bq){bq.set(K,bv.substring(0,bv.indexOf(",")));}}}else{if(bp.substr(0,5)==="/user"){bt=bp.substr(bp.lastIndexOf("/")+1);bn=bu.getById(this.id+"-"+bt);if(bn){bn.set(K,br.data);bn.removeClass(aM);}}else{if(bp===a9){if(true===this.textboxBlurred){this.textbox.focus();this.textbox.set(n,br);}}else{if(bp===aX){this.closeDropdown(true);if(this.textbox.get(n)){this.moduleapi.broadcast(aT,this.textbox.get(n));}}}}}},getEms:function(bo){var bn,bp,bq=this.Y;bn=bo.appendChild(document.createElement("div"));bn.setStyle("height","1em");bn.setStyle("width","1em");bp=bq.DOM.region(bq.Node.getDOMNode(bn));bn.remove();return bp;},handleFFDoubleByte:function(){this.handleKeyUpObject=this.Y.later(500,this,this.handleFFDoubleByteKeyUp,ay,ag);},handleFFDoubleByteKeyUp:function(){var bn,bo=this.currentTab;this.searchQuery=this.textbox.get(n);if(this.searchQuery!=this.lastSearchQuery){bn=this.saConfig;if(bo===bg||bo===af||bo===aD){bn.timeoutId=this.Y.later(bn.queryDelay,this,this.sendQuery);}}this.handleKeyUp();},clearFFDoubleByte:function(){if(this.handleKeyUpObject){this.handleKeyUpObject.cancel();}this.handleKeyUpObject=ay;},createHiddenInputFieldForTab:function(bo,bq){var bp=this.body.getById(this.id+"-p"),bn=bp.get(aj),br=bn.create("<input type='hidden'>");if(bo&&bq){br.setAttribute(aH,bo);br.setAttribute(n,bq);}return bn.insertBefore(br,bp);},removeYNode:function(bn){if(bn){bn.get(aj).removeChild(bn);}},removeHiddenInputFields:function(){var bn,bo=0,bp=this.hiddenInputNodes;if(bp){bo=bp.length;for(bn=bo-1;bn>=0;bn--){this.removeYNode(bp[bn]);bp[bn]=ay;}}},disableHiddenInputField:function(bo){var bn=this.body.getById(bo);if(bn){bn.set(L,ag);}},updateLandingPage:function(){var bn,bo,bp,bq=this.formData[this.currentTab];if(bq.noQueryURL){bo=this.form;bp=bo.getAttribute(c);bn=this.extractURL(bp);if(this.searchQuery.length===0){bp=bp.replace(bn,bq.noQueryURL);}else{bp=bp.replace(bn,this.extractURL(bq.action));}bo.setAttribute(c,bp);}},extractURL:function(bo){var bp,bn=ay;if(bo){bp=bo.indexOf("http://");if(bp===-1){bp=0;}bn=bo.substr(bp,bo.length);}return bn;},prepareEbaySubmit:function(){var bp,bo=this.textbox,bq=this.currentTab,bn=this.ebayInputField;if(bq===aU){bp=this.Y.substitute(this.formData[bq].mpreValue,{"0":bo.get(n)});if(!bn){this.ebayInputField=this.createHiddenInputFieldForTab("mpre",bp);}else{bn.set(L,M);bn.set(n,bp);}this.fireEbayBeacon();}else{if(bn){bn.set(L,ag);}}},fireEbayBeacon:function(){var bn=this.formData[aU],bo={A_rd:bn.rdPath,_E:"rd",_S:bn.spaceId,_u:bn.scurl};this.instrumentation.fireUltBeacon(bo);},isStringInArray:function(bp,bq){var bo,br,bn=M;if(bp&&bq){bo=bq.length;br=bp.toLowerCase();while(bo--){if(br===bq[bo].text.toLowerCase()){bn=ag;break;}}}return bn;},isArrayStringInString:function(bp,bq){var bo,br,bn=M;if(bp&&bq){bo=bq.length;br=bp.toLowerCase();while(bo--){if(br.indexOf(bq[bo].text.toLowerCase())>-1){bn=ag;break;}}}return bn;},beaconPreloadedSearch:function(bo,br){var bq={slk:"sa_link",pos:1,own:"Y",ld:0,itc:0},bn=this.trendData,bp=this.hood.hasClass(a);if(bp){if(this.isStringInArray(bo,bn)){bq.sec=aa;bq.ltxt=bo;}else{if(this.isArrayStringInString(bo,bn)){bq.sec=bm;bq.ltxt="sa_click";}}}else{bq.slk="btn";if(this.isStringInArray(bo,bn)){bq.sec=a2;bq.ltxt=bo;}else{if(this.isArrayStringInString(bo,bn)){bq.sec=t;bq.ltxt="srch-"+this.currentTab;}}}if(bq.sec){this.instrumentation.fireUltBeacon(bq);}}};})();/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */
(function(){var d={},e,c,b="ulm:defaultlocation",a;YModules.type_batchload={init:function(f){c=f;e=c.getService("yui");a=c.getService("moduleplatform");a.subscribe("ready",e.bind(function(){if(this.collectChannelNames()){this.sendChannelsRequest();}},this));c.listen(b);},onmessage:function(f,h,g){if(f==b){this.sendChannelsRequest();}},collectChannelNames:function(){var f=false;a.queryModules(function(m){var l=a.getModuleApi(m),j=l.getProperty("pachannel"),h=l.getProperty("channels"),k,g;if(j){d[j]=m;f=true;}if(h){f=true;for(k=0,g=h.length;k<g;k++){d[h[k]]=m;}}});return f;},sendChannelsRequest:function(){var f=e.Object.keys(d),g={type:"module",moduleId:c.getId(),args:{_action:"show",_subAction:"get_vitals",channels:f}},h={success:this.handleResponseSuccess,failure:this.handleResponseFailure,scope:this};if(f.length){a.getService("arcade_transport").makeRequest(g,h,g.moduleId);}},handleResponseSuccess:function(f){var g=c.getContextData("channels");e.Object.each(g,function(i,h){i.originId=d[h];c.broadcast(h,i);});},handleResponseFailure:function(f){}};})();/* Copyright (c) 2013, Yahoo! Inc.  All rights reserved. */

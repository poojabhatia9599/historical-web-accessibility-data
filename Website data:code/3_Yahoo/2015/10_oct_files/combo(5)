(function(){var d="default",i="edit",c=null,f="location:update",j="location:picker-open",g="location:picker-close",b=".app-ctas",h=".app",e="v-h",a="d-n";YModules.type_weather={id:"",body:null,editBody:null,api:null,viewevents:["click"],locdropWidget:null,userCitySelection:null,ldwService:null,listeners:[],defaultScale:null,locationPickerEnabled:false,locationService:null,locationInstance:null,loadLocationListener:null,init:function(k){this.Y=k.getService("yui");this.id=k.getId();this.api=k;this.platform=k.getService("moduleplatform");this.instrumentationService=k.getService("instrumentation");this.rapidEnabled=this.api.getContextData("rapid.enabled");if(this.platform){this.arcadeTransport=this.platform.getService("arcade_transport");}else{this.arcadeTransport=k;}this.arcadeTransport=k;},onviewload:function(o){var m=this.api,k,n,l;this.locationPickerEnabled=m.getContextData("locationPickerEnabled");if(o===d){this.body=m.getViewNode(o);k=this.body.one(".celsius");if(!m.getContextData("isApp")){this.listeners.push(this.body.delegate("mouseover",this.onShowToolbar,h,this));this.listeners.push(this.body.delegate("mouseout",this.onHideToolbar,h,this));}this.loadLocationListener=this.body.delegate("mouseover",this.loadLocationWidget,h,this);l=m.getContextData("locationModuleMeta");if(l){l.state.view="default";this.platform.registerModule(l);this.platform.start(l.props.id,false,true);}if(this.rapidEnabled){this.instrumentationService.refreshModule(this.body);}if(k&&k.hasClass("selected")){this.defaultScale="C";}else{this.defaultScale="F";}}if(o===i){this.editBody=m.getViewNode(o);if(this.editBody.one("#weather-locdrop-widget")&&this.locdropWidget===null){this.subscribeLocdropWidgetV2("weather-locdrop-widget");}n=this.editBody.one(".scale-option.selected input");if(n){this.defaultScale=n.get("value");}}},onviewunload:function(k){if(k===d){this.body=null;if(this.locationPickerEnabled){this.locationService=null;if(this.locationInstance){this.locationInstance.destroy();this.locationInstance=null;}}}if(k===i){this.editBody=null;}this.Y.Array.each(this.listeners,function(l){l.detach();});this.listeners=[];this.platform.unsubscribe(f,this.handleLocationUpdate);},onviewevent:function(s,q){var p=this.api,m=q.target,u=this,k,t=m.ancestor(".tempUnit",true),r,n,o,l=m.ancestor(".loc-picker-link",true)||m.ancestor(".loc-picker-icon",true);if(s===d){if(m.ancestor(".settings-cta",true)){p.openView("edit");return;}if(t){q.preventDefault();if(!m.hasClass("unit")){return;}r=m.hasClass("celsius")?"C":"F";if(r===this.defaultScale){return;}this.defaultScale=r;m.ancestor(".scale",true).one(".selected").removeClass("selected");m.addClass("selected");n=this.body.all(".temp");n.each(function(v){o=u.convertTemp(v.get("innerHTML"),u.defaultScale);v.setContent(o);});this.arcadeTransport.makeRequest({type:"module",moduleId:this.id,args:this.Y.merge({_action:"save",_subAction:"saveScalePref",tempScale:this.defaultScale})},{success:function(){},failure:function(){},scope:this,argument:this.Y.merge({subAction:"saveScalePref"})});}else{if(this.body.one(".wrapper-current")&&m.ancestor(".current",true,".type_weather")){window.location=this.body.one(".wrapper-current").one("a").getAttribute("href");}else{if(l&&!this.locDropLoaded){this.loadLocationWidget(l,true);}}}}else{if(s===i){if(m.ancestor(".lw-anchor-item",true)){this.manageLocdropWidgetToggle("opened");}if(m.hasClass("edit-save-btn")){q.preventDefault();this.arcadeTransport.makeRequest({type:"module",moduleId:this.id,args:this.Y.merge({_action:"save",_subAction:"saveScalePref",tempScale:this.defaultScale})},{success:function(){p.refreshView(d);this.cleanUpLocdropWidget();p.closeView(i);},failure:function(){},scope:this,argument:this.Y.merge({subAction:"saveScalePref"})});}if(m.ancestor(".scale-option",true)){k=m.ancestor(".scale-option",true).one("input").get("value");this.setScalePreference(k);}}}},subscribeLocdropWidgetV2:function(l){var m=this.api,p,r,n,q,k,o,s;m.listen("ldw:defaultlocation");if(this.ldwService===null){this.ldwService=m.getService("ld_service");}r=m.getContextData("locdrop_crumb");p=m.getContextData("locale");n=m.getContextData("best_loc");k=m.getContextData("cur_loc");q=m.getContextData("def_loc");o=this.userCitySelection||m.getContextData("user_loc");s={crumb:r,locale:p,bestLoc:n,currentLoc:k,defaultLoc:q,anchorText:o,anchorClass:"loc-label fz-s",strFind:m.getContextData("strFind"),glApi:m.getContextData("useGlApi")};this.locdropWidget=this.ldwService.create(l,s);this.locdropWidget.on("locationselect",this.onLocWidgetSelect,this);this.locdropWidget.on("widgetclose",this.manageLocdropWidgetToggle,this);},onLocWidgetSelect:function(k){this.platform.fire(f,k);this.userCitySelection=k.city;this.editBody.one(".loc-input").set("value",this.userCitySelection);this.api.refreshView(d);this.cleanUpLocdropWidget();this.api.closeView(i);},manageLocdropWidgetToggle:function(l){var k=this.editBody.one(h);if(l==="opened"){k.setStyle("zIndex","51");}else{k.setStyle("zIndex","");}},cleanUpLocdropWidget:function(){if(this.locdropWidget){this.locdropWidget.detachAll();this.locdropWidget.destroy();this.locdropWidget=null;delete (this.locdropWidget);this.ldwService=null;}},initLocation:function(k){var n=this.body.one(".loc-picker"),m=this.api,l;if(n){if(!n.one(".loc-picker-link")){return false;}this.Y.use("location_service","ld_service","lw_view",this.Y.bind(function(o){this.locDropLoaded=true;this.locationService=m.getService("location_service");l={locDropSettings:{crumb:m.getContextData("locdrop_crumb"),locale:m.getContextData("locale"),bestLoc:m.getContextData("best_loc"),curLoc:m.getContextData("cur_loc"),defLoc:m.getContextData("def_loc"),userLoc:this.userCitySelection||m.getContextData("user_loc"),anchorClass:"",strFind:m.getContextData("strFind"),glApi:m.getContextData("useGlApi")},beacon:{sec:m.getContextData("beacon_sec"),rspns:m.getContextData("beacon_rspns"),t1:m.getContextData("beacon_t1"),t2:m.getContextData("beacon_t2"),t3:m.getContextData("beacon_t3"),elm:m.getContextData("beacon_elm"),elmt:m.getContextData("beacon_elmt"),slk:m.getContextData("beacon_slk")},parentBody:this.body};if(this.locationService){this.locationInstance=this.locationService.create(n,this.id,m,l);}if(k){this.locationInstance.exposeMenu(k);}this.platform.subscribe(f,this.handleLocationUpdate,this);m.listen(j);m.listen(g);},this));}},setScalePreference:function(p){var k=this.editBody.one(".scale"),o=k.one(".fahrenheit"),n=k.one(".celsius"),m,l;if(p==="F"){m=o;l=n;}else{m=n;l=o;}l.removeClass("selected");l.one("input").set("checked","");m.addClass("selected");m.one("input").set("checked","checked");this.defaultScale=p;},show:function(k){if(k){k.removeClass(e);k.removeClass(a);}},hide:function(k){if(k){k.addClass(e);k.addClass(a);}},onShowToolbar:function(m){var l=m.target.ancestor(h,true),k=(l)?l.one(b):c;if(this.locationPickerEnabled&&!this.locationService){this.initLocation();}this.show(k);},onHideToolbar:function(m){var l=m.target.ancestor(h,true),k=(l)?l.one(b):c;this.hide(k);},loadLocationWidget:function(k,l){if(this.locationPickerEnabled&&!this.locationService){if(l){this.initLocation(k);}else{this.initLocation();}this.loadLocationListener.detach();}},onmessage:function(m,k,l){if(k==="weather"){switch(m){case j:this.body.one(".app").setStyle("zIndex","51");this.body.one(".current").setStyle("zIndex","2");break;case g:this.body.one(".app").setStyle("zIndex","");this.body.one(".current").setStyle("zIndex","");break;default:}}},handleLocationUpdate:function(){var l=this.api,k=l.getContextData("forceIpLocation")===1,m=l.getService("statemgr");if(k&&m){m.setUserPageState("bypassUserLocPref",0);}if(this.platform.getProperty("loc.cookie.persistent")&&m){m.setUserPageState("_fpts",Math.round(new Date().getTime()/1000));}l.refreshView(d);},convertTemp:function(k,l){switch(l){case"F":return Math.round(k*1.8+32);case"C":return Math.round((k-32)/1.8);default:return k;}}};}());/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
(function(){var i="click",f="submit",b="blur",c="default",h="edit",j="recent-quotes",d=true,g=false,e=null,a=e;YModules.type_finance={id:"",body:e,moduleapi:e,instrumentation:e,currentBucket:e,orderTable:"asc",viewevents:[i,f,"focus","mouseover"],allTickers:e,autocompleteEnabled:g,autocompleteLoaded:g,settingspaneEnabled:g,arcadeTransport:e,resizeThrottle:250,tabliteService:e,tabs:e,tabNavigationMode:e,searchBoxBlur:e,stateMgr:e,apiMigrationMode:g,newDefaultPfId:e,init:function(k){this.id=k.getId();this.moduleapi=k;a=this.moduleapi.getService("yui");this.autocompleteEnabled=k.getContextData("enableAutocomplete");this.settingspaneEnabled=k.getContextData("enableSettingspane");this.inlineEditEnabled=k.getContextData("enableRQInlineEdit");this.crumb=k.getContextData(".crumb");this.instrumentation=k.getService("instrumentation");this.rapidEnabled=this.moduleapi.getContextData("rapid.enabled");this.currentBucket=k.getContextData("currentBucket");this.autocompleteUrl=k.getContextData("autocompleteUrl");if(this.settingspaneEnabled){this.arcadeTransport=this.platform?this.platform.getService("arcade_transport"):k;}this.tabliteService=k.getService("tablite");this.tabNavigationMode=k.getContextData("tabNavigationMode");this.stateMgr=this.moduleapi.getService("statemgr");this.apiMigrationMode=k.getContextData("apiMigrationMode");this.newDefaultPfId=k.getContextData("newDefaultPf");},onviewload:function(m){var l=this.moduleapi,k;if(m==c){this.body=this.moduleapi.getViewNode(c);this.autocompleteLoaded=g;if(this.rapidEnabled){this.instrumentation.refreshModule(this.body);}this.allTickers=l.getContextData("allTickers");this.loadingInfo=l.getContextData("loadingInfo")||e;k=this.body.one(".tab-"+this.tabNavigationMode);this.tabs=new this.tabliteService({moduleApi:l,body:this.body,tabWidget:k,navMode:this.tabNavigationMode});this.tabs.setup();if(this.newDefaultPfId){this.arcadeTransport.makeRequest({type:"module",moduleId:this.id,args:{_action:"save",_subAction:"setdefault",pf_id:this.newDefaultPfId}},{success:function(){this.newDefaultPfId=e;l.refreshView(c);},failure:function(){},scope:this,argument:{subAction:"setdefault"}});}if(!this.searchBoxBlur){this.searchBoxBlur=this.body.delegate("blur",function(q){var p=q.target,o=p.get("value"),n=p.getAttribute("placeholder");if(o.length===0||n===o){p.addClass("quotes-input-inactive");p.set("value",n);}},".quotes-input");}}else{if(m==h){this.editBody=l.getViewNode(m);if(this.rapidEnabled&&!this.instrumentation.isModuleTracked(this.editBody)){this.instrumentation.addModule(this.editBody,"app-fin");}}}},onviewevent:function(u,q){var n=this.moduleapi,r=q.target,t=q.type,o=r.getAttribute("placeholder"),p=r.get("value"),s,k,l,m,v;if(u==c){if(t===i){if(this.apiMigrationMode){v=this.moduleapi.getContextData("myPortfolioUrl")||"//finance.yahoo.com/portfolios";m=r.getData("tabid");if(m&&m==="my-portfolio"){a.config.win.location.href=v;return;}}if(r.ancestor(".toggle",d)){if(r.hasClass("edit-link")){return;}q.preventDefault();}if(this.rapidEnabled&&r.hasClass("tab")){this.instrumentation.fireBeacon(r);}if(r.ancestor(".settings-cta",d)&&this.settingspaneEnabled){q.preventDefault();n.openView(h);}if(r.ancestor(".markets .down",d)||r.ancestor(".markets .up",d)){k=r.ancestor(".markets");l=k&&k.hasClass("quote-percent");k.all(".down, .up").each(function(z,y){var A=z,x=A.getAttribute("data-changepercent"),w=A.getAttribute("data-change");if(l){A.setContent(A.getContent().replace(x,w));}else{A.setContent(A.getContent().replace(w,x));}});if(l){k.removeClass("quote-percent");}else{k.addClass("quote-percent");}if(this.rapidEnabled){this.instrumentation.fireBeacon(r);}}}if(t==="focus"||t===i){if(r.hasClass("quotes-input")&&o===p){this.emptyInputBox(r);if(r.hasClass("quotes-input-inactive")){r.removeClass("quotes-input-inactive");}}}if(t==="mouseover"&&this.autocompleteLoaded===g&&this.autocompleteEnabled){this.autocompleteLoaded=d;n.getViewNode(c).detach("mouseover");this.initAutocomplete();}}else{if(u==h){if(t==="submit"||(t===i&&r.hasClass("edit-save-btn"))){q.preventDefault();if(r.hasClass("app-close-button")){n.closeView(h);return;}if(t===i&&r.hasClass("edit-save-btn")){r=r.ancestor(".portfolio-form");}if(r.hasClass("portfolio-form")&&r.one('input[name="pf"]')){r.all('input[name="pf"]').each(function(w){if(w.get("checked")===d){s=w.getAttribute("value");}});this.arcadeTransport.makeRequest({type:"module",moduleId:this.id,args:{_action:"save",_subAction:"setdefault",pf_id:s}},{success:function(){n.refreshView(c);this.editBody=n.getViewNode(u);if(this.instrumentation.isModuleTracked(this.editBody)){this.instrumentation.removeModule(this.editBody);}n.closeView(h);},failure:function(){},scope:this,argument:{subAction:"setdefault"}});}else{if(r.hasClass("portfolio-form")){n.closeView(h);}}}}}},initAutocomplete:function(){try{var k=this;a.use("jsonp","jsonp-url","autocomplete",function(o){var n=k.body.one(".quotes-input"),m;if(n){n.plug(o.Plugin.AutoComplete,{source:function(s,t){YAHOO.util={ScriptNodeDataSource:{callbacks:function(w){var v=w.ResultSet.Result,u=[];for(m=0;m<v.length;m++){if(v[m]&&v[m].symbol){u.push({symbol:v[m].symbol,name:v[m].name,pos:m});}}t(u);}}};function q(u,v,w){return o.Lang.sub(u,{callback:"YAHOO.util.ScriptNodeDataSource.callbacks",query:w});}var r=k.autocompleteUrl,p=new o.JSONPRequest(r,{format:q,on:{success:function(u){}}});p.send(s);},resultTextLocator:"symbol",resultFormatter:function(q,p){return o.Array.map(p,function(r){return"<strong>"+r.raw.symbol+"</strong> "+r.raw.name;});},resultHighlighter:"phraseMatch",align:{node:n,points:["tl","bl"]},queryDelay:200,maxResults:10,activateFirstItem:d});n.ancestor("form").on(f,function(p){if(n.ac.get("visible")===d){p.preventDefault();}});n.ac.on("select",function(p){p.preventDefault();if(k.inlineEditEnabled){if(k.stateMgr){k.stateMgr.saveUserSetting("st",j,k.moduleapi);}k.arcadeTransport.makeRequest({type:"module",moduleId:k.id,args:{_action:"save",_subAction:"addrq",s:p.result.text}},{success:function(){if(this.rapidEnabled){var q={rspns:"nav",t1:"a4",t2:"app-fin",t3:"rcnt",sec:"app-fin",slk:p.result.text,elm:"itm",elmt:"qte",itc:0,pos:p.result.raw.pos+1,action:"click"};this.instrumentation.fireBeacon(q);}k.moduleapi.refreshView(c);},failure:function(){},scope:k,argument:{subAction:"addrq"}});}else{n.set("value",p.result.text);n.ancestor("form").submit();}});n.ac.on("visibleChange",function(p){if(p.newVal===d){k.body.one(".app").setStyle("zIndex","10");}else{k.body.one(".app").setStyle("zIndex","");}});}});}catch(l){}},emptyInputBox:function(k){k.set("value","").removeClass("quotes-input-inactive");k.on(b,this.setInputValue,this);},setInputValue:function(l){var k=l.target;if(k.get("value")===""){k.set("value",k.get("defaultValue"));k.addClass("quotes-input-inactive");}k.detach("blur",this.setInputValue);},onviewunload:function(k){if(k==c){this.tabs.teardown();if(this.searchBoxBlur){this.searchBoxBlur.detach();this.searchBoxBlur=e;}}},handleRequests:function(k,o){var l=this.moduleapi,n=this.requestId,m=this.body.getById(this.id+"-loading-info");if(l.isRequestPending(n)){l.abortRequest(n);if(m){m.get("parentNode").removeChild(m);}}this.requestId=l.makeRequest(k,o);}};}());/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
YModules.type_sportacular={body:null,editBody:null,id:"",moduleapi:null,arcadeTransport:null,teamLoadReqId:null,viewevents:["click","focus","mouseover"],searchBoxBlur:null,tabliteService:null,tabs:null,tabNavigationMode:null,init:function(a){this.Y=a.getService("yui");this.platform=a.getService("moduleplatform");this.enableAutocomplete=a.getContextData("enableAutocomplete");this.enableSearchbackfill=a.getContextData("enableSearchbackfill");this.enableMyTeams=a.getContextData("enableMyTeams");this.enableBucketedGames=a.getContextData("enableBucketedGames");this.defaultPanelCounter=a.getContextData("defaultPanelCounter");this.id=a.getId();this.arcadeTransport=this.platform?this.platform.getService("arcade_transport"):a;this.moduleapi=a;this.rapidEnabled=this.moduleapi.getContextData("rapid.enabled");this.instrumentationService=a.getService("instrumentation");this.tabliteService=a.getService("tablite");this.tabNavigationMode=a.getContextData("tabNavigationMode");},formSubmit:function(a){return false;},onviewload:function(d){var b=this.moduleapi,c=this.Y,a;if(d==="default"){this.body=b.getViewNode(d);a=this.body.one(".tab-"+this.tabNavigationMode);this.tabs=new this.tabliteService({moduleApi:b,body:this.body,tabWidget:a,navMode:this.tabNavigationMode});this.tabs.setup();if(!this.searchBoxBlur){this.searchBoxBlur=this.body.delegate("blur",function(i){var h=i.target,g=h.get("value"),f=h.getAttribute("placeholder");if(g.length===0||f===g){h.addClass("sports-input-inactive");h.set("value",f);}},".sports-input");}}else{if(d==="edit"){this.editBody=b.getViewNode(d);}}},onviewunload:function(a){if(this.arcadeTransport.isRequestPending(this.teamLoadReqId)){this.arcadeTransport.abortRequest(this.teamLoadReqId);}if(a==="default"){this.body=null;}else{if(a==="edit"){this.editBody=null;}}this.tabs.teardown();if(this.searchBoxBlur){this.searchBoxBlur.detach();this.searchBoxBlur=null;}},loadTeams:function(b,c,e){var d,a;e=e||{};b=b||{};c=c||{};d=this.arcadeTransport.makeRequest({type:"module",moduleId:this.id,args:this.Y.merge({_action:"show",_subAction:"getTeams",noups:"1"},b)},{success:this.loadTeamsSuccess,failure:this.loadTeamsFailure,scope:this});a=this.moduleapi.getViewNode("default");a.detach("mouseover");return d;},loadTeamsFailure:function(a){},loadTeamsSuccess:function(c){if(c.data&&c.data.allTeams&&c.data.allTeams.teams){var b=c.data.allTeams.teams;try{this.Y.use("autocomplete","autocomplete-filters","autocomplete-highlighters",function(d){d.one("#sportsSearch").plug(d.Plugin.AutoComplete,{resultFilters:function(h,f){if(!h){return f;}var e={ignoreCase:true},g=d.Text.WordBreak.getUniqueWords(h,e);return d.Array.filter(f,function(i){var j=i.text.toLowerCase();return((i.raw.code.toLowerCase()).indexOf(h)!==-1)||d.Array.every(g,function(k){return j.indexOf(k)!==-1;});});},resultHighlighter:"subWordMatch",source:b,activateFirstItem:true,resultTextLocator:"name",maxResults:5,resultFormatter:function(f,e){return d.Array.map(e,function(g){return g.raw.name;});},on:{select:function(g){var f=g.result.raw.searchI13nUrl;d.config.win.location.href=f;}},align:{node:d.one("#sportsSearch"),points:["tl","bl"]}});});}catch(a){}}},onviewevent:function(g,d){var c=d.target,a=c.getAttribute("placeholder"),b=c.get("value"),f=this.Y.one("#sportsSearch");if(this.rapidEnabled&&c.hasClass("tab")){this.instrumentationService.fireBeacon(this.instrumentationService.getBeaconKeys(c));}if(this.enableAutocomplete&&f){if(!this.teamLoadReqId){this.Y.one("#sportsSearch").on("submit",this.formSubmit,this);this.teamLoadReqId=this.loadTeams();}}if(this.enableSearchbackfill||this.enableAutocomplete){if(d.type==="focus"||d.type==="click"){if(c.hasClass("sports-input")&&a===b){c.set("value","");if(c.hasClass("sports-input-inactive")){c.removeClass("sports-input-inactive");}}if(this.autocompleteLoaded===false&&this.autocompleteEnabled){this.autocompleteLoaded=true;this.initAutocomplete();}}}}};/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
YModules.type_flickr={body:null,editBody:null,id:"",moduleapi:null,viewevents:["click"],init:function(a){this.Y=a.getService("yui");this.id=a.getId();this.moduleapi=a;this.arcadeTransport=this.platform?this.platform.getService("arcade_transport"):a;this.user=a.getService("userinfo");this.loggedIn=this.user.isLoggedIn();this.enableMyPhotos=a.getContextData("enableMyPhotos")&&a.getContextData("isFlickrUser");},onviewload:function(c){var b=this.moduleapi,a=this;if(c==="default"){this.body=b.getViewNode(c);if(this.loggedIn&&this.enableMyPhotos){a.arcadeTransport.makeRequest({type:"module",moduleId:a.id,args:this.Y.merge({_action:"view",_subAction:"getPhotos",noups:0,s:"whatever this is"})},{success:function(d){if(d&&d.data&&d.data.myPhotos&&d.data.myPhotos.photos&&d.data.myPhotos.photos.length>0){this.body.set("innerHTML",d.data.myPhotos.markup);}},failure:function(){},scope:a,argument:this.Y.merge({subAction:"getPhotos"})});}}else{if(c==="edit"){this.editBody=b.getViewNode(c);}}},onviewunload:function(a){if(a==="default"){this.body=null;}else{if(a==="edit"){this.editBody=null;}}},onviewevent:function(b,a){if(b==="default"){}else{if(b==="edit"){}}}};/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
(function(){var b=false,c=null,a=true,d=null;YModules.type_topvideos={body:c,ccode:c,ct:c,editBody:c,id:"",videoInlineEnabled:b,moduleapi:c,searchBoxEnabled:b,searchBoxBlur:c,videoService:c,viewevents:["click","focus"],yepPlayer:c,init:function(e){d=e.getService("yui");this.id=e.getId();this.moduleapi=e;this.ccode=e.getContextData("ccode");this.ct=e.getContextData("ct")||3;this.searchBoxEnabled=e.getContextData("searchBoxEnabled");this.videoInlineEnabled=e.getContextData("video.inline.enabled");},onviewload:function(f){var e=this.moduleapi;if(f==="default"){this.body=e.getViewNode(f);if(!this.searchBoxBlur){this.searchBoxBlur=this.body.delegate("blur",function(j){var i=j.target,h=i.get("value"),g=i.getAttribute("placeholder");if(h.length===0||g===h){i.addClass("videos-input-inactive");i.set("value",g);}},".videos-input");}}else{if(f==="edit"){this.editBody=e.getViewNode(f);}}},onviewunload:function(e){if(e==="default"){this.body=c;}else{if(e==="edit"){this.editBody=c;}}if(this.searchBoxBlur){this.searchBoxBlur.detach();this.searchBoxBlur=c;}},onviewevent:function(k,j){var i=j.target,f=i.getAttribute("placeholder"),g=i.get("value"),h,l=b;if(this.videoInlineEnabled&&j.type==="click"){h=i.ancestor("li.video-inline",true,"li");if(h){l=this.handleInlineVideo(h,i);}}if(this.searchBoxEnabled){if(j.type==="focus"||j.type==="click"){if(i.hasClass("videos-input")&&f===g){i.set("value","");if(i.hasClass("videos-input-inactive")){i.removeClass("videos-input-inactive");}}}}if(l){j.preventDefault();}},handleInlineVideo:function(k,f,e){var i=k.one("a"),h=this.body.one(".app-featured.videos"),j,l,g;if(!k){return b;}if(!this.videoService){this.videoService=this.moduleapi.getService("videoyep");if(this.videoService!==""){this.yepPlayer=this.videoService.create();}}if(!this.yepPlayer){return b;}if(i){g=i.get("href");}j=k.getData();if(j&&j.sec&&j.uuid&&j.pos){l={analytics:{sec:j.sec,cpos:parseInt(j.pos,10),ccode:this.ccode,ct:3},config:{animated:b,attach:h,location:"prepend",returnTabIndexTo:f,yep:{id:j.uuid,autoplay:true},videoPageUrl:g||c}};this.yepPlayer.init(l);return a;}}};}());/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
(function(){var d="default",a=".horoscope-sign",c=".halt",b;YModules.type_horoscope={moduleapi:null,body:null,isBusy:false,viewevents:["click"],moduleCookieName:"fpms",cookieDomain:null,cookieSignKey:null,statemgr:null,init:function(e){this.Y=e.getService("yui");this.id=e.getId();this.moduleapi=e;this.instrumentationService=e.getService("instrumentation");this.rapidEnabled=this.moduleapi.getContextData("rapid.enabled");if(!b){b=e.getService("aria");}this.statemgr=e.getService("statemgr");this.cookieDomain=e.getContextData("cookieDomain");this.cookieSignKey=e.getContextData("cookieSignKey");},onviewload:function(f){var e=this.moduleapi;this.body=e.getViewNode(f);},onviewunload:function(e){this.body=null;},onviewevent:function(g,e){if(this.isBusy){return;}var f=e.target;if(f.test(c)||f.ancestor(c)){e.preventDefault();this.handleDefaultClick(f);}},handleDefaultClick:function(g){var f=g.ancestor(a,true),e=null;if(f){e=f.getAttribute("data-sign-id");}if(e!==null||g.hasClass("change-sign")){this.changeView(e);}},changeView:function(e){var f={type:"module",moduleId:this.id,args:{_container:0,_id:this.id,_action:"show",_subAction:"changeView",selectedSign:e,is_pageload:"false"}},g={success:this.handleGetSignDataSuccess,failure:this.handleGetSignDataError,scope:this,argument:{selectedSign:e,is_pageload:"false"}};this.isBusy=true;this.moduleapi.makeRequest(f,g);},handleGetSignDataSuccess:function(e,g){var f=this.moduleapi;this.isBusy=false;f.setView(d,e.html);if(g.selectedSign){this.Y.Cookie.setSub(this.moduleCookieName,this.id,"",{path:"/",domain:this.cookieDomain});if(this.statemgr){this.statemgr.setUserModuleState(this.cookieSignKey,g.selectedSign);this.statemgr.update();}}if(this.rapidEnabled){this.instrumentationService.refreshModule(this.body);}},handleGetSignDataError:function(e,f){this.isBusy=false;}};})();/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
(function(){var e=null,c="d-n",b="loaded",d="load-error",f="current-comics-strip",a="type_comics";YModules.type_comics={body:null,editBody:null,id:"",moduleapi:null,viewevents:["click"],autoHide:e,autoHideId:e,comicsWrapper:e,expanded:false,tablistService:null,tabList:null,isBusy:false,instrumentation:e,modalService:e,modal:e,init:function(g){this.Y=g.getService("yui");this.id=g.getId();this.moduleapi=g;this.tablistService=g.getService("tablist");this.instrumentation=g.getService("instrumentation");this.modalService=g.getService("modal");this.rapidEnabled=this.moduleapi.getContextData("rapid.enabled");},onviewload:function(i){var h=this.moduleapi,g=this;if(i==="default"){this.body=h.getViewNode(i);this.comicsWrapper=this.body.one(".comics-wrapper");this.tabList=this.tablistService.create(this.body.one(".y-tablist"),{moduleApi:h,panels:this.body.all(".tabpanel"),sticky:true,stickyKey:"st",vertical:true});this.tabList.on("tabchange",function(j){var k=this.getTabNode(this.getSelectedIndex());if(!k.hasClass(b)){g.loadComic(k);}else{g.updateAppState(g.body);}g.instrumentation.fireBeacon(k.getAttribute("data-b-inactive"));});}else{if(i==="edit"){this.editBody=h.getViewNode(i);}}},onviewunload:function(g){if(g==="default"){this.body=null;}else{if(g==="edit"){this.editBody=null;}}this.tabList.destroy();this.tabList=null;},onviewevent:function(h,g){if(h==="default"){this.handleEvents(this.body,g);}else{if(h==="edit"){}}},handleEvents:function(h,j){var k,m,o,l=j.target,g={},n=this.expanded?"lg":"sm",i=l.get("parentNode");if(this.rapidEnabled&&l.hasClass("ddmenu")){this.instrumentation.fireBeacon(this.instrumentation.getBeaconKeys(l));}if(!this.expanded){k=h.one(".tabpanel.selected ."+f);}else{k=h.one("."+f);}if(i.hasClass("older")||l.hasClass("older")){m=k.previous();if(m){k.replaceClass(f,c);m.replaceClass(c,f);this.updateAppState(h);g={sec:"app-com-"+n+"-"+this.getComicTag(),slk:"btn",ltxt:"pr",itc:1};this.instrumentation.fireBeacon(g);j.preventDefault();}}else{if(i.hasClass("newer")||l.hasClass("newer")){o=k.next();if(o){k.replaceClass(f,c);o.replaceClass(c,f);this.updateAppState(h);g={sec:"app-com-"+n+"-"+this.getComicTag(),slk:"btn",ltxt:"ne",itc:1};this.instrumentation.fireBeacon(g);j.preventDefault();}}}},loadComic:function(i){var g=i.getAttribute("data-comic"),h={type:"module",moduleId:this.id,args:{_container:0,_id:this.id,_action:"show",_subAction:"pickComic",comic:g}},j={success:this.handleGetComicDataSuccess,failure:this.handleGetComicDataFailure,scope:this,argument:{comicTabNode:i,comic:g}};this.isBusy=true;this.moduleapi.makeRequest(h,j);},handleGetComicDataSuccess:function(h,j){var g=this.body,i;this.isBusy=false;i=g.one(".y-tabpanels ."+j.comic);if(i){if(h.html&&h.html!=""){i.setHTML(h.html);j.comicTabNode.addClass(b);}else{i.setHTML(this.moduleapi.getString("STR.COMICS.FALLBACK"));j.comicTabNode.addClass(d);}if(this.rapidEnabled){this.instrumentation.refreshModule(this.body);}this.updateAppState(g);}},handleGetComicDataFailure:function(h,j){var g=this.body,i;this.isBusy=false;i=g.one(".y-tabpanels ."+j.comic);if(i){i.setHTML(this.moduleapi.getString("STR.COMICS.FALLBACK"));this.updateAppState(g);j.comicTabNode.addClass(d);}},updateAppState:function(j){var g,h=j.one("button.older"),i=j.one("button.newer");if(!this.expanded){g=j.one(".tabpanel.selected .current-comics-strip");}else{g=j.one(".current-comics-strip");}if(h){this.updateNavButtonState(g,h,i);}},updateNavButtonState:function(g,h,i){if(!g){this.disableButton(h);this.disableButton(i);}else{if(g.previous()){this.enableButton(h);}else{this.disableButton(h);}if(g.next()){this.enableButton(i);}else{this.disableButton(i);}}},disableButton:function(g){g.setAttribute("disabled","disabled");g.addClass("disabled");},enableButton:function(g){g.removeAttribute("disabled");g.removeClass("disabled");},registerAutoHide:function(h){var g=this.moduleapi.getService("autohide");this.autoHideId=g.register({targets:[h],hide:this.Y.bind(this.restoreApp,this)});this.autoHide=g;},unregisterAutoHide:function(){var g=this.autoHide;if(g){g.unregister(this.autoHideId);}},restoreApp:function(){var g;this.modal.destroy();this.modal=e;this.expanded=false;this.unregisterAutoHide();g={sec:"app-com-lg-"+this.getComicTag(),slk:"comic",ltxt:"shnk",itc:1};this.instrumentation.fireBeacon(g);},getComicTag:function(){return this.body.one(".y-tablist .selected").getAttribute("data-comictag").substr(0,3);}};})();/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
YModules.type_windowshade={body:null,editBody:null,id:"",moduleapi:null,viewevents:["click"],init:function(a){this.Y=a.getService("yui");this.id=a.getId();this.moduleapi=a;this.statemgr=a.getService("statemgr");},onviewload:function(m){var c=this.moduleapi,a,b,j=c.getContextData("autoClose"),h=this.messagesEnabled=c.getContextData("messagesEnabled"),l=h.length,g,d=0,f,e=20000,k=c.getContextData("UCSMessage");if(m==="default"){this.body=f=c.getViewNode(m);this.UCSMessage=k;for(d;d<l;d++){g=h[d];a=this.statemgr.getUserModuleState(g);b=c.getContextData(g+"FrequencyCap");if(k&&(g===k)){this.increaseUCSCount();}else{if(!a){this.statemgr.setUserModuleState(g,1);}else{if(a<b){this.statemgr.setUserModuleState(g,a+1);}}}e++;}if(j){this.Y.later(e,this,function(){f.remove();});}}},onviewunload:function(a){if(a==="default"){this.body=null;}},onviewevent:function(m,g){var h,k,f=this.messagesEnabled,j=this.messagesEnabled.length,l=4,c=0,d,a,b;if(m==="default"){h=g.target;k=h.ancestor(".close-btn",true,".type_windowshade");if(k){g.preventDefault();for(c;c<j;c++){d=f[c];if(this.UCSMessage&&(d===this.UCSMessage)){this.increaseUCSCount(true);}else{this.statemgr.setUserModuleState(d,l);}}this.body.remove();}if(h.hasAttribute("data-close")){g.preventDefault();if(h.getAttribute("data-close")==="true"){a=h.getAttribute("href");b=h.getAttribute("href");for(c;c<j;c++){d=f[c];if(this.UCSMessage&&(d===this.UCSMessage)){this.increaseUCSCount(true);}else{this.statemgr.setUserModuleState(d,l);}}this.body.remove();this.moduleapi.navigate(a,b);}}}},increaseUCSCount:function(c){var b=this.Y.Cookie.getSub("ucs","disclaimer",Number),a=this.Y.Cookie.get("AO",{raw:true});if(!b||b===null){b=0;}if(c){b=this.moduleapi.getContextData("UCSFrequencyCap");}this.Y.Cookie.setSub("ucs","disclaimer",b+1,{expires:new Date("January 12, 2025"),path:"/",domain:"yahoo.com"});a=a.replace("o=1","o=0");this.Y.Cookie.set("AO",a,{expires:new Date("January 12, 2025"),path:"/",domain:"yahoo.com",raw:true});}};/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
(function(){var b=true,d="today_tab_open",c="today_tab_close",e="worldcup_tab_update",a="13872472";YModules.type_todaycontainer={body:null,editBody:null,id:"",moduleapi:null,viewevents:["click"],init:function(f){this.Y=f.getService("yui");this.id=f.getId();this.moduleapi=f;this.arcadeTransport=f.getService("moduleplatform").getService("arcade_transport");this.moduleId=f.getId();this.statemgr=f.getService("statemgr");f.listen(e);},onviewload:function(g){var f=this.moduleapi;if(g==="default"){this.body=f.getViewNode(g);this.tabs=this.body.one(".today-tabs");}},onviewunload:function(f){if(f==="default"){this.body=null;}},onviewevent:function(i,h){if(i==="default"){var g=h.target,f=g.ancestor("a.tab-change",b,"DIV");if(f){h.preventDefault();this.changeTab(f);}}},changeTab:function(i){var g=this.tabs.all("LI"),f=i.getAttribute("data-suid"),h=i.get("parentNode"),l=this.body.all(".tab-holder"),k=this.body.one("#tab-"+f),j=1;g.removeClass("selected");h.addClass("selected");l.removeClass("tab-selected");k.addClass("tab-selected");if(f===a){this.moduleapi.broadcast(d);}else{this.moduleapi.broadcast(c);j=2;}this.statemgr.setUserModuleState("state",j);},loadTab:function(i){var f=i.getAttribute("data-suid"),h=this.moduleId,g,j;g={type:"module",moduleId:h,args:{_action:"show",_subAction:"load-module",suid:f}};j={success:this.loadTabSuccess,failure:this.loadTabFailure,argument:{node:i},scope:this};if(this.arcadeTransport.isRequestPending(this.loadTab)){this.arcadeTransport.abortRequest(this.loadTab);}this.loadTab=this.arcadeTransport.makeRequest(g,j,h);},loadTabSuccess:function(f,h){var g=h.node;g.set("innerHTML",f.html);},loadTabFailure:function(f,g){},onmessage:function(i,f,h){var g;if(i===e){if(h.suid&&h.html){g=this.body.one("#tab-"+h.suid);if(g){g.set("innerHTML",h.html);}}}}};}());/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
(function(){var v="hide",at="prev",q="next",d="close",N="empty",av="selected",ac="inlinevid",o="indicator",i="todaytop",O="main-story",j=".main-story-content",D='<div class="main-story-next"></div>',y="no-visibility",Z="related-links",ay="no-top-padding",aj="indicator-playing",g="y-today-grad1",f="y-today-grad2",z="y-today-ln-1",ar="y-ln-2",ap="y-ln-4",Q="trans-border",ae="item",ag="play",n="pause",ad=null,U=true,A=false,ak="href",F="innerHTML",aq="pa:open",aw="pa:close",M="lightbox:start",a="lightbox:end",u="y-carousel",e="parentNode",k="none",ao="OK",aa="-panel",x="abort",I="data-b",af=".package-header",K="story",ab="footers",c="story_footer_pairs",b="fpck",t="interactive",S="sayt:open",az="sayt:close",E="fp:window:resize",am="today_tab_open",ah="today_tab_close",X="mouseout",V="mouseover",J=300,p="pane",Y="package",m="baseline",aA="ta",W="ca",B="1",ai="0",h="pof",R="footers",al="stories",H=0,C=0,aB=0,G=-1,w=1,P=2,T=3,au="fade",an="crossfade",s="always",L="single_pane",ax="all_panes",r="fp:today:offscreen",l="fp:today:onscreen";YModules.type_fptoday={viewevents:["click","keyup"],moduleapi:ad,cache:ad,body:ad,moduleId:ad,mainStory:ad,mainStoryContent:ad,mainStoryNext:ad,lastSelectedFooter:ad,carousel:ad,instrumentation:ad,packageIds:ad,visibleElementCount:0,textCount:ad,paginationType:ad,yep:ad,cokeTestId:ad,mcode:ad,woeId:ad,cookieDomain:ad,delayMouseover:ad,timeDelayed:0,carouselContainer:ad,carouselOuterContainer:ad,footerOverlay:ad,loadingOverlay:ad,isTodayOnTop:1,showDate:U,animMode:k,animStoryOverlayDuration:0,animStoryOverlayDelay:0,animTransition:au,preloadPaneCount:0,timeoutPaneCount:0,animIntervalInitial:0,animIntervalSubsequent:0,isInitialAnim:U,animFadeDuration:C,animHtml:ad,animPlayBeacon:ad,animPauseBeacon:ad,animPlayString:ad,animPauseString:ad,delayAutoPlayMouseover:ad,autoPlayReference:ad,isOtherModuleOpen:A,isManuallyPaused:A,titleRegion:ad,statemgr:ad,arcadeTransport:ad,doBroadcastEvent:A,footerHeight:0,blurHandler:ad,focusHandler:ad,activeElement:ad,mod:ad,handleOffsetWidth:0,handleParentLeft:0,handleParentOffsetWidth:0,handleCursorOffset:0,populateStoryRequestId:ad,populateScrollItemRequestId:ad,unifiedEnabled:ad,persPkgId:ad,clickStCookie:ad,clickStToastCookie:ad,todayPkgPersEnabled:ad,inlineVideoEnabled:A,videoService:ad,videoBindNode:ad,videoPlayer:ad,sec:ad,i13nReason:ad,moneyballAdEnabled:false,moneyballAdPkgId:"",moneyballAdData:null,payoffsFantasyTTL:ad,init:function(aD){this.Y=aD.getService("yui");this.cache={};this.moduleId=aD.getId();this.moduleapi=aD;this.cookieDomain=aD.getService("moduleplatform").getProperty("cookieDomain");this.instrumentation=aD.getService("instrumentation");this.storage=aD.getService("storage");this.userinfo=aD.getService("userinfo");this.inlineLightboxEnabled=aD.getContextData("inlineLightboxEnabled");this.moneyballAdEnabled=aD.getContextData("moneyballAdEnabled");this.moneyballAdPkgId=aD.getContextData("moneyballAdPkgId");this.moneyballAdData=aD.getContextData("moneyballAdData");var aC=this.statemgr=aD.getService("statemgr");this.todayPkgPersEnabled=aD.getContextData("today_pkg_pers");if(this.todayPkgPersEnabled){this.clickStCookie=aC.getUserModuleState(W);}this.arcadeTransport=aD.getService("moduleplatform").getService("arcade_transport");this.inlineVideoEnabled=aD.getContextData("inline.video.enabled");if(this.inlineVideoEnabled){this.videoService=aD.getService("videoyep");if(this.videoService){this.videoPlayer=this.videoService.create();}this.sec=aD.getContextData("sec");}this.footerHoverOpacity=aD.getContextData("footerHoverOpacity");aD.listen(aq);aD.listen(aw);aD.listen(M);aD.listen(a);aD.listen(S);aD.listen(az);aD.listen(E);aD.listen(am);aD.listen(ah);aD.listen(r);aD.listen(l);},onviewload:function(aO){if(aO=="default"){var aD=this.Y,aL=aD.UA.ie,aV,aJ,aU,aR,aZ,aX,a1,aG,aE,aY=this.moduleId,a2=this.moduleapi,a0=a2.getContextData(),aH=a2.getService("carousel"),aQ=a2.getContextData("crslAnimEnabled"),aK=this.clickStCookie,aF,aN,aI,aW,aP,aS,aC,aT,aM;aJ=this.body=a2.getViewNode(aO);if(this.inlineVideoEnabled){this.videoBindNode=aJ.one(".fptoday-container");}aR=this.mainStory=aJ.getById(aY+"-main_story");this.footerOverlay=aJ.query(".footer-overlay");this.loadingOverlay=aJ.query(".loading-overlay");if(!aR||aJ.query(".xotitle")){this.onviewevent=ad;return;}this.mainStoryContent=aR.one(j);aU=this.carousel=aH.create(aJ.query("."+u),{animDuration:0.4,loop:U,animate:aQ});aU.subscribe("beforescroll",this.loadScrollItem,this);aU.subscribe("scroll",this.updatePaginator,this);this.isTodayOnTop=a2.getContextData(i);this.showDate=a2.getContextData("showdate");aZ=this.packageIds=a0.pkgIds;aM=this.i13nReason=a0.i13nReason;if(this.moneyballAdEnabled&&this.moneyballAdPkgId&&this.moneyballAdData){this.packageIds.splice(5,0,this.moneyballAdPkgId);this.packageIds.pop();}this.initializeCache(a0);a1=aJ.query("#"+aY+aa+"0 ."+ae);this.lastSelectedFooter=(a0.centerStory==1)?a1.next("."+ae):a1;this.visibleElementCount=aZ.length/aU.getItemCount();this.textCount=a0.textCount;this.paginationType=(a0.paginationtype)?a0.paginationtype:m;this.cokeTestId=a0.cokeTestId;this.mcode=a0.mcode;this.woeId=a0.woeId;this.timeDelayed=a2.getContextData("today_delay_mouseover")||J;if(aU.getItemCount()>1){aX=aJ.query(".y-carousel-list").get("children");aX.removeClass(v);this.updatePaginator();aJ.query(".navigation").removeClass(y);}aG=this.carouselContainer=aJ.one("."+u);aE=this.carouselOuterContainer=aJ.one(".carousel-container");aG.on(V,this.handleFooterMouseover,this);aG.on(X,this.handleFooterMouseout,this);this.unifiedEnabled=a2.getContextData("unified.todaynews.enabled");this.animMode=a2.getContextData("footer.anim.mode");if(this.animMode!=k){this.animIntervalInitial=a2.getContextData("footer.anim.interval.initial")||H;this.animIntervalSubsequent=a2.getContextData("footer.anim.interval.subsequent")||H;this.animFadeDuration=a2.getContextData("footer.anim.fade.duration")||C;this.animTransition=a2.getContextData("footer.anim.transition")||au;this.preloadPaneCount=a2.getContextData("footer.anim.preload.pane_count")||0;this.timeoutPaneCount=a2.getContextData("footer.anim.timeout.pane_count")||0;this.animHtml=aJ.create(a2.getContextData("animHtml"));aT=aJ.one(".title-date");this.titleRegion=aT?aT.get("region"):ad;this.attachEngagingAreaMouseEvents();if(aL){document.onfocusout=this.Y.bind(this.handleBlur,this);document.onfocusin=this.Y.bind(this.handleFocus,this);}else{this.blurHandler=this.Y.on("blur",this.Y.bind(this.handleBlur,this),window);this.focusHandler=this.Y.on("focus",this.Y.bind(this.handleFocus,this),window);}this.insertPlayPauseButton();this.isInitialAnim=U;this.isManuallyPaused=a2.getContextData("animPausedState");this.startAutoPlay();}this.doBroadcastEvent=a2.getContextData("broadcast.interactive_event");this.animStoryOverlayDuration=a2.getContextData("layout.overlay.anim.duration");this.showMainStoryOverlay();this.animStoryOverlayDelay=a2.getContextData("layout.overlay.anim.delay");if(aK&&aK.pkgId&&aK.pkgIds){aP=true;aN=aK.pane?aK.pane:0;aC=aK.pkgIds;aF=aC.length;for(aV=0;aV<aF;aV++){aS=aC[aV];aI=this.indexOf(aS,aZ);if("-1"!=aI&&(!aW||(aW&&(aW+1)==aI))){aW=aI;}else{aP=false;break;}}if(aP){this.persPkgId=aK.pkgId;if("0"!=aN){this.carousel.scrollTo(aN);}else{this.handlePersistantScroll();}}}if(aK){this.statemgr.setUserModuleState(W,ad);}this.payoffsFantasyEnabled=a2.getContextData("payoffsFantasyEnabled");if(this.payoffsFantasyEnabled){this.payoffsFantasyTTL=a2.getContextData("payoffsFantasyTTL");}}},indexOf:function(aF,aE){var aD=aE.length,aC;for(aC=0;aC<aD;aC++){if(aE[aC]==aF){return aC;}}return -1;},handlePersistantScroll:function(aE){var aF,aD=this.body.getById(this.moduleId+aa+this.clickStCookie.pane).all("a"),aC=this.persPkgId;if(aD){aD.each(function(aG){if(aG.getAttribute("y-pkgid")==aC){aF=aG;}});if(aF){this.populateStory({linkNode:aF,userHover:A});}}this.persPkgId=null;},onviewunload:function(aC){if(aC=="default"){this.cleanup();}},onviewevent:function(aP,aF){var aD,aM=aF.target,aQ=aF.type,aG,aK,aS,aH,aR,aJ,aO=this.delayMouseover,aI=A,aL,aC,aE,aN={};if(aO){aO.cancel();this.delayMouseover=ad;}if(aP=="default"&&aM){if(this.inlineLightboxEnabled){aL=aM.ancestor(".fp-open-inline",true);if(aL){aF.preventDefault();if(aL.hasClass("fp-bday")){aN={name:aL.getData("bday-name"),bday:aL.getData("bday-date"),hash:aL.getData("bday-hash"),id:aL.getData("bday-fbid")};this.moduleapi.broadcast("fp:open-inline",{sec:"fptoday-bday",mode:"embed",module:"birthday",subModuleView:"birthday-story",subModuleData:this.Y.JSON.stringify(aN)});}else{if(aL.getAttribute("data-uuid")){aC=aL.getAttribute("data-uuid");}if(aL.getAttribute("href")){aE=aL.getAttribute("href");}else{aE=aL.one("A.rapidnofollow").getAttribute("href");}this.moduleapi.broadcast("fp:open-inline",{uuid:aC,href:aE,sec:"td-strm",ct:"1"});}return;}}if(aQ=="keyup"){if(this.carouselContainer.contains(aM)){this.handleFooterMouseover(aF);this.cancelAutoPlay();}}else{if(this.carouselContainer.contains(aM)){aD=this.handleFooterClick(aM);}else{if(this.classMatch(aM,at)){aD=this.previous;aI=U;}else{if(this.classMatch(aM,q)){aD=this.next;aI=U;}else{if(this.classMatch(aM,ag)){aD=this.handleManualPlayPauseAutoPlay(ag,aM);}else{if(this.classMatch(aM,n)){aD=this.handleManualPlayPauseAutoPlay(n,aM);}else{if((aM.hasClass(ac)||this.classMatch(aM,O))){aD=this.handleMainStory(aM);}}}}}}}if(this.todayPkgPersEnabled&&aQ=="click"&&(aM.get("tagName")=="A"||aM.ancestor("a"))&&aM.ancestor(".fptoday-container")){aG=this.carousel.getCurrentIndex();aJ=this.statemgr;aK=aM.ancestor(".fptoday-container").one(".footer-section .selected");aS=aK.getAttribute("y-pkgid");aH=[];aK.ancestor("li").all("a").each(function(aT){aH.push(aT.getAttribute("y-pkgid"));});aR={pane:aG,pkgId:aS,pkgIds:aH};aJ.setUserModuleState(W,aR);}if(aD){this.cancelAutoPlay();aF.preventDefault();aD.call(this);if(aI&&this.doBroadcastEvent){this.broadcastEvent();}}}},loadScrollItem:function(aQ){var aK=this.body,aG,aH,aR=this.carousel,aU=this.moduleapi,aO=aR.getCurrentIndex(),aC=aO,aS=this.moduleId,aP=this.animMode,aL=aK.getById(aS+aa+aO),aI,aJ="",aM=ad,aD,aE,aF,aN=aQ.toIndex,aT=(aN-aQ.fromIndex==1)?q:at;if(aL){if(aP==k){aD=ab;aE=this.populateScrollItem;aF=this.populateScrollItemFailure;aJ=aL.hasClass(N)?P:"";}else{aD=c;aE=this.preloadSuccess;aF=this.preloadFailure;if(aL.hasClass(N)){aJ=P;}else{if(this.preloadPaneCount!==aB){aJ=w;}}}if(aJ!==""){aM=this.getPackageIds(aO,aJ,aT);}if(aM&&aM.length>0){if(aJ==w){aU.refreshView("default");return;}if(aT==at&&aJ==T){aC=aO-aM.length/this.visibleElementCount+1;}aG={type:"module",moduleId:aS,args:{_action:"show",_subAction:aD,storyIds:aM,panelIndex:aC,cokeTestId:this.cokeTestId,mcode:this.mcode,woeId:this.woeId,todaytop:this.isTodayOnTop,i13nReason:this.i13nReason,adData:this.moneyballAdData||""}};aH={success:aE,failure:aF,argument:{panel:aL,panelIndex:aO,showStory:U,direction:aT},scope:this};if(!this.autoPlayReference){aG.args=this.Y.merge(aG.args,{isScroll:1});}this.loadingOverlay.removeClass(v);if(this.arcadeTransport.isRequestPending(this.populateScrollItemRequestId)){this.arcadeTransport.abortRequest(this.populateScrollItemRequestId);}this.populateScrollItemRequestId=this.arcadeTransport.makeRequest(aG,aH,aS);}else{if(aP!=k){if(!this.persPkgId){aR=this.carousel;aI=aR.getItemNode(aR.getCurrentIndex()).query("."+ae);this.populateStory({linkNode:aI,userHover:A});}else{this.handlePersistantScroll();}this.startAutoPlay();}}}},preload:function(aG,aD,aI){var aC=this.body.getById(this.moduleId+aa+aG),aF=this.getPackageIds(aG,T,q),aE={type:"module",moduleId:this.moduleId,args:{_action:"show",_subAction:c,storyIds:aF,panelIndex:aG,cokeTestId:this.cokeTestId,mcode:this.mcode,woeId:this.woeId,todaytop:this.isTodayOnTop,adData:this.moneyballAdData||""}},aH={success:this.preloadSuccess,failure:this.preloadFailure,argument:{panel:aC,panelIndex:aG,showStory:aD,direction:q},scope:this};if(aI){aE.args=this.Y.merge(aE.args,aI);}if(this.arcadeTransport.isRequestPending(this.populateScrollItemRequestId)){this.arcadeTransport.abortRequest(this.populateScrollItemRequestId);}this.populateScrollItemRequestId=this.arcadeTransport.makeRequest(aE,aH,this.moduleId);},preloadSuccess:function(aD,aJ){var aU=this.moduleapi,aQ=this.carousel,aF=aU.getContextData(al),aC=aU.getContextData(R),aM=aJ.panelIndex,aK=aJ.panel,aG=aJ.showStory,aS=aJ.direction,aO=this.visibleElementCount,aN,aH,aP,aI=(aS==at)?(aC.length-aO):0,aR,aE=aK,aT,aL="";while(aK&&aK.hasClass(N)&&aC[aI]){aL+=aC[aI];if((aI+1)%aO===0){aK.removeClass(N);aK.set(F,aL);aN=aK.all("."+ae);for(aR=0;aR<aO;aR++){aT=this.extractId(aN.item(aR));if(aT!=""){this.cache[aT]=aF[aT];}}}aI++;if(aI%aO===0){aK=(aS==at)?aK.previous():aK.next();aL="";aI=(aS==at)?aI-(2*aO):aI;}}if(aG){if(aM!=aQ.getCurrentIndex()){this.carousel.scrollTo(aM);}this.loadingOverlay.addClass(v);if(!this.persPkgId){aH=aE.one("."+ae);this.populateStory({linkNode:aH,userHover:A});}else{this.handlePersistantScroll();}this.startAutoPlay();}aP=aE.one(".empty");if(aP){aU.refreshView("default");}},preloadFailure:function(aD,aE){var aC=this.Y.Lang.isObject(aD);if(aC&&aD.statusText==x){if(this.preloadPaneCount==this.timeoutPaneCount){this.handleFatalError();}else{}}else{if(aC&&aD.statusText==ao){}else{this.handleFatalError();}}},handleFatalError:function(){var aC=this.carousel;this.animMode=L;this.loadingOverlay.addClass(v);aC.scrollTo(0,A);this.populateStory({linkNode:aC.getItemNode(0).query("."+ae),userHover:A});this.body.one(".y-nav-buttons").addClass(y);},updatePaginator:function(){var aC=this.body,aF,aI,aE,aD=this.visibleElementCount,aH,aG;switch(this.paginationType){case m:aC.query(".navigation .selected").removeClass(av);aC.getById(this.moduleId+"_"+this.carousel.getCurrentIndex()).addClass(av);break;case p:aF=aC.query(".navigation .y-nav-count");this.setPaginationString(this.carousel.getCurrentIndex()+1,this.carousel.getItemCount());break;case Y:if(aC.all(".package-overlay")&&aC.all(".package-overlay").item(0).hasClass("CTA-live")){if(aC.one(".y-nav-count")){aC.one(".y-nav-count").setStyle("display","none");}if(aC.one(".playpause")){aC.one(".playpause").setStyle("display","none");}}else{if(aC.one(".y-nav-count")){aC.one(".y-nav-count").setStyle("display","block");}if(aC.one(".playpause")){aC.one(".playpause").setStyle("display","block");}}aI=aC.queryAll("."+ae);aE=aI.size();aG=(this.carousel.getCurrentIndex()+1)*aD;aH=aG-(aD-1);this.setPaginationString(aH+" \u2013 "+aG,aE);break;}},setPaginationString:function(aF,aE){var aD,aC=this.body.query(".navigation .y-nav-count");if(aC){aD=this.Y.Lang.sub(this.textCount,{"0":aF,"1":aE});aC.set(F,aD);}},handleFooterMouseover:function(aG){var aF=aG.target,aE=aF.ancestor(".item"),aC,aH=aF.ancestor(".footer-img-holder"),aD=false;if(!aF){return;}if(aF.hasAttribute(ak)){aC=aF;}else{aC=aE;}if(this.footerHoverOpacity){if(aH){this.body.one(".package-overlay").removeClass("text-hover");}else{aD=true;this.body.one(".package-overlay").addClass("text-hover");}}if(!aC||(aC.hasClass(ae)&&aC.hasClass(av))){return;}this.delayMouseover=this.Y.later(this.timeDelayed,this,this.populateStory,{linkNode:aC,userHover:U,showOpaque:aD});},handleFooterMouseout:function(aD){var aC=this.delayMouseover;if(this.body.one(".package-overlay")){this.body.one(".package-overlay").removeClass("text-hover");}if(aC){aC.cancel();this.delayMouseover=ad;}},populateStory:function(aE){var aH,aI,aL,aK,aT=this.moduleapi,aN=this.cache,aC=aE.linkNode,aQ=aE.userHover,aO=this.animMode===s||!aQ,aS=this.extractId(aC),aF=this.lastSelectedFooter,aP=aF.query(".image"),aR=aN[aS],aJ,aM,aG,aD=aE.showOpaque;if(!aC.hasClass(ae)){return;}if(aR&&aR.index&&!(/^\d+$/.test(aR.index))){return;}if(aP){aP.replaceClass(ap,ar);}aF.removeClass(av).replaceClass(ap,Q).replaceClass(f,g).addClass(z);this.lastSelectedFooter=aC;if(!aR){aS=this.extractId(aC);this.lastSelectedFooter=aC;aR=aN[aS];}if(aR){this.lastSelectedFooter.addClass(av).replaceClass(Q,ap).replaceClass(g,f).removeClass(z);aK=aR.html;if(aK){aO=(this.Y.UA.ie&&this.Y.UA.ie<=8)?A:aO;this.setMainStory(aK,aS,aO,U,aD);}else{aJ=this.body.getById(this.moduleId+"-header-image");if(aJ){if(aJ.hasAttribute("data-img")){aM=aJ.getAttribute("data-img");aG=aJ.get("text");}else{aM=aJ.get("src");aG=aJ.get("alt");}}aH={type:"module",moduleId:this.moduleId,args:{_action:"show",_subAction:K,storyId:aS,storyIndex:aR.index,cokeTestId:this.cokeTestId,woeId:this.woeId,todaytop:this.isTodayOnTop}};aI={success:this.handlePopulateStorySuccess,failure:this.handlePopulateStoryFailure,argument:{storyId:aS,oldImageSrc:aM,oldImageAlt:aG,doFade:aO,showOpaque:aD},scope:this};if(aT.isRequestPending(this.populateStoryRequestId)){aT.abortRequest(this.populateStoryRequestId);}this.populateStoryRequestId=aT.makeRequest(aH,aI);}aL=aF.query("."+aj);if(this.showDate&&this.isTodayOnTop!="0"){this.mainStory.addClass("has-date");}if(aL){aL.replaceClass(aj,o);this.carouselContainer.removeClass(ay);}if(aC&&aQ){this.tracking(aC);}if(aS===this.moneyballAdPkgId&&aN[aS].imprBeacon){this.instrumentation.getBeaconImage(aN[aS].imprBeacon);aN[aS].imprBeacon=null;}this.updatePaginator();if(this.doBroadcastEvent&&aQ){this.broadcastEvent();}}},tracking:function(aC){var aD=this.cache,aE=this.extractId(aC);if(aD[aE]&&!aD[aE].beaconFired){if(aC.hasAttribute("data-b-tdh")){this.instrumentation.fireUltBeacon(aC.getAttribute("data-b-tdh"));}aD[aE].beaconFired=U;if(this.preloadPaneCount!==aB){this.setFPCKCookie(aE);}}},handleMainStory:function(aF){var aG,aH=ad,aC=this.cache,aE=aF.ancestor(".package-overlay",U,".type_fptoday"),aD;if(aE){if(!aF.ancestor("A",U,".type_fptoday")){aD=aE.one("H3 > A");this.moduleapi.navigate(aD.get("href"));}}if(!this.inlineVideoEnabled||!this.videoPlayer){return aH;}if(this.classMatch(aF,d)){aH=this.closeVideo;}else{if(aF.hasClass(ac)||!this.classMatch(aF,Z)&&(aF.hasAttribute(ak)||aF.ancestor(function(aI){return aI.hasAttribute(ak);}))){aG=this.extractId(this.lastSelectedFooter);if(aC[aG]&&aC[aG].clipId){aH=this.showInlineVideo;}}}return aH;},handleFooterClick:function(aD){var aF,aG=ad,aC=this.cache,aE=this.classMatch(aD,ae);if(aE){aF=this.extractId(aE);if(aC[aF]&&aC[aF].clipId&&this.inlineVideoEnabled){aG=this.showInlineVideo;}}return aG;},closeVideo:function(){if(this.inlineVideoEnabled&&this.videoPlayer){this.videoPlayer.detachVideo();}},showInlineVideo:function(){if(!this.inlineVideoEnabled){return;}var aF=this.extractId(this.lastSelectedFooter),aD=this.cache[aF],aC=this.footerOverlay,aE;if(aC){aC.removeClass(v);}aE={analytics:{sec:this.sec,ccode:this.cokeTestId,cpos:aD.index},config:{yep:{id:aD.clipId,autoplay:U},animated:A,attach:this.body.one(".main-story-content")}};this.videoPlayer.init(aE);},onmessage:function(aE,aC,aD){var aF=this.body.getById(this.moduleId+"-main_story");if(!aF||this.body.query(".xotitle")){return;}switch(aE){case M:case aq:case S:this.isOtherModuleOpen=U;this.cancelAutoPlay();break;case a:case aw:case az:this.isOtherModuleOpen=A;this.startAutoPlay();break;case E:this.handleResize();break;case r:case ah:this.cancelAutoPlay();break;case l:case am:this.startAutoPlay();break;default:break;}},handlePopulateStorySuccess:function(aD,aG){var aF=aD.data,aC=aF.story,aI=aG.storyId,aE=this.cache[aI],aH=this.extractId(this.lastSelectedFooter);if(aH===aI){aG.doFade=(this.Y.UA.ie&&this.Y.UA.ie<=8)?A:aG.doFade;this.setMainStory(aC,aI,aG.doFade,A,aG.showOpaque);aE.clipId=aF.clipId;aE.channelNodeId=aF.channelNodeId;}else{}},handlePopulateStoryFailure:function(aC,aD){},populateScrollItem:function(aE,aF){var aH,aD,aC=aF.panel,aG=this.body.getById(this.moduleId+aa+aF.panelIndex);aC.removeClass(N);this.loadingOverlay.addClass(v);aG.set(F,aE.data.footers);if(this.animMode!=k){if(!this.persPkgId){aH=this.carousel;aD=aH.getItemNode(aH.getCurrentIndex()).query("."+ae);this.populateStory({linkNode:aD,userHover:A});}else{this.handlePersistantScroll();}this.startAutoPlay();}},populateScrollItemFailure:function(aC){if(aC.statusText==x){}else{this.moduleapi.refreshView("default");}},getPackageIds:function(aH,aJ,aK){var aP=[],aM=this.packageIds,aI=aM.length,aO=this.visibleElementCount,aE=this.preloadPaneCount,aC,aN,aL,aD,aF,aG;if(aJ==w){aC=this.body.getById(this.moduleId+aa+aH);aN=aC.all("."+ae);for(aG=0;aG<aO;aG++){if(aN.item(aG).hasClass(N)){aP.push(aM[(aH*aO)+aG]);}}}else{aE=(aE==G)?aM.length/aO-1:aE;aL=this.carouselContainer.all(".y-panel");if(aK==at){aF=(aH+1)*aO;aD=(aJ!==T)?aF-aO:aF-aE*aO;if(aD<0){aD=aO;}}else{aD=aH*aO;aF=(aJ!==T)?aD+aO:aD+aE*aO;aF=aF>aI?aI:aF;}for(aG=aD;aG<aF;aG++){if(aL.item(Math.floor(aG/aO)).hasClass(N)){aP.push(aM[aG]);}}}return aP;},cleanup:function(){var aF=this.carousel,aC=this.delayMouseover,aE=this.carouselContainer,aD=this.moduleapi;if(aF){aF.unsubscribe("beforescroll",this.loadScrollItem);aF.unsubscribe("scroll",this.updatePaginator);aF.destroy();}if(aC){aC.cancel();}if(aE){aE.detach(V,this.handleFooterMouseover);aE.detach(X,this.handleFooterMouseout);}if(this.animMode!=k){this.detachEngagingAreaMouseEvents();this.cancelAutoPlay();if(this.Y.UA.ie){document.onfocusout=ad;document.focusin=ad;}else{this.Y.detach("blur",this.blurHandler,window);this.Y.detach("focus",this.focusHandler,window);}}aD.abortRequest(this.populateStoryRequestId);this.arcadeTransport.abortRequest(this.populateScrollItemRequestId);this.moduleapi.unlisten();this.body=this.statemgr=this.carousel=this.mainStory=this.mainStoryContent=this.delayMouseover=this.carouselContainer=this.carouselOuterContainer=this.populateStoryRequestId=this.populateScrollItemRequestId=this.activeElement=this.blurHandler=this.focusHandler=ad;},setMainStory:function(aH,aE,aJ,aC,aI){var aK=this.mainStoryContent,aF=this.mainStoryNext,aD,aG;if(aE==="id-fantasy"&&this.payoffsFantasyTTL){this.statemgr.setUserModuleState(h,parseInt(this.Y.Lang.now()/1000,10)+(60*60*this.payoffsFantasyTTL));}if(this.animMode==k||!aJ){aK.set(F,aH);this.replaceImageInMainStory(aH,aE,aC);this.showMainStoryOverlay();aD=aK;}else{if(this.animTransition===an){if(aF){this.crossFadeMainStoryEnd();aK=this.mainStoryContent;}this.mainStoryNext=aF=this.mainStory.insertBefore(D,this.mainStoryContent);aF.setContent(aH);aG=aF.one(".package-overlay");if(aG){aF.one(".package-overlay").removeClass("text-hover");if(aI){aF.one(".package-overlay").addClass("text-hover");}this.showMainStoryOverlay(aF);}aD=aF;}aK.transition({opacity:0,duration:this.animFadeDuration},this.Y.bind(this.fadeOutMainStoryEnd,this,aH,aE,aC));}},replaceImageInMainStory:function(aC,aE,aD){this.cache[aE].html=this.mainStoryContent.get(F);},showMainStoryOverlay:function(aC){var aE=this.mainStoryContent,aD=(aC||aE).one(".package-overlay");if(aD){if(aE.one(".package-overlay")&&aC&&aC!==aE&&this.animTransition===an){aE.one(".package-overlay").hide();}if(this.animStoryOverlayDuration){aD.setStyle("opacity",0);aD.transition({duration:this.animStoryOverlayDuration,delay:this.animStoryOverlayDelay,opacity:1});}else{aD.setStyle("opacity",1);}}},fadeOutMainStoryEnd:function(aF,aD,aC){var aJ=this.mainStoryContent,aE=this.extractId(this.lastSelectedFooter),aK,aI=this.body.one("#navigation-"+this.moduleId),aG=this.oldTextPosition,aH;if(aE===aD){if(this.animTransition===an){this.crossFadeMainStoryEnd();this.replaceImageInMainStory(aF,aD,aC);}else{aJ.set(F,aF);this.replaceImageInMainStory(aF,aD,aC);}}else{}if(this.animTransition===au){this.showMainStoryOverlay();aJ.transition({opacity:1,duration:this.animFadeDuration});}aH=this.mainStoryContent.one(af);if(aH){aK=aH.getAttribute("data-pos");if(aG){aI.replaceClass(aG,aK);}this.oldTextPosition=aK;}},crossFadeMainStoryEnd:function(){if(this.mainStoryNext){var aC=this.mainStoryContent;this.mainStoryContent=this.mainStoryNext.replaceClass("main-story-next","main-story-content");aC.remove();this.mainStoryNext=ad;}},extractId:function(aC){return(aC?aC.getAttribute("y-pkgId"):ad);},classMatch:function(aD,aC){return aD.hasClass(aC)?aD:aD.ancestor(function(aE){return aE.hasClass(aC);});},initializeCache:function(aF){var aE,aH=this.packageIds,aD=aF.stories,aG=aH.length,aC;for(aE=0;aE<aG;aE++){aC=aD[aH[aE]];this.cache[aH[aE]]=(aC&&aC.html)?{html:aC.html,index:aE,clipId:aC.clipId,channelNodeId:aC.channelNodeId,beaconFired:aC.beaconFired}:{html:ad,index:aE,clipId:ad,channelNodeId:ad,beaconFired:A};}},previous:function(){var aC=this.carousel;if(!aC.isScrolling()){aC.previous();}},next:function(){var aC=this.carousel;if(!aC.isScrolling()){aC.next();}},startAutoPlay:function(){if(this.animMode!=k&&!this.autoPlayReference&&!this.isVideoPlaying()&&!this.isOtherModuleOpen&&!this.isManuallyPaused){var aC=this.animIntervalInitial,aD=this.animIntervalSubsequent;if(this.isInitialAnim){if(aC>0){this.autoPlayReference=this.Y.later(aC*1000,this,this.autoPlay,ad,U);}}else{if(aD>0){this.autoPlayReference=this.Y.later(aD*1000,this,this.autoPlay,ad,U);}}}},autoPlay:function(){var aG=this.lastSelectedFooter,aI=aG.next(),aH=this.animMode,aK=this.carousel,aE,aF=aK.getCurrentIndex(),aC=aF+1,aJ,aD=this.timeoutPaneCount;if(this.hasAdRunning()){this.cancelAutoPlay();this.startAutoPlay();return;}if(aI){aE=aI;this.populateStory({linkNode:aE,userHover:A});if(!aI.next()&&(aH==ax||aH==s)){aJ=this.body.getById(this.moduleId+aa+aC);if(aJ&&aJ.hasClass(N)){this.preload(aC,A);}}}else{if(aH==L){aE=aK.getItemNode(aF).query("."+ae);this.populateStory({linkNode:aE,userHover:A});}if(aH==ax||aH==s){if(this.arcadeTransport.isRequestPending(this.populateScrollItemRequestId)){this.arcadeTransport.abortRequest(this.populateScrollItemRequestId);if(aD>0&&this.preloadPaneCount!=aD){this.preloadPaneCount=aD;this.preload(aC,U,{isTimeout:1});}}else{this.next();}}}if(this.isInitialAnim){this.isInitialAnim=A;this.cancelAutoPlay();this.startAutoPlay();}},cancelAutoPlay:function(aD){var aC=this.autoPlayReference;if(aC){aC.cancel();this.autoPlayReference=ad;}if(this.isInitialAnim){this.isInitialAnim=A;}if(aD){this.tracking(this.lastSelectedFooter);}},delayedStartOrCancelAutoPlay:function(aD,aE){var aC=this.delayAutoPlayMouseover;if(aC){aC.cancel();this.delayAutoPlayMouseover=ad;}this.delayAutoPlayMouseover=this.Y.later(this.timeDelayed,this,aD,aE);},handleEngagingAreaMouseover:function(aE){var aD=this.titleRegion,aC=aE.pageX,aF=aE.pageY;if(aD&&aD.top<aF&&aD.right>aC&&aD.bottom>aF&&aD.left<aC){this.delayedStartOrCancelAutoPlay(this.startAutoPlay,A);}else{this.delayedStartOrCancelAutoPlay(this.cancelAutoPlay,U);}},handleEngagingAreaMouseout:function(aC){this.delayedStartOrCancelAutoPlay(this.startAutoPlay);},attachEngagingAreaMouseEvents:function(){var aC=this.carouselOuterContainer,aD=this.mainStory;aC.on(V,this.handleEngagingAreaMouseover,this);aC.on(X,this.handleEngagingAreaMouseout,this);aD.on(V,this.handleEngagingAreaMouseover,this);aD.on(X,this.handleEngagingAreaMouseout,this);},detachEngagingAreaMouseEvents:function(){var aC=this.carouselOuterContainer,aD=this.mainStory;aD.detach(V,this.handleEngagingAreaMouseover);aD.detach(X,this.handleEngagingAreaMouseout);aC.detach(V,this.handleEngagingAreaMouseover);aC.detach(X,this.handleEngagingAreaMouseout);},handleBlur:function(){if(this.Y.UA.ie){this.activeElement=document.activeElement;}this.cancelAutoPlay(A);this.detachEngagingAreaMouseEvents();},handleFocus:function(){if(!this.Y.UA.ie||this.activeElement==document.activeElement){this.startAutoPlay();this.attachEngagingAreaMouseEvents();}},isVideoPlaying:function(){if(this.inlineVideoEnabled&&this.videoPlayer){return this.videoPlayer.playing;}return A;},insertPlayPauseButton:function(){var aE=this.body.query(".navigation .next"),aD=this.moduleapi,aC=this.animHtml;this.animPlayBeacon=aD.getContextData("animPlayBeacon");this.animPauseBeacon=aD.getContextData("animPauseBeacon");this.animPlayString=aD.getContextData("animPlay");this.animPauseString=aD.getContextData("animPause");if(aE){aE.get(e).insertBefore(aC,aE);}if(this.body.all(".package-overlay")&&this.body.all(".package-overlay").item(0).hasClass("CTA-live")){if(this.body.one(".playpause")){this.body.one(".playpause").setStyle("display","none");}}},handleManualPlayPauseAutoPlay:function(aG,aE){var aI=ad,aD=this.statemgr,aF,aH=(aE.get("tagName")=="A")?aE:aE.ancestor("A"),aC=aH.one(".ti");if(aG==ag){this.isManuallyPaused=A;aF=B;aH.replaceClass(ag,n);aH.setAttribute(I,this.animPauseBeacon);aC.set(F,this.animPauseString);aI=this.startAutoPlay;}else{if(aG==n){this.isManuallyPaused=U;aF=ai;aH.replaceClass(n,ag);aH.setAttribute(I,this.animPlayBeacon);aC.set(F,this.animPlayString);aI=this.cancelAutoPlay;}}if(aI&&aD){aD.setUserModuleState(aA,aF);}return aI;},broadcastEvent:function(){this.moduleapi.broadcast(t);},setFPCKCookie:function(aD){var aC={type:"module",moduleId:this.moduleId,args:{_action:"show",_subAction:b,storyId:aD}},aE={scope:this};if(true){return;}this.arcadeTransport.makeRequest(aC,aE,this.moduleId);},hasAdRunning:function(){return(document.documentElement.className.indexOf("ad-running")>-1);},handleResize:function(){this.carousel.resetPositioning();}};})();/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
(function(){var i="tooltip",a="mouseover",o="mouseout",d="focus",k="blur",c="hover",f="td-ofl-rm",h="td-ofl-ctrl",g="remove",e=".type_offlead",l=".offlead-drawer-login",m=".voh-parent-wrapper",j=".offlead-wrapper",n="data-pkg-id",b="offleadPkgId";YModules.type_offlead={body:null,editBody:null,id:"",moduleapi:null,viewevents:["click"],tooltip:null,listeners:[],userinfo:null,statemgr:null,wrapperContent:null,removeTimer:null,removeEnabled:false,actionDrawer:null,instrumentation:null,init:function(p){this.Y=p.getService("yui");this.id=p.getId();this.moduleapi=p;this.removeLoginEnabled=this.moduleapi.getContextData("remove.login.enabled");this.rapidEnabled=this.moduleapi.getContextData("rapid.enabled");this.statemgr=p.getService("statemgr");this.instrumentation=p.getService("instrumentation");if(this.removeLoginEnabled){this.userinfo=p.getService("userinfo");this.loginService=p.getService("login");this.userState=this.userinfo.isLoggedIn();if(this.loginService&&!this.userState){this.loginWrapperItem=this.Y.Node.create(this.moduleapi.getContextData("drawer.login.html"));this.loginService.getButtons(this.loginWrapperItem,{sec:f,layout:"horizontal",title:"",narrow:1});this.loginService.configClick({selector:l+" a",clickHandler:this.Y.bind(this.onLoginBtnClick,this)});}}},onviewload:function(t){var s=this.moduleapi,r="t",q="c";this.body=s.getViewNode(t);this.actionDrawer=this.body.one(".offlead-drawer");if(this.body.one(m)){this.removeEnabled=true;}if(this.removeEnabled){if(this.removeLoginEnabled){this.actionDrawer.append(this.loginWrapperItem);}try{if(this.moduleapi.getContextData("offlead.position")==1){q="b";r="b";}this.tooltip=s.getService("tooltip").create({parentNode:this.body,className:i,position:{box:r,arrow:q}});this.tooltip.getNode().addClass("fz-xxs");this.listeners.push(this.body.delegate([a,d],this.onShowTooltip,".side-button",this));this.listeners.push(this.body.delegate([o,k],this.onHideTooltip,".side-button",this));if(this.Y.UA.ie&&this.Y.UA.ie<=6){this.listeners.push(this.body.delegate([a,o],this.onOffleadHover,".voh-parent",this));}}catch(p){}}},onviewunload:function(p){if(p==="default"){this.body=null;}else{if(p==="edit"){this.editBody=null;}}},onviewevent:function(r,q){var p=q.target;this.instrument(p);if(this.removeEnabled){if(p.hasClass("side-button")){if(p.hasClass("close")){this.handleCloseBtn(q);}}}},onOffleadHover:function(p){var r=p.currentTarget,q=p.relatedTarget,s;if(r!==q&&!r.contains(q)){s=this.body.one(".side-button");if(s){s.toggleClass("voh",(p.type===o));}}},onShowTooltip:function(p){var q=this.moduleapi,s,r=p.target;s=this.body.hasClass(g)?q.getString("STR.TOOLTIP.UNDO"):q.getString("STR.INTERESTS.REMOVE");if(s){this.tooltip.show(r,{msg:s});}},onHideTooltip:function(p){this.tooltip.hide();},handleCloseBtn:function(p){var u=this.body.one(".voh-parent"),q=this.removeLoginEnabled,t=this.userinfo?this.userinfo.isLoggedIn():null,s=this.getPkgId(),r=this.instrumentation.getBeaconKeys(p.target);if(!this.body.hasClass(g)){if(q&&!t){this.statemgr.setUserModuleState("loggedOutRemove",s);this.showLoginBtns();}else{if(r&&this.rapidEnabled){r.rspns="rmct";this.instrumentation.fireBeacon(r);}this.removeOfflead();}this.body.addClass(g);u.addClass(c);}else{if(q&&!t){this.actionDrawer.transition({height:"0px",duration:0.3,easing:"ease-out"},this.Y.bind(function(){this.actionDrawer.addClass("d-n");this.body.removeClass("drawer-open");},this));this.statemgr.removeUserModuleState("loggedOutRemove");}else{if(r&&this.rapidEnabled){r.rspns="unrmct";this.instrumentation.fireBeacon(r);}this.undoRemoveOfflead();}this.body.removeClass(g);u.removeClass(c);}this.onShowTooltip(p);},getPkgId:function(){return this.body.one(m).getAttribute(n);},removeOfflead:function(){var q=this.body.one(j),r=this.getPkgId(),p;if(!this.wrapperContent){this.wrapperContent=q.getContent();}q.setContent(this.moduleapi.getString("STR.ITEM_REMOVED"));if(!this.removeTimer){if(this.removeLoginEnabled){this.statemgr.saveUserSetting("ol_pkg",r,this.moduleapi);}else{this.statemgr.setUserModuleState(b,r);}this.removeTimer=setTimeout(this.Y.bind(function(){if(this.Y.UA.ie&&this.Y.UA.ie<=7){this.body.addClass("d-n");}else{q.transition({height:"0px",duration:0.3,easing:"ease-out"},this.Y.bind(function(){this.body.addClass("d-n");},this));}if(this.Y.UA.ie&&this.Y.UA.ie<=8){p=this.Y.one(".type_fstream");p._node.className=p._node.className;}},this),4000);}},undoRemoveOfflead:function(){var p=this.body.one(j);if(this.removeLoginEnabled){this.statemgr.saveUserSetting("ol_pkg","0",this.moduleapi);}else{this.statemgr.removeUserModuleState(b);}p.setContent(this.wrapperContent);clearTimeout(this.removeTimer);this.removeTimer=null;},showLoginBtns:function(){var q=this.actionDrawer.one(".embed"),p,r;this.body.addClass("drawer-open");this.actionDrawer.removeClass("d-n");if(!this.actionDrawer.one(".title")){r=this.Y.Node.create(this.moduleapi.getContextData("drawer.title.html"));q.prepend(r);}p=q.get("offsetHeight");this.actionDrawer.transition({height:p+"px",duration:0.3,easing:"ease-in"},function(){});},instrument:function(q){var p={};if(q.ancestor(".ylogin",true,e)){p.sec=f;p.slk="login-yh";p.itc=0;}else{if(q.ancestor(".fblogin",true,e)){p.sec=f;p.slk="login-fb";p.itc=1;}else{if(q.ancestor(".close",true,e)){if(q.ancestor(".drawer-open",true,e)){p.sec=h;p.slk="undo";p.itc=1;p.g="id-"+this.getPkgId();p.ltxt=this.moduleapi.getContextData("offlead.ltxt");p.pkgt=this.moduleapi.getContextData("offlead.pkgt");}else{p.sec=h;p.slk="rm";p.itc=1;p.g="id-"+this.getPkgId();p.ltxt=this.moduleapi.getContextData("offlead.ltxt");p.pkgt=this.moduleapi.getContextData("offlead.pkgt");}}}}if(p.sec){this.instrumentation.fireBeacon(p);}}};}());/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
YModules.type_livevent={body:null,editBody:null,id:"",moduleapi:null,viewevents:["click"],tooltip:null,listeners:[],init:function(a){this.Y=a.getService("yui");this.id=a.getId();this.moduleapi=a;},onviewload:function(b){var a=this.moduleapi;this.body=a.getViewNode(b);},onviewunload:function(a){if(a==="default"){this.body=null;}else{if(a==="edit"){this.editBody=null;}}},onviewevent:function(g,f){var d=f.target,b=null,c,a;if(g==="default"){if(d.ancestor(".evt-header")){b=d.ancestor(".evt-header").ancestor("div");}if(d.hasClass("evt-header")){b=d.ancestor("div");}if(b){b.toggleClass("toggle-open");c=b.getAttribute("data-alt-b");a=b.getAttribute("data-b");b.setAttribute("data-b",c);b.setAttribute("data-alt-b",a);}}}};/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
YUI.add("storage_service",function(d){var i="MPServices",e="StorageProvider",f=true,h=false,g=null,a={},b={},j=g;function c(k){this._moduleId=k;this.onReady(function(){this.ready=f;},this);}c.prototype={_moduleId:g,ready:h,onReady:function(l,k){d.StorageLite.on("storage-lite:ready",function(){l.call(k);});},getItem:function(k){var l;try{l=b[k]||d.StorageLite.getItem(k,f);}catch(m){j.logError(this._moduleId,m.message);}finally{if(l&&d.Object.owns(l,"$v")&&(!l.$e||l.$e>+(new Date()))){b[k]=l;return l.$v;}delete b[k];return g;}},setItem:function(l,p,k){var m;try{m={$v:p,$e:k?+(new Date())+k:0};d.StorageLite.setItem(l,m,f);b[l]=m;return f;}catch(o){if(/QUOTA_EXCEEDED_ERR/.test(o.message)){try{d.StorageLite.removeItem(l);d.StorageLite.setItem(l,m,f);b[l]=m;return f;}catch(n){j.logError(this._moduleId,n.message);}}else{j.logError(this._moduleId,o.message);}return h;}},removeItem:function(k){try{delete b[k];d.StorageLite.removeItem(k);return f;}catch(l){j.logError(this._moduleId,l.message);return h;}},getSet:function(k,n){var p=this.getItem(k),m=+(new Date()),o=h,l={};d.Object.each(p,function(r,q){if(d.Object.owns(r,"$v")&&(!r.$e||r.$e>m)){l[q]=r.$v;}else{o|=delete p[q];}});if(o){this.setItem(k,p);}return n?d.Object.keys(l):l;},addToSet:function(l,m,n,k){var o=this.getItem(l)||{};o[m]={$v:n,$e:k?+(new Date())+k:0};return this.setItem(l,o);},removeFromSet:function(k,l){var m=this.getItem(k);if(m&&d.Object.owns(m,l)){delete m[l];return this.setItem(k,m);}return h;}};d.namespace(i)[e]={name:"storage",getService:function(l,k){if(!j){j=l.getService("metrologger");}if(!a[k]){a[k]=new c(k);}return a[k];}};if(d.ModulePlatform){d.ModulePlatform.registerService(d[i][e]);}},"0.0.1",{requires:["gallery-storage-lite","metrologger"]});/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
(function(){var j=null,n=false,i=true,e=null,d=30*60*1000,k="stream:filter",p="stream:dynamic",h="stream:fallback",c="stream:loadsuccess",a="stream_filter",g="recent_filters",b="filter-selected",m="transform",f="mouseover",o="mouseout",l=".static-list, .dynamic-list, .recent-list";YModules.type_fstream={body:null,editBody:null,id:"",moduleapi:null,platform:j,autoHideEnabled:false,autoHideService:j,swiperService:j,lastSwipeOffset:0,autoHideId:j,viewevents:["click"],isRtl:false,init:function(s){this.Y=s.getService("yui");this.id=s.getId();this.moduleapi=s;this.platform=s.getService("moduleplatform");this.instrumentation=s.getService("instrumentation");this.statemgr=s.getService("statemgr");this.storage=s.getService("storage");this.loginService=s.getService("login");this.swiperService=s.getService("swiper");this.isRtl=(this.moduleapi.getViewDirection("default")==="rtl");this.listeners=[];e=this.Y.config.win;var r=s.getContextData(),q=s.getService("userinfo");this.filterRestoreEnabled=r.filterRestoreEnabled;this.filterFontSize=r.filterFontSize;this.dropdownFilter=r.dropdownFilter;this.tabFilter=r.tabFilter;this.dropdownHover=r.dropdownHover;this.dynamicMax=r.dynamicMax;this.autoHideEnabled=r.autoHideEnabled;this.swipeFilterEnabled=r.swipeFilterEnabled;this.dynamicSectionEnabled=r.dynamicSectionEnabled;this.loginState=q.isLoggedIn();if(this.autoHideEnabled){this.autoHideService=s.getService("autohide");}this.recentFiltersEnabled=r.recentFiltersEnabled;s.listen(k);s.listen(p);s.listen(c);s.listen(h);},onviewload:function(v){var t=this.moduleapi,r,q=this.Y.one("#banner"),u,s;if(q){this.headerHeight=q.get("clientHeight");}if(v==="default"){this.body=t.getViewNode(v);}else{if(v==="edit"){this.editBody=t.getViewNode(v);}}if(this.body.one(".dropdown-label")){if(!this.dropdownFilter&&this.dropdownHover){this.listeners.push(this.body.delegate(f,this.onShowFilterMenu,".dropdown-label-text, .list-container, .drop-arrow",this));this.listeners.push(this.body.delegate(o,this.onHideFilterMenu,".dropdown-label-text, .list-container, .drop-arrow",this));}}if(this.swipeFilterEnabled){s=e.hasOwnProperty("onorientationchange")?"orientationchange":"resize";this.listContainer=this.body.one(".list-container");u=this.Y.bind(this.swipeActionHandler,this);this.swiper=new this.swiperService({body:this.listContainer,slides:1,completeHandler:u,actionEndHandler:u,transitionEnd:i,slideHandler:u,invalid_swipe_range:80});this.swiper.swipeMinDistance=0;this.listeners.push(this.Y.on(s,this.onOrientationChange,e,this));this.rotationDelay=this.Y.UA.android?250:0;}this.storage.onReady(function(){if(this.filterRestoreEnabled){this.savedFilters=this.storage.getItem(a);if(this.savedFilters&&this.savedFilters.loginState===this.loginState){t.unlisten(p);this.buildDynamicCategories(this.savedFilters.list,n);this.platform.on("ready",function(){t.broadcast(p,{dynamicCategories:this.savedFilters.list});},this);}else{this.statemgr.removeUserModuleState(a);this.savedFilters=j;if(!this.dynamicSectionEnabled&&this.swipeFilterEnabled){this.calculateHorizontalFilterWidths();}}}else{if(this.swipeFilterEnabled){this.calculateHorizontalFilterWidths();this.pullSelectedFilterIntoView(this.body.one("."+b));}}r=this.body.one("."+b);if(this.tabFilter&&r){if(this.Y.one(".type_login .wrap")){r.addClass("filter-signedOut");}else{r.removeClass("filter-signedOut");}}if(this.recentFiltersEnabled&&n===this.loginState){var w=this.storage.getItem(g);if(w){this.buildRecentFilters(w);}}},this);this.listeners.push(this.Y.Global.on("media:remove-node",function(w){if(w.node.contains(this.body)){this.onviewunload("default");}},this));},onviewunload:function(q){if(q==="default"){this.body=j;this.Y.Array.each(this.listeners,function(r){r.detach();});this.listeners=[];}else{if(q==="edit"){this.editBody=j;}}},onmessage:function(t,q,s){var r;if(q=="stream"){if(s){if(t===k){this.checkFilterState(s.category,s.name);}else{if((t===p)){this.moduleapi.unlisten(p);this.buildDynamicCategories(s.dynamicCategories,i);}}}if((t===k)||(t===c&&s.batchCount===1)){r=this.body.one("."+b);if(r&&this.Y.one(".type_login .wrap")){r.addClass("filter-signedOut");}}if(t===h){this.clearDynamicFilters();}}},onviewevent:function(s,q){var r=this.Y;if(s==="default"){if(q.type==="click"){q.preventDefault();this.onClick(q.target);}else{}}},buildDynamicCategories:function(u,s){if(!this.dynamicSectionEnabled){return;}var q=this.body.one(".recommended-label"),r=(this.tabFilter)?"fltr-strm-menu":"fltr-strm",v={ftype:"dynamic",sec:r,ft:2,fontSize:this.filterFontSize},t=0;t=this._buildFilters(u,".dynamic-list .filter-list",this.dynamicMax,v);if(t>0&&q){q.removeClass("dn");}if(s&&this.filterRestoreEnabled){this.savedFilters={list:u,loginState:this.loginState};if(!this.storage.setItem(a,this.savedFilters,d)){this.savedFilters=j;}}if(this.swipeFilterEnabled){this.calculateHorizontalFilterWidths();}},buildRecentFilters:function(s){var u={ftype:"recent",sec:"gs-fltr-mu",ft:4},t=this.body.one(".recent-list"),r=0,q=8;r=this._buildFilters(s,t.one(".filter-list"),q,u);if(r>0){t.removeClass("dn");}},_buildFilters:function(s,x,w,r){var q=this.Y,u=this.body,v=(typeof x==="string")?u.one(x):x,t="",y=[];if(r.fontSize){t=" "+r.fontSize;}q.Array.each(s,function(z,A){if(A<w){y.push('<li class="filter-item" data-filter="'+z.id+'" data-ftype="'+r.ftype+'"><a href="javascript:void(0);" data-ylk="sec:strm;ft:'+r.ft+";cpos:"+(A+1)+';pos:0;t1:a3;t2:strm;t3:lst;elm:itm;elmt:fltr;itc:1" data-action-outcome="slctfltr" class="filter-name rapidnofollow'+t+'" role="button">'+z.name+"</a></li>");}});if(y.length>0){v.append(y.join(""));this.instrumentation.refreshModule(u);}return y.length;},setSavedFilter:function(u){var t=this.body.one('[data-filter="'+u+'"]'),r=this.body.one('span[data-filter="'+u+'"]'),s=this.body.one(".dropdown-label-text"),q;if(t&&t.getAttribute("data-api")){return;}if(t){this.body.all("."+b).removeClass(b);q=t.one("a").getContent();t.addClass(b);if(r){r.addClass(b);}if(this.tabFilter&&t.ancestor(".filter-list")){this.fillTabs(t);}if(s&&!this.tabFilter){s.setContent(q);}if(this.swipeFilterEnabled){this.pullSelectedFilterIntoView(t);}}},pullSelectedFilterIntoView:function(q){if(this.isRtl===true){if(q&&this.filter_page_width>(q.getX()+q.get("offsetWidth"))){this.lastSwipeOffset=Math.floor(q.getX());if(this.lastSwipeOffset>this.finalSwipeOffset){this.lastSwipeOffset=this.finalSwipeOffset;}this.listContainer.setStyle(m,"translateX("+this.lastSwipeOffset+"px)");}}else{if(q&&this.filter_page_width<(q.getX()+q.get("offsetWidth"))){this.lastSwipeOffset=-Math.floor(q.getX());if(this.lastSwipeOffset<-this.finalSwipeOffset){this.lastSwipeOffset=-this.finalSwipeOffset;}this.listContainer.setStyle(m,"translateX("+this.lastSwipeOffset+"px)");}}},fillTabs:function(u){var r=this.body.one(".tab-list"),q=r.get("lastChild"),s=this.body.one(".dynamic-list"),t=s?s.one(".recommended-label"):j,A,y,v,z,x,w;v=q.getAttribute("data-filter");z=q.getContent();x=q.getAttribute("data-ftype");w=q.getAttribute("data-api");q.setAttribute("data-filter",u.getAttribute("data-filter"));q.setContent(u.getContent());q.setAttribute("data-ftype",u.getAttribute("data-ftype"));q.setAttribute("data-api",u.getAttribute("data-api"));u.setAttribute("data-filter",v);u.setContent(z);u.setAttribute("data-ftype",x);u.setAttribute("data-api",w);A=((x==="dynamic")||(x==="stream"))?this.body.one(".dynamic-list"):this.body.one(".static-list");A.one(".filter-list").prepend(u);q.one("a").replaceClass("fz-xs","fz-s");u.one("a").replaceClass("fz-s","fz-xs");r.setStyle("overflow","visible");this.Y.later(0,this,function(){r.setStyle("overflow","");});y=A.one(".filter-list");if(y&&y.get("children").size()>this.dynamicMax){y.get("lastChild").remove();if(this.savedFilters){this.savedFilters.list.pop();if(!this.storage.setItem(a,this.savedFilters,d)){this.savedFilters=j;}}}if(t){t.toggleClass("dn",s.all(".filter-list>*").size()===0);}u.removeClass(b);q.addClass(b);q.one("A").focus();this.instrumentation.refreshModule(this.body);},addNewFilter:function(t,r){var v=this.Y,q,s=this.body.one(".dynamic-list UL"),u=+(new Date())+d;q='<li class="filter-item" data-filter="'+t+'" data-ftype="stream"><a href="#" data-ylk="sec:strm;slk:'+r+';cpos:5;pos:0;ft:3" data-action-outcome="slctfltr" class="filter-name rapidnofollow '+this.filterFontSize+'" role="button">'+r+"</a></li>";if(s){s.append(q);this.body.all("."+b).removeClass(b);if(this.savedFilters){this.savedFilters.list.unshift({id:t,name:r});this.setCurFilterData(t,u);}this.fillTabs(v.one('.type_fstream .dynamic-list [data-filter="'+t+'"]'));}},checkFilterState:function(s,q){var t=this.body.one("."+b),r=this.body.one('[data-filter="'+s+'"]'),u=+(new Date())+d;if(!r){if(!q){this.Y.later(0,this,function(){this.moduleapi.broadcast(k,{category:""});this.setSavedFilter("");});}else{this.addNewFilter(s,q);}}else{if(t!==r){if(this.savedFilters){this.setCurFilterData(s,u);}this.setSavedFilter(s);}else{if(this.tabFilter&&t&&t.ancestor(".list-container")){this.setSavedFilter(s);}}}},setCurFilterData:function(q,r){if(this.savedFilters){this.savedFilters.loginState=this.loginState;}if(!this.dynamicSectionEnabled||this.storage.setItem(a,this.savedFilters,d)){this.statemgr.setUserModuleState(a,q+"::"+r);}else{this.savedFilters=j;}},clearDynamicFilters:function(){var q=this.body.one(".rec-list"),r=this.body.one(".recommended-label");if(q){q.all(".filter-item").remove();if(r){r.addClass("dn");}}this.savedFilters=j;this.statemgr.removeUserModuleState(a);this.storage.removeItem(a);this.setSavedFilter("");},onClick:function(H){var r=this.Y,A=this.body,t=A.one(".dropdown-label-text"),C=A.one(".list-container"),B=H,v,u,q,z,G,F,y,D=+(new Date())+d,E,x,w,s;v=this.body.all("."+b);if((this.dropdownFilter||!this.dropdownHover)&&!this.swipeFilterEnabled){if(C.hasClass("list-container-reveal")){this.onHideFilterMenu();}else{this.onShowFilterMenu();}return;}if(H.getAttribute("aria-haspopup")=="true"){this.onShowFilterMenu();E=this.Y.one("body").on("focus",function(I){if(!C.contains(I.target)){this.onHideFilterMenu();E.detach();}},this);this.listeners.push(E);return;}B=B.ancestor(".filter-item",i);if(B&&(v.indexOf(B)===-1)){q=B.getAttribute("data-filter");y=B.getAttribute("data-ftype");if(v){v.removeClass(b);}x=this.body.one('[data-filter="'+q+'"]');x.addClass(b);z=B.one("a").getContent();G=B.ancestor(".static-list")?"filter-s":(B.ancestor(".dynamic-list")?"filter-d":"filter-yml");if(this.tabFilter){G=(y==="dynamic")?"filter-d":(y==="stream")?"filter-i":"filter-s";}F=B.ancestor(l)?C.all("li"):this.body.all(".tab-list li");if((y==="dynamic")||(this.tabFilter)){u={sec:!B.ancestor(".list-container")?"fltr-strm":"fltr-strm-menu",slk:G,ltxt:z,cpos:F?F.indexOf(B)+1:"",pos:0,itc:1};this.instrumentation.fireBeacon(u);}if(t&&H.ancestor(".list-container")){this.onHideFilterMenu();if(!this.tabFilter){t.setContent(z);}}if(this.savedFilters||!this.dynamicSectionEnabled){this.setCurFilterData(q,D);}this.moduleapi.broadcast(k,{category:q,api:B.getAttribute("data-api")});if(this.tabFilter&&B.ancestor(l)){this.fillTabs(B);}if(this.swipeFilterEnabled){s=B.getX();w=s+B.get("offsetWidth");if(this.isRtl===true){if(B.get("offsetLeft")+B.get("offsetWidth")>this.filter_page_width){if(this.lastSwipeOffset>0){this.lastSwipeOffset=Math.floor(-B.get("offsetLeft")+B.get("offsetWidth")+this.filter_page_width);this.lastSwipeOffset=this.lastSwipeOffset<0?0:this.lastSwipeOffset;}this.listContainer.setStyle(m,"translateX("+this.lastSwipeOffset+"px)");}else{if((this.lastSwipeOffset-B.get("offsetLeft"))+B.get("offsetWidth")>0){if(this.lastSwipeOffset<this.finalSwipeOffset){this.lastSwipeOffset+=Math.floor(B.get("offsetLeft")+B.get("offsetWidth"));this.listContainer.setStyle(m,"translateX("+this.lastSwipeOffset+"px)");}}}}else{if(this.filter_page_width<w){w+=this.dropdownFilter?20:0;this.lastSwipeOffset+=Math.floor(this.filter_page_width-w);this.listContainer.setStyle(m,"translateX("+this.lastSwipeOffset+"px)");}else{if(s<0){this.lastSwipeOffset-=Math.floor(s);this.listContainer.setStyle(m,"translateX("+this.lastSwipeOffset+"px)");}}}}}else{if(B&&(v.indexOf(B)!==-1)){if(t){this.onHideFilterMenu();}}}},onShowFilterMenu:function(){var q=this.body,w=q.one(".list-container"),r=q.one(".dropdown-label-text"),u=q.one(".dropdown-label"),s=q.one(".drop-arrow"),v=this.Y,t=this.autoHideService;if(w){if(this.hoverBeacon){this.hoverBeacon.cancel();}if(!this.tabFilter){this.instrumentation.fireBeacon({sec:"fltr-strm",slk:"menu-open",itc:1,action:"click"});}if(this.dropdownFilter){e.scrollTo(0,u.getY()-this.headerHeight);this.curSelectedText=r.getContent();r.setContent(this.moduleapi.getString("STR.FILTERS.FILTERBY"));w.removeClass("list-container-animate");}w.addClass("list-container-reveal");w.setAttribute("aria-hidden",false);}if(s){u.addClass("dropdown-label-hover");s.addClass("drop-arrow-hover");}if(w.hasClass("list-container-reveal")&&t){this.autoHideId=t.register({targets:[q],hide:v.bind(this.onHideFilterMenu,this)});}},onHideFilterMenu:function(){var u=this.body.one(".list-container"),q=this.body.one(".dropdown-label-text"),t=this.body.one(".dropdown-label"),s=this.body.one(".drop-arrow"),r=this.autoHideId;if(u){if(this.tabFilter){this.hoverBeacon=this.Y.later(500,this,function(){this.instrumentation.fireUltBeacon({sec:"fltr-strm",slk:"menu",itc:2,action:"hover"});this.instrumentation.fireYwaBeacon({sec:"strm",itc:2,action:"hvr",rspns:"op",t1:"a3",t2:"strm",t3:"lst",slk:q.get("text"),elm:"itm",elmt:"mu"});});}else{this.instrumentation.fireBeacon({sec:"fltr-strm",slk:"menu-close",itc:1,action:"click"});}if(this.dropdownFilter){q.setContent(this.curSelectedText);u.addClass("list-container-animate");}u.removeClass("list-container-reveal");u.setAttribute("aria-hidden",true);}if(s){t.removeClass("dropdown-label-hover");s.removeClass("drop-arrow-hover");}if(j!==r){this.autoHideService.unregister(r);this.autoHideId=j;}},swipeActionHandler:function(q){var s,r=0,u=8,t;if(!this.canSwipe){return;}switch(q.type){case"slide":if(q.delta.ax>20){this.listContainer.removeClass("fast-animate");s=q.delta.x+this.lastSwipeOffset;this.listContainer.setStyle(m,"translateX("+s+"px)");}t+=1;break;case"swipeEnd":this.lastSwipeOffset+=q.delta.x;if(q.delta.ax>0){r=Math.floor(q.delta.ax/t);}if(r>1){if(q.delta.x<0){this.lastSwipeOffset-=(r*u);}else{this.lastSwipeOffset+=(r*u);}}if((this.isRtl===false&&this.lastSwipeOffset>0)||(this.isRtl===true&&this.lastSwipeOffset<0)){this.lastSwipeOffset=0;this.fireSwipeBeacon();}else{if(Math.abs(this.lastSwipeOffset)>this.finalSwipeOffset){this.lastSwipeOffset=(this.isRtl===true?this.finalSwipeOffset:-this.finalSwipeOffset);this.fireSwipeBeacon();}}this.lastSwipeOffset=Math.floor(this.lastSwipeOffset);this.listContainer.setStyle(m,"translateX("+this.lastSwipeOffset+"px)");this.listContainer.addClass("fast-animate");t=1;break;case"complete":this.listContainer.removeClass("fast-animate");break;}},calculateHorizontalFilterWidths:function(){var q=this.listContainer.ancestor();this.canSwipe=true;this.filter_page_width=q.get("offsetWidth");this.scrollerWidth=this.listContainer.get("offsetWidth");if(this.scrollerWidth<this.filter_page_width){this.canSwipe=false;}this.finalSwipeOffset=Math.floor(this.scrollerWidth-this.filter_page_width);},onOrientationChange:function(q){this.Y.later(this.rotationDelay,this,function(){this.calculateHorizontalFilterWidths();if(this.lastSwipeOffset<-this.finalSwipeOffset){if(this.canSwipe){this.lastSwipeOffset=-this.finalSwipeOffset;}else{this.lastSwipeOffset=0;}this.listContainer.setStyle(m,"translateX("+this.lastSwipeOffset+"px)");}});},fireSwipeBeacon:function(){this.instrumentation.fireBeacon({t1:"a3",t2:"strm",t3:"lst",sec:"strm",slk:"cntr",elm:"itm",elmt:"ctnr",itc:1,action:"swp"});}};}());/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
(function(){var ai=null,t=false,M=true,V=ai,b=ai,au=ai,y,ao=ai,aj=1000/60,aU=2*24*60*60*1000,g=20,aF="click",Q="mouseover",U="mouseout",ak="focus",aw="blur",aG="ul",s="li",aQ="> "+aG+":last-of-type",k="hover",a1="newcontent",I="lastnew",aJ="more",ax="fetch_uuids",a0="content_by_uuid",aA="stream:click",R="stream:dynamic",S="stream:filter",C="stream:refresh",j="location:update",O="stream:fallback",L="stream:loadsuccess",d="stream:new_content",W="stream:entities",H="stream:filters",P="stream:restoreRemovedArticle",D="y-tooltip-stream",aX=D+"-1",aV=D+"-2",aT=D+"-3",aS=D+"-4",aR=D+"-5",ad="hidden",X="dn",a2="remove",av="label",aW="value",o="disabled",i="checked",B="offsetHeight",aP="offsetWidth",aL="height",G="data-ka",E="data-kb",an=s+".rmx-ad",am=s+".related-tweet",F=s+".stream-ad,"+an,ab=an+" .adlink",f=an+" .adv",at=an+" .sp",m=ab+","+f+","+at,n="data-uuid",aq=s+".content",aD="highline",u="data-reason",z="data-i",aZ="data-wikiid",c="data-wikiids",aK="next-batch",ag="."+aK,af="endfilters",J="."+af,ay=".historystate",x=">H2,>UL,>.loading,>.type_login,>.strm-error-msg,>.see-more-button",w="li.cavideo h3 a,li.slideshow h3 a",ah="hovertitle",ar="YPROP:LOCAL",ae="YPROP:SAVE",v="YCUSTOM:MYTEAMS",aY="fblogin",h="ylogin",al="streamLoginType",a=0,aN=".action-drawer-button-wrapper",aE="saved",ap="liked",A="disliked",aH="ads_disliked",r="flagged",aB="drawer-open",T="p_30345831",aI="pos-feedback",aa="neg-feedback",q="hilite",l=aq+"."+q,K="request-manager",Z="streamReadList",ac="streamClosedList",aO="streamEntityFeedbackList",p="streamState",aC="streamFlaggedList",e="data-impr-beacon",aM="data-rmx-beacon",az="data-ad-feedback-beacon",N="data-thirdparty-beacons";YModules.type_stream={body:ai,list:ai,lastScrollCheck:0,scrollThrottle:40,scrollBuffer:50,id:"",moduleapi:ai,platform:ai,viewevents:[aF],instrumentation:ai,batchCount:1,pollBatchCount:0,batchSize:0,clientPagination:ai,items:ai,woeId:ai,intl:ai,ccode:ai,filter:ai,itemRemovalTimer:ai,currentRemovalMenu:ai,pendingNewItems:[],swipeMenu:ai,yepService:ai,yepPlayer:ai,evtStreamEntities:ai,isRmp:t,nativeAds:[],locationPickerEnabled:false,locationService:null,locationInstance:null,init:function(a4){V=a4.getService("yui");b=V.config.win;au=V.config.doc;try{ao=!!(b.history&&b.history.replaceState&&b.history.state!==y);}catch(a3){ao=t;}var Y=a4.getContextData();this.moduleapi=a4;this.id=a4.getId();this.platform=a4.getService("moduleplatform");this.transportHelperService=a4.getService("transport_helper");this.listeners=[];this.customEvents=[];this.instrumentation=a4.getService("instrumentation");this.storage=a4.getService("storage");this.statemgr=a4.getService("statemgr");this.saveForLaterService=a4.getService("saveforlater");this.highlineService=a4.getService("stream_highline");this.userinfo=a4.getService("userinfo");this.loginService=a4.getService("login");this.interestsService=a4.getService("interests");this.batchSize=Y.batchSize||20;this.woeId=Y.woeId;this.intl=Y.intl;this.ccode=Y.ccode||"";this.listId=Y.listId||"";this.pageloadListId=Y.pageloadListId||"";this.blogType=Y.blogType||"";this.items=Y.items||[];this.clientPagination=Y.clientPagination;this.filter={category:Y.filter||"",name:Y.catName||""};this.contentpos=Y.contentpos;this.dynamicEnabled=Y.dynamicEnabled;this.removalMenuEnabled=Y.removalMenuEnabled;this.adsRemoveEnable=Y.adsRemoveEnable;this.bucketid=a4.getContextData("bucketid");this.pollForNewBroadcastEnabled=Y.pollForNewBroadcastEnabled;this.pollForNewFrequency=Y.pollForNewFrequency;this.pollForNewAutoInsert=Y.pollForNewAutoInsert;this.pollForNewPauseOnIdle=Y.pollForNewPauseOnIdle;this.userIdleAfter=Y.userIdleAfter;this.newCountInTitleEnabled=Y.newCountInTitleEnabled;this.pendingNewItems=Y.pendingNewItems||[];this.restoreStateExpire=Y.restoreStateExpire;this.restoreStateMethod=Y.restoreStateMethod;this.restoreStateOnCacheMiss=Y.restoreStateOnCacheMiss;this.batchPause=Y.batchPause;this.endFiltersEnabled=Y.endFiltersEnabled;this.endFiltersCount=Y.endFiltersCount;this.activeItemId=Y.contentId;this.highlightActive=Y.highlightActive;this.highlightActiveBroadcastScroll=Y.highlightActiveBroadcastScroll;this.itemClickBroadcastOnly=Y.itemClickBroadcastOnly;this.itemClickContext=Y.itemClickContext;this.markAsReadEnabled=Y.markAsReadEnabled;this.closeEnabled=Y.closeEnabled;this.fbAcctLinked=Y.fbAcctLinked;this.tooltipsEnabled=Y.tooltipsEnabled;this.interestFiltersEnabled=Y.interestFiltersEnabled;this.interestFiltersBroadcast=Y.interestFiltersBroadcast;this.broadcastDynamicEnabled=Y.broadcastDynamicEnabled;this.sortBy=Y.sortBy;this.isRmp=Y.isRmp;this.minArticleCount=Y.minArticleCount;this.saveEnabled=Y.saveEnabled;this.postLoadActionDrawer=Y.postLoadActionDrawer;this.inlineLightboxEnabled=Y.inlineLightboxEnabled;this.actionDrawerEnabled=Y.actionDrawerEnabled;this.actionDrawerButtonsEnabled=Y.actionDrawerButtonsEnabled;this.writeMixerActions=Y.writeMixerActions;this.readMixerActions=Y.readMixerActions;this.inFallbackState=Y.inFallbackState;this.nonPersonalStream=Y.nonPersonalStream;this.registerRapidInViewport=Y.rapidInViewport;this.flagContentEnabled=Y.flagContentEnabled;this.pageload=M;if(Y.splitOnscroll){this.pagescroll=t;}if(this.interestsService&&Y.interestsData){this.interestsService.set(Y.interestsData);}if(!this.filter.category&&this.pageloadListId&&this.listId!==this.pageloadListId){this.filter.category="LISTID:"+this.listId;}V.Node.DOM_EVENTS.mouseenter=1;V.Node.DOM_EVENTS.mouseleave=1;V.Node.DOM_EVENTS.touchend=1;V.Node.DOM_EVENTS.pageshow=1;a4.listen(S);a4.listen(R);a4.listen(C);this.platform.subscribe(j,this.handleLocationUpdate,this);V.on("pageshow",function(a5){this.markRead();},b,this);this.initGlobalListeners();this.videoManager=null;if(a4.getContextData("videoPlayerJs")){this.videoManager=a4.getService("inline_video_manager");}},onviewload:function(a3){if(a3==="default"){var Y=this.moduleapi;this.body=Y.getViewNode(a3);this.rapidContainer=this.body.ancestor(".rapid-container")||this.body;this.isLoading=t;this.locationPickerEnabled=Y.getContextData("locationPickerEnabled");this.setupScroll();if(this.restoreStateExpire){this.restoreState(this.initDefaultView);}else{this.initDefaultView();}}},initDefaultView:function(){if(this.storage){this.storage.onReady(this.setupDefaultView,this);}else{this.setupDefaultView();}},setupDefaultView:function(){var a4=this.moduleapi,a5=a4.getContextData("dynamicCategories"),a3=a4.getContextData("dynamicEntities"),a6=this.activeItemId&&this.getItemByUuid(this.activeItemId);if(this.postLoadActionDrawer){this.addActionDrawer();}this.markRead();this.markFlag();this.updateDislikedInterests();this.updateControls();if(this.readMixerActions){this.getMixerActionsForFirstBatch();}this.cacheNativeAdData();this.initPagination();this.statemgr.removeUserModuleState("context");if(a6){if(this.highlightActive){this.highlightItem(a6);if(!this.restored){if(this.highlightActiveBroadcastScroll){V.Global.fire("media:scroll-into-view",{node:a6});}else{this.scrollDomNode.scrollTop=a6.get("offsetTop")-(this.scrollNodeHeight-a6.get(B))/2;}}}if(this.interestFiltersBroadcast){this.broadcastEntities(a6);}}if(!a4.getContextData("skipCheckBufferOnload")){V.later(0,this,this.checkScroll);}this.platform.on("ready",function(){if(a5&&V.Lang.isArray(a5)&&a5.length>0&&!this.inFallbackState){this.moduleapi.broadcast(R,{dynamicCategories:a5});}if(this.broadcastDynamicEnabled){this.broadcastDynamicFilters({dynamicCategories:a5,dynamicWikis:a3});}if(this.inFallbackState){this.moduleapi.broadcast(O,{});this.dynamicCats=ai;}this.moduleapi.broadcast(S,V.merge(this.filter,{norefresh:1}));},this);if(this.pollForNewFrequency&&this.body.one(aq)){if(!this.pollForNewAutoInsert){this.listeners.push(this.body.delegate(aF,this.onClickNewContentNotice,".newcontentnotice button",this));this.listeners.push(V.on("resize",V.bind(this.positionNewContentNotice,this,M)));}if(this.pollForNewPauseOnIdle&&this.userIdleAfter){this.idleService=a4.getService("idle");if(this.idleService){this.idleService.on("idleChange",this.onIdleChange,this);this.idleService.start(this.userIdleAfter);}}this.scheduleNewContentPoll();if(this.pendingNewItems.length){this.onNewContent();}}if(this.saveForLaterService){this.saveForLaterWidget=new this.saveForLaterService({body:this.body,moduleApi:a4,writeToMixer:this.writeMixerActions,itemSelector:aq,saveHandler:V.bind(this.onSaveArticle,this),signedOutSaveHandler:V.bind(this.onSignedOutSaveClick,this)});}if(this.actionDrawerEnabled){this.actionDrawer=a4.getService("stream_action_drawer");if(this.actionDrawer){this.actionDrawer.on("declareFeedback",this.onActionDrawerFeedback,this);this.actionDrawer.on("removeStreamItem",this.removeStreamItem,this);this.actionDrawer.on("onFlagDone",this.onFlagDone,this);this.actionDrawer.on("recordFlag",this.recordFlag,this);this.actionDrawer.on("deleteSaved",this.deleteSavedFromActionDrawer,this);if(!this.actionDrawerButtonsEnabled){this.actionDrawer.on("drawerToggleStart",this.disableStreamButtons,this);this.actionDrawer.on("drawerToggleComplete",this.enableStreamButtons,this);this.actionDrawer.disableButtons();}}}if(a4.getContextData("swipeEnabled")){this.swipeMenu=a4.getService("stream_swipe_menu");this.swipeMenu.init({rootNode:this.body,swipeEducCount:a4.getContextData("swipeEducCount"),swipeEducMaxViews:a4.getContextData("swipeEducMaxViews"),filter:this.filter,closeEnabled:this.closeEnabled,eventHandlers:{onRemoveTransition:V.bind(this.fancyRemove,this),onRemoveContent:V.bind(this.removeContent,this),onSavedRemove:this.saveForLaterService?V.bind(this.deleteSavedArticle,this):ai}});}if(this.tooltipsEnabled){try{this.tooltip=a4.getService("tooltip").create({parentNode:this.body,className:D,position:{box:"t",arrow:"c"}});this.tooltip.getNode().addClass("fz-xxs");this.listeners.push(this.body.delegate([Q,ak],this.onShowTooltip,".label, .profile-img, .more, .side-button",this));this.listeners.push(this.body.delegate([U,aw],this.onHideTooltip,".label, .profile-img, .more, .side-button",this));}catch(Y){}}if(a4.getContextData("playIconHoverEnabled")){this.listeners.push(this.body.delegate([Q,U],this.onHoverTitle,w,this));}if(this.removalMenuEnabled){this.listeners.push(this.body.delegate(Q,this.onMouseOverMenu,".remove",this));this.listeners.push(this.body.delegate(U,this.onMouseOutMenu,".remove",this));}if(this.adsRemoveEnable){this.listeners.push(this.body.delegate(Q,this.onMouseOverRemoveBtn,".close",this));}if(this.interestFiltersEnabled){this.listeners.push(this.body.delegate([Q,ak],this.onMouseOverLi,".content",this));this.listeners.push(this.body.delegate([U,aw],this.onMouseOutLi,".content",this));}if(V.UA.ie&&V.UA.ie<=6){this.listeners.push(this.body.delegate([Q,U],this.onHoverContent,"ul .content",this));}this.pruneClosed();if(this.filter.category===ar&&this.locationPickerEnabled===true){this.initLocation();}V.Global.fire("pane-manager:sync-nav-pane-scroll");},addActionDrawer:function(){var Y=this.moduleapi.getString("STR.ACTIONDRAWER.MARKUP"),a3=this.body.all(aq);if(!Y||!a3){return;}a3.each(function(a4){if(!a4.hasClass("rmx-ad")){a4.one(".body").insert(Y,"after");}});},onviewunload:function(Y){if(Y==="default"){this.body=ai;if(this.streamLoadReqObj){this.streamLoadReqObj.abort();this.streamLoadReqObj=ai;}V.Array.each(this.listeners,function(a3){a3.detach();});this.listeners=[];V.Array.each(this.customEvents,function(a3){a3.fired=t;});this.customEvents=[];if(this.scrollListener){this.scrollListener.detach();this.scrollListener=ai;}if(this.newContentPoll){this.newContentPoll.cancel();this.newContentPoll=ai;}if(this.tooltip){this.tooltip.destroy();this.tooltip=ai;}if(this.locationPickerEnabled){this.locationService=null;if(this.locationInstance){this.locationInstance.destroy();this.locationInstance=null;}}}},onmessage:function(a5,a3,a4){switch(a5){case S:if(!a4||!a4.norefresh){if(this.videoManager&&this.videoManager.onmessage){this.videoManager.onmessage(a5,a3,a4);}this.onFilter(a4);}break;case C:if(this.videoManager&&this.videoManager.onmessage){this.videoManager.onmessage(a5,a3,a4);}this.onFilter(this.filter);break;case R:this.moduleapi.unlisten(R);this.dynamicCats=a4.dynamicCategories;var Y=this.getNode(J);if(Y){this.handleStreamEnd(Y);}break;default:}},handleLocationUpdate:function(Y){if(this.platform.getProperty("loc.cookie.persistent")&&this.statemgr){this.statemgr.setUserPageState("_fpts",Math.round(new Date().getTime()/1000));}this.woeId=Y.woe;if(this.filter.category===ar){this.onFilter(this.filter);}},onviewevent:function(a3,Y){if(a3==="default"){if(Y.type===aF){this.onClick(Y);}else{}}},initLocation:function(a3){var a5=this.body.one(".loc-picker"),a4=this.moduleapi,Y;if(a5){if(!a5.one(".loc-picker-link")){return false;}if(!this.locationService){this.locationService=a4.getService("location_service");}Y={locDropSettings:{crumb:a4.getContextData("locdrop_crumb"),locale:a4.getContextData("locale"),bestLoc:a4.getContextData("best_loc"),curLoc:a4.getContextData("cur_loc"),defLoc:a4.getContextData("def_loc"),userLoc:this.userCitySelection||a4.getContextData("user_loc"),anchorClass:"",glApi:a4.getContextData("useGlApi")},beacon:{sec:a4.getContextData("beacon_sec"),slk:a4.getContextData("beacon_slk"),test:a4.getContextData("bucketid")}};if(this.locationInstance&&a3){this.locationInstance.destroy();this.locationInstance=null;if(this.locationService){this.locationInstance=this.locationService.create(a5,this.id,a4,Y);}}else{if(!this.locationInstance){if(this.locationService){this.locationInstance=this.locationService.create(a5,this.id,a4,Y);}}}}},loadContent:function(a3,a4,a6){var a5,Y={};if(this.pollRequestObj&&!a3.poll){this.pollRequestObj.abort();this.pollRequestObj=ai;}if(this.filter.category===ar){Y.ups=M;}else{if(this.filter.category===v){Y.udb=M;}}a6=a6||{};a5=this.transportHelperService.makeRequest(V.merge({type:"module",moduleId:this.id,args:V.merge({_action:"show",batch:this.batchCount+1,cat:this.filter.category||"",catName:this.filter.name||"",sb:this.sortBy,ccode:this.ccode,woeid:this.woeId},a3)},Y),{success:a6.success||this.loadContentSuccess,failure:a6.failure||this.loadContentFailure,scope:this,argument:V.merge(a4,{subAction:a3._subAction})});return a5;},loadContentSuccess:function(a8,a6){var a4=this.moduleapi,a3=this.getNode(a6.insertNode),a7=this.getNode(a6.removeNode),a5,Y;if(a8.html){if(a3){a3.insert(a8.html,a6.insertLoc);}this.pruneClosed();this.markRead();this.markFlag();this.instrumentation.refreshModuleAsRichView(this.rapidContainer);}if(a7){a7.remove();}if(a7||a3){this.cacheNativeAdData();}if(a6.subAction===aJ){this.isLoading=t;a5=a4.getContextData("dynamicCategories");if(a5&&V.Lang.isArray(a5)&&a5.length>0&&!this.inFallbackState){if(this.filter&&this.filter.category===""){this.platform.on("ready",function(){a4.broadcast(R,{dynamicCategories:a5});},this);}}Y=a4.getContextData("dynamicEntities");if(a8.hasOwnProperty("data")){if(a8.data.hasOwnProperty("contentpos")){this.contentpos=a8.data.contentpos;}if(a8.data.comscore==="pageview_candidate"){this.instrumentation.fireComscoreBeacon();}if(a8.data.hasOwnProperty("items")&&V.Lang.isArray(a8.data.items)){this.items=this.closeEnabled?this.removeDuplicates(a8.data.items,this.storage.getSet(ac,M)):a8.data.items;}if(this.interestsService&&a8.data.hasOwnProperty("interestsData")){this.interestsService.set(a8.data.interestsData);}}if(a6.firstBatch){if(this.readMixerActions){this.getMixerActionsForFirstBatch();}this.ccode=a4.getContextData("ccode");this.clientPagination=a4.getContextData("clientPagination");}}else{if(a6.subAction===a0){this.contentReqDone=M;}}this.batchCount+=1;this.moduleapi.broadcast(L,{category:this.filter.category,batchCount:this.batchCount});this.body.all("a.twitter-follow-button").each(function(a9){b.twttr.widgets.load(a9.getDOMNode());});if(this.filter.category===ar&&this.locationPickerEnabled===true){this.initLocation(true);}V.later(aj,this,function(){this.body.setStyle(aL,ai);var a9=this.getNode(J);if(a9){this.handleStreamEnd(a9);}else{this.checkScroll();}});V.Global.fire("pane-manager:sync-nav-pane-scroll");},loadContentFailure:function(a4,Y){if(this.transportHelperService.wasAborted(a4)){return;}var a3=this.getNode(Y.removeNode);if(a3){a3.remove();}if(Y.subAction===aJ){this.isLoading=t;if(Y.firstBatch&&this.filter.category){this.moduleapi.broadcast(S,{category:""});}}V.later(aj,this,function(){this.body.setStyle(aL,ai);});},fetchContentIds:function(){var Y,a3;Y={_subAction:ax,listid:this.listId,blogtype:this.blogType,key:this.getContinuationKey()};if(!this.clientPagination||!Y.key){return;}this.isLoading=M;a3={success:function(a7){var a4,a6,a5=this.body.one(aQ);if(a7&&a7.data){a4=a7.data.items;a6=a7.data.dynamicCategories;if(a7.data.fbcount&&a5){a5.append("<!-- fb="+a7.data.fbcount+" uuids -->");}}this.isLoading=t;if(a4&&V.Lang.isArray(a4)){this.items=this.removeDuplicates(a4,this.items,a5?a5.all(aq):[],this.closeEnabled?this.storage.getSet(ac,M):[]);}if(a6&&V.Lang.isArray(a6)){this.moduleapi.broadcast(R,{dynamicCategories:a6});}if(this.items.length===0){this.handleStreamEnd();}else{this.checkScroll();}},failure:function(a4){if(this.transportHelperService.wasAborted(a4)){return;}this.isLoading=t;if(this.items.length===0){this.handleStreamEnd();}}};this.streamLoadReqObj=this.loadContent(Y,{},a3);},loadNextBatch:function(a3,a6,a9){if(this.isLoading){return;}var a7=this.body.one(ag),a5,a8,Y,a4;if(!a7){return;}if(a9){Y=parseInt(this.moduleapi.getContextData("splitSnippetCount"),10);if(this.batchSize<=Y){return;}a4=this.items.splice(0,this.batchSize-Y);}else{a4=this.items.splice(0,this.batchSize);}a5={_subAction:aJ,items:a4,listid:this.listId,blogtype:this.blogType,left:this.items.length,key:this.getContinuationKey(a7),cpos:this.contentpos};if(a6){a5.data=a6;}a8={removeNode:a7,insertNode:a7,insertLoc:"after",firstBatch:a3};if(a9){a5.partialBatch=M;}if(!a3){this.instrumentation.fireBeacon(a7);}if(a7.hasClass("loading")&&(a5.key||a5.items.length)){this.isLoading=M;a7.setContent(this.moduleapi.getString("STR.LOADING"));this.streamLoadReqObj=this.loadContent(a5,a8);}else{if(a7){this.handleStreamEnd(a7);}}},handleStreamEnd:function(a6){a6=a6||this.getNode(ag+","+J);if(!a6){return;}var a3=this.dynamicCats,a5=this.filter.category,Y=[],a4=0;if(this.endFiltersEnabled&&a3&&a3.length){a6.removeClass(aK).replaceClass("loading",af);V.Array.each(a3,function(a7){if(a7.id!==a5&&a4<this.endFiltersCount){Y[a4++]='<a href="#" class="interest-filter rapidnofollow whs-nw" data-action-outcome="slctfltr" data-filter="'+a7.id+'" data-ylk="rspns:nav;t1:a3;t2:strm;t3:ft;sec:strm;ft:2;elm:itm;elmt:fltr;itc:1;cpos:'+a4+';" role="button">'+a7.name+"</a>";}},this);a6.setContent(!Y.length?"":'<h4 class="fz-s">'+this.moduleapi.getString("STR.END_FILTERS_HEADING")+'</h4><p class="fz-s">'+Y.join('<span class="v-h mr-s">, </span>')+"</p>");this.instrumentation.refreshModule(this.rapidContainer);}else{a6.remove();}},setHistoryState:function(a3,Y){if(a3&&Y){a3._expires=+(new Date())+Y;}if(this.restoreStateMethod==="LOCAL_STORAGE"){if(a3){a3.href=b.location.href;this.storage.setItem(p,a3);}else{this.storage.removeItem(p);}}else{if(this.restoreStateMethod==="HTML5_HISTORY"&&ao){b.history.replaceState(a3,"");}else{try{this.getNode(ay).set(aW,V.JSON.stringify(a3));}catch(a4){}}}},getHistoryState:function(){var Y=ai,a4;if(this.restoreStateMethod==="LOCAL_STORAGE"){Y=this.storage.getItem(p);if(Y&&Y.href!==b.location.href){Y=ai;}}else{if(ao){Y=b.history.state;}else{a4=this.getNode(ay);if(a4&&a4.get(aW)){try{Y=V.JSON.parse(a4.get(aW));}catch(a3){}}}}if(Y){this.setHistoryState(ai);}return(Y&&(!Y._expires||new Date()<Y._expires))?Y:ai;},saveState:function(){var a3=[],a4=ai,Y=this.clickedItem||this.clickedLink,a5;if(Y){this.body.all(aq).each(function(a6){var a7=a6.getAttribute(n);if(a6.test(an)){return;}else{if(a6.test(am)){a7="tweet:"+a7;}}a3.push({u:a7,r:a6.getAttribute(u),i:a6.getAttribute(z)});});a5=this.scrollDomNode.scrollTop;a4={time:this.getNode(ay).getAttribute("data-time"),items:a3,listId:this.listId,pending:this.items,filter:this.filter,scrollX:this.scrollDomNode.scrollLeft,scrollY:a5,sortBy:this.sortBy,relY:Y.getY()-a5,itemId:(this.clickedItem)?this.clickedItem.getAttribute(n):ai,activeItemId:this.activeItemId||V.Object.getValue(b,["YUI","type_stream","activeItemId"])};}this.setHistoryState(a4,this.restoreStateExpire);},restoreState:function(a9){var a8,a3,a7=t,ba=this,Y=ba.getHistoryState(),a5=ba.getNode(aQ),a4={},a6={};if(this.filter.category===ar&&this.locationPickerEnabled===true){this.initLocation();}if(a5&&Y&&Y.items&&Y.items.length&&V.Object.getValue(Y,["filter","category"])!==ae){a8=(Y.time===ba.getNode(ay).getAttribute("data-time"));a4._subAction=aJ;a4.restore=1;ba.activeItemId=Y.activeItemId;ba.sortBy=Y.sortBy;ba.updateControls();if(a8||this.restoreStateOnCacheMiss){a3=Y.pending;a4.items=Y.items;a4.listid=Y.listId;a4.left=a3.length;a4.batch=1;a4.cpos=0;a6.insertNode=this.body;a7=M;}else{Y.items=ba.removeDuplicates(Y.items,a5.all(aq));ba.scrollDomNode.scrollLeft=Y.scrollX;ba.scrollDomNode.scrollTop=Y.scrollY;ba.restored=!Y.items.length;a9.call(ba);return;}ba.isLoading=M;ba.filter=Y.filter;ba.loadContent(a4,a6,{success:function(bd,bc){bd.data.items=a3;delete bd.data.comscore;if(a7){ba.body.all(x).remove();}ba.loadContentSuccess(bd,bc);ba.restored=M;a9.call(ba);var bb=Y.itemId&&ba.getItemByUuid(Y.itemId);ba.scrollDomNode.scrollLeft=Y.scrollX;ba.scrollDomNode.scrollTop=bb?bb.getY()-Y.relY:Y.scrollY;V.later(0,ba,function(){ba.checkScroll();if(ba.pollForNewFrequency){ba.checkForNewContent();}});},failure:function(bc,bb){ba.loadContentFailure(bc,bb);a9.call(ba);}});}else{a9.call(ba);}},updateDocTitle:function(Y){if(!this.newCountInTitleEnabled){return;}if(!this.originalDocTitle){this.originalDocTitle=V.Lang.trim(au.title);if(!this.originalDocTitle){return;}}var a3=this.originalDocTitle;if(Y){if(Y>g){a3=V.Lang.sub(this.moduleapi.getString("STR.NEWCONTENT.TITLE.OVERMAX"),{count:g,title:a3});}else{a3=V.Lang.sub(this.moduleapi.getString("STR.NEWCONTENT.TITLE"),{count:Y,title:a3});}}au.title=a3;},onIdleChange:function(Y){if(this.pollForNewPauseOnIdle){this.pollForNewPaused=Y.idle;if(!this.pollForNewPaused&&this.pollForNewSkipped){this.checkForNewContent();}}},scheduleNewContentPoll:function(){if(this.newContentPoll){this.newContentPoll.cancel();}this.newContentPoll=V.later(this.pollForNewFrequency,this,this.checkForNewContent);},checkForNewContent:function(){if(this.pollForNewPaused){this.pollForNewSkipped=M;return;}if(this.isLoading||this.filter.category||this.sortBy!==a){V.log("skipping checkForNewContent: isLoading="+this.isLoading+", sort="+this.sortBy+", filter="+V.Object.getValue(this.filter,["category"]),"debug","type_stream");this.scheduleNewContentPoll();return;}var Y={_subAction:ax,key:0,poll:1},a3={},a4={success:function(a6){this.pollRequestObj=ai;var a5=V.Object.getValue(a6,["data","items"]),a7;if(a5){a7=this.body.all(aq);a5=this.removeDuplicates(a5,a7.size()?a7:[],this.closeEnabled?this.storage.getSet(ac,M):[],this.items);if(a5.length){this.pendingNewItems=a5;this.broadcastNewContentNotice(a5.length);this.onNewContent();}this.scheduleNewContentPoll();}},failure:function(a5){this.pollRequestObj=ai;}};this.pollRequestObj=this.loadContent(Y,a3,a4);this.pollForNewSkipped=t;},onNewContent:function(){this.updateDocTitle(this.pendingNewItems.length);if(this.pollForNewAutoInsert){if(this.body.getY()>this.scrollDomNode.scrollTop){this.instrumentation.fireYwaBeacon({action:"insert",sec:"td-strm-new",slk:"insert"});this.insertNewContent();}}else{this.displayNewContentNotice(this.pendingNewItems.length);}},broadcastNewContentNotice:function(a3){if(!this.pollForNewBroadcastEnabled){return;}var Y="STR.NEWCONTENT.BROADCAST."+(["ZERO","ONE","TWO"][a3]||"OTHER"),a5=Y&&this.moduleapi.getString(Y)||"",a4=a5&&V.Lang.sub(a5,[a3])||"";this.moduleapi.broadcast(d,{count:a3,message:a4});},displayNewContentNotice:function(a4){var a8=this.moduleapi.getString("STR.NEWCONTENT.NOTICE.MESSAGE."+(a4===1?"SINGLE":(a4>g?"OVERMAX":"PLURAL"))),a7=V.Lang.sub(a8,{count:(a4>g?g:a4)}),Y=V.Lang.sub(this.moduleapi.getString("STR.NEWCONTENT.NOTICE.TEMPLATE"),{msg:a7}),a5=this.body.one(aQ),a6=V.Node.create(Y),a3=this.body.one(".newcontentnotice");if(!a5){return;}if(a3){a3.replace(a6);}else{a5.insert(a6,"before");this.instrumentation.fireYwaBeacon({action:"secview",sec:"td-strm-msg",outcome:"msgview"});}this.newContentNotice=a6;this.positionNewContentNotice();this.highlightNewItems(ai);},onClickNewContentNotice:function(Y){this.newContentNotice.remove();this.newContentNotice=ai;this.scrollToTop();this.instrumentation.fireBeacon({sec:"td-strm-msg",slk:"top",itc:1});this.insertNewContent();},getMixerActionsForFirstBatch:function(){if(this.filter.category===ae||this.filter.category===ar){return;}var Y=this.getUuids();if(Y.length){this.makeRequestToGetMixerActions(Y,{success:function(a3){this.markStreamActions(a3.data.mixerActions);},failure:function(a3){},scope:this});}},onActionDrawerFeedback:function(Y){this.onDeclareInterest(Y.interestObj,Y.item);},beaconDislikeAds:function(a6,a5,a8,a7){var a4,a9,Y,a3;a9=a6.getAttribute(az);a3="({type}{subo}{cmnt})";if(a3){a4={rmx:a9,type:a5&&a5!==""?"type$"+a5:"",subo:a8&&a8!==""?",subo$"+a8:"",cmnt:a5==="fdb_submit"?",cmnt$"+a7:""};Y=a9.replace("$(AD_FEEDBACK)",V.Lang.sub(a3,a4));this.instrumentation.getBeaconImage(Y);}},removeStreamItem:function(a9){var ba=a9.item,a5="",a6="",a8=!a9.animate?a9.uuid:ba?ba.getAttribute(n):ai,a4=a9.action||ai,a3,Y=ba.next(".ads_disliked")||ai,a7=a4===aH?this.moduleapi.getString("STR.REMOVE.ADS.THANKYOU"):this.moduleapi.getString("STR.REMOVE.ITEM.THANKYOU");if(a4===aH){if(Y){if(Y.one("[name=ads-dislike-option]:checked")){a5=Y.one("[name=ads-dislike-option]:checked").get("value")||"";a6=Y.one("#cmnt").get("value")||"";this.beaconDislikeAds(ba,"fdb_submit",a5,a6);}}}if(a8){if(this.filter.category!==ae){if(a9.immediate){ba.remove();}else{if(a9.animate){if(this.actionDrawerEnabled){ba.one(".wrapper").addClass("dn");ba.append(a7);if(a4===aH){ba.setStyle("background-color","");}if(ba.hasClass("featured")){ba.replaceClass("featured","featured-removed");}if(ba.one(".fb-friends")){ba.one(".fb-friends").addClass("dn");}a3=ba.one(".action-drawer-button-wrapper");if(a3){a3.addClass("dn");}}else{ba.setContent(a7);}ba.addClass("remove-item");this.removalTimer=V.later(3000,this,function(){this.fancyRemove(ba);});}}this.recordClosed(a8);}}},onFlagDone:function(a6){var a3=a6.item,a7=!a6.animate?a6.uuid:a3?a3.getAttribute(n):ai,a5=this.moduleapi.getString("STR.FLAG.ITEM.THANKYOU"),a4,Y;if(a7){if(a6.animate){a4='<li class="flag-thankyou-msg-drawer">'+a5+"</li>";a3.insert(a4,"after");Y=a3.get("nextSibling");V.later(3000,this,function(){this.fancyRemove(Y);});}}},recordFlag:function(a3){var Y=a3.item,a4=Y?Y.getAttribute(n):ai;if(a4){if(a3.flag){this.storage.addToSet(aC,a4,1,aU);}else{this.storage.removeFromSet(aC,a4);}}},deleteSavedFromActionDrawer:function(Y){this.deleteSavedArticle();},restoreRemovedArticle:function(a4){var a5=a4.one(".action-drawer-button-wrapper"),a6=a4.one("h3 a").get("text").substring(0,8),a3=a4.getAttribute(n),Y=V.merge(this.instrumentation.getBeaconKeys(a4),{sec:"td-strm-rm",slk:"undo-itm",ltxt:a6,itc:1,action:aF,outcome:"undo"});if(this.removalTimer){this.removalTimer.cancel();a4.one(".remove-wrap").remove();a4.setStyle("background-color","#FAFAFF");a4.one(".wrapper").removeClass("dn");if(a4.hasClass("remove-item")){this.beaconDislikeAds(a4,"fdb_undo","","");}a4.removeClass("remove-item").removeClass(aH);a4.removeClass("remove-item").removeClass(A);a4.removeClass("y-pattern").removeClass("hover");this.enableStreamButtons({item:a4});if(a4.one(".fb-friends")){a4.one(".fb-friends").removeClass("dn");}if(a5){a5.removeClass("dn");}if(a4.hasClass("featured-removed")){a4.replaceClass("featured-removed","featured");}if(this.actionDrawer&&a3){if(this.userinfo.isLoggedIn()){this.actionDrawer.markItemFeedbackInMixer(a3,"neutral","dislike");}this.recordClosed(a3,M);}this.instrumentation.fireBeacon(Y);if(this.videoManager&&this.videoManager.onmessage){this.videoManager.onmessage(P,this,{item:a4});}}},insertNewContent:function(){var a3=this.body.one(aQ),a6=350,Y=V.Node.create('<li style="height:0">'+this.moduleapi.getString("STR.LOADING")+"</li>"),a5=+(new Date()),a4=function(a7,a8){this.newContentRequestObj=ai;V.later(Math.max(a6,+(new Date())-a5),this,function(){Y.remove();this.updateDocTitle(0);if(!a7&&a8&&a8.html){var a9=V.Node.create("<ul>"+a8.html+"</ul>").all(aq);if(a3&&a9.size()){a3.prepend(a9);this.highlightNewItems(a9);if(this.interestsService&&a8.data&&a8.data.interestsData){this.interestsService.set(a8.data.interestsData);}}this.instrumentation.refreshModule(this.rapidContainer);this.cacheNativeAdData();this.pollBatchCount+=1;}});};if(!a3){return;}a3.prepend(Y);Y.transition({height:"85px",duration:a6/1000});this.newContentRequestObj=this.loadContent({_subAction:a0,items:this.pendingNewItems,poll:1,ccode:this.ccode,woeid:this.woeId,batch:this.pollBatchCount+1},{},{success:function(a7){a4.call(this,ai,a7);},failure:function(a7){a4.call(this,a7);}});this.pendingNewItems=[];this.broadcastNewContentNotice(0);},getMastheadHeight:function(){var Y=V.one("#masthead");return Y?Y.get(B)-4:0;},scrollToTop:function(){var Y=V.one("#stream")||this.body,a3=Y.getY()-this.getMastheadHeight();if(this.scrollDomNode.scrollTop>a3){this.scrollDomNode.scrollTop=a3;}},positionNewContentNotice:function(a7){if(!this.newContentNotice){return;}var a6=this.newContentNotice,a5=V.one("#stream").one(".filter-bar-section"),Y=this.getMastheadHeight(),a8=a6.hasClass("sticky"),a4,a3=V.one("BODY");if(a5){Y+=a5.get(B);}a4=(this.scrollDomNode.scrollTop>(this.body.getY()-Y));if(a4&&(!a8||a7)&&a3.hasClass("fixed-enabled")){a6.setStyles({top:Y+"px",left:this.body.getX()+"px",width:(this.body.get(aP)-parseInt(a6.getComputedStyle("paddingLeft"),10)-parseInt(a6.getComputedStyle("paddingRight"),10))+"px"}).addClass("sticky");}else{if(a8&&(!a4||!a3.hasClass("fixed-enabled"))){a6.removeClass("sticky").setStyles({top:ai,left:ai,width:ai});}}},highlightNewItems:function(Y){this.body.all("."+a1).removeClass(a1).removeClass(I);if(Y&&Y.size()){Y.addClass(a1);Y.item(Y.size()-1).addClass(I);}},recordRead:function(Y){if(!this.markAsReadEnabled){return;}Y=V.one(Y);if(Y&&Y.hasAttribute(n)&&!Y.test(F)&&!Y.hasClass(aD)){this.storage.addToSet(Z,Y.getAttribute(n),1,aU);Y.addClass("read");}},markRead:function(a3){if(!this.markAsReadEnabled){return;}var Y=this.storage.getSet(Z);if(Y&&V.Object.size(Y)){a3=a3||this.body.all(aq);a3.each(function(a4){var a5=a4.getAttribute(n);if(a5&&Y[a5]){a4.addClass("read");}});}},markFlag:function(a3){if(!this.flagContentEnabled){return;}if(this.filter.category===ae||this.filter.category===ar){return;}var Y=this.storage.getSet(aC);if(Y&&V.Object.size(Y)){a3=a3||this.body.all(aq);a3.each(function(a4){var a5=a4.getAttribute(n);if(a5&&Y[a5]){a4.addClass("flagged");}});}},markStreamActions:function(a6){if(!a6){return;}var a3=(a6.saveforlater&&V.Lang.isArray(a6.saveforlater))?a6.saveforlater:[],Y=(a6.like&&V.Lang.isArray(a6.like))?a6.like:[],a5=(a6.dislike&&V.Lang.isArray(a6.dislike))?a6.dislike:[],a4;V.Array.each(a3,function(a7){a4=this.getItemByUuid(a7);if(a4){a4.addClass(aE);}},this);V.Array.each(Y,function(a7){a4=this.getItemByUuid(a7);if(a4){a4.addClass(ap);}},this);V.Array.each(a5,function(a7){a4=this.getItemByUuid(a7);if(a4){a4.remove();}},this);},recordClosed:function(a3,Y){if(!this.closeEnabled||(this.readMixerActions&&this.userinfo.isLoggedIn())){return;}if(Y){this.storage.removeFromSet(ac,a3);}else{this.storage.addToSet(ac,a3,1,aU);}},pruneClosed:function(a3){if(!this.closeEnabled||this.filter.category===ae){return;}var Y=this.storage.getSet(ac);if(Y&&V.Object.size(Y)&&(this.filter.category!==ar)){a3=a3||this.body.all(aq);a3.each(function(a4){var a5=a4.getAttribute(n);if(a5&&V.Object.owns(Y,a5)){a4.remove();}});}},onDeclareInterest:function(a6,a3){var a4=this.instrumentation.getBeaconKeys(a3),Y={"1":"pos","0":"neu","-1":"neg"},a5=this.userinfo.isLoggedIn();if(a5){a4.dcl=Y[a6.current]+"-"+Y[a6["new"]];}a4.itc=1;a4.action=aF;switch(a6.type){case"entity":a4.sec="td-strm-dr";a4.ltxt=a6.id;a4.slk=a6.source?"prvdr":"ent";if(a5){a4.outcm="dclent";}break;case"content":a4.sec="td-strm-ctrl";a4.ltxt=a3.one("h3 a").get("text").substring(0,8);if(a6.action==="disliked"){a4.rspns=(a6["new"]==="-1")?"rmct":"unrmct";}a4.slk=(a6.action==="liked")?"like":"rm";if(a5){a4.outcm="dclitm";}break;}this.instrumentation.fireBeacon(a4);},initPagination:function(){this.listeners.push(V.after("touchend",this.afterScroll,b,this));this.listeners.push(V.on("resize",function(){this.scrollNodeHeight=this.getScrollNodeHeight();},b,this));if(this.clientPagination){if(this.items.length===0){if(this.pollForNewFrequency||this.dynamicEnabled||this.isInScrollBuffer()){this.fetchContentIds();}else{this.listeners.push(V.onceAfter("scroll",this.fetchContentIds,b,this));}}else{if(this.closeEnabled){this.items=this.removeDuplicates(this.items,this.storage.getSet(ac,M));}}}else{if(this.getContinuationKey()===""){this.batchCount=0;this.loadNextBatch();}}this.scrollBuffer=this.moduleapi.getContextData("scrollBuffer")||this.scrollBuffer;},getContinuationKey:function(a3){var Y=a3||this.body.one(ag);if(Y){return Y.hasAttribute("data-key")?Y.getAttribute("data-key"):ai;}return ai;},getNode:function(Y){return V.Lang.isString(Y)?this.body.one(Y):(Y&&this.body.contains(Y)?V.one(Y):ai);},getItemByUuid:function(a3,Y){Y=Y||this.body;return a3?Y.one(aq+"["+n+'="'+a3+'"]'):ai;},getUuids:function(a3){var Y=a3||this.body.all(aq),a4=[];Y.each(function(a6){var a5=a6.hasAttribute(n)&&a6.getAttribute(n);if(a5){a4.push(a5);}});return a4;},fancyRemove:function(a3){var Y=this;a3=a3&&V.one(a3);if(!a3||!a3.inDoc()){return;}a3.transition({height:0,opacity:0,duration:0.4,easing:"ease-in"},function(){a3.remove();a3=ai;Y.repaint();});},repaint:function(){if(V.UA.ie&&V.UA.ie<8){this.body._node.className=this.body._node.className;}},setupScroll:function(){var Y=au.body||V.Node.getDOMNode(V.one("body"));this.scrollDomNode=this.isRmp?V.Node.getDOMNode(this.body.ancestor(function(a4){var a3=a4.getStyle("overflowY");return(a3==="scroll"||a3==="auto"||a4.compareTo(Y));})):Y;this._scrollNodeIsBody=(this.scrollDomNode===Y);if(this._scrollNodeIsBody&&!V.UA.webkit){this.scrollDomNode=au.documentElement;}this.scrollNodeHeight=this.getScrollNodeHeight();if(this.scrollListener){this.scrollListener.detach();}this.scrollListener=V.one(this._scrollNodeIsBody?b:this.scrollDomNode).after("scroll",this.afterScroll,this);},getScrollNodeHeight:function(){var a3=this.scrollDomNode,Y=this._scrollNodeIsBody;if(Y&&V.UA.webkit){a3=au.documentElement;}return(Y&&V.UA.ios)?b.innerHeight:a3.clientHeight;},isInScrollBuffer:function(){var a3=this.body.get("region"),Y=this.body.get("viewportRegion");if(this.registerRapidInViewport&&a3.height>0&&a3.top<=Y.bottom){this.registerWithRapid();this.registerRapidInViewport=t;}return(a3.height>0&&a3.bottom<(Y.bottom+this.scrollBuffer));},hasScrolled:function(){var a3=this.body.get("region"),Y=this.body.get("viewportRegion");return(a3.height>0&&Y.top>5);},checkScroll:function(){if(this.newContentNotice){this.positionNewContentNotice();}if(this.moduleapi.getContextData("splitFirstBatch")){if(this.moduleapi.getContextData("splitOnload")&&this.pageload){this.batchCount=0;this.loadNextBatch(M,null,M);}else{if(this.moduleapi.getContextData("splitOnscroll")&&!this.pagescroll&&this.hasScrolled()){this.pagescroll=M;this.batchCount=0;this.loadNextBatch(M,null,M);}}}if(this.isInScrollBuffer()){if(!this.batchPause||this.batchCount%this.batchPause){this.loadNextBatch();}}if(this.pollForNewAutoInsert&&this.pendingNewItems.length){this.onNewContent();}this.beaconVisibleNativeAds();if(this.pageload){this.pageload=false;}},onClick:function(a9){var a4=V.one(a9.target),a6="#"+V.DOM.generateID(this.body),ba=a4.ancestor(aq,M,a6),a5=ba&&"#"+V.DOM.generateID(ba),bb=a4.ancestor("a",M,a6),a7,Y="",a3="",a8={};if(bb&&bb.hasClass("fp-article")){a7=a4.ancestor(".fp-open-inline",true);if(a7&&ba.hasClass("fp-bday")){a9.preventDefault();a8={name:ba.getData("bday-name"),bday:ba.getData("bday-date"),hash:ba.getData("bday-hash"),id:ba.getData("bday-fbid")};this.moduleapi.broadcast("fp:open-inline",{sec:"td-strm",ct:"birthday",mode:"embed",module:"birthday",subModuleView:"birthday-story",subModuleData:V.JSON.stringify(a8)});}else{if(this.inlineLightboxEnabled&&a7){if(a7.getAttribute("data-uuid")){Y=a7.getAttribute("data-uuid");}if(a7.getAttribute("href")){a3=a7.getAttribute("href");}else{a3=a7.one("A.rapidnofollow").getAttribute("href");}a9.preventDefault();this.moduleapi.broadcast("fp:open-inline",{uuid:Y,href:a3,sec:"td-strm",ct:"1"});return;}}}if(a4.hasClass("fblink")){return;}if(a4.ancestor(".social-actions",M,a6)&&this.swipeMenu){this.swipeMenu.onClick(a9);return;}if(a4.test(ag+" button")){this.loadNextBatch();return;}if(a4.test('input[name="sb"]')){this.setSortMode(parseInt(a4.get(aW),10),M);return;}if(a4.ancestor(".see-more-button",M,".type_stream")){this.toggleCollapsibleStream(a4.ancestor(".see-more-button",M));return;}if(bb&&bb.test(m)){this.onAdInfoClick(bb,ba);}if(a4.hasClass("interest-filter")){a9.halt();this.moduleapi.broadcast(S,{category:a4.getAttribute("data-filter"),name:a4.getAttribute("data-filter-name")||a4.getContent()});this.filterBeacon(a4);return;}if(ba){if(ba.hasClass("remove")&&a4.ancestor(".menu",M,a5)){this.onRemovalMenuClick(a9);}else{if(this.actionDrawer&&a4.ancestor(aN,M,a5)){this.actionDrawer.toggleDrawer(ba,t);}else{if(this.actionDrawer&&a4.ancestor(".close,.check-icon,.save-button,.flag-content-btn",M,a5)){if(!a4.ancestor("button:disabled",M,a5)){this.handleActionDrawerTrigger(ba,a4);}}else{if(this.actionDrawer&&a4.ancestor(".undo-btn",M,a5)){this.restoreRemovedArticle(ba);}else{if(a4.ancestor(".close",M,a5)){a9.preventDefault();if(ba.hasAttribute(n)){if(this.saveForLaterWidget&&this.filter.category===ae){this.deleteSavedArticle(a4);}else{this.removeContent(ba);}}else{this.fancyRemove(ba);}}else{if(a4.hasClass("share-drawer-icon")){a9.preventDefault();}else{if(a4.ancestor(".share-drawer, .friends-string, .label, .sponsorship",M,a5)){}else{if(ba.hasClass("video-inline")&&this.handleInlineVideo(ba,a4)){a9.preventDefault();}else{if(bb){if(!a4.hasClass("interest-filter")){this.recordRead(ba);}if(a9.which!==2&&a9.button!==4&&!a9.altKey&&!a9.ctrlKey&&!a9.shiftKey&&!a9.metaKey&&bb.getAttribute("target").toLowerCase()!=="_blank"){this.clickedItem=ba;this.clickedLink=ai;if(this.restoreStateExpire&&!ba.hasClass("rss-fallback")){this.saveState();}if(this.itemClickContext){this.statemgr.setUserModuleState("context",{cat:this.filter.category,catName:this.filter.name||"",listid:this.listId||"",blogtype:this.blogType||"",u:ba.getAttribute(n)});}if(this.highlightActive){this.highlightItem(ba);}}}}}}}}}}}}this.moduleapi.broadcast(aA);},handleActionDrawerTrigger:function(bd,a4){var a6=bd&&"#"+V.DOM.generateID(bd),a5=a4.ancestor(".rmx-ad",M,a6)?aH:a4.ancestor(".close",M,a6)?A:a4.ancestor(".check-icon",M,a6)?ap:a4.ancestor(".flag-content-btn",M,a6)?r:aE,Y,bb=this.userinfo.isLoggedIn(),ba,bc,a3=(bd.hasClass(aB)&&bd.get("nextSibling")&&bd.get("nextSibling").hasClass("action-drawer"))?bd.get("nextSibling"):ai,a9,a8,a7;if(bd.get("nextSibling")&&bd.get("nextSibling").hasClass("flag-thankyou-msg-drawer")){bd.get("nextSibling").remove();bd.removeClass("y-pattern").removeClass("hover");}if(a5===aH){if(a3){this.beaconDislikeAds(bd,"fdb_undo","","");}else{this.beaconDislikeAds(bd,"fdb_start","","");}}this.onHideTooltip();if(a5===ap){a9=A;a8=r;a7=aE;}else{if(a5===A){if(this.filter.category===ae){this.actionDrawer.toggleDrawer(bd,M);this.actionDrawer.handleSaveClick();return;}a9=ap;a8=r;a7=aE;}else{if(a5===aE){a9=ap;a8=A;a7=r;}else{if(a5===r){a9=ap;a8=A;a7=aE;}}}}bd.toggleClass(a5);if(a5===aE){ba=bb;bc=bb?t:!bd.test("."+ap+",."+A+",."+r+",."+aH);}else{ba=!bd.hasClass(aB)&&!bd.hasClass(a5);bc=bb?(!a3||!a3.test("."+a9+",."+a8)):(!bd.test("."+a9+",."+a8+",."+a7));}if(!bd.hasClass(aB)||bc){this.actionDrawer.toggleDrawer(bd,ba,a5);}if(a5===aH){if(this.actionDrawer.currentDrawer){this.actionDrawer.showAdsDislikeBtns();}}else{if(bb||(this.nonPersonalStream&&(a5===A))){if(a5===ap){this.actionDrawer.handleLikeClick();}else{if(a5===A){this.actionDrawer.handleDislikeClick();Y=bd.getAttribute(n);this.recordClosed(Y,!bd.hasClass(A));}else{if(a5===aE){this.actionDrawer.handleSaveClick();}else{if(a5===r){this.actionDrawer.handleFlagClick();}}}}this.instrumentation.refreshModule(this.rapidContainer);}else{bd.removeClass(a9).removeClass(a8).removeClass(a7);if(this.actionDrawer.currentDrawer){this.actionDrawer.showLoginBtns();}else{if(a5===ap||a5===A){this.actionDrawer.fireItemInterestChange("0",a5===ap?"1":"-1",a5);}}}}bd.one("h3 a").focus();},disableStreamButtons:function(a3){var Y=a3?a3.item:ai;if(Y){Y.all(".side-button").set(o,M);}},enableStreamButtons:function(a3){var Y=a3?a3.item:ai;if(Y){Y.all(".side-button").set(o,t);}},handleInlineVideo:function(a4,Y){var a5,a3,a6,a7=ai;if(!this.yepService){this.yepService=this.moduleapi.getService("videoyep");if(this.yepService){this.yepPlayer=this.yepService.create();}}if(!this.yepPlayer){return t;}a5=a4.getData();if(!a5.uuid){return t;}if(a5["poster-img"]){a7=a5["poster-img"];}a3=this.instrumentation.getBeaconKeys(a4);a6={analytics:{sec:a3.sec,ccode:this.ccode,cpos:a3.cpos,ct:a3.ct||3},config:{animated:M,attach:a4,location:"prepend",returnTabIndexTo:Y,yep:{autoplay:M,id:a5.uuid},videoPageUrl:a5.url||ai}};if(a7){a6.config.image=a7;}this.yepPlayer.init(a6);this.recordRead(a4);return M;},onRemovalMenuClick:function(be){var a5=be.target,bc,bg=a5.ancestor(aq,M,"#"+V.DOM.generateID(this.body)),a7=V.merge(this.instrumentation.getBeaconKeys(bg),{itc:1,pos:0}),a8,ba,a4,a6,bb,a9,Y,bd={},a3=[],bf=this;if(a5.ancestor("button.undo",M)){this.clearRemovalTimer();Y=bg.getAttribute(n);this.recordClosed(Y,M);bg.one(".menu").remove();bg.removeClass(a2);this.currentRemovalMenu=ai;a8=bg.one(".wrapper .body h3 a").get("text");a8=(a8&&a8.length>8)?a8.substring(0,8):a8;this.instrumentation.fireBeacon(V.mix({action:aF,outcome:"undo",sec:"td-strm-rm",slk:"undo",ltxt:a8},a7));this.repaint();if(this.userinfo.isLoggedIn()&&this.writeMixerActions){a9={_subAction:"article_feedback",uuid:Y,state:"neutral",mixerAction:"dislike"};this.makeInterestRequest(a9);}bg.one(".wrapper .body a").focus();}else{if(a5.ancestor(".wikiid",M,".menu")){bc=a5.ancestor(".wikiid",M,".menu");bb=bc.hasClass(aI)?1:bc.hasClass(aa)?-1:0;if(a5.hasClass("remove-title")){if(bc.hasClass(aI)){bc.replaceClass(aI,aa);}else{if(bc.hasClass(aa)){bc.removeClass(aI).removeClass(aa);}else{bc.replaceClass(aa,aI);}}}else{if(a5.ancestor(".remove-pos",M,".wikiid")){bc.toggleClass(aI).removeClass(aa);}else{if(a5.ancestor(".remove-neg",M,".wikiid")){bc.toggleClass(aa).removeClass(aI);}else{bc.toggleClass(aa);bc.removeClass(aI);}}}a4=bc.hasClass(aI)?1:bc.hasClass(aa)?-1:0;a8=bc.getAttribute(aZ);a6=((bb===1)?"pos":(bb===-1)?"neg":"neu")+"-"+((a4===1)?"pos":(a4===-1)?"neg":"neu");bd[a8]={"new":a4,current:bb,type:bc.getAttribute("data-interesttype")};a3=bd;this.handleRemovalMenuFeedback(a3,function(bi,bj){var bh;if(bf.currentRemovalMenu&&bf.currentRemovalMenu===bg){if(bi===t){if(bf.interestsService){bf.interestsService.update(a8,{state:a4});}bh=a5.ancestor(".remove-menu-main",M,"div");if(!bh.getData("confirmed")){bh.append(bf.moduleapi.getString("STR.BUTTON.REMOVE_DONE"));bh.setData("confirmed",M);bf.repaint();}}else{if(bb===1){bc.replaceClass(aa,aI);}else{if(bb===-1){bc.replaceClass(aI,aa);}else{bc.removeClass(aa).removeClass(aI);}}}}});ba=bg.one(".login");if(ba){ba.removeClass(ad);this.repaint();}if(this.userinfo.isLoggedIn()){this.instrumentation.fireBeacon(V.mix({sec:"td-strm-rm",slk:a6,ltxt:a8,action:aF,outcome:"entitydecl"},a7));}}else{if(a5.ancestor("button.remove-done",M)){bg.one(".menu").empty().setStyle("minHeight",0).append(bf.moduleapi.getString("STR.REMOVE.CONFIRM"));bg.addClass("remove-disappear");bg.removeClass("featured");this.setRemovalTimer();this.repaint();this.instrumentation.fireBeacon(V.mix({slk:"done",ltxt:"done"},a7));}}}},afterScroll:function(Y){if(this.scrollTimer){this.scrollTimer.cancel();}var a3=+(new Date()),a4=a3-this.lastScrollCheck;if(a4>this.scrollThrottle){this.checkScroll();this.lastScrollCheck=a3;}else{this.scrollTimer=V.later(this.scrollThrottle-a4,this,this.checkScroll);}},onHoverContent:function(Y){var a4=Y.currentTarget,a3=Y.relatedTarget;if(a4!==a3&&!a4.contains(a3)){a4.toggleClass(k,(Y.type===Q));}},onHoverTitle:function(Y){var a3=Y.target.ancestor(aq);if(a3){a3.toggleClass(ah,Y.type===Q);}},onMouseOverMenu:function(Y){this.clearRemovalTimer();},onMouseOutMenu:function(Y){this.setRemovalTimer();},onMouseOverLi:function(Y){var a3=Y.currentTarget,a4=Y.target.ancestor(an);this.trimEntityList(a3);if(a4){this.beaconDislikeAds(a4,"fdb_movr_ad","","");}},onMouseOverRemoveBtn:function(Y){var a3=Y.target.ancestor(an);if(a3){this.beaconDislikeAds(a3,"fdb_movr_x","","");}},trimEntityList:function(a3){var Y=a3.one(".interest-list"),a4=Y?a3.one(".attribution").get("region"):ai,a5;if(Y&&!a3.hasClass("remove")){Y.removeClass("dn");Y.removeClass("voh");a5=Y.all(".interest-wrap");while(a5.size()&&!Y.inRegion(a4,M)){a5.pop().remove();}}},onMouseOutLi:function(Y){var a3=Y.currentTarget;this.hideEntityList(a3);},hideEntityList:function(a3){var Y=a3.one(".interest-list");if(Y){Y.addClass("voh");}},onShowTooltip:function(Y){this.showTooltip(Y.currentTarget);},showTooltip:function(a5){var a4=this.tooltip.getNode(),a3=this.moduleapi,Y=a5.ancestor(aq),a7,a6;if(a5.hasClass("side-button")&&this.actionDrawerEnabled){a4.addClass("whs-nw");if(a5.hasClass("save-button")){a6=Y.hasClass("saved")?a3.getString("STR.TOOLTIP.UNDO"):a3.getString("STR.SAVE.SAVETEXT");a4.addClass(aX);}else{if(a5.hasClass("check-icon")){a6=Y.hasClass("liked")?a3.getString("STR.TOOLTIP.UNDO"):a3.getString("STR.INTERESTS.LIKETEXT");a4.addClass(aV);}else{if((this.filter.category===ae)||this.nonPersonalStream){a6=a3.getString("STR.INTERESTS.REMOVETEXT");a7=this.nonPersonalStream?aT:aS;a4.addClass(a7);}else{if(a5.hasClass("close")){a6=Y.hasClass("disliked")||Y.hasClass(aH)?a3.getString("STR.TOOLTIP.UNDO"):Y.hasClass("rmx-ad")?a3.getString("STR.INTERESTS.ADSDISLIKETEXT"):a3.getString("STR.INTERESTS.DISLIKETEXT");a4.addClass(aT);}else{if(a5.hasClass("flag-content-btn")){a6=Y.hasClass("flagged")?a3.getString("STR.TOOLTIP.UNDO"):a3.getString("STR.INTERESTS.FLAGTEXT");a4.addClass(aR);}}}}}}else{if(a5.hasClass("profile-img")){a6=a5.one("img").get("alt");}else{if(a5.hasClass("more")){a6=a5.getAttribute("data-friendlist").split(",").join("<br/>");}}}if(a6){this.tooltip.show(a5,{msg:a6});}},onHideTooltip:function(Y){this.tooltip.hide();this.tooltip.getNode().removeClass(aX).removeClass(aV).removeClass(aT).removeClass(aS).removeClass(aR).removeClass("whs-nw");},onFilter:function(Y){if(this.streamLoadReqObj){this.streamLoadReqObj.abort();this.streamLoadReqObj=ai;}if(this.newContentRequestObj){this.newContentRequestObj.abort();this.newContentRequestObj=ai;}this.filter=Y||{};this.listId=(Y.category&&Y.category.indexOf("LISTID:")===0)?Y.category.slice(7):"";this.batchCount=0;this.contentpos=0;this.isLoading=t;this.items=[];this.pendingNewItems=[];this.broadcastNewContentNotice(0);this.body.setStyle(aL,Math.max(parseInt(this.body.get(B),10),60)+"px");this.body.all(x).remove();this.body.append(this.moduleapi.getString("STR.LOADING.CONTENT"));V.later(aj,this,this.scrollToTop);this.clearRemovalTimer();this.currentRemovalMenu=ai;this.updateDocTitle(0);this.updateControls();this.clearNativeAdData();this.loadNextBatch(M);if(this.saveForLaterWidget&&(Y.category===ae)){this.saveForLaterWidget.onSavedFilter();}if(this.actionDrawer){this.actionDrawer.onFilter(Y);}if(this.swipeMenu){this.swipeMenu.onFilter(Y);}},removeDuplicates:function(Y){var a4={},a3=[];if(Y&&Y.length){if(arguments.length>1){V.each(V.Array(arguments).slice(1),function(a5){V.each(a5,function(a6){if(!a6){return;}if(a6 instanceof V.Node){a4[a6.getAttribute(n)]=1;if(a6.hasAttribute(G)){a4[a6.getAttribute(G)]=1;}if(a6.hasAttribute(E)){a4[a6.getAttribute(E)]=1;}}else{if(V.Lang.isObject(a6)){a4[a6.u]=1;if(a6.ka){a4[a6.ka]=1;}if(a6.kb){a4[a6.kb]=1;}}else{a4[a6]=1;}}});});V.each(Y,function(a5){if((!a4.hasOwnProperty(a5.u))&&(!a5.ka||!a4.hasOwnProperty(a5.ka))&&(!a5.kb||!a4.hasOwnProperty(a5.kb))){a3.push(a5);}});}else{a3=Y.slice(0);}}return a3;},showRemovalMenu:function(a5){var a9=a5.one(".wrapper"),a4=this.parseInterests(a5),Y=a9.get(B),a7,a3,a8,a6;a5.addClass(a2);a3=this.moduleapi.getString("STR.REMOVE.MENU");a7=a5.appendChild(a3);a8=a7.one(".remove-menu-main");a6=a7.one(".profile-link");a7.setStyle("minHeight",Y);if(a4.length){a8.append(this.moduleapi.getString("STR.SHOW.LESS"));if(a6){a6.removeClass(X);}V.Array.each(a4,function(ba){ba.type=ba.declared?"declared":"";ba.selected=ba.state===1?aI:ba.state===-1?aa:"";a8.append(V.Lang.sub(this.moduleapi.getString("STR.BUTTON.WIKIID"),ba));},this);}this.repaint();this.currentRemovalMenu=a5;},handleRemovalMenuFeedback:function(a3,a7){if(!this.userinfo.isLoggedIn()){return;}var Y,a5;function a6(a8){if(V.Lang.isFunction(a7)){a7(t,a8);}}function a4(a8){if(V.Lang.isFunction(a7)){a7(M,a8);}}Y={_subAction:"int_manage",interest:a3};a5={success:a6,failure:a4,scope:this};this.makeInterestRequest(Y,a5);},makeRequestToGetMixerActions:function(Y,a3){this.transportHelperService.makeRequest({type:"module",moduleId:this.id,args:{_action:"show",_subAction:"getMixerActions",uuids:Y}},a3);},makeInterestRequest:function(Y,a3){var a4=a3?a3:{};this.transportHelperService.makeRequest({type:"module",moduleId:T,args:V.merge({_action:"show"},Y)},a4);},onRemovalMenuLoginClick:function(a5){var a4=a5.ancestor(aq,M,"#"+V.DOM.generateID(this.body)),a3=V.mix(this.instrumentation.getBeaconKeys(a4),{itc:1,pos:0}),a7=a5.get("text"),a8={},a6=t,Y=[];a7=(a7&&a7.length>8)?a7.substring(0,8):a7;this.clearRemovalTimer();this.currentRemovalMenu=ai;a4.all("span.wikiid").each(function(ba){var bc=ba.getAttribute(aZ),a9="neu-"+(ba.hasClass(aI)?"pos":ba.hasClass(aa)?"neg":""),bb=ba.hasClass(aI)?1:ba.hasClass(aa)?-1:0;if(ba.hasClass(aI)||ba.hasClass(aa)){a8[bc]={"new":bb,current:0,type:"declared"};a6=M;Y.push(V.merge(a3,{slk:a9,ltxt:bc}));}});if(a6){this.storage.setItem(aO,{wikiids:a8,beacons:Y});}this.storage.setItem(al,a5.hasClass("fblogin")?aY:h);},updateDislikedInterests:function(){if(!this.removalMenuEnabled){return;}var Y;if(!this.userinfo.isLoggedIn()){this.loginService.configClick({selector:".type_stream .remove a",clickHandler:V.bind(this.onRemovalMenuLoginClick,this)});}else{Y=this.storage.getItem(aO);if(Y){if(V.Object.size(Y.wikiids)>0){this.handleRemovalMenuFeedback(Y.wikiids,M);}V.Array.each(Y.beacons,function(a3){this.instrumentation.fireBeacon(a3);},this);this.storage.removeItem(aO);}this.storage.removeItem(al);}},parseInterests:function(a3){var Y=a3&&a3.hasAttribute(c)?a3.getAttribute(c):ai,a4=Y?V.Object.values(this.interestsService.get(Y.split("|"))):[];V.Array.each(a4,function(a5){a5.streamEligible=(a5.url&&(a5.count>=this.minArticleCount));},this);return a4;},clearRemovalTimer:function(Y){if(this.itemRemovalTimer){this.itemRemovalTimer.cancel();this.itemRemovalTimer=ai;}},setRemovalTimer:function(){this.itemRemovalTimer=V.later(5000,this,function(){this.fancyRemove(this.currentRemovalMenu);this.currentRemovalMenu=ai;});},removeContent:function(a4){var a3,Y;a4=V.one(a4);if(a4&&a4.hasAttribute(n)){a3=a4.getAttribute(n);this.recordClosed(a3);if(this.removalMenuEnabled){if(this.currentRemovalMenu){this.clearRemovalTimer();this.fancyRemove(this.currentRemovalMenu);this.currentRemovalMenu=ai;}this.showRemovalMenu(a4);}else{if(!this.swipeMenu){this.fancyRemove(a4);}}if(this.userinfo.isLoggedIn()&&this.writeMixerActions){Y={_subAction:"article_feedback",uuid:a3,state:"disliked",mixerAction:"dislike"};this.makeInterestRequest(Y);}this.instrumentation.fireYwaBeacon(V.mix({itc:1,action:aF,outcome:"rmct",slk:"rm",sec:"td-strm-ctrl"},this.instrumentation.getBeaconKeys(a4)));}},setSortMode:function(a5,a3){var a4=this.instrumentation,Y;if(a5===this.sortBy){return;}this.sortBy=a5;this.statemgr.saveUserSetting("sb",a5,this.moduleapi);this.onFilter(this.filter);if(a3){this.updateControls();Y=(a5===a?"sort-t":"sort-c");a4.fireBeacon({sec:"set-strm",itc:1,slk:Y,action:aF,outcome:"sort"});}},toggleCollapsibleStream:function(a5){var a6=this.body.all(aq),a4=a6.filter(".expanded-item"),a3=a5.one("i"),a7,Y={sec:"td-strm",elm:"btn",itc:1,action:aF};if(a5.hasClass("expand")){a5.setHTML(this.moduleapi.getString("STR.STREAM.COLLAPSE")+" "+a3.get("outerHTML"));a7=M;Y.slk="xpnd";Y.elmt="xpnd";a5.removeClass("expand");a4.removeClass("dn");}else{a5.setHTML(this.moduleapi.getString("STR.STREAM.EXPAND")+" "+a3.get("outerHTML"));a7=t;Y.slk="clps";Y.elmt="clps";a5.addClass("expand");a4.addClass("dn");}a6.removeClass("no-bottom-border").filter(":not(.dn)").pop().addClass("no-bottom-border");this.instrumentation.fireBeacon(Y);this.statemgr.saveUserSetting("es",a7,this.moduleapi);V.Global.fire("pane-manager:sync-nav-pane-scroll");},updateControls:function(){var Y=this.body.one(".controls"),a3,a4,a5=this.filter.category,a6=this.sortBy;if(!Y){return;}a3=Y.one(".sort");Y.all(av).removeClass(i);if(a3){if(a5===ar){a3.addClass(o).setAttribute(o,o);a6=a;}else{a3.removeClass(o).removeAttribute(o);}a4=a3.one('input[value="'+a6+'"]');if(a4){a4.set(i,M).ancestor(av).addClass(i);}}},filterBeacon:function(a4){var a3,a5,Y={ltxt:a4.getContent(),cpos:a4.get("parentNode").all(".interest-filter").indexOf(a4)+1,itc:1};if(a4.ancestor(J)){Y.sec="fltr-strm-ft";Y.slk="filter-d";this.instrumentation.fireBeacon(Y);}else{if(a4.ancestor(".interest-list")){a3=a4.ancestor(aq);a5=this.instrumentation.getBeaconKeys(a3);Y.slk="filter-i";Y.sec=a5.sec;Y.g=a5.g;Y.woe=this.woeid;Y.ccode=this.ccode;Y.intl=this.intl;this.instrumentation.fireBeacon(Y);}}},deleteSavedArticle:function(Y){if(this.saveForLaterWidget){this.saveForLaterWidget.deleteArticle(Y);}var a3=this.body.all(aq),a4=this.body.one(".strm-error-msg");if(this.filter.category===ae&&a4&&a3&&a3.size()===0){a4.removeClass(X);}this.updateSflHeader(a3.size());},updateSflHeader:function(a3){var a4=this.body.one(".saved-stories-header"),Y;if(a4){Y=a4.one(".saved-header-count");if(Y){Y.setHTML(a3);}if(a3===0){a4.one(".saved-header-count-wrap").addClass("d-n");}}},onSaveArticle:function(a4,Y){if(!a4){return;}var a3=V.merge(this.instrumentation.getBeaconKeys(a4),{sec:"td-strm-ctrl",slk:Y,itc:1,action:aF,outcome:((Y==="sv")?"svct":"undo")});this.instrumentation.fireBeacon(a3);},onSignedOutSaveClick:function(a3){if(!a3){return;}var Y=V.merge(this.instrumentation.getBeaconKeys(a3),{sec:"td-strm-ctrl",action:aF,outcome:"login"});this.instrumentation.fireYwaBeacon(Y);},registerWithRapid:function(){var a4=this.instrumentation,a3=this.rapidContainer,Y=a4.getBeaconKeys(a3);if(a4.isModuleTracked(a3)){a4.refreshModule(a3);}else{a4.addModule(a3,Y&&Y.sec?Y.sec:"td-strm");}},cacheNativeAdData:function(){var Y=this.body.all(an+"["+aM+"]");this.clearNativeAdData();if(Y.size&&Y.size()>0){Y.each(function(a4,a3){this.nativeAds.push({node:a4,y:a4.getY(),height:a4.get(B)});},this);return true;}return false;},clearNativeAdData:function(){this.nativeAds=[];},beaconVisibleNativeAds:function(){var a4,a3,Y,a5;if(this.nativeAds.length>0){a4=this.scrollDomNode;a3=this.getScrollNodeHeight();Y=this.nativeAds.length-1;while(Y>=0){a5=this.nativeAds[Y];if(((a4.scrollTop+a3)>(a5.y+(a5.height/2)))&&(a4.scrollTop<a5.y)){this.fireNativeAdBeaconWhenReady(a5);this.nativeAds.splice(Y,1);}Y--;}}},fireNativeAdBeaconWhenReady:function(a3){var Y=this;V.later(1000,this,function(){var a7,a9,a5,a8=this.scrollDomNode,a4=this.getScrollNodeHeight();if(((a8.scrollTop+a4)>(a3.y+(a3.height/2)))&&(a8.scrollTop<a3.y)){a7=a3.node.getAttribute(aM);a9=a3.node.getAttribute(e);a5=a3.node.getAttribute(N);if(a7){this.instrumentation.getBeaconImage(a7);a3.node.removeAttribute(aM);}if(a5){try{a5=V.JSON.parse(a5);}catch(a6){}if(a5&&V.Lang.isArray(a5)){V.Array.each(a5,function(ba){Y.instrumentation.getBeaconImage(ba);});}a3.node.removeAttribute(N);}else{if(a9){this.instrumentation.getBeaconImage(a9);a3.node.removeAttribute(e);}}}else{this.nativeAds.push(a3);}});},onAdInfoClick:function(a5,a4){var a3=this.instrumentation.getBeaconKeys(a4),Y=a5.test(at)?"sp":a5.test(f)?"adv":"info";this.instrumentation.fireYwaBeacon(V.mix(a3,{slk:Y,ad:1,action:"click",rspns:"nav"}));},initGlobalListeners:function(){this.listeners.push(V.Global.on("media:remove-node",function(Y){if(Y.node.contains(this.body)){this.onviewunload("default");}},this));this.listeners.push(V.Global.on(K+":initialized",this.onReqMgrInitialized,this));this.listeners.push(V.Global.on(K+":active-content-changed",this.onReqMgrActiveContentChange,this));this.listeners.push(V.Global.on("pane-manager:scroll-mode-change",this.setupScroll,this));this.listeners.push(V.Global.on(S,function(Y){this.moduleapi.broadcast(S,Y);},this));},onReqMgrInitialized:function(Y){if(Y&&Y.metadata){this.substituteDataInTemplate(Y.metadata);}},onReqMgrActiveContentChange:function(a4){var Y=V.Object.getValue(a4,["uuid"]),a3=Y&&this.getItemByUuid(Y)||ai;b.YUI.namespace("type_stream").activeItemId=this.activeItemId=Y;if(a3&&this.interestFiltersBroadcast){this.broadcastEntities(a3);}if(this.highlightActive){this.highlightItem(a3);}},substituteDataInTemplate:function(a3){var Y=a3&&a3.uuid&&this.getItemByUuid(a3.uuid);if(Y&&Y.hasClass(X)){if(a3.url&&a3.title){a3=V.merge({summary:a3.description||"",pubdate:"",attribution:""},a3);Y.setHTML(V.Lang.sub(Y.getHTML(),a3)).removeClass(X);}else{Y.remove();}}},highlightItem:function(Y){this.body.all(l).removeClass(q);if(Y&&!Y.hasClass(aD)){Y.addClass(q);}},broadcastEntities:function(a3){var a4={url:"",uuid:"",entities:[]},Y;if(a3){Y=a3.one("h3 a");if(Y){a4.url=Y.getAttribute("href");}if(a3.hasAttribute(n)){a4.uuid=a3.getAttribute(n);}if(this.interestFiltersBroadcast&&a3.hasAttribute(c)){a4.entities=this.parseInterests(a3);}}if(!this.evtStreamEntities){this.evtStreamEntities=V.Global.publish(W,{fireOnce:M,async:M});this.customEvents.push(this.evtStreamEntities);}else{if(this.evtStreamEntities.fireOnce){this.evtStreamEntities.applyConfig({fireOnce:t,async:t},M);}}this.evtStreamEntities.fire(a4);},broadcastDynamicFilters:function(Y){if(!this.evtStreamDynamicFilters){this.evtStreamDynamicFilters=V.Global.publish(H,{fireOnce:M,async:M});this.customEvents.push(this.evtStreamDynamicFilters);}else{if(this.evtStreamDynamicFilters.fireOnce){this.evtStreamDynamicFilters.applyConfig({fireOnce:t,async:t},M);}}this.evtStreamDynamicFilters.fire(Y);}};}());/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
YUI.add("interests_service",function(b){var i="MPServices",d="InterestsProvider",e=true,f=null,j=b.guid(),g="interests_service|",h="interests:change",c={},k=f;function a(){b.Global.detachAll(g+"*");b.Global.on(g+h,this._onInterestsChange,this);}a.prototype={_fireWithOrigin:function(l,n){var m={origin:j,data:n};this.fire(l,m);},_onInterestsChange:function(l){if(l.origin!==j){this.set(l.data);}},get:function(n,m){var o,l={};b.Array.each(n||b.Object.keys(c),function(p){o=b.Object.owns(c,p)?b.merge(c[p]):f;if(o&&(!m||m(o,p))){l[p]=o;}});return l;},getById:function(l){return this.get([l])[l]||f;},set:function(m){var l={};b.Object.each(m,function(n,o){this.update(o,n,e);l[o]=b.merge(c[o]);},this);this._fireWithOrigin(h,l);return this;},update:function(o,m,l){var n={};if(b.Object.owns(c,o)){b.mix(c[o],m,e);}else{m.id=o;c[o]=b.merge(m);}if(!l){n[o]=b.merge(c[o]);this._fireWithOrigin(h,n);}return this;}};b.augment(a,b.EventTarget,e,f,{broadcast:2,emitFacade:e});b.namespace(i)[d]={name:"interests",getService:function(m,l){if(!k){k=new a();}return k;}};if(b.ModulePlatform){b.ModulePlatform.registerService(b[i][d]);}},"0.0.1",{requires:["event-custom-base"]});/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
YUI.add("stream_action_drawer",function(Q){var W=null,J=true,v=false,aj="click",an=5*60*1000,au=2*24*60*60*1000,al=80,c="data-uuid",aw="YPROP:SAVE",ap="height",U="MPServices",H="StreamSocialProvider",e=Q.ModulePlatform,h={LIKE:1,NEUTRAL:0,DISLIKE:-1},q=Q.Node.create('<span class="action-drawer-login"></span>'),k="like",aa="dislike",ah="saveforlater",D=".social-actions",a=".social-icon",G=".save-button",I=".check-button",L=".remove",j=".delete",m=G+","+I+","+L+","+j,Z=".saved,.liked,.disliked,.flagged",ao=".entity",r=".entity-list",S=".entity-msg",t=".done-button",ak=".action-drawer-login",u="li",ab=".menu",R=".flag-content-item",ae="drawer-open",F="drawer-transition",ag="highline",ai="saved",X="liked",K="neutral",A="disliked",am="ads_disliked",p="pos",at="neu",az="neg",s="flagged",n="put-update",av="delete-update",x="savedarticles",B="actionRestore",E="flagDetailsRestore",l="declareFeedback",z="removeStreamItem",d="onFlagDone",ad="recordFlag",O="deleteSaved",f="drawerToggleStart",aq="drawerToggleComplete",i="checked",P="input",g="saveforlater:newsaved",T="p_30345860",M="p_30345831",ar,N,w,C,V,ac,af,b,ay="",o=J,ax=0,y;y=function(Y){var aA=W,aB=w.isLoggedIn();if(C&&!aB){if(af.getString("STR.ACTIONDRAWER.LOGIN.TEMPLATE")){q.setContent(af.getString("STR.ACTIONDRAWER.LOGIN.TEMPLATE"));}else{C.getButtons(q,{sec:"td-strm-dr",layout:"horizontal",title:af.getString("STR.ACTIONDRAWER.LIKEDCTA"),narrow:1});}C.configClick({selector:ak+" a",clickHandler:Q.bind(this.onLoginBtnClick,this)});}if(N){N.removeItem(x);aA=N.getItem(B);if(aA){if(aB){this.restoreAction(aA);}N.removeItem(B);}}this.viewingSavedStories=ac?ac.isSflPage:v;this.flagContentEnabled=ac?ac.flagContentEnabled:v;this.sourceDeclarationEnabled=ac?ac.sourceDeclarationEnabled:v;this.timerInProcess=null;};y.prototype={disableButtons:function(){o=v;},restoreAction:function(aA){var aB={},Y;if(aA.type===ai){this.makeSaveRequest(n,aA.uuid,J);ar.fireBeacon(aA.beacon);}else{ar.fireBeacon(aA.beacon);if(aA.type===A){this.fire(z,{uuid:aA.uuid,animate:v});aB={uuid:aA.uuid,state:h.DISLIKE};}else{aB={uuid:aA.uuid,state:h.LIKE};}this.fire(l,aB);Y=(aA.type===X)?k:aa;this.markItemFeedbackInMixer(aA.uuid,aA.type,Y);}},handleSaveClick:function(aC){var aD=this.currentItem.hasClass(ai),aB,aA=this.currentItem.getAttribute(c),Y=Q.merge(ar.getBeaconKeys(this.currentItem),{sec:"td-strm-ctrl",itc:1,action:aj});if(!aD||this.viewingSavedStories){if(this.viewingSavedStories){Y.slk="rm";Y.outcm="rmsvct";Y.rspns="rmct";}else{Y.slk="unsv";Y.outcm="unsvct";}aB=av;}else{Y.slk="sv";Y.outcm="svct";aB=n;Q.Global.fire(g);}ar.fireBeacon(Y);this.makeSaveRequest(aB,aA);if(this.viewingSavedStories){if(o){this.closeDrawer(this.currentDrawer);}this.currentItem.remove();this.fire(O,{});}},handleLikeClick:function(aB){var aE=this.currentItem.hasClass(X),aA=this.currentItem.hasClass(A),Y=this.currentItem.getAttribute(c),aD=aE?"1":"0",aC=aA?"-1":aE?"0":"1";if(!o){this.currentItem.removeClass(A);if(this.currentDrawer){this.currentDrawer.removeClass(A);if(aE){this.currentDrawer.addClass(X);}else{this.currentDrawer.removeClass(X);}}}this.fireItemInterestChange(aD,aC,X);this.markItemFeedbackInMixer(Y,aE?X:K,k);if(aA){this.markItemFeedbackInMixer(Y,K,aa);}if(!aE){if(this.currentItem.hasClass(ae)&&this.currentDrawer&&this.currentDrawer.hasClass(s)){this.buildFlagEntityList();}if(o){this.closeDrawer(this.currentDrawer);}}else{this.buildEntityList(v);}},handleDislikeClick:function(aB){var aE=this.currentItem.hasClass(X),aA=this.currentItem.hasClass(A),Y=this.currentItem.getAttribute(c),aD=aA?"-1":"0",aC=aE?"1":aA?"0":"-1";if(!o){this.currentItem.removeClass(X);this.currentItem.removeClass(am);if(this.currentDrawer){this.currentDrawer.removeClass(X);this.currentDrawer.removeClass(am);if(aA){this.currentDrawer.addClass(A);}else{this.currentDrawer.removeClass(A);}}}this.fireItemInterestChange(aD,aC,A);this.markItemFeedbackInMixer(Y,aA?A:K,aa);if(aE){this.markItemFeedbackInMixer(Y,K,k);}if(!aA){if(this.currentItem.hasClass(ae)&&this.currentDrawer&&this.currentDrawer.hasClass(s)){this.buildFlagEntityList();}if(o){this.closeDrawer(this.currentDrawer);}}else{this.buildEntityList(v);this.updateConfirmationMsg(af.getString("STR.ENTITY.LIST.DISLIKED.MSG"));}},handleFlagClick:function(aB){var aA=this.currentItem.hasClass(s),Y=Q.merge(ar.getBeaconKeys(this.currentItem),{sec:"td-strm-ctrl",elm:"btn",elmt:"flag",itc:1,intl:ac.intl,action:aj});if(this.currentDrawer){if(aA){this.currentDrawer.addClass(s);}else{this.currentDrawer.removeClass(s);}}if(!aA){Y.slk="unflag";Y.outcm="unflagitm";Y.rspns="clps";Q.later(300,this,function(){this.fire(ad,{item:this.currentItem,flag:v});});if(this.currentItem.hasClass(ae)&&this.currentDrawer&&this.currentDrawer.hasClass(X)){this.buildEntityList(J);}else{if(this.currentItem.hasClass(ae)&&this.currentDrawer&&this.currentDrawer.hasClass(A)){this.buildEntityList(J);this.updateConfirmationMsg(af.getString("STR.ENTITY.LIST.DISLIKED.MSG"));}}if(o){this.closeDrawer(this.currentDrawer);}}else{Y.slk="flag";Y.outcm="flagitm";Y.rspns="xpnd";Q.later(300,this,function(){this.fire(ad,{item:this.currentItem,flag:J});});this.buildFlagEntityList();}ar.fireBeacon(Y);},markItemFeedbackInMixer:function(Y,aB,aA){if(!ac.writeMixerActions||!w.isLoggedIn()){return;}if(!ay&&ac.listId){ay="LISTID:"+ac.listId;}this.makeInterestRequest({_subAction:"article_feedback",uuid:Y,state:aB,mixerAction:aA,curFilter:ay});},updateConfirmationMsg:function(aA){var Y=this.currentDrawer.one(S);if(Y){Y.setHTML(aA);}},buildEntityList:function(aO){var aI=o?af.getString("STR.ENTITY.LIST.TEMPLATE"):af.getString("STR.REMOVE.MENU"),aQ=af.getString("STR.ENTITY.ITEM.TEMPLATE"),aP="",aA,Y,aE,aM=this.currentDrawer.one(S),aF=this.currentDrawer.one(r),aK=this.currentDrawer.one(t),aH=this.currentDrawer.one(ab),aB,aN="",aC={},aL,aD=J,aR=0,aG=this.currentDrawer,aJ=this;if(aF&&aK&&aM){aF.remove();aK.remove();aM.remove();}if(aH){aH.remove();}aB=V.get(this.currentItem.getAttribute("data-wikiids").split("|"));Q.Object.each(aB,function(aS){aC={state:(aS.state===1)?p:(aS.state===-1)?az:at,type:aS.declared?"declared":"inferred",id:aS.id,name:aS.name};aN+=Q.Lang.sub(aQ,aC);});if(!o){this.currentItem.addClass("y-pattern").addClass("hover");aG.removeClass("dn");}if(this.sourceDeclarationEnabled){aE=this.currentItem.getAttribute("data-sourceid");if(aE){aP=af.getString("STR.SOURCE.ITEM.TEMPLATE");Y=V.getById(aE);aA={state:Y?((Y.state===1)?p:((Y.state===-1)?az:at)):at,id:aE,name:Y.name};aP=Q.Lang.sub(aP,aA);}}if(Q.Object.size(aB)>0){aN=Q.Lang.sub(aI,{source:aP,entities:aN});aG.append(aN);if(o){aG.one(D).setStyle(ap,al+"px");aL=al+aG.one(r).get("clientHeight")+aG.one(t).get("clientHeight")+aG.one(S).get("clientHeight")+30;}else{aG.all(ao).addClass("d-ib");aL=aG.one(ab).get("offsetHeight");aK=aG.one(t);}aD=v;}else{if(!aO){if(o){aG.one(D).remove();}aN=af.getString("STR.ACTIONDRAWER.NOENTITIESLIKE");aG.append(aN);aL=aG.one(".no-entities").get("clientHeight");aD=v;aR=aG.hasClass(A)?0:3000;this.timerInProcess=Q.later(aR,this,function(){if(aJ.currentDrawer===aG){aJ.closeDrawer(aG,ac.nonPersonalStream);}});if(aG.hasClass(A)){aG.addClass("dn");this.currentItem.removeClass(ae);return aD;}}}aG.transition({height:aL+"px",duration:0.3,easing:"ease-in",on:{start:function(){aJ.fire(f,{item:aJ.currentItem});},end:function(){aJ.fire(aq,{item:aJ.currentItem});if(aK){aK.removeClass("dn");}aJ.repaint();}}});return aD;},showAdsDislikeBtns:function(){if(!this.currentItem||!this.currentDrawer){return;}var aE=af.getString("STR.ACTIONDRAWER.ADSDISLIKEDCTA"),aI=af.getString("STR.ACTIONDRAWER.ADSDISLIKEOPTN1"),aB=af.getString("STR.ACTIONDRAWER.ADSDISLIKEOPTN2"),aH=af.getString("STR.ACTIONDRAWER.ADSDISLIKEOPTN3"),aC=af.getString("STR.ACTIONDRAWER.ADSDISLIKEOPTN4"),aG=af.getString("STR.ACTIONDRAWER.ADSDISLIKE.SOMETHING.ELSE"),aM=Q.Node.create('<span class="action-drawer-login"></span>'),aF,aJ=this.currentDrawer.one(ak),Y,aL,aA,aD,aK=this;if(aJ){aJ.remove();}if(af.getString("STR.ADSDISLIKE.TEMPLATE")){aD={cdata:aE,option1:aI,option2:aB,option3:aH,option4:aC,somethingq:aG};aL=Q.Lang.sub(af.getString("STR.ADSDISLIKE.TEMPLATE"),aD);aM.setContent(aL);aJ=this.currentDrawer.appendChild(aM.cloneNode(J));this.currentDrawer.all("input[type=radio]").each(function(aN){aN.on("change",function(aS){var aQ=aS.target.ancestor(".embed",true),aP=parseInt(aK.currentDrawer.getStyle("height"),10),aO=aQ.one("input[id=ads-dislike-option4]"),aR=aQ.one("input[name=ads-dislike-option]:checked");if(aR.compareTo(aO)){aQ.one(".custom_resp").removeClass("hidden");aQ.one(".custom_resp").addClass("required");aP=aP+40;aK.currentDrawer.transition({height:aP+"px",duration:0.2,easing:"ease-in"},function(){var aT=aK.currentDrawer.one("#cmnt");aT.focus();});}else{if(!aQ.one(".custom_resp").hasClass("hidden")){aQ.one(".custom_resp").addClass("hidden");aQ.one(".custom_resp").removeClass("required");aP=aP-40;aK.currentDrawer.transition({height:aP+"px",duration:0.2,easing:"ease-in"});}}});});}else{aJ=this.currentDrawer.appendChild(q.cloneNode(J));}aF=aJ.appendChild(af.getString("STR.ACTIONDRAWER.DONE"));this.currentDrawer.addClass(am);aA=this.currentDrawer.one(".title");if(aA){if(o){this.currentDrawer.one(D).setStyle(ap,al+"px");Y=al+this.currentDrawer.one(".embed").get("clientHeight");if(aF){Y+=(aF.get("clientHeight")+5);}}else{this.currentItem.addClass("y-pattern").addClass("hover");this.currentDrawer.removeClass("dn");Y=this.currentDrawer.one(".embed").get("offsetHeight");this.fireItemInterestChange("-1","0",A);}this.currentDrawer.transition({height:Y+"px",duration:0.3,easing:"ease-in",on:{start:function(){aK.fire(f,{item:aK.currentItem});},end:function(){aK.fire(aq,{item:aK.currentItem});aK.repaint();}}});}},showLoginBtns:function(){if(!this.currentItem||!this.currentDrawer){return;}var aA=this.currentItem.hasClass(ai)?af.getString("STR.ACTIONDRAWER.SAVEDCTA"):this.currentItem.hasClass(X)?af.getString("STR.ACTIONDRAWER.LIKEDCTA"):this.currentItem.hasClass(s)?af.getString("STR.ACTIONDRAWER.FLAGGEDCTA"):af.getString("STR.ACTIONDRAWER.DISLIKEDCTA"),aD,Y=this.currentDrawer.one(ak),aB,aF,aE,aC=this;if(Y){Y.remove();}Y=this.currentDrawer.appendChild(q.cloneNode(J));if(this.currentItem.hasClass(A)){aD=Y.appendChild(af.getString("STR.ACTIONDRAWER.DONE"));}aE=this.currentDrawer.one(".title");if(aE){aE.setHTML(aA);if(o){this.currentDrawer.one(D).setStyle(ap,al+"px");aB=al+this.currentDrawer.one(".embed").get("clientHeight");if(aD){aB+=(aD.get("clientHeight")+5);}}else{this.currentItem.addClass("y-pattern").addClass("hover");this.currentDrawer.removeClass("dn");aB=this.currentDrawer.one(".embed").get("offsetHeight");if(this.currentItem.hasClass(X)||this.currentItem.hasClass(A)){aF=this.currentItem.hasClass(X);this.fireItemInterestChange(aF?"1":"-1","0",aF?X:A);}}this.currentDrawer.transition({height:aB+"px",duration:0.3,easing:"ease-in",on:{start:function(){aC.fire(f,{item:aC.currentItem});},end:function(){aC.fire(aq,{item:aC.currentItem});aC.repaint();}}});}},onLoginBtnClick:function(Y){var aC=Q.merge(ar.getBeaconKeys(this.currentItem),{sec:"td-strm-ctrl",action:aj}),aB=this.currentItem.getAttribute(c),aA;if(this.currentItem.hasClass(X)){aA=X;aC.slk="neu-pos";aC.outcome="itemdecl";}else{if(this.currentItem.hasClass(A)){aA=A;aC.slk="neu-neg";aC.outcome="itemdecl";}else{if(this.currentItem.hasClass(ai)){aA=ai;aC.slk="sv";aC.outcome="svct";}else{if(this.currentItem.hasClass(s)){aA=s;aC.slk="flag";aC.outcome="flagitm";}}}}N.setItem(B,{type:aA,uuid:aB,beacon:aC},an);},onDoneClick:function(Y){var aC,aD,aA,aF,aB,aE="";if(this.currentDrawer.hasClass(am)){aC=this.currentDrawer.one("#ads-dislike-option4");aD=aC?aC.get("vlaue"):0;aA=this.currentDrawer.one("[name=ads-dislike-option]:checked");aF=aA?aA.get("value"):aD;aB=this.currentDrawer.one("#cmnt");if(aF===aD){aE=aB.get("value")||"";}}else{ar.fireBeacon({sec:"td-strm-dr",slk:"btn-dn",itc:1,action:aj});}this.closeDrawer(this.currentDrawer);},onFilter:function(Y){this.currentItem=W;this.currentDrawer=W;ay=Y.category;this.viewingSavedStories=v;if(ay===aw){this.viewingSavedStories=J;}},populateHighlineMenu:function(){var aB=this.currentItem.getAttribute("data-highline-id"),aA={id:encodeURIComponent(aB)},Y=this.currentDrawer.all("a");Y.each(function(aC){aC.setAttribute("href",Q.Lang.sub(aC.getAttribute("data-base-url"),aA));});},onEntityClick:function(aJ){var aD=aJ.target,aI=aD.ancestor(ao,J),aB=aI.getAttribute("data-interestid"),aG=aI.hasClass(p)?h.LIKE:aI.hasClass(az)?h.DISLIKE:h.NEUTRAL,aC=aI.hasClass("inferred")?"inferred":"declared",Y,aE=aI.hasClass("source"),aA={},aF={},aH={};if(this.currentDrawer.hasClass(X)&&!aI.hasClass(p)){aI.addClass(p);aI.removeClass(at).removeClass(az);Y=h.LIKE;}else{if(this.currentDrawer.hasClass(A)&&!aI.hasClass(az)){aI.addClass(az);aI.removeClass(at).removeClass(p);Y=h.DISLIKE;}else{aI.addClass(at);aI.removeClass(p).removeClass(az);Y=h.NEUTRAL;}}aH={"new":Y.toString(),current:aG.toString(),type:"entity",id:aB};if(aE){aH.source=1;}this.fire(l,{interestObj:aH,item:this.currentItem,markFeedback:v});aA={"new":Y,current:aG,type:aC};if(aE){aA.name=aI.get("text");}aF[aB]=aA;this.makeInterestRequest({_subAction:"int_manage",interest:aF});V.update(aB,{state:Y});},toggleDrawer:function(aI,aD,aB){var aF=w.isLoggedIn(),aE="",aJ,aG=J,Y,aH=aI.get("nextSibling"),aK=this,aC=this.currentItem&&this.currentItem.hasClass(ae)&&aI!==this.currentItem,aA={sec:"td-strm-ctrl",itc:1,action:aj};if(aH&&aH.hasClass("flag-thankyou-msg-drawer")){aH.remove();}if(aC){this.closeDrawer(this.currentDrawer,true);}this.currentItem=aI;Y=this.currentItem.getAttribute(c);if(!aD&&this.currentItem&&!this.currentItem.hasClass(ae)){if(o){if(this.viewingSavedStories){aE=af.getString("STR.SAVE.BTN.TEMPLATE");}else{if(aI.hasClass(ag)){aE=af.getString("STR.HIGHLINE.BTN.TEMPLATE");}else{aE=af.getString("STR.SHARE.BTN.TEMPLATE");}}}aJ='<li class="action-drawer y-pattern">'+aE+"</li>";this.currentItem.insert(aJ,"after");this.currentDrawer=this.currentItem.get("nextSibling");if(o){this.currentDrawer.one(D).removeClass("v-h").removeClass("closed");this.actionBtnListner=this.currentDrawer.delegate(aj,this.onActionDrawerClick,m,this);}if(this.flagContentEnabled){this.flagItemListner=this.currentDrawer.delegate("change",this.onFlagItemClick,R+" "+P,this);}this.entityListner=this.currentDrawer.delegate(aj,this.onEntityClick,ao,this);this.doneBtnListner=this.currentDrawer.delegate(aj,this.onDoneClick,t,this);if(!this.viewingSavedStories&&(o||aF)){if(aB){this.currentDrawer.addClass(aB);}else{if(this.currentItem.hasClass(ai)){this.currentDrawer.addClass(ai);}if(this.currentItem.hasClass(X)){this.currentDrawer.addClass(X);if(o){aG=this.buildEntityList(J);}}if(this.currentItem.hasClass(A)){this.currentDrawer.addClass(A);if(o){aG=this.buildEntityList(J);}this.updateConfirmationMsg(af.getString("STR.ENTITY.LIST.DISLIKED.MSG"));}if(this.currentItem.hasClass(am)){this.currentDrawer.addClass(am);if(o){aG=this.buildEntityList(J);}this.updateConfirmationMsg(af.getString("STR.ENTITY.LIST.DISLIKED.MSG"));}if(this.currentItem.hasClass(s)){this.currentDrawer.addClass(s);if(o){this.buildFlagEntityList();}}}if(this.currentItem.hasClass(ag)){this.currentDrawer.addClass(ag);this.populateHighlineMenu();}}else{if(!o&&!aF){aG=v;}}if(aG&&o){this.currentDrawer.transition({height:al+"px",duration:0.3,easing:"ease-in",on:{start:function(){aK.currentDrawer.addClass(F);},end:function(){aK.currentDrawer.removeClass(F);}}});Q.config.win.scrollTo(0,aK.currentItem.getY()-ax);}this.currentItem.addClass(ae);if(!o){this.currentDrawer.addClass("dn");}aA.rspns="xpnd";}else{if(!aD&&this.currentItem&&this.currentItem.hasClass(ae)){this.closeDrawer(this.currentDrawer);this.currentDrawer=W;aA.rspns="clps";if(o){this.actionBtnListner.detach();}this.entityListner.detach();this.doneBtnListner.detach();if(this.flagContentEnabled){this.flagItemListner.detach();}}}if(o){aA.slk="btn-dr";ar.fireBeacon(aA);}},closeDrawer:function(aA,Y){var aC=w.isLoggedIn(),aG=this.currentItem,aH=this.currentDrawer,aD=aA.one(t),aF=this,aB,aE={};if(aD){aD.addClass("dn");}if(aG.hasClass(s)&&aH.one(".flag-entity-msg")){Q.later(300,this,function(){this.fire(d,{item:aG,drawer:aH,animate:J});});}if(aG.hasClass(A)||aG.hasClass(am)){aB=aG.hasClass(am)?am:A;if(aG.hasClass(s)&&aH.one(".flag-entity-msg")){Q.later(300,this,function(){this.fire(z,{item:aG,animate:J,immediate:J,action:aB});});}else{Q.later(300,this,function(){this.fire(z,{item:aG,animate:J,immediate:v,action:aB});});}}if(!aC&&this.currentItem){aG.removeClass(ai).removeClass(X).removeClass(A).removeClass(s).removeClass(am);}aE.start=function(){aF.fire(f,{item:aG});if(!aA.one(r)&&!aA.one(ak)){aA.addClass(F);}};aE.end=function(){aF.fire(aq,{item:aG});aA.remove();aG.removeClass(ae);if(!o){aG.removeClass("y-pattern").removeClass("hover");}aF.repaint();};if(Y){aE.start();aA.setStyle("height","0px");aE.end();}else{aA.transition({height:"0px",duration:0.3,easing:"default",on:aE});}},fireItemInterestChange:function(aB,aA,Y){this.fire(l,{interestObj:{"new":aB,current:aA,type:"content",action:Y},item:this.currentItem,markFeedback:v});},onActionDrawerClick:function(Y){var aC=Y.target,aA=aC.ancestor(u),aB=aC.ancestor(a,J),aE=w.isLoggedIn(),aD;Y.preventDefault();if(aB.test(G)){aA.toggleClass(ai);this.currentItem.toggleClass(ai);if(aE){this.handleSaveClick(aB);}else{aA.removeClass(X).removeClass(A);this.currentItem.removeClass(X).removeClass(A);}}else{if(aB.test(j)){this.handleSaveClick(aB);}else{if(aB.test(I)){aA.toggleClass(X);this.currentItem.toggleClass(X);if(aE){this.handleLikeClick(aB);}else{aD=aA.hasClass(X);this.fireItemInterestChange(aD?"0":"1",aD?"1":"0",X);aA.removeClass(ai).removeClass(A);this.currentItem.removeClass(ai).removeClass(A);}aA.removeClass(A);this.currentItem.removeClass(A);}else{aA.toggleClass(A);this.currentItem.toggleClass(A);if(aE){this.handleDislikeClick(aB);}else{aD=aA.hasClass(A);this.fireItemInterestChange(aD?"0":"-1",aD?"-1":"0",A);aA.removeClass(ai).removeClass(X);this.currentItem.removeClass(ai).removeClass(X);}aA.removeClass(X);this.currentItem.removeClass(X);}}}if(!aE){if(this.currentDrawer.test(Z)&&(!ac.nonPersonalStream||!aB.test(L))){this.showLoginBtns();}else{this.closeDrawer(this.currentDrawer);}}},buildFlagEntityList:function(){var aL=this.currentDrawer,aB=this.currentItem.getAttribute(c),aM=this.currentDrawer.one(".flag-content-form"),aI=this.currentDrawer.one(S),aE=this.currentDrawer.one(r),aF=this.currentDrawer.one(t),aA=this.currentDrawer.one(ab),aJ=this.currentDrawer.one(".no-entities"),aH=N.getItem(E)||{},aC=[],aG,Y=0,aD=0,aK=this;if(aE&&aF&&aI){aE.remove();aF.remove();aI.remove();}if(this.timerInProcess){this.timerInProcess.cancel();this.timerInProcess=null;if(this.currentDrawer){if(this.currentDrawer.hasClass(X)){this.currentDrawer.removeClass(X);this.currentItem.addClass(X);}}if(aJ){aJ.remove();}}if(aA){aA.remove();}if(!o){this.currentItem.addClass("y-pattern").addClass("hover");aL.removeClass("dn");}aL.addClass(s);aG=af.getString("STR.ACTIONDRAWER.FLAGMENU");if(aG){aM=aL.append(aG);Y=120;}aC=aH[aB];if(aC&&aC.length>0){for(aD=0;aD<aC.length;aD++){aL.one('[value="'+aC[aD]+'"]').set("checked",true);}}this.currentDrawer.transition({height:Y+"px",duration:0.3,easing:"ease-in",on:{end:function(){aK.repaint();}}});},onFlagItemClick:function(aD){var aF=aD.target,aC=aF.ancestor(R,J,ab),aE=aD.target.getAttribute("value"),aG=this.currentItem.getAttribute(c),aB=N.getItem(E)||{},aA=[],Y=Q.merge(ar.getBeaconKeys(this.currentItem),{sec:"td-strm-dr",slk:aC.get("text"),elm:"inpt",elmt:"flag",itc:1,intl:ac.intl,action:aj});aA=aB[aG]||[];if(aF.get(i)){Y.outcm="flagcat";if(aA.indexOf(aE)<0){aA.push(aE);}}else{Y.outcm="unflagcat";if(aA.indexOf(aE)>-1){aA.splice(aA.indexOf(aE),1);}}aB[aG]=aA;N.setItem(E,aB,au);ar.fireBeacon(Y);},repaint:function(){var Y=this.currentItem?this.currentItem.get("parentNode"):W;if(Q.UA.ie&&Q.UA.ie<8&&Y){Y._node.className=Y._node.className;}},makeSaveRequest:function(aA,Y){if(!ay&&ac.listId){ay="LISTID:"+ac.listId;}af.makeRequest({type:"module",moduleId:T,args:{_action:"save",_subAction:aA,noups:1,uuid:Y,mixerAction:ah,curFilter:ay}},{});},makeInterestRequest:function(Y){b.makeRequest({type:"module",moduleId:M,args:Q.merge({_action:"show"},Y)},{});}};Q.augment(y,Q.EventTarget);Q.namespace(U);Q[U][H]={name:"stream_action_drawer",getService:function(aB,aA){var Y;b=aB.getService("transport_helper",aA);af=aB.getModuleApi(aA);ar=aB.getService("instrumentation");N=aB.getService("storage");w=aB.getService("userinfo");C=aB.getService("login",aA);V=af.getService("interests");ac=af.getContextData();if((!Q.UA.android||Q.UA.android>=3)){Y=Q.one(".banner-wrapper")||Q.one(".type_masthead")||Q.one(".type_mastheadlite")||Q.one(".yog-hd");if(Y){ax=Y.get("offsetHeight");}}return new y();}};if(e){e.registerService(Q[U][H]);}},"1.0");/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
YUI.add("type_video_manager",function(d,D){var a=null,u={},x=[],r={},Q="not-ready",C="MPServices",N="StreamInlineVideoPlayer",b="stream:filter",O="stream:refresh",F="stream:restoreRemovedArticle",c=d.ModulePlatform,l,I,h=[],M=true,t=true,y="bottomright",G=true,q=true,w=null,j="frontpage",e=null,v=null,P=false,m=false,z=false,J=false,S=false,o=true,s=false,f=false,B=false,n=3,E={},p=0.1,H=0,g="",i="",K=false,k=false,L=0,A=20+12,R=12;d.VideoManager={initPlayerJs:function(V){var T=this,U;if(Q==="not-ready"){Q="fetching";if(a&&!(d.config&&d.config.groups&&d.config.groups.videoplayer)){U={modules:{videoplayer:{group:"videoplayer",name:"videoplayer",type:"js",fullpath:a}},groups:{videoplayer:{name:"videoplayer",combine:false,filter:"min"}}};d.applyConfig(U);}d.on("domready",function(){d.use("videoplayer",function(){Q="ready";if(typeof V==="function"){V.call(T);}});});}},createPlayerInstance:function(Z,ah){var ac=this,ai=".js-video-target",ak,aa,af,ad,ae,ab,V,aj,X,U,T,ag,W,Y;af=Z.node.getData("conf-overrides");if(af){ah=d.merge(ah,JSON.parse(af));}if(Q!=="ready"){if(!ac.queue){ac.queue=[];}ac.queue.push(Z);ac.initPlayerJs(ac.playerInitCallback);}else{if(Z&&Z.node&&(Z.uuid||Z.vidUrl)){ab=d.one(Z.node);ae=ab.generateID();if(ae in r){return;}V=ab.one(ai);T="";Y=ab.getData("ylk");if(Y){U=Y.split(";");d.Array.each(U,function(al){var am=al.split(":");if(am[0]&&am[1]&&am[0]==="cpos"){T=am[1];}});}if(V){aa=ac.createPlayerContainer(V);ad=aa.one(".ratiobox").generateID();X=l.getProperty("lang")||"en-US";X=X.replace(/([^\-]+\-)+/,"");if(Z.vidUrl){W={streams:[{url:Z.vidUrl}]};if(V&&V.getStyle("background-image")){W.images={thumbnail:V.getStyle("background-image").replace(/url\(([^\)]+)\)/,"$1").replace(/^"([^"]+)"/,"$1")};}}else{W={id:Z.uuid};}ak={autoplay:false,comscoreC4:"US fp",continuousPlay:false,conviva:f,cpos:T,endscreen:true,expBucket:v,expName:"classic",expType:"strm-inline",html5:false,lang:l.getProperty("lang")||"en-US",loop:false,mute:o,pageSpaceId:e,pausescreen:false,playlist:{mediaItems:[W]},preload:true,qosSamplingRate:p,region:X||"US",settingscreen:false,stopBufferingOnPause:G,replayonlyendscreen:q,site:j,startscreen:{showButton:J,showDesc:false,showProvider:false,showTitle:false},CMS:{env:"prod",suppressAdContext:true},videoapps:false,ywaSamplingRate:H};if(i){ak.sec=i;}if(g){ak.ccode=g;}if(k){ak.html5=true;}V.replace(aa);if(Z.boss){ag=ac._getMediaStore(Z.boss);}if(ah){ak=d.merge(ak,ah);}if(ag){aj=new YAHOO.VideoPlatform.VideoPlayer(ak,ag);}else{aj=new YAHOO.VideoPlatform.VideoPlayer(ak);}ac.attachVideoListeners(aj,ab,ae);aj.render("#"+ad);u[ae]={player:aj,playerNode:aa,swapNode:V,is_playing:ak.autoplay,has_interacted:false,enable_pip_opt:false,is_complete:false,inExpandMode:false};x.push(ae);if(P){ac._setupControls(ae);}f=true;}}}return ae;},_getMediaStore:function(T){if(u[T]){return u[T].player.getMediaStore();}return false;},_setupControls:function(X){var U=this,Y=u[X],W=z?d.Node.create('<div class="outer-wrap"> <div class="inner-wrap"> <div class="pl-controls-wrap two-controls"> <span class="js-btn-sound '+(Y.player.controls.getMute()?"":"js-state-muted")+'"> <i class="on"></i> </span> <span class="js-btn-expand"> <i class="on"></i></i> </span> </div> </div> </div>'):d.Node.create('<div class="outer-wrap"> <div class="inner-wrap"> <div class="pl-controls-wrap"> <span class="js-btn-expand"> <i class="on"></i></i> </span> </div> </div> </div>'),Z=W.one(".pl-controls-wrap"),V=Y.playerNode.one(".yvp-custom-controls"),T;if(V){V.append(W);if(M){V.one(".js-btn-sound").addClass("js-state-muted");}Z.delegate("click",function(ad){var ac=ad.currentTarget,ab,aa=ad.target.ancestor(".js-inline-video");if(aa){if(ac.hasClass("js-btn-sound")){ac.toggleClass("js-state-muted");if(ac.hasClass("js-state-muted")){Y.player.controls.setMute(true);T={slk:"mute-on",itc:1};}else{Y.player.controls.setMute(false);Y.enable_pip_opt=true;if(t&&!Y.has_interacted){U.allPlayersResetPositions(X);}U.volumeHandler(X);T={slk:"mute-off",itc:1};}Y.has_interacted=true;if(w){T=d.merge(w.getBeaconKeys(aa),T);w.fireBeacon(T);}}if(ac.hasClass("js-btn-expand")){if(t&&!Y.has_interacted){U.allPlayersResetPositions(X);}Y.enable_pip_opt=true;ab=parseInt(aa.get("offsetWidth"),10);if(aa.hasClass("js-player-expand")){aa.removeClass("js-player-expand");aa.one(".js-player-container").setStyle("marginTop","0");aa.one(".js-player-container").setStyle("width","100%");T={slk:"expand-half-off",itc:1};}else{aa.addClass("js-player-expand");aa.one(".js-player-container").setStyle("marginTop",aa.one(".body").get("offsetHeight")+"px");aa.one(".js-player-container").setStyle("width",(((ab-(A))/ab)*100)+"%");T={slk:"expand-half-on",itc:1};}if(w){T=d.merge(w.getBeaconKeys(aa),T);w.fireBeacon(T);}}}},"span");}},isDestroyable:function(T){var U=u[T]&&!u[T].has_interacted&&u[T].playerNode;return U&&!U.inViewportRegion();},auditPlayerInstances:function(){var V=x.length,W=[],U,T=this;if(V>R){d.Array.each(x,function(X){if(T.isDestroyable(X)){W.push(X);}});U=W.shift();this.destroyPlayerInstance(U);}},createPlayerContainer:function(T){return d.Node.create('<div class="js-player-container ratio-16-9 z-1"><div class="ratiobox"></div></div>');},destroyPlayerInstance:function(T,W){var V=d.Array.indexOf(x,T),X;if(T&&T in u&&u[T]){X=u[T];if(!X.playerNode.inViewportRegion()||W){if(X.playerNode&&X.swapNode){X.playerNode.replace(X.swapNode);}if(X.player){try{X.player.destroy();}catch(U){}}if(X.playerNode){X.playerNode.destroy();}X=null;delete u[T];x.splice(V,1);}}if(this.unmutedVP&&this.unmutedVP===T){this.unmutedVP=null;}if(this.playingVP&&this.playingVP===T){this.playingVP=null;}},handleViewEnter:function(aa){var af=this,Y=aa.currentTarget,T=Y.hasClass("rmx-ad")?Y.getData("vidid"):Y.getData("uuid"),V=Y.getData("vidurl"),ab=Y.generateID(),ad=u&&ab in u&&u[ab],ae=ad&&ad.player,W,U,Z,ac,X={node:Y};if(V){X.vidUrl=V;}else{X.uuid=T;}af.playerResetPosition(ad);if(ad.is_playing&&ad.has_interacted&&t){W={slk:"pip-cl-scrl",itc:1};if(w){U=ad.playerNode.ancestor(".js-inline-video");W=d.merge(w.getBeaconKeys(U),W);w.fireBeacon(W);}}if(M&&ae&&!ad.is_playing&&!ad.has_interacted){ad.is_playing=true;ae.controls.play();if(K){Z=d.config.win.location.href.match(/vpErrorType=([^&]+)/);ac=d.config.win.location.href.match(/vpErrorCode=([^&]+)/);if(Z&&Z.length===2&&ac&&ac.length===2){ae._controller.error({type:Z,code:ac});}}}else{af.createPlayerInstance(X,{autoplay:M});}},handleViewLeave:function(X){var T=this,W=X.currentTarget,U=W.generateID(),Y=u&&U in u&&u[U],V=Y&&Y.player;if(Y.is_playing&&Y.enable_pip_opt&&t){T.keepVideoAtPip(Y);}if(V&&Y.is_playing&&!Y.has_interacted&&!Y.inExpandMode){Y.is_playing=false;V.controls.pause();}T.auditPlayerInstances();},handleMouseup:function(T){d.Array.each(x,function(U){var V=u[U];if(V.playerNode.inViewportRegion()&&!V.has_interacted){V.is_playing=true;V.player.controls.play();}});},init:function(){var T=this;T.queue=[];T.findVideosInit();d.Global.on("pane-manager:sync-nav-pane-scroll",T.findStreamVideos,T);if(d.UA.ie){d.config.doc.onfocusout=d.bind(T.handleBlur,T);d.config.doc.onfocusin=d.bind(T.handleFocus,T);}else{d.on("blur",d.bind(T.handleBlur,T),d.config.win);d.on("focus",d.bind(T.handleFocus,T),d.config.win);if(S){d.on("touchend",d.bind(T.handleMouseup,T),d.config.doc);}}},normalizePayload:function(W){var T=W&&W.guid&&d.one("#applet_"+W.guid)||d.one("#applet_p_50000173"),U=W&&W.list,V={container:T,items:U};return V;},getVideoNodes:function(){var T=new d.NodeList();d.Array.each(h,function(U){var V=U.all(".js-inline-video");if(V){V.each(function(W){T.push(W);});}});return T;},loopVideos:function(X,Z,U){var V=this,T,aa,W,Y;Z=Z||{};T=function(ae,ab){var ag={node:ae},af=function(){var ah;if(ab===0){ah=X.getData("uuid");W=V.createPlayerInstance(ag,{autoplay:false,prefetchIds:ah});}else{ag.boss=W;V.createPlayerInstance(ag,{preconnect:false});}},ac=ae.getData("vidurl"),ad=ae.hasClass("rmx-ad")?ae.getData("vidid"):ae.getData("uuid");if(ac){ag.vidUrl=ac;}else{ag.uuid=ad;}setTimeout(af,0);};aa=function(ad){var ab=ad.getData("vidurl"),ac=ad.hasClass("rmx-ad")?ad.getData("vidid"):ad.getData("uuid"),ae={node:ad};if(ab){ae.vidUrl=ab;}else{ae.uuid=ac;}V.queue.push(ae);};Y=Z.init?aa:T;if(X){X.each(Y);if(U){U();}V.attachViewportListeners(X);}},findStreamVideos:function(){var T=this,U;L++;if(L<=1){return;}U=T.getVideoNodes();if(U){T.loopVideos(U);}},findVideosInit:function(){var U=this,V=U.getVideoNodes(),T=false;if(V){U.loopVideos(V,{init:true},function(){if(U.queue.length>0){d.Array.each(U.queue,function(W){if(W.node.inViewportRegion()){T=true;}});if(B){U.initPlayerJs(U.playerInitCallback);}else{if(T){U.initPlayerJs(U.playerInitCallback);}else{d.one(d.config.win).once("scroll",function(){U.initPlayerJs(U.playerInitCallback);});}}}});}},attachViewportListeners:function(U){var T=this;U.detach("viewenter",T.handleViewEnter,T);U.detach("viewleave",T.handleViewLeave,T);U.on("viewenter",T.handleViewEnter,T);U.on("viewleave",T.handleViewLeave,T);},attachVideoListeners:function(T,aa,Y){var ab=this,X=ab.getVpAPI(),W,V,U,Z;if(X){T.on(X.UI_INTERACT,function(ad){var ac;if(T.controls.setLoop){T.controls.setLoop(false);}if(ad&&ad.srcElement&&(ad.srcElement==="ctrl-mute-btn-off"||ad.srcElement.match(/ctrl-volume/))){ac=u[Y].playerNode.one(".yvp-custom-controls .js-btn-sound");if(ac){ac.toggleClass("js-state-muted");}if(!u[Y].has_interacted&&u[Y].is_playing){u[Y].enable_pip_opt=true;}if(t){ab.allPlayersResetPositions(Y);}ab.volumeHandler(Y);}if(ad&&ad.srcElement&&ad.srcElement==="ctrl-mute-btn-on"){ac=u[Y].playerNode.one(".yvp-custom-controls .js-btn-sound");if(ac){ac.toggleClass("js-state-muted");}}if(u&&u[Y]){u[Y].has_interacted=true;}});W=function(ac){r[Y]=true;ab.destroyPlayerInstance(Y,true);};if(s){T.on(X.PLAYBACK_RESUMED,function(){ab.playbackHandler(Y);});}T.on(X.PLAYBACK_ERROR,W);T.on(X.PLAYER_ERROR,W);V=T.on(X.PLAYBACK_TIMEOUT,W);T.on(X.PLAYBACK_START,function(){if(V){V();}u[Y].is_playing=true;if(s){ab.playbackHandler(Y);}if(u[Y].has_interacted){u[Y].enable_pip_opt=true;}});T.on(X.PLAYBACK_RESUMED,function(){if(!u[Y].enable_pip_opt){u[Y].is_playing=true;if(u[Y].is_complete){u[Y].enable_pip_opt=true;u[Y].is_complete=false;ab.allPlayersResetPositions(Y);}}if(s){ab.playbackHandler(Y);}});T.on(X.PLAYBACK_COMPLETE,function(){if(u[Y].is_playing&&u[Y].enable_pip_opt&&t){u[Y].is_playing=false;u[Y].enable_pip_opt=false;u[Y].is_complete=true;ab.playerResetPosition(u[Y]);}});if(S||J){aa.getDOMNode().addEventListener("gestureend",function(ac){if(ac.scale>=1){T.controls.setFullscreen(true);}});}if(aa&&aa.hasClass("rmx-ad")){Z=aa.getData("uuid");T.on(X.PLAYBACK_START,function(){if(!u[Y].startBeacon){U=E[Z].start;if(U){w.getBeaconImage(U);}u[Y].startBeacon=true;}});T.on(X.PLAYBACK_TIME_UPDATE,function(ad,ac,ae){if(u[Y]&&E[Z]){if(!u[Y].viewBeacon&&ac>n){U=E[Z].view;if(U){w.getBeaconImage(U);}u[Y].viewBeacon=true;}if(!u[Y]["30secBeacon"]&&ac>30){U=E[Z]["30sec"];if(U){w.getBeaconImage(U);}u[Y]["30secBeacon"]=true;}if(!u[Y]["25pctBeacon"]&&ac>(ae*0.25)){U=E[Z]["25pct"];if(U){w.getBeaconImage(U);}u[Y]["25pctBeacon"]=true;}if(!u[Y]["50pctBeacon"]&&ac>(ae*0.5)){U=E[Z]["50pct"];if(U){w.getBeaconImage(U);}u[Y]["50pctBeacon"]=true;}if(!u[Y]["75pctBeacon"]&&ac>(ae*0.75)){U=E[Z]["75pct"];if(U){w.getBeaconImage(U);}u[Y]["75pctBeacon"]=true;}}});T.on(X.PLAYBACK_COMPLETE,function(){if(u[Y]&&E[Z]){U=E[Z].done;if(U){w.getBeaconImage(U);}delete u[Y].viewBeacon;delete u[Y].startBeacon;delete u[Y]["30secBeacon"];delete u[Y]["25pctBeacon"];delete u[Y]["50pctBeacon"];delete u[Y]["75pctBeacon"];}});}}},playerInitCallback:function(){var V=this,U=V.queue,T=U&&U.length||0,W,X;for(W=0;W<T;W++){X=U[W];if(X.node.inViewportRegion()){V.createPlayerInstance(X,{autoplay:M});}else{V.createPlayerInstance(X,{preconnect:false});}}V.queue=null;},handleBlur:function(){var T=this;d.Array.each(x,function(U){var W=u&&U in u&&u[U],V=W&&W.player;if(V&&!W.has_interacted){W.is_playing=false;V.controls.pause();T.playerResetPositionWithStop(V);}});},allPlayersResetPositions:function(W){var V=this,T,U;d.Array.each(x,function(Y){if(W!=Y){var X=u[Y];if(X&&X.enable_pip_opt){V.playerResetPositionWithStop(X);if(W!==null){U=X.playerNode.ancestor(".js-inline-video");T={slk:"pip-cl-inter",itc:1};if(w){T=d.merge(w.getBeaconKeys(U),T);w.fireBeacon(T);}}}}});},playerResetPositionWithStop:function(T){if(M){if(T.playerNode&&T.player){T.playerNode.one(".js-btn-sound").toggleClass("js-state-muted");T.player.controls.setMute(true);}T.inExpandMode=false;T.has_interacted=false;T.enable_pip_opt=false;T.is_playing=true;}else{if(T.player){T.player.controls.pause(true);}}this.playerResetPosition(T);},playerResetPosition:function(X){var U=X.playerNode,T,V,W;if(U){T=U.get("parentNode").get("parentNode");U.removeClass("pip-video");U.removeClass("pip-video-style");U.setStyle("top","");U.setStyle("left","");if(U.one(".video_player_close_btn")){W=U.one(".video_player_close_btn");W.remove(true);}if(X.inExpandMode){if(!T.hasClass("js-player-expand")){V=parseInt(T.get("offsetWidth"),10);T.addClass("js-player-expand");T.one(".js-player-container").setStyle("marginTop",T.one(".body").get("offsetHeight")+"px");T.one(".js-player-container").setStyle("width",(((V-(A))/V)*100)+"%");X.inExpandMode=false;}}d.on("windowresize",null);}},keepVideoAtPip:function(aa){var V=this,Y=aa.playerNode,U=Y.get("parentNode").get("parentNode"),T,X,W,Z;if(aa.playerNode){if(parseInt(Y.getStyle("width"),10)>90){if(U.hasClass("js-player-expand")){U.removeClass("js-player-expand");U.one(".js-player-container").setStyle("marginTop","0");aa.inExpandMode=true;}}U.one(".js-player-container").setStyle("width","");W=V.runPipAnimation(Y);if(W){X=Y.ancestor(".js-inline-video");T={slk:"pip-dsply",itc:1};if(w){T=d.merge(w.getBeaconKeys(X),T);w.fireBeacon(T);}Y.append('<div class="img-sprite video_player_close_btn voh"></div>');Y.one(".video_player_close_btn").on("click",function(ae){var ac,ab,ad;ac=ae.target.ancestor(".js-inline-video");Z=ae.target.ancestor(".js-player-container");d.Array.each(x,function(af){ad=u[af];if(ad&&ad.enable_pip_opt){if(Z.compareTo(ad.playerNode)){aa.inExpandMode=false;V.playerResetPositionWithStop(ad);}}});ab={slk:"pip-cl",itc:1};if(w){ab=d.merge(w.getBeaconKeys(ac),ab);w.fireBeacon(ab);}});d.on("windowresize",function(){d.Array.each(x,function(ac){var ab=u[ac];if(ab&&ab.enable_pip_opt){V.keepVideoAtPip(ab);}});});}else{V.playerResetPosition(aa);d.on("windowresize",function(){});}}},runPipAnimation:function(V){if(V){var U,T,W,Y,X;V.addClass("pip-video-style");U=this.figerOutTheCorner(V);if(!U){return false;}T=U.topEnd+"px";W=U.leftEnd+"px";Y=U.top+"px";X=U.left+"px";V.addClass("pip-video");V.setStyle("left",X);V.setStyle("top",Y);V.transition({duration:0.5,easing:"ease-in-out",left:W,top:T},function(){V.setStyle("left",W);V.setStyle("top",T);});return true;}},figerOutTheCorner:function(W){var X=W.getDOMNode().getBoundingClientRect(),aa,U=0,Y=20,Z=120,T=W.get("parentNode"),V={leftEnd:0,topEnd:160};if(d.UA.ios||(d.UA.android&&d.UA.chrome)){V.bottom=V.height=d.config.win.innerHeight;V.right=V.width=d.config.win.innerWidth;}else{V.bottom=V.height=d.config.doc.documentElement.clientHeight;V.right=V.width=d.config.doc.documentElement.clientWidth;}V.top=parseInt(X.top,10);V.left=parseInt(X.left,10);aa=T.getDOMNode().getBoundingClientRect();switch(y){case"topleft0":V.topEnd=Z;V.leftEnd=Y;break;case"topright0":V.topEnd=Z;V.leftEnd=V.width-X.width-Y;U=1;break;case"bottomleft0":V.topEnd=V.height-X.height-Y;V.topEnd=V.topEnd>0?V.topEnd:Y;V.leftEnd=Y;break;case"bottomright0":V.topEnd=V.height-X.height-Y;V.topEnd=V.topEnd>0?V.topEnd:Y;V.leftEnd=V.width-X.width-Y;U=1;break;case"topleft":V.topEnd=Z;V.leftEnd=aa.left;U=-1;break;case"topright":V.topEnd=Z;V.leftEnd=aa.right+Y*2;U=1;break;case"bottomleft":V.topEnd=V.height-X.height-Y;V.topEnd=V.topEnd>0?V.topEnd:Y;V.leftEnd=aa.left;U=-1;break;default:V.topEnd=V.height-X.height-Y;V.topEnd=V.topEnd>0?V.topEnd:Y;V.leftEnd=aa.right+Y*2;U=1;}if(U===1&&V.leftEnd<aa.right){return null;}if(U===0&&V.leftEnd+X.width>aa.left){return null;}return V;},figerOutMiddelPage:function(){var T=0;if(d.UA.ios||(d.UA.android&&d.UA.chrome)){T=d.config.win.innerWidth;}else{T=d.config.doc.documentElement.clientWidth;}return T/2;},volumeHandler:function(U){var T=this,V,X,W;if(T.unmutedVP&&U!==T.unmutedVP){if(u&&u[T.unmutedVP]){X=u[T.unmutedVP];V=X.player;W=X.playerNode;V.controls.setMute(true);if(!W.inViewportRegion()){V.controls.pause(true);X.is_playing=false;T.playerResetPositionWithStop(V);}X.has_interacted=false;}}T.unmutedVP=U;},playbackHandler:function(U){var T=this,V,W;if(T.playingVP&&U!==T.playingVP){if(u&&u[T.playingVP]){W=u[T.playingVP];V=W.player;V.controls.pause(true);W.is_playing=false;T.playerResetPositionWithStop(V);}}T.playingVP=U;},handleFocus:function(){d.Array.each(x,function(T){var W=u&&T in u&&u[T],U=W&&W.player,V=u[T]&&u[T].playerNode;if(M&&U&&!W.has_interacted&&V&&V.inViewportRegion()){W.is_playing=true;U.controls.play();}});},onmessage:function(Z,V,X){var T=this,Y,W,U;switch(Z){case b:case O:d.Array.each(x,function(aa){T.destroyPlayerInstance(aa,true);});break;case F:if(X&&X.item){d.Array.each(x,function(aa){if(u[aa].playerNode.ancestor(".js-inline-video")===X.item){T.destroyPlayerInstance(aa,true);Y={node:X.item};W=X.item.hasClass("rmx-ad")?X.item.getData("vidid"):X.item.getData("uuid");U=X.item.getData("vidurl");if(U){Y.vidUrl=U;}else{Y.uuid=W;}T.createPlayerInstance(Y,{autoplay:M});}});}break;}},getVpAPI:function(){var T=this;if(!T.vpAPI){T.vpAPI=d&&d.VideoPlatform&&d.VideoPlatform.API_Events;}return T.vpAPI;}};d.namespace(C);d[C][N]={name:"inline_video_manager",getService:function(U,T){l=U;I=U.getModuleApi(T);a=I.getContextData("videoPlayerJs");R=I.getContextData("videoPlayerMaxInstances");M=I.getContextData("videoPlayerAutoPlay");t=I.getContextData("videoPlayerPipEnable");y=I.getContextData("videoPlayerPipPosition");if(I.getContextData("videoPlayerErrorSimulator")){K=I.getContextData("videoPlayerErrorSimulator");}if(I.getContextData("videoPlayerYwaRate")){H=parseFloat(I.getContextData("videoPlayerYwaRate"));}if(I.getContextData("videoPlayerQosRate")){p=parseFloat(I.getContextData("videoPlayerQosRate"));}if(!d.Lang.isNull(I.getContextData("videoPlayerStopBuffering"))){G=I.getContextData("videoPlayerStopBuffering");}if(!d.Lang.isNull(I.getContextData("videoPlayerStopRelated"))){q=I.getContextData("videoPlayerStopRelated");}if(!d.Lang.isNull(I.getContextData("videoPlayerSite"))){j=I.getContextData("videoPlayerSite");}v=l.getProperty("ywa.rapid.bucket.id")||I.getContextData("bucketid");if(typeof YMedia!=="undefined"&&typeof YMedia.rapid!=="undefined"&&typeof YMedia.rapid.rapidConfig!=="undefined"){e=""+YMedia.rapid.rapidConfig.spaceid;}else{e=""+l.getProperty("ywa.rapid.space.id");}g=I.getContextData("ccode");i=I.getContextData("videoPlayerSec");if(I.getService("instrumentation")){w=I.getService("instrumentation");}if(I.getContextData("videoPlayerSafariHtml5")){k=I.getContextData("videoPlayerSafariHtml5");if(k&&d.UA.safari){k=true;}else{k=false;}}if(!d.Lang.isNull(I.getContextData("videoPlayerTwoControls"))){z=I.getContextData("videoPlayerTwoControls");}if(!d.Lang.isNull(I.getContextData("videoPlayerExpandControl"))){m=I.getContextData("videoPlayerExpandControl");}P=m||z;if(!d.Lang.isNull(I.getContextData("videoPlayerShowButton"))){J=I.getContextData("videoPlayerShowButton");}if(!d.Lang.isNull(I.getContextData("videoPlayerTouchPlay"))){S=I.getContextData("videoPlayerTouchPlay");}if(!d.Lang.isNull(I.getContextData("videoPlayerMute"))){o=I.getContextData("videoPlayerMute");}if(!d.Lang.isNull(I.getContextData("videoPlayerSingleAudio"))){s=I.getContextData("videoPlayerSingleAudio");}if(I.getContextData("videoPlayerAdsDelay")!==null){n=I.getContextData("videoPlayerAdsDelay");}if(I.getContextData("videoAdBeacons")!==null){E=I.getContextData("videoAdBeacons");}if(d.one("#default-"+T)){h.push(d.one("#default-"+T));}if(d.one("#default-p_30346011 .video-promo")){h.push(d.one("#default-p_30346011"));B=true;}if(a){a+="?lang="+l.getProperty("lang");d.VideoManager.init();}return d.VideoManager;}};if(c){c.registerService(d[C][N]);}},"0.0.1",{requires:["event-viewenter","node-core"]});YUI.add("event-viewenter",function(d,c){var a="inviewport",b={isElementOnscreen:function(h,e){var f={left:0,top:160},g=h.getDOMNode().getBoundingClientRect(),i=20,j=parseFloat(h.getData("video-offset"),10)||0.25,k=Math.floor(169*j);if(d.UA.ios||(d.UA.android&&d.UA.chrome)){f.bottom=f.height=d.config.win.innerHeight;f.right=f.width=d.config.win.innerWidth;}else{f.bottom=f.height=d.config.doc.documentElement.clientHeight;f.right=f.width=d.config.doc.documentElement.clientWidth;}f.top+=k;if(f.bottom>k){f.bottom-=k+40;}return !(g.top>f.bottom+i||g.bottom<f.top-i||g.right<f.left-i||g.left>f.right+i);},checkNode:function(i,h,e){var j,g,f=h.handle.evt.type;i=d.one(i);j=this.isElementOnscreen(i,e);g=i.getData(a);if((f==="viewenter"&&j&&!g)||(f==="viewleave"&&!j&&g)){h.fire({target:i});i.setData(a,j);}},notify:function(j,i,h,g){var f=i.handle.evt.type;if(f==="viewenter"||f==="viewleave"){g.checkNode(h,i,this);}else{i.fire({target:h});}},filterNotify:function(n,l,j,k){var g,f,m,h=l.handle.evt.type;m=d.Selector.query(j||"*");for(g=0,f=m.length;g<f;g++){if(h==="viewenter"||h==="viewleave"){k.checkNode(m[g],l,this);}else{l.fire({target:m[g]});}}},bind:function(i,f,h,e){var g,j,k,l;k=e||i;l=e?this.filterNotify:this.notify;if(this.type==="viewenter"||this.type==="viewleave"){g="scroll";j=d.one("body");}else{g=this.type;j=i;}j.plug(d.Plugin.ScrollInfo);j.scrollInfo.set("scrollDelay",25);f.handle=j.scrollInfo.on(g,l,null,h,k,this);},on:function(g,e,f){return this.bind(g,e,f);},delegate:function(h,f,g,e){return this.bind(h,f,g,e);},detach:function(f,e){e.handle.detach();},detachDelegate:function(f,e){e.handle.detach();}};d.Event.define("viewenter",b,true);d.Event.define("viewleave",b,true);d.Event.define("scrollToBottom",b,true);d.Event.define("scrollToTop",b,true);d.Event.define("scrollToLeft",b,true);d.Event.define("scrollToRight",b,true);},"1.0.0",{requires:["event-synthetic","node-scroll-info","transition"]});/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */
var yasearch,fxsearch;(function(){var T=null,G=true,v=false,S="undefined",r="ymobilizerouter",R="hidden",ay="loaded",k="browser",af="showOnlySetHP",aA="focus",j="SP",P="v=1&a=1",ap="v=1&a=0",C=5,Z=10,aa=5,az="web",s="innerHTML",f="value",aq="title",b="action",Y="name",al="text",I="parentNode",ak="tagName",w="href",K="height",M="width",H="auto",u="disabled",ao="focus",n="blur",c="submit",aC="mouseover",h="click",ax="4em",J="8em",g="1.6",ab="hide-completely",an="ds-b",a="open",V="bottom",A="denabled",X="uenabled",E="selected",ad="sa-results",ac="ghosttext",d=".promo",Q=".stabs",t=".more-tab",ar=".input-query",ae=".search-form",au=".searchwrapper",aB=".searchwrapper-inner",x=".sa-window",B=".sa-drawer",W=".sa-results",aD=".aria-announce",O="px",ah="allow.redirected.ult.links",z="pa:ready",aj="search.tab.",N=".showdrawer",L=".showdrawerhandle",p={kr:G,jp:G,tw:G,cn:G},q="ulm:defaultlocation",av="ldw:defaultlocation",at="pmh:searchtext",ai="pmh:show",F="sayt:open",aw="sayt:close",ag="mh:web_srch_inp",y="AREA",o=150,e=1000,m=100,l="interactive",am="srch-pl",D="srch-pl-s",i="srch-plu",aE="srch-plu-s",U="$q";YModules.type_masthead={id:"",body:T,moduleapi:T,platform:T,instrumentation:T,tablistService:T,tablist:T,autoHide:T,autoHideId:T,paService:T,viewevents:[h,"keyup"],formData:T,dummyYLT:T,ywaObject:T,YWATracker:T,textboxBlurred:T,saConfig:{enabled:G,minQueryLength:0,queryDelay:0,containerOpen:v,timeoutId:T,abortId:T,cachedResults:T,delayedRequests:0,numResults:0,normalizationRules:T,isAutoOpen:v,isManualOpen:v,selectedIndex:-1,lastAnimHeight:0,lastVisibleItem:0,connectionPriming:{enabled:v,throttleRate:15000,beacon:null,beaconFunc:null}},currentTab:"",form:T,textbox:T,hood:T,saWindow:T,saDrawer:T,saResults:T,searchwrapperInner:T,searchwrapper:T,aria:T,secondInput:T,hiddenInputNodes:T,suggestions:T,searchQuery:"",lastSearchQuery:"",lastQueryLength:0,defLoc:"",currentSelectedListItem:T,menu:T,useFxjsonp:v,keyUpSupported:G,handleKeyUpObject:T,allowRedirectedULTLinks:G,ebayInputField:T,numberOfVisibleItems:C,horizontalPadding:"0",moreLink:T,displayNameInMoreDropDown:v,logoContainer:T,trendData:T,numCycles:0,ghostTextIndex:0,ghostTextCharPosition:1,ghostTextId:T,restartId:T,uraPromo:T,usingDoubleByte:v,ywaTrackingEnabled:0,setHomepageService:T,browser:"",compactFilter:false,compactDimensions:{},adPromoNodeHack:false,clearBtn:null,search_focused:false,search_wrapper:T,blur_interval:1000,blur_timer:T,init:function(aJ){this.Y=aJ.getService("yui");this.moduleapi=aJ;this.hiddenInputNodes=[];this.id=aJ.getId();this.platform=aJ.getService("moduleplatform");this.instrumentation=aJ.getService("instrumentation");this.defLoc=aJ.getContextData("defLoc");this.currentTab=az;this.preloadSRP=aJ.getContextData("preloadSRP")?G:v;this.srpAssetURL=aJ.getContextData("srpAssetURL");this.ywaTrackingEnabled=parseInt(aJ.getContextData("ywaTrackingEnabled"),10);this.saytEnabled=parseInt(aJ.getContextData("saytEnabled"),10);this.browser=aJ.getContextData(k);this.compactFilter=aJ.getContextData("search.filter.compact.enabled")?!!aJ.getContextData("search.filter.compact.enabled"):false;this.saConfig.connectionPriming.enabled=aJ.getContextData("sayt.connection.priming")?!!aJ.getContextData("sayt.connection.priming"):false;this.clearBtn=this.Y.one("#btn-clear");if(aJ.getContextData("visibleItems")){this.saConfig.lastVisibleItem=this.numberOfVisibleItems=parseInt(aJ.getContextData("visibleItems"),10);this.saConfig.lastVisibleItem--;}var aG=aJ.getContextData("saData"),aL=aG.cssSAWindowMaxHeightIE6,aK=aJ.getContextData("horizontalPadding"),aM=aG.cssSAWindowSuggestionHeightIE6,aF,aI,aH;this.tpcGif=aG.tpcGifUrl;this.horizontalPadding=aK?aK:"0";if(aL&&aL.length>0){J=aL;}if(aM&&aM.length>0){g=aM;}this.formData=aJ.getContextData("formData");aJ.listen(q);aJ.listen(av);aJ.listen(z);aF=aJ.getProperty("channels");if(aF){aI=aF.length;for(aH=0;aH<aI;aH++){aJ.listen(aF[aH]);}}aJ.listen(ai);aJ.listen(at);},triggerSearchboxAnimation:function(){var aF=this.body;aF.addClass(ay);setTimeout(function(){aF.removeClass(ay);},750);setTimeout(function(){aF.addClass(ay);},1500);},onviewload:function(aM){if(aM==="default"){var aK=this.moduleapi,aL=this.Y,aI,aG=aK.getViewNode(aM),aJ=aK.getContextData("searchIntl")?aK.getContextData("searchIntl").toLowerCase():T,aF=this.trendData=aK.getContextData("trendData"),aH;aI=aK.getContextData(af);this.usingDoubleByte=p[aJ]?G:v;this.allowRedirectedULTLinks=aK.getContextData(ah);this.useFxjsonp=aK.getContextData("use.fxjsonp")?G:v;this.keyUpSupported=(aL.UA.gecko&&p[aJ])?v:G;this.body=aG;this.searchOverlayDiv=this.Y.one("#search-overlay");if(aK.getContextData("saData").enableAnimation){this.triggerSearchboxAnimation();}this.form=aG.one(ae);aH=this.textbox=aG.one(ar);this.searchwrapper=aG.one(au);this.searchwrapperInner=aG.one(aB);this.aria=aG.one(aD);this.uraPromo=aG.one(d);if(aH.hasClass("ime-enabled")){aH.removeClass("ime-enabled");}if(this.saytEnabled){this.initSA();}this.form.on(c,this.handleSubmit,this);this.form.on(ao,this.handleFocus,this);this.form.on(n,this.handleBlur,this);this.search_wrapper=aG.one(".searchwrapper-border");aH.on(n,this.handleTextBlur,this);aH.on(ao,this.handleTextFocus,this);this.registerAutoHide();this.dummyYLT=aK.getContextData("dummyYLT");if(!this.keyUpSupported){aH.on(ao,this.handleFFDoubleByte,this);aH.on(n,this.clearFFDoubleByte,this);}this.logoContainer=aG.one(".logo-container");if(aF){aH.blur();aH.on(ao,this.cancelGhostWriting,this,ac);this.numCycles=aK.getContextData("numCycles");this.ghostTextId=aL.later(o,this,this.ghostWrite,aF,true);}}},handleFocus:function(aG){var aF=this.blur_interval;this.search_focused=true;if(this.search_wrapper){this.search_wrapper.addClass(aA);if(this.blur_timer){this.blur_timer.cancel();}this.blur_timer=this.Y.later(aF,this,function(){this.search_focused=false;},false);}},handleBlur:function(aF){if(this.search_wrapper&&!this.search_focused){this.search_wrapper.removeClass(aA);}},setMobilizer:function(){var aG="100%",aK=document.documentElement.clientHeight+"px",aI=document.body.scrollTop||document.documentElement.scrollTop,aJ=document.createElement("iframe"),aH="99999",aF=this.moduleapi.getContextData("locale"),aL=this.moduleapi.getContextData("mobilizerUrl");if(document.getElementById(r)){document.body.removeChild(document.getElementById(r));}aJ.src=aL+"&lang="+aF;aJ.setAttribute("id",r);aJ.setAttribute("name",r);aJ.setAttribute("allowTransparency","allowTransparency");aJ.setAttribute("frameborder",0);aJ.setAttribute("scrolling","no");aJ.setAttribute("width",aG);aJ.setAttribute("height",aK);aJ.style.position="absolute";aJ.style.left="0px";aJ.style.top=aI+"px";aJ.style.zoom="1";aJ.style.zIndex=aH;aJ.style.overflow="hidden";aJ.setAttribute("style","z-index:"+aH+";position:absolute;top:"+aI+"px;left:0px;width:"+aG+";height:"+aK+";");document.body.appendChild(aJ);if(typeof window.addEventListener!=S){window.addEventListener("message",this.closeMobilizer,v);}else{if(typeof window.attachEvent!=S){window.attachEvent("onmessage",this.closeMobilizer);}}},closeMobilizer:function(aF){if(aF.data=="closeYMBZ"){if(document.getElementById(r)){document.body.removeChild(document.getElementById(r));}}},hideOverlay:function(){this.overlay.addClass(R);},ghostWrite:function(aH){var aK="",aG=this.textbox,aI=arguments.length,aM=this.ghostTextIndex,aF=this.ghostTextCharPosition,aJ,aL;if(this.ghostTextIndex>=aI){aL=--this.numCycles;this.ghostTextIndex=this.ghostTextCharPosition=0;if(aL===0){this.cancelGhostWriting(T,ac);}}else{aJ=arguments[aM].text;if(aJ&&aF<aJ.length+1){aK=aJ.substring(0,this.ghostTextCharPosition++);aG.set(f,aK).addClass(ac);}else{this.ghostTextIndex++;this.ghostTextCharPosition=0;this.cancelGhostWriting();this.restartId=this.Y.later(e,this,this.restartGhostText);}}},restartGhostText:function(){this.ghostTextId=this.Y.later(o,this,this.ghostWrite,this.trendData,true);},cancelGhostWriting:function(aH,aG){var aI=this.ghostTextId,aF=this.restartId;if(aI||aF){if(aI){aI.cancel();aI=T;}if(aF){aF.cancel();aF=T;}if(aG){this.textbox.removeClass(aG);}}},initSA:function(){var aH=this.moduleapi,aF=this.saConfig,aG=aH.getContextData("saData");aF.minQueryLength=aG.minQueryLength;aF.queryDelay=aG.queryDelay;aF.normalizationRules=aG.normalizationRules;aF.lastVisibleItem=this.numberOfVisibleItems-1;aF.cachedResults={};aF.cachedResults[az]={};if(this.Y.Cookie.get(j)===ap){aF.enabled=v;}yasearch=fxsearch=this.Y.bind(function(aI){this.handleSearch(aI);},this);this.createDropdown();},onviewunload:function(aH){var aF=this.textbox,aG=this.ghostWriteId;if(aG){aG.cancel();this.ghostWriteId=T;}this.closeDropdown();this.unregisterAutoHide();this.form.detach(c,this.handleSubmit);this.form.detach(ao,this.handleFocus);this.form.detach(n,this.handleBlur);aF.detach(n,this.handleTextBlur);if(!this.keyUpSupported){aF.detach(ao,this.handleFFDoubleByte);aF.detach(n,this.clearFFDoubleByte);}if(this.trendData){aF.detach(ao,this.cancelGhostWriting);}this.clearFFDoubleByte();this.body=this.paService=this.textbox=this.form=this.searchwrapper=this.searchwrapperInner=this.aria=this.hood=this.saWindow=this.saDrawer=this.secondInput=this.hiddenInputNodes=this.restartId=this.ghostTextId=this.logoContainer=this.trendData=this.formData=this.saConfig=T;},registerAutoHide:function(){var aI=this.id,aG=this.body,aH=this.Y,aF=this.moduleapi.getService("autohide");this.autoHideId=aF.register({targets:[this.hood,this.textbox,aG.getById(aI+"-masthead-stabs")],hide:aH.bind(this.closeDropdown,this)});this.autoHide=aF;},unregisterAutoHide:function(){var aF=this.autoHide;if(aF){aF.unregister(this.autoHideId);}},playLogoAnimation:function(){if(typeof Aniden!="undefined"&&Aniden.play){Aniden.play();}},createDropdown:function(){var aF=this.body,aH,aI,aG;aH=aF.one(".hood");aI=aH.one(x);aG=aH.one(B);this.hood=aH;this.saWindow=aI;this.saDrawer=aG;},openDropdown:function(){var aG=this.saConfig,aF=this.body,aI=this.saWindow,aK,aJ=this.moduleapi,aH=aF.one(".search-promo"),aL=this.Y;aJ.broadcast(F);aJ.broadcast(l);if(aG.isAutoOpen===G){this.instrumentation.fireUltBeacon(this.formData[this.currentTab].bcnAutoOpen);aG.isAutoOpen=v;}if(aL.UA.ie===6&&aG.containerOpen===v){this.syncDropdown();}this.saDrawer.set("innerHTML",aJ.getString("STR.SA.TOGGLE.OFF"));aG.selectedIndex=-1;this.hood.addClass(a);if(!aJ.getContextData("saData").openAnimDisabled){aK=aI.get("offsetHeight");if(aK>aG.lastAnimHeight&&aG.containerOpen===v){aI.setStyle(K,"0");aI.transition({height:aK+"px",easing:"ease-out",duration:parseFloat(aJ.getContextData("saData").openAnimDuration)},this.Y.bind(this.afterDropdownOpened,this));aG.lastAnimHeight=aK;}}else{this.afterDropdownOpened();}aG.containerOpen=G;this.textbox.set(aq,aJ.getString("STR.SA.DROPDOWN.DESCRIPTION")).focus();aF.one(au+" .rc-bl").addClass(ab);aF.one(au+" .rc-br").addClass(ab);if(aH){if(aL.UA.ie&&aL.UA.ie<8){aH.addClass(ab);}else{aL.Node.getDOMNode(aH).style.zIndex=0;}}},closeDropdown:function(aG){var aF=this.moduleapi;if(this.hood&&this.hood.hasClass("open")){this.saWindow.transition({height:0,easing:"ease-in",duration:parseFloat(aF.getContextData("saData").closeAnimDuration)});this.afterCloseDropdown(aG);}},afterDropdownOpened:function(){var aF=this.saWindow,aG=aF.get("offsetHeight");if(this.Y.UA.ie!==6){aF.setStyle(K,H);}else{aF.setStyle(K,aG+"px");}},afterCloseDropdown:function(aM){var aJ=this.hood,aG=this.saConfig,aH=this.textbox,aF=this.body,aK=this.moduleapi,aL=this.Y,aI=aF.one(".search-promo");this.moduleapi.broadcast(aw);this.saDrawer.set("innerHTML",aK.getString("STR.SA.TOGGLE.ON"));this.saWindow.setStyle(K,H);aG.lastAnimHeight=0;aG.lastVisibleItem=this.numberOfVisibleItems-1;aJ.removeClass(a);aG.containerOpen=v;aH.set(aq,this.formData[this.currentTab].button);if(!aM){aH.focus();if(!this.usingDoubleByte){aH.set(f,aH.get(f));}}aF.one(au+" .rc-bl").removeClass(ab);aF.one(au+" .rc-br").removeClass(ab);aJ.detach(aC,this.handleMouseover);if(aL.UA.ie===6){document.getElementById(this.id+"-hood").style.width="";aJ.addClass(an);}if(aI){if(aL.UA.ie&&aL.UA.ie<8){aI.removeClass(ab);}else{aL.Node.getDOMNode(aI).style.zIndex=6;}}aK.broadcast(ag,aH.get(f));},syncDropdown:function(){var aJ=this.saWindow,aH=this.searchwrapperInner,aG=this.hood,aK,aF,aI=this.saConfig.numResults;aK=parseFloat(aH.get("offsetWidth"))+2+O;aG.removeClass(an);aG.setStyle(M,aK);if(!this.suggestions){aF=ax;}else{if(aI>this.numberOfVisibleItems){aF=J;}else{aF=g*aI+0.4+"em";}}aJ.setStyle(K,aF);},highlightItem:function(aJ,aI,aH,aK){var aG=aJ.item(aI),aL=aG.get("parentNode"),aF=this.currentSelectedListItem;if(aF){aF.removeClass(E);}aJ.removeClass(E);aG.addClass(E);aL.addClass(E);this.currentSelectedListItem=aL;this.saConfig.selectedIndex=aI;if(!aH){this.textbox.set(f,aG.get(al));}},scroll:function(){var aL,aJ=this.saConfig,aM=this.body,aF=this.id,aO=aJ.lastVisibleItem+1,aH=aO-this.numberOfVisibleItems>0?aO-this.numberOfVisibleItems:0,aI=aM.getById(aF+"-arr-up"),aG=aM.getById(aF+"-arr-down"),aK=aM.getById(aF+"-results"),aN=this.moduleapi,aP=aN.getContextData("saData").cssFontSizeSAYT;if(aP&&aP.length>0){aP=ad+" "+aP;}else{aP=ad;}aK.set("className",aP);aH=aH>aO?aO:aH;if(aJ.selectedIndex>=aO){aH++;}aK.addClass(aO>this.numberOfVisibleItems?V+aH:"");if(aI){aL=this.numberOfVisibleItems-aO;if(aL===0||aL===1){aI.removeClass(X);}else{aI.addClass(X);}}if(aG){if(aJ.numResults-aO===0){aG.removeClass(A);}else{aG.addClass(A);}}},scrollSelection:function(aI,aH){var aF=this.saConfig,aJ=this.numberOfVisibleItems,aG;if(aH){aI=--aI;}aG=aJ-(Z-1-aI);if(aF.numResults>aF.lastVisibleItem){if(aG<0){aF.lastVisibleItem=aJ-1;}else{if(aG+aJ<=Z){aF.lastVisibleItem=aG+aJ-1;}else{if(aF.lastVisibleItem<aJ){aF.lastVisibleItem++;}}}if(aF.numResults>aJ){this.scroll();}}else{if(aH){aF.lastVisibleItem--;}}},moveSelectionDown:function(){var aF=this.saConfig,aH=aF.selectedIndex,aG=this.suggestions;if(aG&&aG.size()>0){if(aH<aF.numResults-1){aG.removeClass(E);this.highlightItem(aG,++aF.selectedIndex,v);this.scrollSelection(aH);}}},moveSelectionUp:function(){var aF=this.saConfig,aH=aF.selectedIndex,aG=this.suggestions;if(aH!==-1){aG.removeClass(E);if(aH===0){this.textbox.set(f,this.lastSearchQuery);aF.selectedIndex=-1;}else{this.highlightItem(aG,aF.selectedIndex===0?0:--aF.selectedIndex,v,G);this.scrollSelection(aH,G);}}},blurText:function(aF){var aG=aF.target;if(aG.get(f)===""){aG.set(f,aG.get("defaultValue"));}},resetSA:function(){var aG=this.saConfig,aF,aH=aG.containerOpen;this.suggestions=T;if(aG.enabled===G){aG.lastVisibleItem=this.numberOfVisibleItems-1;aG.numResults=0;aG.selectedIndex=-1;aG.isAutoOpen=v;aG.isManualOpen=v;aG.containerOpen=v;aF=this.body.getById(this.id+"-sa-info");if(aF){aF.setAttribute(w,this.formData[this.currentTab].yltInfoPage);}}if(aH){this.Y.later(150,this,this.resetHood);}else{this.resetHood();}},resetHood:function(){this.saWindow.set(s,this.moduleapi.getContextData(this.saConfig.enabled?"HTML_HOODCONTENT_ENABLED":"HTML_HOODCONTENT_DISABLED"));if(this.moduleapi.getContextData(aj+this.currentTab+L)){this.saDrawer.removeClass(ab);}},hideSA:function(){this.saDrawer.addClass(ab);},fireYodelBeacon:function(){var aF={sec:"ylogo",slk:"yodel",ltxt:"yodel",pos:0,own:"Y",ld:0,itc:1};this.instrumentation.fireUltBeacon(aF);},handleMouseover:function(aM){var aN=aM.target,aK,aI,aO,aF,aJ,aL=this.body.getById(this.id+"-results"),aH=this.suggestions,aG=aN.get(ak);if(aH){if((aG==="A"||aG==="STRONG")&&aL.contains(aN)){aF=aH.size();if(aG==="A"){aO=aN.get("id");aI=aN.get(al);}else{aI=aN.get(I).get(al);}for(aJ=0;aJ<aF;aJ++){aK=aH.item(aJ);if(aO){if(aO==aK.get("id")&&aI===aN.get(I).get(al)){this.highlightItem(aH,aJ,G);break;}}else{if(aI===aK.get(al)){this.highlightItem(aH,aJ,G);break;}}}}else{aH.removeClass(E);}}},isYHSAction:function(){var aF=this.form.getAttribute(b);return(aF.indexOf("="+U)!==-1&&window.location.search.indexOf("yhs")!==-1);},submitYHS:function(aJ,aI,aH){var aK,aG,aF;this.Y.all(".srch-hidden").set(u,true);this.Y.use("querystring-parse",function(aL){aK=aJ.substr((aJ.indexOf("?")+1),(aJ.length-1));aG=aL.QueryString.parse(aK);aL.each(aG,function(aN,aM){if(aN===U){aI.one(".input-query").setAttribute("name",aM);}else{aF=aL.Node.create('<input type="hidden">');aF.setAttribute("name",aM);aF.setAttribute("value",aN);aI.append(aF);}});aI.set("action",aJ);aI.submit();});},onviewevent:function(aQ,aW){if(aQ==="default"){var aM=this.instrumentation,aL=this.body,aP=this.id,aU,aY=this.saResults,aT=this.currentTab,aS=this.formData[aT],aF=this.saConfig,aO=this.textbox,aJ=this.secondInput,aV=aO.get(f),aH,aI,aZ=aW.target,aN=aW.type,aK="",aG=this.trendData,aX=aL.one(t),aR=(aZ===aO);this.searchQuery=aV;if(aR){this.moduleapi.broadcast(l);}if(aN==="keyup"&&aR){this.handleKeyUp(aW.keyCode);this.inputValueChange();}else{if(aN===h){aI=aL.one(Q);if(aI&&aI.contains(aZ)){if(!aX||!aX.contains(aZ)){aO.focus();if(this.Y.UA.ie===8){aO.set(f,aV);}}}if(this.search_wrapper){this.search_wrapper.addClass(aA);}aK=aZ.get("id");aH=aZ.get(ak);if(aH&&aH===y){this.fireYodelBeacon();}if(aK){if(this.hood&&this.hood.contains(aZ)&&aZ.get(ak)==="A"&&aZ.getAttribute(w).indexOf("ylt")===-1){aW.preventDefault();switch(aK){case (aP+"-arr-up"):aM.fireUltBeacon(aS.bcnScroll);if(aZ.hasClass(X)){aF.lastVisibleItem--;this.scroll();}break;case (aP+"-arr-down"):aM.fireUltBeacon(aS.bcnScroll);if(aZ.hasClass(A)){aF.lastVisibleItem++;this.scroll();}break;case (aP+"-sa-drawer"):if(aF.containerOpen===G){aM.fireUltBeacon(aS.bcnDrawerClose);this.closeDropdown();}else{aM.fireUltBeacon(aS.bcnDrawerOpen);this.manualOpenDropdown();}break;case (aP+"-onswitch"):case (aP+"-sa-hintswitch"):this.toggleSA(true);break;case (aP+"-offswitch"):this.toggleSA(false);break;default:break;}}else{switch(aK){case (aP+"-location"):if(aJ.get(f)===aS.locationGhostText){aJ.set(f,"");}break;case aP+"-close-overlay":aW.preventDefault();this.hideOverlay();break;case aP+"-mobilizer":aW.preventDefault();this.setMobilizer();break;default:break;}}}else{if(aG){aW.preventDefault();if(!aY){aY=this.saResults=aL.one(W);}if(aY&&aY.contains(aZ)){this.beaconPreloadedSearch(aO.get(f),G);aU=aZ.get(w);if(!aU){aU=aZ.ancestor("A").get(w);}this.moduleapi.navigate(aU);}}}}}if(this.clearBtn&&aZ.hasClass("btn-clear")){aW.preventDefault();this.emptyInputValue();}}},primeSearch:function(){var aF=this.saConfig.connectionPriming;if(aF.enabled){if(aF.beaconFunc===null){this.Y.use("yui-throttle",this.Y.bind(function(aG){aF.beaconFunc=aG.throttle(aG.bind(this.primeSearchConnection,this),aF.throttleRate);this.primeSearchConnection();},this));}else{aF.beaconFunc();}}},primeSearchConnection:function(){var aF=this.saConfig.connectionPriming,aG=new Date();aF.beacon=null;aF.beacon=new Image();aF.beacon.src=this.tpcGif+aG.getTime();},handleKeyUp:function(aN){var aL=this.aria,aI=this.moduleapi,aH=this.saConfig,aF=this.currentTab,aM=this.searchQuery,aJ=aM.length,aG=this.lastQueryLength,aK=this.srpAssetURL;if(this.preloadSRP&&aK){this.Y.Get.script(aK,{onSuccess:function(){this.preloadSRP=false;},context:this});}if(this.keyUpSupported){aM=this.textbox.get(f);aJ=aM.length;if(aN==8){if(aJ>aH.minQueryLength&&aH.enabled){if((aM&&aJ>0)&&aM!=this.lastSearchQuery){this.sendQuery();}}else{this.closeDropdown();}}}switch(aN){case 13:break;case 27:if(aH.containerOpen===G){this.closeDropdown();}break;case 37:case 39:break;case 38:if(aH.enabled===G&&aH.containerOpen===G){this.clearFFDoubleByte();this.moveSelectionUp();}break;case 40:this.clearFFDoubleByte();if(aI.getContextData(aj+az+N)){this.manualOpenDropdown();}break;default:if(aJ===aG&&!this.keyUpSupported){break;}if(!this.keyUpSupported&&!this.handleKeyUpObject){this.handleFFDoubleByte();}if(aH.enabled===G){if(aJ===0){aL.set(s,"<p></p>");this.closeDropdown();}else{if(aJ>aH.minQueryLength){if(aH.timeoutId){aH.timeoutId.cancel();}if(aH.containerOpen===v){aH.isAutoOpen=G;}if(aF===az){this.primeSearch();}aH.timeoutId=this.Y.later(aH.queryDelay,this,this.sendQuery);if(aH.containerOpen){aH.lastVisibleItem=this.numberOfVisibleItems-1;}}else{aL.set(s,"<p>"+aI.getString("STR.MASTHEAD.NO_SUGGESTION")+"</p>");if(aH.containerOpen){this.closeDropdown();}}}this.lastQueryLength=aJ;}this.moduleapi.broadcast(ag,aM);break;}},manualOpenDropdown:function(){var aF=this.saConfig;if(aF.enabled===G){if(aF.containerOpen===v){if(this.searchQuery.length>aF.minQueryLength){aF.isManualOpen=true;this.sendQuery();}else{this.resetSA();this.openDropdown();}}else{if(this.suggestions){this.moveSelectionDown();}}}else{this.resetSA();this.openDropdown();}},toggleSA:function(aK){var aL=this.instrumentation,aJ=this.formData[this.currentTab],aF="yahoo.com",aI=new Date(),aH,aG;if(aK===G){aH=P;aG="on";}else{aH=ap;aG="off";}aL.fireUltBeacon(aJ.bcnOnOff);this.Y.Cookie.set(j,aH,{expires:aI.setDate(aI.getDate()+120),path:"/",domain:aF});this.saConfig.enabled=aK;this.resetSA();this.closeDropdown();},handleSubmit:function(aN){aN.preventDefault();var aM=this.moduleapi,aH=this.saConfig,aJ=this.trendData,aK=this.body,aF=this.id,aP,aO,aI=this.textbox.get(f),aG=this.formData[this.currentTab],aL;if(aI.length===0){aN.preventDefault();return;}aH.enabled=v;if(this.ywaTrackingEnabled&&YWA!==null){this.ywaObject=YWA;}if(this.ywaTrackingEnabled&&this.ywaObject!==T){aL=this.moduleapi.getContextData("ywaProjectId")+"";this.YWATracker=this.ywaObject.getTracker(aL);this.Y.later(m,this,function(){if(this.YWATracker!==T){this.YWATracker.setAction("INTERNAL_SEARCH");this.YWATracker.setISK(aI);this.YWATracker.setISR("100");if(aI.length===0){this.YWATracker.setISR("0");}this.YWATracker.setDocumentGroup("Search");this.YWATracker.setDocumentName("Search Results");this.YWATracker.submit();}},T);}if(aJ){this.beaconPreloadedSearch(this.textbox.get(f));}if(aH.selectedIndex!==-1){this.setFRCode(true);aP=aK.getById(aF+"-results").all("li a");aO=aP.item(aH.selectedIndex).get(w);if(aJ){this.Y.later(m,this,function(){this.moduleapi.navigate(aO);},aO);}else{aM.navigate(aO);}}else{this.setFRCode(false);if(aJ){this.Y.later(m,this,function(){this.form.submit();},T);}else{if(this.isYHSAction()){this.submitYHS(aG.action,this.form,aI);}else{this.form.set("action",aG.action);this.form.submit();}}}},handleTextBlur:function(){this.textboxBlurred=true;this.aria.set(s,"<p></p>");},handleTextFocus:function(){this.textboxBlurred=false;},sendQuery:function(){if(this.moduleapi.getContextData(aj+this.currentTab+N)&&this.saytEnabled){var aJ=this.saConfig,aK=this.moduleapi,aP=this.searchQuery,aL=""+aP,aO=aL.replace(/%20/g," "),aH=this.currentTab,aF=aJ.cachedResults[aH][aO],aI,aM=0,aN,aG;if(typeof aF==="object"){aJ.numResults=aF.length;this.populateList(aF);if(aP.length>aJ.minQueryLength&&aJ.numResults>0||aJ.isManualOpen){this.openDropdown();}}else{if(aJ.delayedRequests<aa){aL=encodeURIComponent(aL.replace(/"/g,""));aI=aK.getContextData("saData").webGossipUrl;aM=aK.getContextData("saData").newWebGossipUrlEnable;if(aL.length>0){aN=aI+aL;if(aM==1){aG=this.textbox.get("selectionStart");if(aG<aO.length){aN+="&ipos="+aG;}}aJ.abortId=this.Y.Get.script(aN,{timeout:1000,onTimeout:this.Y.bind(this.increaseDelayedRequests,this)});}}}this.lastSearchQuery=""+aP;}},increaseDelayedRequests:function(){this.saConfig.delayedRequests++;},handleSearch:function(aF){var aH=[],aG=this.saConfig,aI=this.useFxjsonp?aF[1].length:aI=aF.r.length;aG.numResults=aI;aH=this.formatResults(aF);if(this.useFxjsonp){aG.cachedResults[this.currentTab][aF[0]]=aH;}else{aG.cachedResults[this.currentTab][aF.q]=aH;}this.populateList(aH);if(this.searchQuery.length>aG.minQueryLength&&aI>0){this.openDropdown();}},populateList:function(aV){var aH=this.Y.DOM,aT=this.id,aJ=this.moduleapi,aF=this.saConfig,aX=this.formData,aY=this.currentTab,a1=aX[aY],aL=this.aria,aQ=this.body,aW=aH.byId(aT+"-sayt"),aR=aV.length,aG=aJ.getContextData("frCode"),aP=aJ.getContextData("typeCode"),a0=aP?"type="+aP+"&":"",aS="",a3="",aN="",aZ,aM="",a2,aU,aO,aI,aK=/<\S[^><]*>/g;if(aR>0){aL.set(s,"<p>"+aJ.getString("STR.MASTHEAD.HAS_SUGGESTION")+"</p>");if(!aW){this.resetHood();aW=aH.byId(aT+"-sayt");}aS=aJ.getContextData("ilcValue")?"ilc="+aJ.getContextData("ilcValue")+"&":"";aW.innerHTML=aJ.getContextData("HTML_RESULTSLIST");a2=document.getElementById(aT+"-results");a3=aJ.getContextData("searchTracking")?aJ.getContextData("searchTracking")+"&":"";for(aZ=0;aZ<aR;aZ++){if(this.useFxjsonp){if(!this.isYHSAction()){aN="?fr="+aG+"-s&toggle=1&"+a0+aS+a3+"cop=mss&ei=UTF-8"+aM+"&p="+encodeURIComponent(aV[aZ].replace(aK,""));}else{aN=a1.yltClickSuggestion.replace(U,encodeURIComponent(aV[aZ].replace(aK,"")));}a2.innerHTML+=aJ.getContextData("HTML_RESULTSITEM");aU=a2.lastChild.firstChild;aU.href=a1.yltClickSuggestion+aN;aU.innerHTML=aV[aZ];}else{aO=aV[aZ].formattedResults;if(!this.isYHSAction()){aN="?fr="+aG+"-s&toggle=1&"+a0+aS+a3+"cop=mss&ei=UTF-8"+aM+"&p="+encodeURIComponent(aO.replace(aK,""));}else{aN=a1.yltClickSuggestion.replace(U,encodeURIComponent(aO.replace(aK,"")));}a2.innerHTML+=aJ.getContextData("HTML_RESULTSITEM");aI=a2.lastChild;aU=aI.firstChild;if(this.isYHSAction()){aU.href=aN;}else{aU.href=a1.yltClickSuggestion+aN;}aU.innerHTML=aO;}}if(aF.numResults>this.numberOfVisibleItems){aW.innerHTML+=aJ.getContextData("HTML_RESULTS_SCROLLARROWS");}this.suggestions=aQ.getById(aT+"-results").all("li a");if(this.Y.UA.ie===6){this.syncDropdown();}this.hood.on(aC,this.handleMouseover,this);}else{if(this.suggestions||!this.saWindow.one("ul")){this.resetSA();this.closeDropdown();aL.set(s,"<p>"+aJ.getString("STR.MASTHEAD.NO_SUGGESTION")+"</p>");}this.suggestions=T;}},formatResults:function(aL){var aV=this.saConfig.normalizationRules,aM,aU,aP,aK=aV.length,aJ,aN,aI,aH,aG,aQ,aT=[],aO,aR,aF,aS;if(this.useFxjsonp){aU=this.Y.Lang.trim(this.normalize(aL[0].toUpperCase()));aP=aL[1].length;}else{aM=aL.r;aU=this.Y.Lang.trim(this.normalize(aL.q));aP=aM.length;}aU=aU.replace(/\(+/g,"").replace(/\)+/g,"").replace(/\{+/g,"").replace(/\}+/g,"").replace(/\[+/g,"").replace(/\]+/g,"").replace(/\\+/g,"");aH=aU.split("");aJ=aH.length-1;while(aJ-->0){aO=aH[aJ+1];switch(aH[aJ]){case"A":if(aH[aJ+1]==="E"){aH[aJ]="AE";}break;case"O":if(aH[aJ+1]==="E"){aH[aJ]="OE";}break;case"U":if(aH[aJ+1]==="E"){aH[aJ]="UE";}break;case"T":if(aH[aJ+1]==="H"){aH[aJ]="TH";}break;case"S":if(aH[aJ+1]==="S"){aH[aJ]="SS";}break;default:break;}if(aH[aJ].length>1){aH.splice(aJ+1,1);}}aN=aH.length;while(aN-->0){while(aK-->0){if(aH[aN]===aV[aK][0]){aH[aN]="("+aV[aK][1]+")";}}aK=aV.length;}aG="("+aH.join("")+")";aG=aG.replace(/(\$|\^|\*|\+|\?|\\|\[|\]\{|\}\|\|)/g,"\\$1");aQ=new RegExp(aG,"i");for(aI=0;aI<aP;aI++){aS=this.useFxjsonp?aL[1][aI]:aM[aI][0];aF=(aQ)?aS.replace(aQ,"<strong>$1</strong>"):aL[1][1];if(this.useFxjsonp){aT[aI]=aF;}else{aR=aM[aI][3];aT[aI]={formattedResults:aF,suid:aR};}}return aT;},normalize:function(aF){var aH=this.saConfig.normalizationRules,aG=aH.length-1;while(aG--){aF=aF.replace(new RegExp(aH[aG][1],"g"),aH[aG][0]);}return aF;},setFRCode:function(aF){var aH=this.body.getById(this.id+"-frcode"),aG=this.moduleapi.getContextData("frCode");if(aH){aH.set(f,aF?aG+"-s":aG);}},removeYLT:function(aG){var aF=aG.lastIndexOf("http");return aG.substr(aF,aG.length);},saveSetting:function(aG,aH){var aF={type:"module",moduleId:this.id,args:{_action:"save",_subAction:aG,value:aH}},aI={success:function(aK,aJ){},failure:function(aK,aJ){},scope:this};this.moduleapi.makeRequest(aF,aI);},onmessage:function(aH,aG,aJ){var aM=this.body,aK=this.secondInput,aN=aJ?aJ.displayName:T,aO,aI,aL,aF;if((aH===q||aH===av)&&aN){this.defLoc=aN;if(aK){aK.set(f,aN);}aO=aM.getById(this.id+"-weather");if(aO){aI=aO.next();if(aI){aI.set(s,aN.substring(0,aN.indexOf(",")));}}}else{if(aH.substr(0,5)==="/user"){aL=aH.substr(aH.lastIndexOf("/")+1);aF=aM.getById(this.id+"-"+aL);if(aF){aF.set(s,aJ.data);aF.removeClass(ab);}}else{if(aH===at){if(true===this.textboxBlurred){this.textbox.focus();this.textbox.set(f,aJ);}}else{if(aH===ai){this.closeDropdown(true);if(this.textbox.get(f)){this.moduleapi.broadcast(ag,this.textbox.get(f));}}}}}},getEms:function(aG){var aF,aH,aI=this.Y;aF=aG.appendChild(document.createElement("div"));aF.setStyle("height","1em");aF.setStyle("width","1em");aH=aI.DOM.region(aI.Node.getDOMNode(aF));aF.remove();return aH;},handleFFDoubleByte:function(){this.handleKeyUpObject=this.Y.later(500,this,this.handleFFDoubleByteKeyUp,T,G);},handleFFDoubleByteKeyUp:function(){var aF;this.searchQuery=this.textbox.get(f);if(this.searchQuery!=this.lastSearchQuery){aF=this.saConfig;aF.timeoutId=this.Y.later(aF.queryDelay,this,this.sendQuery);}this.handleKeyUp();},clearFFDoubleByte:function(){if(this.handleKeyUpObject){this.handleKeyUpObject.cancel();}this.handleKeyUpObject=T;},createHiddenInputFieldForTab:function(aG,aI){var aH=this.body.getById(this.id+"-p"),aF=aH.get(I),aJ=aF.create("<input type='hidden'>");if(aG&&aI){aJ.setAttribute(Y,aG);aJ.setAttribute(f,aI);}return aF.insertBefore(aJ,aH);},removeYNode:function(aF){if(aF){aF.get(I).removeChild(aF);}},removeHiddenInputFields:function(){var aF,aG=0,aH=this.hiddenInputNodes;if(aH){aG=aH.length;for(aF=aG-1;aF>=0;aF--){this.removeYNode(aH[aF]);aH[aF]=T;}}},disableHiddenInputField:function(aG){var aF=this.body.getById(aG);if(aF){aF.set(u,G);}},updateLandingPage:function(){var aF,aG,aH,aI=this.formData[this.currentTab];if(aI.noQueryURL){aG=this.form;aH=aG.getAttribute(b);aF=this.extractURL(aH);if(this.searchQuery.length===0){aH=aH.replace(aF,aI.noQueryURL);}else{aH=aH.replace(aF,this.extractURL(aI.action));}aG.setAttribute(b,aH);}},extractURL:function(aG){var aH,aF=T;if(aG){aH=aG.indexOf("http://");if(aH===-1){aH=0;}aF=aG.substr(aH,aG.length);}return aF;},isStringInArray:function(aH,aI){var aG,aJ,aF=v;if(aH&&aI){aG=aI.length;aJ=aH.toLowerCase();while(aG--){if(aJ===aI[aG].text.toLowerCase()){aF=G;break;}}}return aF;},isArrayStringInString:function(aH,aI){var aG,aJ,aF=v;if(aH&&aI){aG=aI.length;aJ=aH.toLowerCase();while(aG--){if(aJ.indexOf(aI[aG].text.toLowerCase())>-1){aF=G;break;}}}return aF;},beaconPreloadedSearch:function(aG,aJ){var aI={slk:"sa_link",pos:1,own:"Y",ld:0,itc:0},aF=this.trendData,aH=this.hood.hasClass(a);if(aH){if(this.isStringInArray(aG,aF)){aI.sec=D;aI.ltxt=aG;}else{if(this.isArrayStringInString(aG,aF)){aI.sec=aE;aI.ltxt="sa_click";}}}else{aI.slk="btn";if(this.isStringInArray(aG,aF)){aI.sec=am;aI.ltxt=aG;}else{if(this.isArrayStringInString(aG,aF)){aI.sec=i;aI.ltxt="srch-"+this.currentTab;}}}if(aI.sec){this.instrumentation.fireUltBeacon(aI);}},inputValueChange:function(aF){if(this.clearBtn){if(this.textbox.get("value")){if(!this.clearBtn.hasClass("enabled")){this.clearBtn.addClass("enabled");}}else{this.clearBtn.removeClass("enabled");}}},emptyInputValue:function(){var aF=this.textbox||this.body.one(ar);if(this.clearBtn&&aF){this.clearBtn.removeClass("enabled");aF.set("value","");aF.focus();}}};})();/* Copyright (c) 2015, Yahoo! Inc.  All rights reserved. */

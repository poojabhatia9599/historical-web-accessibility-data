"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(){var e=window,n=e.onerror,o=["apptype","rid","bucketId","bucket","device","osName","browserName","browserVersion"],t=/^resource:\/\//,r=/ActionScript|Decompress\sfail/,a={beaconPath:"p.gif",site:"fp"},i=function(){var n=e.YAHOO&&e.YAHOO.context||e.Af&&e.Af.context||{},t="";return o.forEach((function(e){"undefined"!==_typeof(n[e])&&(t+="&".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(n[e])))})),t},c=function(n,o,t,r){n&&o||r&&r("Missing required params - type: ".concat(n,", src: ").concat(o));var c=t||{};o&&(c.src=o),c._rdn=(new Date).getTime().toString().substr(7);var s=Object.keys(c).map((function(e){return encodeURIComponent(e)+"="+encodeURIComponent(c[e])})).join("&"),f="".concat("/_td_api/beacon","/").concat(n,"?").concat(s).concat(i(),"&site=").concat(a.site),d=!(window.navigator&&"sendBeacon"in window.navigator);if(!d)try{window.navigator.sendBeacon(f)}catch(e){d=!0}if(d){var u=new Image;u.onerror=function(e){var n=e instanceof Error?e.toString():e;r&&r(n)},u.onload=function(){r&&r()},u.src=f,e.__testError&&(e.__testImg=u)}},s=function(e,n){if(n){var o="string"==typeof n?n:n.message;if(!o||!r.test(o)){var t,a=n.toString();if(n){switch(a){case"[object String]":t={code:999,message:n};break;case"[object Error]":t={code:n.code||n.name||999,file:n.fileName||"",line:n.lineNumber||"",message:n.message};break;case"[object Object]":t=n;break;default:try{t={code:999,message:JSON.stringify(n)}}catch(e){}}t.message=t.message&&t.message.substring(0,300)||""}c("error",e,t)}}};e.onerror=function(e,o,r){try{if(!t.test(o)){var a={code:e.name,file:e.fileName||"",line:e.lineNumber||r||"",message:e.message||e,url:o&&o.substring(0,300)};s("winerror",a)}}catch(e){}return"function"==typeof n&&n(e,o,r)},addEventListener("ybar.error",(function(e){var n=e&&e.detail||{},o=n.error||{},t=n.message||o.message||o.toString();try{var r={code:o.name,file:o.fileName||"",line:o.lineNumber||"",message:t};s("ybar",r)}catch(e){}}));var f,d=function(e){e&&("IDB-connection-success"===e.name&&window.wafer.base.clearOldCache({timeDiffToDelete:13824e5}))},u=function(n){if(n){var o=n.meta,t=n.name,r=n.stack,c=e.navigator&&(navigator.connection||navigator.mozConnection||navigator.webkitConnection)||{},s={downlink:c.downlink||"",downlinkMax:c.downlinkMax||"",effectiveType:c.effectiveType||"",rtt:c.rtt||"",saveData:c.saveData||"",type:c.type||""},f=r&&r.message||"",d="/".concat(a.beaconPath,"?err=").concat(t,"&beaconType=wafer_err&info=").concat(escape(JSON.stringify(o)),"&stack=").concat(f,"&connection=").concat(escape(JSON.stringify(s))).concat(i());e.wafer.utils.fireBeacon(d),e.__testError&&(e.__testBeaconUrl=d)}},w=function(){if(f)return!0;window.wafer.on("log",d),window.wafer.on("error",u),f=!0,window.YAHOO&&window.YAHOO.errBeaconConfig&&Object.assign(a,window.YAHOO.errBeaconConfig),"ReportingObserver"in window&&new window.ReportingObserver((function(e,n){for(var o=0;o<e.length;o++){var t=e[o];if(t&&"csp-violation"!==t.type){var r=t.body;r.url=t.url,c("reporting-observer",t.type,{meta:JSON.stringify(r)})}}}),{buffered:!0}).observe()};window.wafer.ready?window.wafer.ready((function(){w()})):window.addEventListener("load",(function(){w()})),e.__testError&&w()}();
"use strict";window.wafer&&window.wafer.ready((function(){window.wafer.on("fetch:success",(function(e){var t=e.elem;if(t){if(t.classList&&(t.classList.contains("collections-view-more")&&(document.documentElement.classList.remove("Reader-closed"),document.documentElement.classList.add("Reader-open"),window.wafer.base.lock(document.getElementById("MainView")),window.scrollTo(0,0)),t.classList.contains("stream-batch-fetch"))){var i=window.rapidPageConfig&&window.rapidPageConfig.rapidConfig&&window.rapidPageConfig.rapidConfig.spaceid;i&&(window._comscore=window._comscore||[],window._comscore.push({c1:2,c2:"7241469",c5:i,c7:document.location.href,c14:window.YAHOO&&window.YAHOO.comscore&&window.YAHOO.comscore.c14||-1}),window.COMSCORE&&window.COMSCORE.purge())}var a=t.getAttribute("data-wf-url");if(a&&a.indexOf("StandAloneVideo")>-1){var r="/p.gif?info=trendingvideofetch&bucket="+(window.rapidPageConfig&&window.rapidPageConfig.rapidConfig||{}).test_id;window.wafer.utils.fireBeacon(r)}}}));var e,t,i,a,r,n,o,s,l,c,d,u="show-drawer",f=null,m=null,w=null,g="wafer-fetch-error",p="wafer-fetch-complete",v="stream-related-drawer",y="StreamRelated",L="tdv2-wafer-stream",A="json",h="wafer-fetch",b="stream-uuid-list",E="userintent-disliked-anim",q="data-uuid",S="youmaylike",N=[],T=document.querySelectorAll(".stream-items"),k=document.querySelector(".stream-ad-fetch"),C=window.innerWidth||document.documentElement.clientWidth,I="js-sponsored-moments-dwell-time",O="userintent-show-reason",R=window.wafer&&window.wafer.utils,U=document.querySelector(".stream-category-filter"),D=document.getElementById("Main"),B=document.getElementById("stream-filter-adpill-upsell-module"),M=!!window.localStorage.streamFilterLoginTooltipLastInteracted,P=!1,_="",V=0;if(U){var x=function(){if(!$())return!1;var e=Date.now();return void 0===window.localStorage.streamFilterLoginTooltipLastInteracted||e>=window.localStorage.streamFilterLoginTooltipLastInteracted+F},H=function(e,t,i){return function(){!e||M&&(!j||j&&V<n)||(U.offsetTop>0?(e.classList.contains("D(n)")&&W&&x()&&z(),e.style.position="fixed",e.style.top=i.classList.contains("ybar-hide-navigation")?"150px":"184px",e.style.left=t,e.classList.add("sticky-active")):(e.style.position="",e.style.bottom="",e.style.top="",e.style.left="",e.classList.remove("sticky-active")))}},W=!1,F=6048e5,j=document.getElementById("streamFilterMaxFilterClicks");j&&(n=Number(j.getAttribute("value"))),e=document.getElementById("stream-category-form"),t=document.getElementById("stream-filter-ad-pill"),"stream-category-filter-btn-",".stream-category-filter-btn-fwd",".stream-category-filter-btn-back",r=document.querySelector(".stream-filter-last-category-tooltip"),i=U.querySelector(".stream-category-filter-btn-fwd"),a=U.querySelector(".stream-category-filter-btn-back");var Y=function(e){if(!P){if(e){var t=document.querySelector(".stream-filter-tooltip");t&&t.classList.add("D(n)")}else{var i=document.querySelector(".stream-filter-tooltip-close");i&&i.click()}P=!0}},$=function(){return _||(_=document.getElementById("stream-filter-login-tooltip")),_},J=function(e){if(!M){var t=$();t&&(t.classList.add("D(n)"),e&&(M=!!window.localStorage.streamFilterLoginTooltipLastInteracted))}},z=function(e){if(x()||!0===e){Y(!0);var t=$();t&&t.classList.remove("D(n)")}},G=function(){document.querySelector(".stream-filter-last-category-tooltip").classList.add("D(n)"),r.classList.remove("tooltip-pointer-right")},K=function(){Y(),G();var t=Math.ceil(100*e.scrollLeft/(e.scrollWidth-e.clientWidth));i.style.color=t>=100?"#ccc":"#7e1fff",0===t&&(a.style.display="none"),t>0&&(a.style.display="block",a.classList.remove("D(n)"))},X=function(){B&&(B.classList.add("D(n)"),B.classList.remove("tooltip-pointer-right"))},Q=function(t,i){if(i&&D){var a=document.querySelector(t);if(a){var r="#stream-filter-adpill-upsell-module"===t?490:318,n=0,o=i.offsetLeft-e.scrollLeft-64+i.offsetWidth/2;o+r>D.offsetWidth&&(n=r-100,a.classList.add("tooltip-pointer-right")),a.style.left=o-n+"px",a.classList.remove("D(n)")}}},Z=[];(x()||j)&&(o=$(),s=document.getElementById("atomic"),l=document.querySelector(".stream-with-filters"),c=l.getClientRects(),d=Math.abs(.5*l.offsetWidth+c[0].left),"function"==typeof requestAnimationFrame?window.wafer.on("scroll",(function(){var e=d-document.documentElement.scrollLeft+"px";requestAnimationFrame(H(o,e,s))})):window.wafer.on("scroll",window.wafer.utils.throttle(H(o,d,s)),16)),U&&e&&(U.addEventListener("click",(function(i){var a=i.target;if(a&&"BUTTON"===a.tagName)a.classList.contains("stream-category-filter-btn-fwd")&&(e.scrollLeft+=500),a.classList.contains("stream-category-filter-btn-back")&&(e.scrollLeft-=500),setTimeout((function(){K()}),500),J(!0),G(),Y();else if(a&&a.classList&&a.classList.contains("stream-cat-adpill-input"))B&&B.classList.contains("D(n)")?(ee(),t&&Q("#stream-filter-adpill-upsell-module",t.parentNode)):X();else if(a&&a.classList&&a.classList.contains("stream-cat-input")){if(V++,a.parentNode.setAttribute("aria-selected",a.checked),j&&V>n){i.preventDefault(),z(!0);var r=a.getAttribute("data-display-name");return void window.rapidInstance.beaconClick("strm",r,0,{elm:"filter-prevented",itc:1})}var o=e.querySelectorAll(".stream-cat-input:checked");if(o&&o.length<=0)i.preventDefault(),setTimeout((function(){var t=e.querySelectorAll(".stream-cat-input:checked")[0],i=t&&t.getAttribute("id");i&&function(t){if(t){Z.forEach((function(e){clearTimeout(e)}));var i=e&&e.querySelector("#"+t);i&&Q(".stream-filter-last-category-tooltip",i.parentNode),Z.push(setTimeout(G,1e4))}}(i),J(!1)}),0);else{if(a&&a.type&&"checkbox"===a.type.toLowerCase()){var s=a.getAttribute("data-display-name");window.rapidInstance.beaconClick("strm",s,0,{elm:a.checked?"filter-include":"filter-exclude",itc:1})}G()}}})),e.addEventListener("scroll",(function(e){window.requestAnimationFrame((function(){K(),X()}))})),e.addEventListener("customValidate",(function(t){var i=(e&&e.querySelectorAll(".stream-cat-input:checked").length)>0,a=new CustomEvent("customValidateStatus",{detail:{success:i}});e&&e.dispatchEvent(a)}),!1),e.addEventListener("keydown",(function(e){var t=e.target;if(e&&"Enter"===e.key&&t&&t.classList.contains("stream-filter-display-name")){var i=document.getElementById(t.getAttribute("data-cat-input-id"));i&&i.click()}})),window.wafer.on("fetch:success",(function(e){if(e.elem&&e.elem.classList.contains("stream-tab-contents")){Y();var t=document.querySelector(".alternatenewsstream"),i=(t&&t.offsetTop+t.offsetParent.offsetTop+20||0)+20;t&&window.scrollY>i&&window.scrollTo(0,i-147),U.offsetTop>0&&z(),W=!0,(T=t.querySelectorAll(".stream-items"))&&T.length&&ae()}})),setTimeout((function(){Q(".stream-filter-tooltip",U.querySelector(".stream-filter-point-tooltip-here"))}),0));var ee=function(){var e=t.classList&&t.classList.contains("stream-cat-adpill-selected")?"filter-exclude":"filter-include";window.rapidInstance&&window.rapidInstance.beaconLinkViews([{_links:[{elm:e,itc:"1",slk:"Ads"}],sec:"strm"}])};t&&ee()}var te=function e(t){var i=Math.floor(16*C/9),a=t.querySelector("#defaultRESERVEMOMENTS"),r=a&&a.getAttribute("data-html");if(r){var n=window.DARLA.prefetched();if(window.DARLA.inProgress()||n&&0!==n.length)setTimeout((function(){e(t)}),500);else{var o={dest:"defaultRESERVEMOMENTS",flex:{h:{min:i},w:{min:C}},h:i,id:"RESERVEMOMENTS",supports:{"exp-ovr":1,"exp-push":1,"resize-to":1},w:C};window.DARLA.addPos(o);var s=new window.DARLA.Response("RESERVEMOMENTS",{});r=unescape(r),s.add("RESERVEMOMENTS",r),window.DARLA.render(s)}}},ie={};function ae(){T.forEach((function(e){if(e.addEventListener("animationend",(function(e){var t=e&&e.target;e&&t&&("hideStreamItem"===e.animationName||"fadeOutAdConfirm"===e.animationName)&&(t.classList.contains("ad-feedback-options")||(t.classList.contains("give-feedback-screen")?t=window.wafer.utils.findAncestor(t,"stream-item"):t.classList.contains("comm-undo")&&(t=window.wafer.utils.findAncestor(t,"stream-item-card")),t.parentNode&&(window.wafer.base.destroy(t),t.parentNode.removeChild(t))))})),e.addEventListener("click",(function(t){var i=t.target;if(i.classList.contains("userintent-undo")){var a=i.getAttribute("data-wf-toggle-target"),r=e.querySelector(a);if(r){var n=r.getAttribute(q);n&&ie[n]&&clearTimeout(ie[n])}}!function(e){window.location.href.indexOf("functest=1")>-1&&e.preventDefault();var t=e.target;if(!R||!t)return;var i=R.findAncestor(t,"js-content-viewer");if(!i)return;var a=R.findAncestor(i,"stream-cluster-item")||R.findAncestor(i,"js-stream-content");if(!a)return;var r=a.getAttribute("data-uuid");if(r){var n=a&&a.getAttribute("data-parent-uuid");if(f=n&&document.querySelector('li[data-uuid="'+n+'"]')||a,w=f&&f.getElementsByClassName(v)[0]){if(f.classList.contains(u))return;var o=function(){for(var e=Array.prototype.slice.call(document.getElementsByClassName(b)),t=0;t<e.length;t++){var i=e[t],a=i.text;i.classList.remove(b);try{var r=JSON.parse(a);r&&Array.isArray(r.uuidList)&&N.length+r.uuidList.length<=250&&(N=N.concat(r.uuidList))}catch(e){}}return{dedupUuids:N}}(),s={config:{leadItemUuid:n||r},ctrl:y,m_id:L,m_mode:A},l={dedupUuids:o.dedupUuids.join(","),uuid:r},c=w.getAttribute("data-cfg");if(c){var d=a.getAttribute("data-cposy");d=isNaN(d)?null:parseInt(d,10);try{var E=JSON.parse(c);E&&E.i13n&&(m=E.i13n),null!==d&&(E.i13n.cposy=d),s.config=Object.assign(s.config,E)}catch(e){}}var q=w.getAttribute("data-bucket");q&&(s.bucket=q),s.config.ncpParams=s.config.ncpParams||{},s.config.ncpParams.query=s.config.ncpParams.query||{},s.config.ncpParams.query=Object.assign(l,s.config.ncpParams.query);var S=window.wafer.base.state.drawer,T=S&&S.adsToken;T&&(s.config.ncpParams.query.geminiDedupeToken=T),w.setAttribute("data-wf-body",JSON.stringify(s)),w.classList.remove(g,p),w.classList.add(h),window.wafer.base.sync(w.parentNode)}}}(t)})),k&&window.wafer.base&&window.wafer.utils){var t=k.getAttribute("data-wf-url"),i=k.getAttribute("data-wf-state-body");window.wafer.utils.fetchWithCache(t,{body:i,cache:0}).then((function(t){if(t&&t.html){k.innerHTML=t.html;var i=k.querySelectorAll(".stream-ad"),a=k.getElementsByClassName("wafer-state")[0],r=e.querySelectorAll(".stream-ad-placeholder");if(i&&r)for(var n=i.length,o=r.length,s=0;s<o&&s<n;s++)r[s].replaceWith(i[s]);k.innerHTML="",a&&k.appendChild(a),window.wafer.base.sync(e)}}))}var a=e.querySelectorAll("."+I+", ."+I+"-mon");if(a.length){a.forEach((function(e){e.classList&&e.classList.contains("js-reserve-moments")&&(window.DARLA?te(e):e.style.display="none")}));var r=a[0].querySelector(".js-panorama-scroll-view");r&&0===r.scrollLeft&&(r.scrollLeft=(r.scrollWidth-C)/2)}}))}if(T&&T.length){ae();var re,ne,oe=document.getElementById("scrollable-smad"),se=document.getElementById("scrollable-video"),le=window.innerHeight||document.documentElement.clientHeight,ce={},de=function(e){return e&&(e=(e=(e=(e=(e=(e=e.replace(/\$\(V_AUTOPLAYED\)/,!1)).replace(/\$\(V_PLAYER_WIDTH\)/,oe.clientHeight)).replace(/\$\(V_PLAYER_HEIGHT\)/,oe.clientWidth)).replace(/\$\(V_SKIP_AVAIL\)/,!1)).replace(/\$\(V_EXPANDED\)/,!1)).replace(/\$\(V_AUD_INFO\)/,2)),e};if(oe){var ue=oe.getBoundingClientRect();re=ue.top-le,ne=ue.bottom-re,ce.startActionUrl=oe.getAttribute("data-video-quartile-start"),ce.quartileActionUrl25=oe.getAttribute("data-video-quartile-25"),ce.quartileActionUrl50=oe.getAttribute("data-video-quartile-50"),ce.quartileActionUrl75=oe.getAttribute("data-video-quartile-75"),ce.quartileActionUrl100=oe.getAttribute("data-video-quartile-100")}oe&&se&&window.addEventListener("scroll",window.wafer.utils.throttle((function(){var e=se&&se.duration,t=oe.getBoundingClientRect();if(t.top<le&&t.bottom>0){se.currentTime=(window.pageYOffset-re)*e/ne;var i=(le-t.top)/le*100;(i=5*Math.ceil(i/5))>=100&&ce.quartileActionUrl100?(window.wafer.utils.fireBeacon(de(ce.quartileActionUrl100),{useNavigator:!1}),ce.quartileActionUrl100=null):i>=75&&ce.quartileActionUrl75?(window.wafer.utils.fireBeacon(de(ce.quartileActionUrl75),{useNavigator:!1}),ce.quartileActionUrl75=null):i>=50&&ce.quartileActionUrl50?(window.wafer.utils.fireBeacon(de(ce.quartileActionUrl50),{useNavigator:!1}),ce.quartileActionUrl50=null):i>=25&&ce.quartileActionUrl25?(window.wafer.utils.fireBeacon(de(ce.quartileActionUrl25),{useNavigator:!1}),ce.quartileActionUrl25=null):i>=5&&ce.startActionUrl&&(window.wafer.utils.fireBeacon(de(ce.startActionUrl),{useNavigator:!1}),ce.startActionUrl=null)}}),16))}window.addEventListener("viewerClosed",(function(){if(f&&!f.classList.contains(u)){var e=w&&!!w.getElementsByClassName("stream-realted-list")[0];if(e){f.classList.add("drawer-beacon");var t=f;setTimeout((function(){t.classList.add(u)}),10)}e&&m&&window.rapidInstance&&window.rapidInstance.beaconClick("strm",S,0,Object.assign(m,{_p:0,cnt_tpc:m.categoryLabel,g:f.getAttribute(q),grpt:"storyCluster",itc:1,pkgt:S})),m="",w=null,f=null}}));window.wafer.on("video:adStarted",(function(e){e&&e.elem&&e.elem.parentNode&&e.elem.parentNode.classList&&e.elem.parentNode.classList.contains("stream-video-ad-v2")&&e.elem.parentNode.classList.remove("video-endcard")})),window.wafer.on("video:adEnded",(function(e){e&&e.elem&&e.elem.parentNode&&e.elem.parentNode.classList&&e.elem.parentNode.classList.contains("stream-video-ad-v2")&&e.elem.parentNode.classList.add("video-endcard")}));window.wafer.on("toggle:change",(function(e){if(e&&e.meta&&e.elem){var t=e.elem,i=t.getAttribute("data-wf-toggle-target");if("userintent-hidestrmitem"===e.meta.className&&"add"===e.meta.action&&T&&T.length)T.forEach((function(e){if(i&&e){var t=e.querySelector(i),a=t&&t.getAttribute(q);a&&(ie[a]=setTimeout((r=t,function(){r.classList.contains(E)||r.classList.add(E)}),8e3))}var r}));else if("show-drawer"===e.meta.className)T&&T.length&&T.forEach((function(e){var t=e.querySelector(i),a=t&&t.getElementsByClassName("drawer-fetch-target")[0];setTimeout((function(){a&&(a.innerHTML="")}),300)}));else if("userintent-show"===e.meta.className&&t){var a=window.wafer.utils.findAncestor(t,"stream-item");if(!a)return;"add"===e.meta.action?(a.classList.add(O),window.rapidInstance&&window.rapidInstance.reevaluateModulesViewability(a)):"remove"===e.meta.action&&a.classList.remove(O)}else e.elem&&e.elem.classList.contains("stream-filter-login-tooltip-close")&&(window.localStorage.streamFilterLoginTooltipLastInteracted=Date.now())}}))}));
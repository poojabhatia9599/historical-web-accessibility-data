"use strict";window.wafer&&window.wafer.ready((function(){window.wafer.on("fetch:success",(function(e){var t=e.elem;if(t){if(t.classList&&(t.classList.contains("collections-view-more")&&(document.documentElement.classList.remove("Reader-closed"),document.documentElement.classList.add("Reader-open"),window.wafer.base.lock(document.getElementById("MainView")),window.scrollTo(0,0)),t.classList.contains("stream-batch-fetch"))){var i=window.rapidPageConfig&&window.rapidPageConfig.rapidConfig&&window.rapidPageConfig.rapidConfig.spaceid;i&&(window._comscore=window._comscore||[],window._comscore.push({c1:2,c2:"7241469",c5:i,c7:document.location.href,c14:window.YAHOO&&window.YAHOO.comscore&&window.YAHOO.comscore.c14||-1}),window.COMSCORE&&window.COMSCORE.purge())}var a=t.getAttribute("data-wf-url");if(a&&a.indexOf("StandAloneVideo")>-1){var r="/p.gif?info=trendingvideofetch&bucket="+(window.rapidPageConfig&&window.rapidPageConfig.rapidConfig||{}).test_id;B.fireBeacon(r)}}}));var e,t,i,a,r,n,o,s,l,c=document.getElementById("atomic"),d="show-drawer",u=null,m=null,f=null,w="wafer-fetch-error",g="wafer-fetch-complete",p="stream-related-drawer",v="StreamRelated",y="tdv2-wafer-stream",L="json",A="wafer-fetch",h="stream-uuid-list",E="userintent-disliked-anim",b="data-uuid",q="youmaylike",S=[],N=document.querySelectorAll(".stream-items"),T=document.querySelector(".stream-ad-fetch"),k=window.innerWidth||document.documentElement.clientWidth,I="js-sponsored-moments-dwell-time",C="userintent-show-reason",B=window.wafer&&window.wafer.utils,O=document.querySelector(".stream-category-filter"),R=document.getElementById("Main")||document.getElementById("main-0-StreamGrid-Proxy"),U=document.getElementById("stream-filter-adpill-upsell-module"),D="#stream-filter-adpill-upsell-module",M=0,P=!!window.localStorage.streamFilterLoginTooltipLastInteracted,x=!1,V="",_=0,F=!!document.getElementById("nextgen-desktop");if(O){var W=function(){if(!J())return!1;var e=Date.now();return void 0===window.localStorage.streamFilterLoginTooltipLastInteracted||e>=window.localStorage.streamFilterLoginTooltipLastInteracted+Y},j=function(e,t,i){return function(){if(e){var a=e===U,r=e&&"stream-redisc-tooltip"===e.id;if(r||a||e&&(!P||$&&!($&&_<o)))if(O.offsetTop>0){e.classList.contains("D(n)")&&z&&W()&&X();var n=t;Object.assign(e.style,{position:"fixed",top:i.classList.contains("ybar-hide-navigation")?"150px":"184px"}),a&&(n=M-document.documentElement.scrollLeft),e.style.left=n+"px",e.classList.add("sticky-active")}else{if(Object.assign(e.style,{bottom:"",position:"",top:""}),a||r){var s=a?M:t;e.style.left=s-R.offsetLeft+"px"}else e.style.left="";e.classList.remove("sticky-active")}}}},H=function(e,t,i,a){if(e){var r=l.getClientRects(),n=void 0!==a?a+r[0].left:Math.abs(.5*l.offsetWidth+r[0].left);"function"==typeof requestAnimationFrame?window.wafer.on("scroll",(function(){var i=n-document.documentElement.scrollLeft;requestAnimationFrame(j(e,i,t))})):window.wafer.on("scroll",B.throttle(j(e,n,t)),16),i&&j(e,n,t)()}},z=!1,Y=6048e5,$=document.getElementById("streamFilterMaxFilterClicks");$&&(o=Number($.getAttribute("value"))),l=document.querySelector(".stream-with-filters"),e=document.getElementById("stream-category-form"),t=document.getElementById("stream-filter-ad-pill"),s=document.querySelector(".alternatenewsstream")||document.getElementById("main-0-StreamGrid-Proxy"),"stream-category-filter-btn-",".stream-category-filter-btn-fwd",".stream-category-filter-btn-back",n=document.querySelector(".stream-filter-last-category-tooltip"),i=O.querySelector(".stream-category-filter-btn-fwd"),a=i&&i.querySelector("svg"),r=O.querySelector(".stream-category-filter-btn-back");var G=function(e){if(!x){if(e){var t=document.querySelector(".stream-filter-tooltip");t&&t.classList.add("D(n)")}else{var i=document.querySelector(".stream-filter-tooltip-close");i&&i.click()}x=!0}},J=function(){return V||(V=document.getElementById("stream-filter-login-tooltip")),V},K=function(e){if(!P){var t=J();t&&(t.classList.add("D(n)"),e&&(P=!!window.localStorage.streamFilterLoginTooltipLastInteracted))}},X=function(e){if(W()||!0===e){G(!0);var t=J();t&&t.classList.remove("D(n)")}},Q=function(){document.querySelector(".stream-filter-last-category-tooltip").classList.add("D(n)"),n.classList.remove("tooltip-pointer-right")},Z=function(){G(),Q();var t=Math.ceil(100*e.scrollLeft/(e.scrollWidth-e.clientWidth));t>=100?a&&a.style.setProperty("fill","#ccc","important"):a&&a.style.setProperty("fill","#6e7780",""),0===t&&(r.style.display="none"),t>0&&(r.style.display="block",r.classList.remove("D(n)"))},ee=function e(){U&&(U.classList.add("D(n)"),U.classList.remove("tooltip-pointer-right")),window.removeEventListener("resize",e)},te=function(t,i){if(i&&R){var a=document.querySelector(t),r=t===D,n=a&&a.classList.contains("stream-redisc-tooltip");if(a){var o=r?490:a.offsetWidth,s=n?128:64,l=0,c=i.offsetLeft-e.scrollLeft-s+i.offsetWidth/2;c+o>R.offsetWidth&&(l=o-100,a.classList.add("tooltip-pointer-right")),r&&(M=R.offsetLeft+c-l),a.style.left=r&&a.classList.contains("sticky-active")?M+"px":c-l+"px",a.classList.remove("D(n)")}}},ie=[],ae=!1,re=function(e){var t=e.target,i=t&&t.getAttribute("data-redisc-cat-selector");if(i){var a=O.querySelectorAll(i);B.convertNodeListToArray(a).forEach((function(e){e.classList.remove("stream-filter-semi-select");var t=e.querySelector("input");t&&t.click()}))}};(W()||$)&&H(J(),c),H(U,c),O&&e&&(O.addEventListener("click",(function(i){var a=i.target;if(a&&"BUTTON"===a.tagName)a.classList.contains("stream-category-filter-btn-fwd")&&(e.scrollLeft+=500),a.classList.contains("stream-category-filter-btn-back")&&(e.scrollLeft-=500),setTimeout((function(){Z()}),500),K(!0),Q(),G();else if(a&&a.classList&&a.classList.contains("stream-cat-adpill-input"))t&&te(D,t.parentNode),window.addEventListener("resize",B.debounce(ee,100));else if(a&&a.classList&&a.classList.contains("stream-cat-input")){if(_++,a.parentNode.setAttribute("aria-selected",a.checked),$&&_>o){i.preventDefault(),X(!0);var r=a.getAttribute("data-display-name");return void window.rapidInstance.beaconClick("strm",r,0,{elm:"filter-prevented",itc:1})}var n=e.querySelectorAll(".stream-cat-input:checked");if(n&&n.length<=0)i.preventDefault(),setTimeout((function(){var t=e.querySelectorAll(".stream-cat-input:checked")[0],i=t&&t.getAttribute("id");i&&function(t){if(t){B.convertNodeListToArray(ie).forEach((function(e){clearTimeout(e)}));var i=e&&e.querySelector("#"+t);i&&te(".stream-filter-last-category-tooltip",i.parentNode),ie.push(setTimeout(Q,1e4))}}(i),K(!1)}),0);else{if(a&&a.type&&"checkbox"===a.type.toLowerCase()){var s=a.getAttribute("data-display-name");window.rapidInstance.beaconClick("strm",s,0,{elm:a.checked?"filter-include":"filter-exclude",itc:1})}Q()}}})),e.addEventListener("scroll",(function(e){window.requestAnimationFrame((function(){Z(),ee()}))})),e.addEventListener("customValidate",(function(t){var i=(e&&e.querySelectorAll(".stream-cat-input:checked").length)>0,a=new CustomEvent("customValidateStatus",{detail:{success:i}});e&&e.dispatchEvent(a)}),!1),e.addEventListener("keydown",(function(e){var t=e.target;if(e&&"Enter"===e.key&&t&&t.classList.contains("stream-filter-display-name")){var i=document.getElementById(t.getAttribute("data-cat-input-id"));i&&i.click()}})),window.wafer.on("fetch:success",(function(e){if(e.elem&&e.elem.classList.contains("stream-tab-contents"))return G(),t=!!document.querySelector(".ntktdv2"),i=t?20:0,a=t?147:0,r=(s&&s.offsetTop+s.offsetParent.offsetTop+i||0)+i,s&&window.scrollY>r&&window.scrollTo(0,r-a),O.offsetTop>0&&X(),z=!0,void((N=s&&s.querySelectorAll(".stream-items"))&&N.length&&se());var t,i,a,r;if(e.meta&&e.meta.targetElem&&e.meta.targetElem.classList.contains("catredisc-tooltip-holder")){var n=document.getElementById("stream-redisc-tooltip");if(n){var o=n.getAttribute("data-point-at-id");o&&te("#stream-redisc-tooltip",document.getElementById(o).parentNode),setTimeout((function(){H(n,c,!0,n.offsetLeft)}),8),n.addEventListener("click",re)}}if(e.meta&&e.meta.targetElem&&"wf-stream-item-rediscovery"===e.meta.targetElem.id){var l,d=!1,u=function(){if(!d){ae=!0;var e=document.getElementById("stream-filter-rediscovery");if(e){var t=B.elementInView(e,{},window.wafer.base.viewport),i=e.getBoundingClientRect();if(t&&!l&&(l=i.top),t&&l){var a=Math.abs(l-i.top);if(i.top<l&&a>740){var r=document.querySelector(".stream-redisc-mask");r.classList.add("Op(0)"),setTimeout((function(){r.classList.add("D(n)"),d=!0}),800)}}}}};!ae&&window.wafer.on("scroll",(function(){"function"==typeof requestAnimationFrame?requestAnimationFrame(u):B.throttle(u,16)}))}})),setTimeout((function(){te(".stream-filter-tooltip",O.querySelector(".stream-filter-point-tooltip-here"))}),0))}var ne=function e(t){var i=Math.floor(16*k/9),a=t.querySelector("#defaultRESERVEMOMENTS"),r=a&&a.getAttribute("data-html");if(r){var n=window.DARLA.prefetched();if(window.DARLA.inProgress()||n&&0!==n.length)setTimeout((function(){e(t)}),500);else{var o={dest:"defaultRESERVEMOMENTS",flex:{h:{min:i},w:{min:k}},h:i,id:"RESERVEMOMENTS",supports:{"exp-ovr":1,"exp-push":1,"resize-to":1},w:k};window.DARLA.addPos(o);var s=new window.DARLA.Response("RESERVEMOMENTS",{});r=unescape(r),s.add("RESERVEMOMENTS",r),window.DARLA.render(s)}}},oe={};function se(){B.convertNodeListToArray(N).forEach((function(e){if(F){if(e.classList.contains("stream-items-initialized"))return;e.classList.add("stream-items-initialized")}if(e.addEventListener("animationend",(function(e){var t=e&&e.target;e&&t&&("hideStreamItem"===e.animationName||"fadeOutAdConfirm"===e.animationName)&&(t.classList.contains("ad-feedback-options")||(t.classList.contains("give-feedback-screen")?t=B.findAncestor(t,"stream-item"):t.classList.contains("comm-undo")&&(t=B.findAncestor(t,"stream-item-card")),t.parentNode&&(window.wafer.base.destroy(t),t.parentNode.removeChild(t))))})),e.addEventListener("click",(function(t){var i=t.target;if(i.classList.contains("userintent-undo")){var a=i.getAttribute("data-wf-toggle-target"),r=e.querySelector(a);if(r){var n=r.getAttribute(b);n&&oe[n]&&clearTimeout(oe[n])}}!function(e){window.location.href.indexOf("functest=1")>-1&&e.preventDefault();var t=e.target;if(!B||!t)return;var i=B.findAncestor(t,"js-content-viewer");if(!i)return;var a=B.findAncestor(i,"stream-cluster-item")||B.findAncestor(i,"js-stream-content");if(!a)return;var r=a.getAttribute("data-uuid");if(r){var n=a&&a.getAttribute("data-parent-uuid");if(u=n&&document.querySelector('li[data-uuid="'+n+'"]')||a,f=u&&u.getElementsByClassName(p)[0]){if(u.classList.contains(d))return;var o=function(){for(var e=Array.prototype.slice.call(document.getElementsByClassName(h)),t=0;t<e.length;t++){var i=e[t],a=i.text;i.classList.remove(h);try{var r=JSON.parse(a);r&&Array.isArray(r.uuidList)&&S.length+r.uuidList.length<=250&&(S=S.concat(r.uuidList))}catch(e){}}return{dedupUuids:S}}(),s={config:{leadItemUuid:n||r},ctrl:v,m_id:y,m_mode:L},l={dedupUuids:o.dedupUuids.join(","),uuid:r},c=f.getAttribute("data-cfg");if(c){var E=a.getAttribute("data-cposy");E=isNaN(E)?null:parseInt(E,10);try{var b=JSON.parse(c);b&&b.i13n&&(m=b.i13n),null!==E&&(b.i13n.cposy=E),s.config=Object.assign(s.config,b)}catch(e){}}var q=f.getAttribute("data-bucket");q&&(s.bucket=q),s.config.ncpParams=s.config.ncpParams||{},s.config.ncpParams.query=s.config.ncpParams.query||{},s.config.ncpParams.query=Object.assign(l,s.config.ncpParams.query);var N=window.wafer.base.state.drawer,T=N&&N.adsToken;T&&(s.config.ncpParams.query.geminiDedupeToken=T),f.setAttribute("data-wf-body",JSON.stringify(s)),f.classList.remove(w,g),f.classList.add(A),window.wafer.base.sync(f.parentNode)}}}(t)})),T&&window.wafer.base&&B){var t=T.getAttribute("data-wf-url"),i=T.getAttribute("data-wf-state-body");B.fetchWithCache(t,{body:i,cache:0}).then((function(t){if(t&&t.html){T.innerHTML=t.html;var i=T.querySelectorAll(".stream-ad"),a=T.getElementsByClassName("wafer-state")[0],r=e.querySelectorAll(".stream-ad-placeholder");if(i&&r)for(var n=i.length,o=r.length,s=0;s<o&&s<n;s++)r[s].replaceWith(i[s]);T.innerHTML="",a&&T.appendChild(a),window.wafer.base.sync(e)}}))}var a=e.querySelectorAll("."+I+", ."+I+"-mon");if(a.length){wafer.utils.convertNodeListToArray(a).forEach((function(e){e.classList&&e.classList.contains("js-reserve-moments")&&(window.DARLA?ne(e):e.style.display="none")}));var r=a[0].querySelector(".js-panorama-scroll-view");r&&0===r.scrollLeft&&(r.scrollLeft=(r.scrollWidth-k)/2)}}))}if(N&&N.length){se();var le,ce,de=document.getElementById("scrollable-smad"),ue=document.getElementById("scrollable-video"),me=window.innerHeight||document.documentElement.clientHeight,fe={},we=function(e){return e&&(e=(e=(e=(e=(e=(e=e.replace(/\$\(V_AUTOPLAYED\)/,!1)).replace(/\$\(V_PLAYER_WIDTH\)/,de.clientHeight)).replace(/\$\(V_PLAYER_HEIGHT\)/,de.clientWidth)).replace(/\$\(V_SKIP_AVAIL\)/,!1)).replace(/\$\(V_EXPANDED\)/,!1)).replace(/\$\(V_AUD_INFO\)/,2)),e};if(de){var ge=de.getBoundingClientRect();le=ge.top-me,ce=ge.bottom-le,fe.startActionUrl=de.getAttribute("data-video-quartile-start"),fe.quartileActionUrl25=de.getAttribute("data-video-quartile-25"),fe.quartileActionUrl50=de.getAttribute("data-video-quartile-50"),fe.quartileActionUrl75=de.getAttribute("data-video-quartile-75"),fe.quartileActionUrl100=de.getAttribute("data-video-quartile-100")}de&&ue&&window.addEventListener("scroll",B.throttle((function(){var e=ue&&ue.duration,t=de.getBoundingClientRect();if(t.top<me&&t.bottom>0){ue.currentTime=(window.pageYOffset-le)*e/ce;var i=(me-t.top)/me*100;(i=5*Math.ceil(i/5))>=100&&fe.quartileActionUrl100?(B.fireBeacon(we(fe.quartileActionUrl100),{useNavigator:!1}),fe.quartileActionUrl100=null):i>=75&&fe.quartileActionUrl75?(B.fireBeacon(we(fe.quartileActionUrl75),{useNavigator:!1}),fe.quartileActionUrl75=null):i>=50&&fe.quartileActionUrl50?(B.fireBeacon(we(fe.quartileActionUrl50),{useNavigator:!1}),fe.quartileActionUrl50=null):i>=25&&fe.quartileActionUrl25?(B.fireBeacon(we(fe.quartileActionUrl25),{useNavigator:!1}),fe.quartileActionUrl25=null):i>=5&&fe.startActionUrl&&(B.fireBeacon(we(fe.startActionUrl),{useNavigator:!1}),fe.startActionUrl=null)}}),16))}window.addEventListener("viewerClosed",(function(){if(u&&!u.classList.contains(d)){var e=f&&!!f.getElementsByClassName("stream-realted-list")[0];if(e){u.classList.add("drawer-beacon");var t=u;setTimeout((function(){t.classList.add(d)}),10)}e&&m&&window.rapidInstance&&window.rapidInstance.beaconClick("strm",q,0,Object.assign(m,{_p:0,cnt_tpc:m.categoryLabel,g:u.getAttribute(b),grpt:"storyCluster",itc:1,pkgt:q})),m="",f=null,u=null}}));window.wafer.on("video:adStarted",(function(e){e&&e.elem&&e.elem.parentNode&&e.elem.parentNode.classList&&e.elem.parentNode.classList.contains("stream-video-ad-v2")&&e.elem.parentNode.classList.remove("video-endcard")})),window.wafer.on("video:adEnded",(function(e){e&&e.elem&&e.elem.parentNode&&e.elem.parentNode.classList&&e.elem.parentNode.classList.contains("stream-video-ad-v2")&&e.elem.parentNode.classList.add("video-endcard")}));window.wafer.on("toggle:change",(function(e){if(e&&e.meta&&e.elem){var t=e.elem,i=t.getAttribute("data-wf-toggle-target");if("userintent-hidestrmitem"===e.meta.className&&"add"===e.meta.action&&N&&N.length)wafer.utils.convertNodeListToArray(N).forEach((function(e){if(i&&e){var t=e.querySelector(i),a=t&&t.getAttribute(b);a&&(oe[a]=setTimeout((r=t,function(){r.classList.contains(E)||r.classList.add(E)}),8e3))}var r}));else if("show-drawer"===e.meta.className)N&&N.length&&wafer.utils.convertNodeListToArray(N).forEach((function(e){var t=e.querySelector(i),a=t&&t.getElementsByClassName("drawer-fetch-target")[0];setTimeout((function(){a&&(a.innerHTML="")}),300)}));else if("userintent-show"===e.meta.className&&t){var a=B.findAncestor(t,"stream-item");if(!a)return;"add"===e.meta.action?(a.classList.add(C),window.rapidInstance&&window.rapidInstance.reevaluateModulesViewability(a)):"remove"===e.meta.action&&a.classList.remove(C)}else e.elem&&e.elem.classList.contains("stream-filter-login-tooltip-close")&&(window.localStorage.streamFilterLoginTooltipLastInteracted=Date.now())}})),F&&!window.waferStreamInitialized&&(window.waferStreamInitialized=!0,window.wafer.on("fetch:success",(function(e){e&&e.meta&&e.meta.data&&e.meta.data.html&&e.meta.data.html.indexOf("stream-items")>=0&&(N=document.querySelectorAll(".stream-items"))&&N.length&&se()})),window.wafer.on("module:removed",(function(e){if(e&&e.elem){var t=e.elem.getElementsByClassName(".stream-items-initialized");t&&t.length&&(N=document.querySelectorAll(".stream-items"))}})))}));
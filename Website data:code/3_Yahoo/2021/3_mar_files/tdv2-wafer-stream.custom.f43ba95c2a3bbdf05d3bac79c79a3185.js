"use strict";window.wafer&&window.wafer.ready((function(){window.wafer.on("fetch:success",(function(e){var t=e.elem;if(t){if(t.classList&&(t.classList.contains("collections-view-more")&&(document.documentElement.classList.remove("Reader-closed"),document.documentElement.classList.add("Reader-open"),window.wafer.base.lock(document.getElementById("MainView")),window.scrollTo(0,0)),t.classList.contains("stream-batch-fetch"))){var i=window.rapidPageConfig&&window.rapidPageConfig.rapidConfig&&window.rapidPageConfig.rapidConfig.spaceid;i&&(window._comscore=window._comscore||[],window._comscore.push({c1:2,c2:"7241469",c5:i,c7:document.location.href,c14:window.YAHOO&&window.YAHOO.comscore&&window.YAHOO.comscore.c14||-1}),window.COMSCORE&&window.COMSCORE.purge())}var a=t.getAttribute("data-wf-url");if(a&&a.indexOf("StandAloneVideo")>-1){var r="/p.gif?info=trendingvideofetch&bucket="+(window.rapidPageConfig&&window.rapidPageConfig.rapidConfig||{}).test_id;window.wafer.utils.fireBeacon(r)}}}));var e,t,i,a,r,n,o,s,l,c="show-drawer",d=null,u=null,f=null,w="wafer-fetch-error",m="wafer-fetch-complete",g="stream-related-drawer",p="StreamRelated",v="tdv2-wafer-stream",y="json",A="wafer-fetch",h="stream-uuid-list",L="userintent-disliked-anim",b="data-uuid",E="youmaylike",q=[],S=document.querySelectorAll(".stream-items"),T=document.querySelector(".stream-ad-fetch"),N=window.innerWidth||document.documentElement.clientWidth,C="js-sponsored-moments-dwell-time",O="userintent-show-reason",k=window.wafer&&window.wafer.utils,R=document.querySelector(".stream-category-filter"),U=!!window.localStorage.streamFilterLoginTooltipLastInteracted,I=!1,D="";if(R){var M=function(){if(!x())return!1;var e=Date.now();return void 0===window.localStorage.streamFilterLoginTooltipLastInteracted||e>=window.localStorage.streamFilterLoginTooltipLastInteracted+_},B=function(e,t,i){return function(){e&&!U&&(R.offsetTop>0?(e.classList.contains("D(n)")&&P&&M()&&W(),e.style.position="fixed",e.style.top=i.classList.contains("ybar-hide-navigation")?"150px":"184px",e.style.left=t,e.classList.add("sticky-active")):(e.style.position="",e.style.bottom="",e.style.top="",e.style.left="",e.classList.remove("sticky-active")))}},P=!1,_=6048e5;e=document.getElementById("stream-category-form"),"stream-category-filter-btn-",".stream-category-filter-btn-fwd",".stream-category-filter-btn-back",a=document.querySelector(".stream-filter-last-category-tooltip"),t=R.querySelector(".stream-category-filter-btn-fwd"),i=R.querySelector(".stream-category-filter-btn-back");var V=function(e){if(!I){if(e){var t=document.querySelector(".stream-filter-tooltip");t&&t.classList.add("D(n)")}else{var i=document.querySelector(".stream-filter-tooltip-close");i&&i.click()}I=!0}},x=function(){return D||(D=document.getElementById("stream-filter-login-tooltip")),D},H=function(e){if(!U){var t=x();t&&(t.classList.add("D(n)"),e&&(U=!!window.localStorage.streamFilterLoginTooltipLastInteracted))}},W=function(){if(M()){V(!0);var e=x();e&&e.classList.remove("D(n)")}},j=function(){document.querySelector(".stream-filter-last-category-tooltip").classList.add("D(n)"),a.classList.remove("tooltip-pointer-right")},F=function(){V(),j();var a=Math.ceil(100*e.scrollLeft/(e.scrollWidth-e.clientWidth));t.style.color=a>=100?"#ccc":"#7e1fff",0===a&&(i.style.display="none"),a>0&&(i.style.display="block",i.classList.remove("D(n)"))},Y=function(t,i){if(i){var r=document.querySelector(t);if(r){var n=0;Array.prototype.indexOf.call(i.parentNode.children,i)>8&&(n=235,a.classList.add("tooltip-pointer-right")),r.style.left=i.offsetLeft-e.scrollLeft-64-n+i.offsetWidth/2+"px",r.classList.remove("D(n)")}}},$=[];M()&&(r=x(),n=document.getElementById("atomic"),o=document.querySelector(".stream-with-filters"),s=o.getClientRects(),l=Math.abs(.5*o.offsetWidth+s[0].left)+"px","function"==typeof requestAnimationFrame?window.wafer.on("scroll",(function(){requestAnimationFrame(B(r,l,n))})):window.wafer.on("scroll",window.wafer.utils.throttle(B(r,l,n)),16)),R&&e&&(R.addEventListener("click",(function(t){var i=t.target;if(i&&"BUTTON"===i.tagName)i.classList.contains("stream-category-filter-btn-fwd")&&(e.scrollLeft+=500),i.classList.contains("stream-category-filter-btn-back")&&(e.scrollLeft-=500),setTimeout((function(){F()}),500),H(!0),j(),V();else if(i&&i.classList&&i.classList.contains("stream-cat-input")){var a=e.querySelectorAll(".stream-cat-input:checked");if(a&&a.length<=0)t.preventDefault(),setTimeout((function(){var t=e.querySelectorAll(".stream-cat-input:checked")[0],i=t&&t.getAttribute("id");i&&function(t){if(t){$.forEach((function(e){clearTimeout(e)}));var i=e&&e.querySelector("#"+t);i&&Y(".stream-filter-last-category-tooltip",i.parentNode),$.push(setTimeout(j,1e4))}}(i),H(!1)}),0);else{if(i&&i.type&&"checkbox"===i.type.toLowerCase()){var r=i.getAttribute("data-display-name");window.rapidInstance.beaconClick("strm",r,0,{elm:i.checked?"filter-include":"filter-exclude",itc:1})}j()}}})),e.addEventListener("scroll",(function(e){window.requestAnimationFrame(F)})),e.addEventListener("customValidate",(function(t){var i=(e&&e.querySelectorAll(".stream-cat-input:checked").length)>0,a=new CustomEvent("customValidateStatus",{detail:{success:i}});e&&e.dispatchEvent(a)}),!1),window.wafer.on("fetch:success",(function(e){if(e.elem&&e.elem.classList.contains("stream-tab-contents")){V();var t=document.querySelector(".alternatenewsstream"),i=(t&&t.offsetTop+t.offsetParent.offsetTop+20||0)+20;t&&window.scrollY>i&&window.scrollTo(0,i),R.offsetTop>0&&W(),P=!0}})),setTimeout((function(){Y(".stream-filter-tooltip",R.querySelector(".stream-filter-point-tooltip-here"))}),0))}var J=function e(t){var i=Math.floor(16*N/9),a=t.querySelector("#defaultRESERVEMOMENTS"),r=a&&a.getAttribute("data-html");if(r){var n=window.DARLA.prefetched();if(window.DARLA.inProgress()||n&&0!==n.length)setTimeout((function(){e(t)}),500);else{var o={dest:"defaultRESERVEMOMENTS",flex:{h:{min:i},w:{min:N}},h:i,id:"RESERVEMOMENTS",supports:{"exp-ovr":1,"exp-push":1,"resize-to":1},w:N};window.DARLA.addPos(o);var s=new window.DARLA.Response("RESERVEMOMENTS",{});r=unescape(r),s.add("RESERVEMOMENTS",r),window.DARLA.render(s)}}},z={};S&&S.length&&S.forEach((function(e){if(e.addEventListener("animationend",(function(e){var t=e&&e.target;e&&t&&("hideStreamItem"===e.animationName||"fadeOutAdConfirm"===e.animationName)&&(t.classList.contains("ad-feedback-options")||(t.classList.contains("give-feedback-screen")&&(t=window.wafer.utils.findAncestor(t,"stream-item")),t.parentNode&&(window.wafer.base.destroy(t),t.parentNode.removeChild(t))))})),e.addEventListener("click",(function(t){var i=t.target;if(i.classList.contains("userintent-undo")){var a=i.getAttribute("data-wf-toggle-target"),r=e.querySelector(a);if(r){var n=r.getAttribute(b);n&&z[n]&&clearTimeout(z[n])}}!function(e){window.location.href.indexOf("functest=1")>-1&&e.preventDefault();var t=e.target;if(!k||!t)return;var i=k.findAncestor(t,"js-content-viewer");if(!i)return;var a=k.findAncestor(i,"stream-cluster-item")||k.findAncestor(i,"js-stream-content");if(!a)return;var r=a.getAttribute("data-uuid");if(r){var n=a&&a.getAttribute("data-parent-uuid");if(d=n&&document.querySelector('li[data-uuid="'+n+'"]')||a,f=d&&d.getElementsByClassName(g)[0]){if(d.classList.contains(c))return;var o=function(){for(var e=Array.prototype.slice.call(document.getElementsByClassName(h)),t=0;t<e.length;t++){var i=e[t],a=i.text;i.classList.remove(h);try{var r=JSON.parse(a);r&&Array.isArray(r.uuidList)&&q.length+r.uuidList.length<=250&&(q=q.concat(r.uuidList))}catch(e){}}return{dedupUuids:q}}(),s={config:{leadItemUuid:n||r},ctrl:p,m_id:v,m_mode:y},l={dedupUuids:o.dedupUuids.join(","),uuid:r},L=f.getAttribute("data-cfg");if(L){var b=a.getAttribute("data-cposy");b=isNaN(b)?null:parseInt(b,10);try{var E=JSON.parse(L);E&&E.i13n&&(u=E.i13n),null!==b&&(E.i13n.cposy=b),s.config=Object.assign(s.config,E)}catch(e){}}var S=f.getAttribute("data-bucket");S&&(s.bucket=S),s.config.ncpParams=s.config.ncpParams||{},s.config.ncpParams.query=s.config.ncpParams.query||{},s.config.ncpParams.query=Object.assign(l,s.config.ncpParams.query);var T=window.wafer.base.state.drawer,N=T&&T.adsToken;N&&(s.config.ncpParams.query.geminiDedupeToken=N),f.setAttribute("data-wf-body",JSON.stringify(s)),f.classList.remove(w,m),f.classList.add(A),window.wafer.base.sync(f.parentNode)}}}(t)})),T&&window.wafer.base&&window.wafer.utils){var t=T.getAttribute("data-wf-url"),i=T.getAttribute("data-wf-state-body");window.wafer.utils.fetchWithCache(t,{body:i,cache:0}).then((function(t){if(t&&t.html){T.innerHTML=t.html;var i=T.querySelectorAll(".stream-ad"),a=T.getElementsByClassName("wafer-state")[0],r=e.querySelectorAll(".stream-ad-placeholder");if(i&&r)for(var n=i.length,o=r.length,s=0;s<o&&s<n;s++)r[s].replaceWith(i[s]);T.innerHTML="",a&&T.appendChild(a),window.wafer.base.sync(e)}}))}var a=e.querySelectorAll("."+C+", ."+C+"-mon");if(a.length){a.forEach((function(e){e.classList&&e.classList.contains("js-reserve-moments")&&(window.DARLA?J(e):e.style.display="none")}));var r=a[0].querySelector(".js-panorama-scroll-view");r&&0===r.scrollLeft&&(r.scrollLeft=(r.scrollWidth-N)/2);var n,o,s=document.getElementById("scrollable-smad"),l=document.getElementById("scrollable-video"),L=window.innerHeight||document.documentElement.clientHeight,E={},S=function(e){return e&&(e=(e=(e=(e=(e=(e=e.replace(/\$\(V_AUTOPLAYED\)/,!1)).replace(/\$\(V_PLAYER_WIDTH\)/,s.clientHeight)).replace(/\$\(V_PLAYER_HEIGHT\)/,s.clientWidth)).replace(/\$\(V_SKIP_AVAIL\)/,!1)).replace(/\$\(V_EXPANDED\)/,!1)).replace(/\$\(V_AUD_INFO\)/,2)),e};if(s){var O=s.getBoundingClientRect();n=O.top-L,o=O.bottom-n,E.startActionUrl=s.getAttribute("data-video-quartile-start"),E.quartileActionUrl25=s.getAttribute("data-video-quartile-25"),E.quartileActionUrl50=s.getAttribute("data-video-quartile-50"),E.quartileActionUrl75=s.getAttribute("data-video-quartile-75"),E.quartileActionUrl100=s.getAttribute("data-video-quartile-100")}s&&l&&window.addEventListener("scroll",window.wafer.utils.throttle((function(){var e=l&&l.duration,t=s.getBoundingClientRect();if(t.top<L&&t.bottom>0){l.currentTime=(window.pageYOffset-n)*e/o;var i=(L-t.top)/L*100;(i=5*Math.ceil(i/5))>=100&&E.quartileActionUrl100?(window.wafer.utils.fireBeacon(S(E.quartileActionUrl100),{useNavigator:!1}),E.quartileActionUrl100=null):i>=75&&E.quartileActionUrl75?(window.wafer.utils.fireBeacon(S(E.quartileActionUrl75),{useNavigator:!1}),E.quartileActionUrl75=null):i>=50&&E.quartileActionUrl50?(window.wafer.utils.fireBeacon(S(E.quartileActionUrl50),{useNavigator:!1}),E.quartileActionUrl50=null):i>=25&&E.quartileActionUrl25?(window.wafer.utils.fireBeacon(S(E.quartileActionUrl25),{useNavigator:!1}),E.quartileActionUrl25=null):i>=5&&E.startActionUrl&&(window.wafer.utils.fireBeacon(S(E.startActionUrl),{useNavigator:!1}),E.startActionUrl=null)}}),16))}}));window.addEventListener("viewerClosed",(function(){if(d&&!d.classList.contains(c)){var e=f&&!!f.getElementsByClassName("stream-realted-list")[0];if(e){d.classList.add("drawer-beacon");var t=d;setTimeout((function(){t.classList.add(c)}),10)}e&&u&&window.rapidInstance&&window.rapidInstance.beaconClick("strm",E,0,Object.assign(u,{_p:0,cnt_tpc:u.categoryLabel,g:d.getAttribute(b),grpt:"storyCluster",itc:1,pkgt:E})),u="",f=null,d=null}}));window.wafer.on("toggle:change",(function(e){if(e&&e.meta&&e.elem){var t=e.elem,i=t.getAttribute("data-wf-toggle-target");if("userintent-hidestrmitem"===e.meta.className&&"add"===e.meta.action&&S&&S.length)S.forEach((function(e){if(i&&e){var t=e.querySelector(i),a=t&&t.getAttribute(b);a&&(z[a]=setTimeout((r=t,function(){r.classList.contains(L)||r.classList.add(L)}),8e3))}var r}));else if("show-drawer"===e.meta.className)S&&S.length&&S.forEach((function(e){var t=e.querySelector(i),a=t&&t.getElementsByClassName("drawer-fetch-target")[0];setTimeout((function(){a&&(a.innerHTML="")}),300)}));else if("userintent-show"===e.meta.className&&t){var a=window.wafer.utils.findAncestor(t,"stream-item");if(!a)return;"add"===e.meta.action?(a.classList.add(O),window.rapidInstance&&window.rapidInstance.reevaluateModulesViewability(a)):"remove"===e.meta.action&&a.classList.remove(O)}else e.elem&&e.elem.classList.contains("stream-filter-login-tooltip-close")&&(window.localStorage.streamFilterLoginTooltipLastInteracted=Date.now())}}))}));
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(){var e=window,n=e.onerror,t=["apptype","rid","bucketId","bucket","device","osName","browserName","browserVersion"],o=/^resource:\/\//,r=/ActionScript|Decompress\sfail/,a="",i={beaconPath:"p.gif",site:"fp"},c=function(){var n=e.navigator&&(navigator.connection||navigator.mozConnection||navigator.webkitConnection)||{};return{downlink:n.downlink||"",downlinkMax:n.downlinkMax||"",effectiveType:n.effectiveType||"",rtt:n.rtt||"",saveData:n.saveData||"",type:n.type||""}},s=function(){var n=e.YAHOO&&e.YAHOO.context||e.Af&&e.Af.context||{},o="";return t.forEach((function(e){"undefined"!==_typeof(n[e])&&(o+="&".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(n[e])))})),o},f=function(n,t,o,r){if(!e.navigator||!1!==e.navigator.onLine){n&&t||r&&r("Missing required params - type: ".concat(n,", src: ").concat(t));var a=o||{};t&&(a.src=t),a._rdn=(new Date).getTime().toString().substr(7);var f=Object.keys(a).map((function(e){return encodeURIComponent(e)+"="+encodeURIComponent(a[e])})).join("&"),g="".concat("/_td_api/beacon","/").concat(n,"?").concat(f).concat(s(),"&site=").concat(i.site,"&connection=").concat(escape(JSON.stringify(c()))),w=!(window.navigator&&"sendBeacon"in window.navigator);if(!w)try{window.navigator.sendBeacon(g)}catch(e){w=!0}if(w){var d=new Image;d.onerror=function(e){var n=e instanceof Error?e.toString():e;r&&r(n)},d.onload=function(){r&&r()},d.src=g,e.__testError&&(e.__testImg=d)}}};e.onerror=function(e,t,a){try{if(!o.test(t))!function(e,n){if(n){var t="string"==typeof n?n:n.message;if(!t||!r.test(t)){var o,a=n.toString();if(n){switch(a){case"[object String]":o={code:999,message:n};break;case"[object Error]":o={code:n.code||n.name||999,file:n.fileName||"",line:n.lineNumber||"",message:n.message};break;case"[object Object]":o=n;break;default:try{o={code:999,message:JSON.stringify(n)}}catch(e){}}o.message=o.message&&o.message.substring(0,300)||""}f("error",e,o)}}}("winerror",{code:e.name,file:e.fileName||"",line:e.lineNumber||a||"",message:e.message||e,url:t&&t.substring(0,300)})}catch(e){}return"function"==typeof n&&n(e,t,a)};var g,w=function(n){if(n){var t=n.meta,o=n.name;switch(o){case"IDB-connection-success":window.wafer.base.clearOldCache({timeDiffToDelete:13824e5});break;case"WaferRapid":f("WAFER_LOG",o,{meta:JSON.stringify(t)});break;case"WaferFetch":"nextgen"===(a||(a=e.YAHOO&&e.YAHOO.context&&e.YAHOO.context.apptype),a)&&f("WAFER_LOG",o,{meta:JSON.stringify(t)})}}},d=function(n){if((!e.navigator||!1!==e.navigator.onLine)&&n){var t=n.meta,o=n.name,r=n.stack,a=r&&r.message||"",f="/".concat(i.beaconPath,"?err=").concat(o,"&beaconType=wafer_err&info=").concat(escape(JSON.stringify(t)),"&stack=").concat(a,"&connection=").concat(escape(JSON.stringify(c()))).concat(s());e.wafer.utils.fireBeacon(f),e.__testError&&(e.__testBeaconUrl=f)}},u=function(){if(g)return!0;window.wafer.on("log",w),window.wafer.on("error",d),g=!0,window.YAHOO&&window.YAHOO.errBeaconConfig&&Object.assign(i,window.YAHOO.errBeaconConfig),"ReportingObserver"in window&&new window.ReportingObserver((function(e,n){for(var t=0;t<e.length;t++){var o=e[t];if(o&&"csp-violation"!==o.type){var r=o.body;r.url=o.url,f("reporting-observer",o.type,{meta:JSON.stringify(r)})}}}),{buffered:!0}).observe()};window.wafer.ready?window.wafer.ready((function(){u()})):window.addEventListener("load",(function(){u()})),e.__testError&&u()}();
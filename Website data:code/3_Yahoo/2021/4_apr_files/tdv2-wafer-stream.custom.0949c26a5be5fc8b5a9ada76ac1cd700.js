"use strict";window.wafer&&window.wafer.ready((function(){window.wafer.on("fetch:success",(function(e){var t=e.elem;if(t){if(t.classList&&(t.classList.contains("collections-view-more")&&(document.documentElement.classList.remove("Reader-closed"),document.documentElement.classList.add("Reader-open"),window.wafer.base.lock(document.getElementById("MainView")),window.scrollTo(0,0)),t.classList.contains("stream-batch-fetch"))){var i=window.rapidPageConfig&&window.rapidPageConfig.rapidConfig&&window.rapidPageConfig.rapidConfig.spaceid;i&&(window._comscore=window._comscore||[],window._comscore.push({c1:2,c2:"7241469",c5:i,c7:document.location.href,c14:window.YAHOO&&window.YAHOO.comscore&&window.YAHOO.comscore.c14||-1}),window.COMSCORE&&window.COMSCORE.purge())}var a=t.getAttribute("data-wf-url");if(a&&a.indexOf("StandAloneVideo")>-1){var r="/p.gif?info=trendingvideofetch&bucket="+(window.rapidPageConfig&&window.rapidPageConfig.rapidConfig||{}).test_id;window.wafer.utils.fireBeacon(r)}}}));var e,t,i,a,r,n,o,s,l,c,d="show-drawer",u=null,f=null,m=null,w="wafer-fetch-error",g="wafer-fetch-complete",p="stream-related-drawer",v="StreamRelated",y="tdv2-wafer-stream",A="json",h="wafer-fetch",L="stream-uuid-list",b="userintent-disliked-anim",E="data-uuid",q="youmaylike",S=[],T=document.querySelectorAll(".stream-items"),N=document.querySelector(".stream-ad-fetch"),C=window.innerWidth||document.documentElement.clientWidth,k="js-sponsored-moments-dwell-time",O="userintent-show-reason",R=window.wafer&&window.wafer.utils,U=document.querySelector(".stream-category-filter"),I=!!window.localStorage.streamFilterLoginTooltipLastInteracted,D=!1,M="",B=0;if(U){var P=function(){if(!W())return!1;var e=Date.now();return void 0===window.localStorage.streamFilterLoginTooltipLastInteracted||e>=window.localStorage.streamFilterLoginTooltipLastInteracted+x},_=function(e,t,i){return function(){!e||I&&(!H||H&&B<r)||(U.offsetTop>0?(e.classList.contains("D(n)")&&V&&P()&&Y(),e.style.position="fixed",e.style.top=i.classList.contains("ybar-hide-navigation")?"150px":"184px",e.style.left=t,e.classList.add("sticky-active")):(e.style.position="",e.style.bottom="",e.style.top="",e.style.left="",e.classList.remove("sticky-active")))}},V=!1,x=6048e5,H=document.getElementById("streamFilterMaxFilterClicks");H&&(r=Number(H.getAttribute("value"))),e=document.getElementById("stream-category-form"),"stream-category-filter-btn-",".stream-category-filter-btn-fwd",".stream-category-filter-btn-back",a=document.querySelector(".stream-filter-last-category-tooltip"),t=U.querySelector(".stream-category-filter-btn-fwd"),i=U.querySelector(".stream-category-filter-btn-back");var F=function(e){if(!D){if(e){var t=document.querySelector(".stream-filter-tooltip");t&&t.classList.add("D(n)")}else{var i=document.querySelector(".stream-filter-tooltip-close");i&&i.click()}D=!0}},W=function(){return M||(M=document.getElementById("stream-filter-login-tooltip")),M},j=function(e){if(!I){var t=W();t&&(t.classList.add("D(n)"),e&&(I=!!window.localStorage.streamFilterLoginTooltipLastInteracted))}},Y=function(e){if(P()||!0===e){F(!0);var t=W();t&&t.classList.remove("D(n)")}},$=function(){document.querySelector(".stream-filter-last-category-tooltip").classList.add("D(n)"),a.classList.remove("tooltip-pointer-right")},J=function(){F(),$();var a=Math.ceil(100*e.scrollLeft/(e.scrollWidth-e.clientWidth));t.style.color=a>=100?"#ccc":"#7e1fff",0===a&&(i.style.display="none"),a>0&&(i.style.display="block",i.classList.remove("D(n)"))},z=function(t,i){if(i){var r=document.querySelector(t);if(r){var n=0;Array.prototype.indexOf.call(i.parentNode.children,i)>8&&(n=235,a.classList.add("tooltip-pointer-right")),r.style.left=i.offsetLeft-e.scrollLeft-64-n+i.offsetWidth/2+"px",r.classList.remove("D(n)")}}},G=[];(P()||H)&&(n=W(),o=document.getElementById("atomic"),s=document.querySelector(".stream-with-filters"),l=s.getClientRects(),c=Math.abs(.5*s.offsetWidth+l[0].left)+"px","function"==typeof requestAnimationFrame?window.wafer.on("scroll",(function(){requestAnimationFrame(_(n,c,o))})):window.wafer.on("scroll",window.wafer.utils.throttle(_(n,c,o)),16)),U&&e&&(U.addEventListener("click",(function(t){var i=t.target;if(i&&"BUTTON"===i.tagName)i.classList.contains("stream-category-filter-btn-fwd")&&(e.scrollLeft+=500),i.classList.contains("stream-category-filter-btn-back")&&(e.scrollLeft-=500),setTimeout((function(){J()}),500),j(!0),$(),F();else if(i&&i.classList&&i.classList.contains("stream-cat-input")){if(B++,H&&B>r){t.preventDefault(),Y(!0);var a=i.getAttribute("data-display-name");return void window.rapidInstance.beaconClick("strm",a,0,{elm:"filter-prevented",itc:1})}var n=e.querySelectorAll(".stream-cat-input:checked");if(n&&n.length<=0)t.preventDefault(),setTimeout((function(){var t=e.querySelectorAll(".stream-cat-input:checked")[0],i=t&&t.getAttribute("id");i&&function(t){if(t){G.forEach((function(e){clearTimeout(e)}));var i=e&&e.querySelector("#"+t);i&&z(".stream-filter-last-category-tooltip",i.parentNode),G.push(setTimeout($,1e4))}}(i),j(!1)}),0);else{if(i&&i.type&&"checkbox"===i.type.toLowerCase()){var o=i.getAttribute("data-display-name");window.rapidInstance.beaconClick("strm",o,0,{elm:i.checked?"filter-include":"filter-exclude",itc:1})}$()}}})),e.addEventListener("scroll",(function(e){window.requestAnimationFrame(J)})),e.addEventListener("customValidate",(function(t){var i=(e&&e.querySelectorAll(".stream-cat-input:checked").length)>0,a=new CustomEvent("customValidateStatus",{detail:{success:i}});e&&e.dispatchEvent(a)}),!1),window.wafer.on("fetch:success",(function(e){if(e.elem&&e.elem.classList.contains("stream-tab-contents")){F();var t=document.querySelector(".alternatenewsstream"),i=(t&&t.offsetTop+t.offsetParent.offsetTop+20||0)+20;t&&window.scrollY>i&&window.scrollTo(0,i-147),U.offsetTop>0&&Y(),V=!0,(T=t.querySelectorAll(".stream-items"))&&T.length&&Q()}})),setTimeout((function(){z(".stream-filter-tooltip",U.querySelector(".stream-filter-point-tooltip-here"))}),0))}var K=function e(t){var i=Math.floor(16*C/9),a=t.querySelector("#defaultRESERVEMOMENTS"),r=a&&a.getAttribute("data-html");if(r){var n=window.DARLA.prefetched();if(window.DARLA.inProgress()||n&&0!==n.length)setTimeout((function(){e(t)}),500);else{var o={dest:"defaultRESERVEMOMENTS",flex:{h:{min:i},w:{min:C}},h:i,id:"RESERVEMOMENTS",supports:{"exp-ovr":1,"exp-push":1,"resize-to":1},w:C};window.DARLA.addPos(o);var s=new window.DARLA.Response("RESERVEMOMENTS",{});r=unescape(r),s.add("RESERVEMOMENTS",r),window.DARLA.render(s)}}},X={};function Q(){T.forEach((function(e){if(e.addEventListener("animationend",(function(e){var t=e&&e.target;e&&t&&("hideStreamItem"===e.animationName||"fadeOutAdConfirm"===e.animationName)&&(t.classList.contains("ad-feedback-options")||(t.classList.contains("give-feedback-screen")&&(t=window.wafer.utils.findAncestor(t,"stream-item")),t.parentNode&&(window.wafer.base.destroy(t),t.parentNode.removeChild(t))))})),e.addEventListener("click",(function(t){var i=t.target;if(i.classList.contains("userintent-undo")){var a=i.getAttribute("data-wf-toggle-target"),r=e.querySelector(a);if(r){var n=r.getAttribute(E);n&&X[n]&&clearTimeout(X[n])}}!function(e){window.location.href.indexOf("functest=1")>-1&&e.preventDefault();var t=e.target;if(!R||!t)return;var i=R.findAncestor(t,"js-content-viewer");if(!i)return;var a=R.findAncestor(i,"stream-cluster-item")||R.findAncestor(i,"js-stream-content");if(!a)return;var r=a.getAttribute("data-uuid");if(r){var n=a&&a.getAttribute("data-parent-uuid");if(u=n&&document.querySelector('li[data-uuid="'+n+'"]')||a,m=u&&u.getElementsByClassName(p)[0]){if(u.classList.contains(d))return;var o=function(){for(var e=Array.prototype.slice.call(document.getElementsByClassName(L)),t=0;t<e.length;t++){var i=e[t],a=i.text;i.classList.remove(L);try{var r=JSON.parse(a);r&&Array.isArray(r.uuidList)&&S.length+r.uuidList.length<=250&&(S=S.concat(r.uuidList))}catch(e){}}return{dedupUuids:S}}(),s={config:{leadItemUuid:n||r},ctrl:v,m_id:y,m_mode:A},l={dedupUuids:o.dedupUuids.join(","),uuid:r},c=m.getAttribute("data-cfg");if(c){var b=a.getAttribute("data-cposy");b=isNaN(b)?null:parseInt(b,10);try{var E=JSON.parse(c);E&&E.i13n&&(f=E.i13n),null!==b&&(E.i13n.cposy=b),s.config=Object.assign(s.config,E)}catch(e){}}var q=m.getAttribute("data-bucket");q&&(s.bucket=q),s.config.ncpParams=s.config.ncpParams||{},s.config.ncpParams.query=s.config.ncpParams.query||{},s.config.ncpParams.query=Object.assign(l,s.config.ncpParams.query);var T=window.wafer.base.state.drawer,N=T&&T.adsToken;N&&(s.config.ncpParams.query.geminiDedupeToken=N),m.setAttribute("data-wf-body",JSON.stringify(s)),m.classList.remove(w,g),m.classList.add(h),window.wafer.base.sync(m.parentNode)}}}(t)})),N&&window.wafer.base&&window.wafer.utils){var t=N.getAttribute("data-wf-url"),i=N.getAttribute("data-wf-state-body");window.wafer.utils.fetchWithCache(t,{body:i,cache:0}).then((function(t){if(t&&t.html){N.innerHTML=t.html;var i=N.querySelectorAll(".stream-ad"),a=N.getElementsByClassName("wafer-state")[0],r=e.querySelectorAll(".stream-ad-placeholder");if(i&&r)for(var n=i.length,o=r.length,s=0;s<o&&s<n;s++)r[s].replaceWith(i[s]);N.innerHTML="",a&&N.appendChild(a),window.wafer.base.sync(e)}}))}var a=e.querySelectorAll("."+k+", ."+k+"-mon");if(a.length){a.forEach((function(e){e.classList&&e.classList.contains("js-reserve-moments")&&(window.DARLA?K(e):e.style.display="none")}));var r=a[0].querySelector(".js-panorama-scroll-view");r&&0===r.scrollLeft&&(r.scrollLeft=(r.scrollWidth-C)/2)}}))}if(T&&T.length){Q();var Z,ee,te=document.getElementById("scrollable-smad"),ie=document.getElementById("scrollable-video"),ae=window.innerHeight||document.documentElement.clientHeight,re={},ne=function(e){return e&&(e=(e=(e=(e=(e=(e=e.replace(/\$\(V_AUTOPLAYED\)/,!1)).replace(/\$\(V_PLAYER_WIDTH\)/,te.clientHeight)).replace(/\$\(V_PLAYER_HEIGHT\)/,te.clientWidth)).replace(/\$\(V_SKIP_AVAIL\)/,!1)).replace(/\$\(V_EXPANDED\)/,!1)).replace(/\$\(V_AUD_INFO\)/,2)),e};if(te){var oe=te.getBoundingClientRect();Z=oe.top-ae,ee=oe.bottom-Z,re.startActionUrl=te.getAttribute("data-video-quartile-start"),re.quartileActionUrl25=te.getAttribute("data-video-quartile-25"),re.quartileActionUrl50=te.getAttribute("data-video-quartile-50"),re.quartileActionUrl75=te.getAttribute("data-video-quartile-75"),re.quartileActionUrl100=te.getAttribute("data-video-quartile-100")}te&&ie&&window.addEventListener("scroll",window.wafer.utils.throttle((function(){var e=ie&&ie.duration,t=te.getBoundingClientRect();if(t.top<ae&&t.bottom>0){ie.currentTime=(window.pageYOffset-Z)*e/ee;var i=(ae-t.top)/ae*100;(i=5*Math.ceil(i/5))>=100&&re.quartileActionUrl100?(window.wafer.utils.fireBeacon(ne(re.quartileActionUrl100),{useNavigator:!1}),re.quartileActionUrl100=null):i>=75&&re.quartileActionUrl75?(window.wafer.utils.fireBeacon(ne(re.quartileActionUrl75),{useNavigator:!1}),re.quartileActionUrl75=null):i>=50&&re.quartileActionUrl50?(window.wafer.utils.fireBeacon(ne(re.quartileActionUrl50),{useNavigator:!1}),re.quartileActionUrl50=null):i>=25&&re.quartileActionUrl25?(window.wafer.utils.fireBeacon(ne(re.quartileActionUrl25),{useNavigator:!1}),re.quartileActionUrl25=null):i>=5&&re.startActionUrl&&(window.wafer.utils.fireBeacon(ne(re.startActionUrl),{useNavigator:!1}),re.startActionUrl=null)}}),16))}window.addEventListener("viewerClosed",(function(){if(u&&!u.classList.contains(d)){var e=m&&!!m.getElementsByClassName("stream-realted-list")[0];if(e){u.classList.add("drawer-beacon");var t=u;setTimeout((function(){t.classList.add(d)}),10)}e&&f&&window.rapidInstance&&window.rapidInstance.beaconClick("strm",q,0,Object.assign(f,{_p:0,cnt_tpc:f.categoryLabel,g:u.getAttribute(E),grpt:"storyCluster",itc:1,pkgt:q})),f="",m=null,u=null}}));window.wafer.on("toggle:change",(function(e){if(e&&e.meta&&e.elem){var t=e.elem,i=t.getAttribute("data-wf-toggle-target");if("userintent-hidestrmitem"===e.meta.className&&"add"===e.meta.action&&T&&T.length)T.forEach((function(e){if(i&&e){var t=e.querySelector(i),a=t&&t.getAttribute(E);a&&(X[a]=setTimeout((r=t,function(){r.classList.contains(b)||r.classList.add(b)}),8e3))}var r}));else if("show-drawer"===e.meta.className)T&&T.length&&T.forEach((function(e){var t=e.querySelector(i),a=t&&t.getElementsByClassName("drawer-fetch-target")[0];setTimeout((function(){a&&(a.innerHTML="")}),300)}));else if("userintent-show"===e.meta.className&&t){var a=window.wafer.utils.findAncestor(t,"stream-item");if(!a)return;"add"===e.meta.action?(a.classList.add(O),window.rapidInstance&&window.rapidInstance.reevaluateModulesViewability(a)):"remove"===e.meta.action&&a.classList.remove(O)}else e.elem&&e.elem.classList.contains("stream-filter-login-tooltip-close")&&(window.localStorage.streamFilterLoginTooltipLastInteracted=Date.now())}}))}));
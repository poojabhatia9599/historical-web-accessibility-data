"use strict";window.wafer&&window.wafer.ready((function(){window.wafer.on("fetch:success",(function(e){var t=e.elem;if(t){if(t.classList&&(t.classList.contains("collections-view-more")&&(document.documentElement.classList.remove("Reader-closed"),document.documentElement.classList.add("Reader-open"),window.wafer.base.lock(document.getElementById("MainView")),window.scrollTo(0,0)),t.classList.contains("stream-batch-fetch"))){var i=window.rapidPageConfig&&window.rapidPageConfig.rapidConfig&&window.rapidPageConfig.rapidConfig.spaceid;i&&(window._comscore=window._comscore||[],window._comscore.push({c1:2,c2:"7241469",c5:i,c7:document.location.href,c14:window.YAHOO&&window.YAHOO.comscore&&window.YAHOO.comscore.c14||-1}),window.COMSCORE&&window.COMSCORE.purge())}var a=t.getAttribute("data-wf-url");if(a&&a.indexOf("StandAloneVideo")>-1){var r="/p.gif?info=trendingvideofetch&bucket="+(window.rapidPageConfig&&window.rapidPageConfig.rapidConfig||{}).test_id;window.wafer.utils.fireBeacon(r)}}}));var e,t,i,a,r,n,o,s="show-drawer",l=null,c=null,d=null,u="wafer-fetch-error",f="wafer-fetch-complete",m="stream-related-drawer",w="StreamRelated",g="tdv2-wafer-stream",p="json",v="wafer-fetch",y="stream-uuid-list",L="userintent-disliked-anim",A="data-uuid",h="youmaylike",b=[],E=document.querySelectorAll(".stream-items"),q=document.querySelector(".stream-ad-fetch"),S=window.innerWidth||document.documentElement.clientWidth,N="js-sponsored-moments-dwell-time",T="userintent-show-reason",k=window.wafer&&window.wafer.utils,I=document.querySelector(".stream-category-filter"),C=document.getElementById("Main"),O=document.getElementById("stream-filter-adpill-upsell-module"),B="#stream-filter-adpill-upsell-module",R=0,U=!!window.localStorage.streamFilterLoginTooltipLastInteracted,D=!1,M="",P=0,x=!!document.getElementById("nextgen-desktop");if(I){var _=function(){if(!Y())return!1;var e=Date.now();return void 0===window.localStorage.streamFilterLoginTooltipLastInteracted||e>=window.localStorage.streamFilterLoginTooltipLastInteracted+W},V=function(e,t,i){return function(){var a=e===O;(a||e&&(!U||F&&!(F&&P<o)))&&(I.offsetTop>0?(e.classList.contains("D(n)")&&H&&_()&&J(),Object.assign(e.style,{position:"fixed",top:i.classList.contains("ybar-hide-navigation")?"150px":"184px"}),e.style.left=a?R+"px":t,e.classList.add("sticky-active")):(Object.assign(e.style,{bottom:"",position:"",top:""}),e.style.left=a?R-C.offsetLeft+"px":"",e.classList.remove("sticky-active")))}},j=function(e,t){var i=document.querySelector(".stream-with-filters"),a=i.getClientRects(),r=Math.abs(.5*i.offsetWidth+a[0].left);"function"==typeof requestAnimationFrame?window.wafer.on("scroll",(function(){var i=r-document.documentElement.scrollLeft+"px";requestAnimationFrame(V(e,i,t))})):window.wafer.on("scroll",window.wafer.utils.throttle(V(e,r,t)),16)},H=!1,W=6048e5,F=document.getElementById("streamFilterMaxFilterClicks");F&&(o=Number(F.getAttribute("value"))),e=document.getElementById("stream-category-form"),t=document.getElementById("stream-filter-ad-pill"),"stream-category-filter-btn-",".stream-category-filter-btn-fwd",".stream-category-filter-btn-back",n=document.querySelector(".stream-filter-last-category-tooltip"),i=I.querySelector(".stream-category-filter-btn-fwd"),a=i&&i.querySelector("svg"),r=I.querySelector(".stream-category-filter-btn-back");var z=function(e){if(!D){if(e){var t=document.querySelector(".stream-filter-tooltip");t&&t.classList.add("D(n)")}else{var i=document.querySelector(".stream-filter-tooltip-close");i&&i.click()}D=!0}},Y=function(){return M||(M=document.getElementById("stream-filter-login-tooltip")),M},$=function(e){if(!U){var t=Y();t&&(t.classList.add("D(n)"),e&&(U=!!window.localStorage.streamFilterLoginTooltipLastInteracted))}},J=function(e){if(_()||!0===e){z(!0);var t=Y();t&&t.classList.remove("D(n)")}},G=function(){document.querySelector(".stream-filter-last-category-tooltip").classList.add("D(n)"),n.classList.remove("tooltip-pointer-right")},K=function(){z(),G();var t=Math.ceil(100*e.scrollLeft/(e.scrollWidth-e.clientWidth));t>=100?a&&a.style.setProperty("fill","#ccc","important"):a&&a.style.setProperty("fill","#6e7780",""),0===t&&(r.style.display="none"),t>0&&(r.style.display="block",r.classList.remove("D(n)"))},X=function e(){O&&(O.classList.add("D(n)"),O.classList.remove("tooltip-pointer-right")),window.removeEventListener("resize",e)},Q=function(t,i){if(i&&C){var a=document.querySelector(t),r=t===B;if(a){var n=r?490:318,o=0,s=i.offsetLeft-e.scrollLeft-64+i.offsetWidth/2;s+n>C.offsetWidth&&(o=n-100,a.classList.add("tooltip-pointer-right")),r&&(R=C.offsetLeft+s-o),a.style.left=r&&a.classList.contains("sticky-active")?R+"px":s-o+"px",a.classList.remove("D(n)")}}},Z=[];(_()||F)&&j(Y(),document.getElementById("atomic")),j(O,document.getElementById("atomic")),I&&e&&(I.addEventListener("click",(function(i){var a=i.target;if(a&&"BUTTON"===a.tagName)a.classList.contains("stream-category-filter-btn-fwd")&&(e.scrollLeft+=500),a.classList.contains("stream-category-filter-btn-back")&&(e.scrollLeft-=500),setTimeout((function(){K()}),500),$(!0),G(),z();else if(a&&a.classList&&a.classList.contains("stream-cat-adpill-input"))t&&Q(B,t.parentNode),window.addEventListener("resize",window.wafer.utils.debounce(X,100));else if(a&&a.classList&&a.classList.contains("stream-cat-input")){if(P++,a.parentNode.setAttribute("aria-selected",a.checked),F&&P>o){i.preventDefault(),J(!0);var r=a.getAttribute("data-display-name");return void window.rapidInstance.beaconClick("strm",r,0,{elm:"filter-prevented",itc:1})}var n=e.querySelectorAll(".stream-cat-input:checked");if(n&&n.length<=0)i.preventDefault(),setTimeout((function(){var t=e.querySelectorAll(".stream-cat-input:checked")[0],i=t&&t.getAttribute("id");i&&function(t){if(t){wafer.utils.convertNodeListToArray(Z).forEach((function(e){clearTimeout(e)}));var i=e&&e.querySelector("#"+t);i&&Q(".stream-filter-last-category-tooltip",i.parentNode),Z.push(setTimeout(G,1e4))}}(i),$(!1)}),0);else{if(a&&a.type&&"checkbox"===a.type.toLowerCase()){var s=a.getAttribute("data-display-name");window.rapidInstance.beaconClick("strm",s,0,{elm:a.checked?"filter-include":"filter-exclude",itc:1})}G()}}})),e.addEventListener("scroll",(function(e){window.requestAnimationFrame((function(){K(),X()}))})),e.addEventListener("customValidate",(function(t){var i=(e&&e.querySelectorAll(".stream-cat-input:checked").length)>0,a=new CustomEvent("customValidateStatus",{detail:{success:i}});e&&e.dispatchEvent(a)}),!1),e.addEventListener("keydown",(function(e){var t=e.target;if(e&&"Enter"===e.key&&t&&t.classList.contains("stream-filter-display-name")){var i=document.getElementById(t.getAttribute("data-cat-input-id"));i&&i.click()}})),window.wafer.on("fetch:success",(function(e){if(e.elem&&e.elem.classList.contains("stream-tab-contents")){z();var t=document.querySelector(".alternatenewsstream"),i=(t&&t.offsetTop+t.offsetParent.offsetTop+20||0)+20;t&&window.scrollY>i&&window.scrollTo(0,i-147),I.offsetTop>0&&J(),H=!0,(E=t.querySelectorAll(".stream-items"))&&E.length&&ie()}})),setTimeout((function(){Q(".stream-filter-tooltip",I.querySelector(".stream-filter-point-tooltip-here"))}),0))}var ee=function e(t){var i=Math.floor(16*S/9),a=t.querySelector("#defaultRESERVEMOMENTS"),r=a&&a.getAttribute("data-html");if(r){var n=window.DARLA.prefetched();if(window.DARLA.inProgress()||n&&0!==n.length)setTimeout((function(){e(t)}),500);else{var o={dest:"defaultRESERVEMOMENTS",flex:{h:{min:i},w:{min:S}},h:i,id:"RESERVEMOMENTS",supports:{"exp-ovr":1,"exp-push":1,"resize-to":1},w:S};window.DARLA.addPos(o);var s=new window.DARLA.Response("RESERVEMOMENTS",{});r=unescape(r),s.add("RESERVEMOMENTS",r),window.DARLA.render(s)}}},te={};function ie(){wafer.utils.convertNodeListToArray(E).forEach((function(e){if(x){if(e.classList.contains("stream-items-initialized"))return;e.classList.add("stream-items-initialized")}if(e.addEventListener("animationend",(function(e){var t=e&&e.target;e&&t&&("hideStreamItem"===e.animationName||"fadeOutAdConfirm"===e.animationName)&&(t.classList.contains("ad-feedback-options")||(t.classList.contains("give-feedback-screen")?t=window.wafer.utils.findAncestor(t,"stream-item"):t.classList.contains("comm-undo")&&(t=window.wafer.utils.findAncestor(t,"stream-item-card")),t.parentNode&&(window.wafer.base.destroy(t),t.parentNode.removeChild(t))))})),e.addEventListener("click",(function(t){var i=t.target;if(i.classList.contains("userintent-undo")){var a=i.getAttribute("data-wf-toggle-target"),r=e.querySelector(a);if(r){var n=r.getAttribute(A);n&&te[n]&&clearTimeout(te[n])}}!function(e){window.location.href.indexOf("functest=1")>-1&&e.preventDefault();var t=e.target;if(!k||!t)return;var i=k.findAncestor(t,"js-content-viewer");if(!i)return;var a=k.findAncestor(i,"stream-cluster-item")||k.findAncestor(i,"js-stream-content");if(!a)return;var r=a.getAttribute("data-uuid");if(r){var n=a&&a.getAttribute("data-parent-uuid");if(l=n&&document.querySelector('li[data-uuid="'+n+'"]')||a,d=l&&l.getElementsByClassName(m)[0]){if(l.classList.contains(s))return;var o=function(){for(var e=Array.prototype.slice.call(document.getElementsByClassName(y)),t=0;t<e.length;t++){var i=e[t],a=i.text;i.classList.remove(y);try{var r=JSON.parse(a);r&&Array.isArray(r.uuidList)&&b.length+r.uuidList.length<=250&&(b=b.concat(r.uuidList))}catch(e){}}return{dedupUuids:b}}(),L={config:{leadItemUuid:n||r},ctrl:w,m_id:g,m_mode:p},A={dedupUuids:o.dedupUuids.join(","),uuid:r},h=d.getAttribute("data-cfg");if(h){var E=a.getAttribute("data-cposy");E=isNaN(E)?null:parseInt(E,10);try{var q=JSON.parse(h);q&&q.i13n&&(c=q.i13n),null!==E&&(q.i13n.cposy=E),L.config=Object.assign(L.config,q)}catch(e){}}var S=d.getAttribute("data-bucket");S&&(L.bucket=S),L.config.ncpParams=L.config.ncpParams||{},L.config.ncpParams.query=L.config.ncpParams.query||{},L.config.ncpParams.query=Object.assign(A,L.config.ncpParams.query);var N=window.wafer.base.state.drawer,T=N&&N.adsToken;T&&(L.config.ncpParams.query.geminiDedupeToken=T),d.setAttribute("data-wf-body",JSON.stringify(L)),d.classList.remove(u,f),d.classList.add(v),window.wafer.base.sync(d.parentNode)}}}(t)})),q&&window.wafer.base&&window.wafer.utils){var t=q.getAttribute("data-wf-url"),i=q.getAttribute("data-wf-state-body");window.wafer.utils.fetchWithCache(t,{body:i,cache:0}).then((function(t){if(t&&t.html){q.innerHTML=t.html;var i=q.querySelectorAll(".stream-ad"),a=q.getElementsByClassName("wafer-state")[0],r=e.querySelectorAll(".stream-ad-placeholder");if(i&&r)for(var n=i.length,o=r.length,s=0;s<o&&s<n;s++)r[s].replaceWith(i[s]);q.innerHTML="",a&&q.appendChild(a),window.wafer.base.sync(e)}}))}var a=e.querySelectorAll("."+N+", ."+N+"-mon");if(a.length){wafer.utils.convertNodeListToArray(a).forEach((function(e){e.classList&&e.classList.contains("js-reserve-moments")&&(window.DARLA?ee(e):e.style.display="none")}));var r=a[0].querySelector(".js-panorama-scroll-view");r&&0===r.scrollLeft&&(r.scrollLeft=(r.scrollWidth-S)/2)}}))}if(E&&E.length){ie();var ae,re,ne=document.getElementById("scrollable-smad"),oe=document.getElementById("scrollable-video"),se=window.innerHeight||document.documentElement.clientHeight,le={},ce=function(e){return e&&(e=(e=(e=(e=(e=(e=e.replace(/\$\(V_AUTOPLAYED\)/,!1)).replace(/\$\(V_PLAYER_WIDTH\)/,ne.clientHeight)).replace(/\$\(V_PLAYER_HEIGHT\)/,ne.clientWidth)).replace(/\$\(V_SKIP_AVAIL\)/,!1)).replace(/\$\(V_EXPANDED\)/,!1)).replace(/\$\(V_AUD_INFO\)/,2)),e};if(ne){var de=ne.getBoundingClientRect();ae=de.top-se,re=de.bottom-ae,le.startActionUrl=ne.getAttribute("data-video-quartile-start"),le.quartileActionUrl25=ne.getAttribute("data-video-quartile-25"),le.quartileActionUrl50=ne.getAttribute("data-video-quartile-50"),le.quartileActionUrl75=ne.getAttribute("data-video-quartile-75"),le.quartileActionUrl100=ne.getAttribute("data-video-quartile-100")}ne&&oe&&window.addEventListener("scroll",window.wafer.utils.throttle((function(){var e=oe&&oe.duration,t=ne.getBoundingClientRect();if(t.top<se&&t.bottom>0){oe.currentTime=(window.pageYOffset-ae)*e/re;var i=(se-t.top)/se*100;(i=5*Math.ceil(i/5))>=100&&le.quartileActionUrl100?(window.wafer.utils.fireBeacon(ce(le.quartileActionUrl100),{useNavigator:!1}),le.quartileActionUrl100=null):i>=75&&le.quartileActionUrl75?(window.wafer.utils.fireBeacon(ce(le.quartileActionUrl75),{useNavigator:!1}),le.quartileActionUrl75=null):i>=50&&le.quartileActionUrl50?(window.wafer.utils.fireBeacon(ce(le.quartileActionUrl50),{useNavigator:!1}),le.quartileActionUrl50=null):i>=25&&le.quartileActionUrl25?(window.wafer.utils.fireBeacon(ce(le.quartileActionUrl25),{useNavigator:!1}),le.quartileActionUrl25=null):i>=5&&le.startActionUrl&&(window.wafer.utils.fireBeacon(ce(le.startActionUrl),{useNavigator:!1}),le.startActionUrl=null)}}),16))}window.addEventListener("viewerClosed",(function(){if(l&&!l.classList.contains(s)){var e=d&&!!d.getElementsByClassName("stream-realted-list")[0];if(e){l.classList.add("drawer-beacon");var t=l;setTimeout((function(){t.classList.add(s)}),10)}e&&c&&window.rapidInstance&&window.rapidInstance.beaconClick("strm",h,0,Object.assign(c,{_p:0,cnt_tpc:c.categoryLabel,g:l.getAttribute(A),grpt:"storyCluster",itc:1,pkgt:h})),c="",d=null,l=null}}));window.wafer.on("video:adStarted",(function(e){e&&e.elem&&e.elem.parentNode&&e.elem.parentNode.classList&&e.elem.parentNode.classList.contains("stream-video-ad-v2")&&e.elem.parentNode.classList.remove("video-endcard")})),window.wafer.on("video:adEnded",(function(e){e&&e.elem&&e.elem.parentNode&&e.elem.parentNode.classList&&e.elem.parentNode.classList.contains("stream-video-ad-v2")&&e.elem.parentNode.classList.add("video-endcard")}));window.wafer.on("toggle:change",(function(e){if(e&&e.meta&&e.elem){var t=e.elem,i=t.getAttribute("data-wf-toggle-target");if("userintent-hidestrmitem"===e.meta.className&&"add"===e.meta.action&&E&&E.length)wafer.utils.convertNodeListToArray(E).forEach((function(e){if(i&&e){var t=e.querySelector(i),a=t&&t.getAttribute(A);a&&(te[a]=setTimeout((r=t,function(){r.classList.contains(L)||r.classList.add(L)}),8e3))}var r}));else if("show-drawer"===e.meta.className)E&&E.length&&wafer.utils.convertNodeListToArray(E).forEach((function(e){var t=e.querySelector(i),a=t&&t.getElementsByClassName("drawer-fetch-target")[0];setTimeout((function(){a&&(a.innerHTML="")}),300)}));else if("userintent-show"===e.meta.className&&t){var a=window.wafer.utils.findAncestor(t,"stream-item");if(!a)return;"add"===e.meta.action?(a.classList.add(T),window.rapidInstance&&window.rapidInstance.reevaluateModulesViewability(a)):"remove"===e.meta.action&&a.classList.remove(T)}else e.elem&&e.elem.classList.contains("stream-filter-login-tooltip-close")&&(window.localStorage.streamFilterLoginTooltipLastInteracted=Date.now())}})),x&&!window.waferStreamInitialized&&(window.waferStreamInitialized=!0,window.wafer.on("fetch:success",(function(e){e&&e.meta&&e.meta.data&&e.meta.data.html&&e.meta.data.html.indexOf("stream-items")>=0&&(E=document.querySelectorAll(".stream-items"))&&E.length&&ie()})),window.wafer.on("module:removed",(function(e){if(e&&e.elem){var t=e.elem.getElementsByClassName(".stream-items-initialized");t&&t.length&&(E=document.querySelectorAll(".stream-items"))}})))}));